<!doctype html><html><head><!doctype html><html lang=en-us><link rel=stylesheet href=/css/fonts.css><link rel=stylesheet href=/css/main-site.css><link rel=stylesheet href=/css/fa5-all.css><style type=text/css>body{background-color:#fff;color:#1a1917}a{color:#38577f}a:hover{color:#42709b}a:focus{outline-color:#42709b}.column25-left .sectionTitle a:hover:not(.current),.column16-left .sectionTitle a:hover:not(.current){color:#1a1917}.icon-attribution,.icon-attribution a{color:#1a1917;opacity:75%}#homeContent .band.first{background-color:#fff}#homeContent .band.second{background-color:#fdeba4}#homeContent .band.third{background-color:#fff}#rStudioHeader{background-color:#1a162d;color:#fff}#rStudioHeader .productName{color:#fff}#rStudioHeader .productName:hover,#rStudioHeader .productName:focus{color:#fdeba4}#rStudioHeader #menu .menuItem.a{background-color:#75aadb;color:#fff}#rStudioHeader #menu .menuItem:hover{background-color:#484557;color:#fff}#rStudioHeader #menu .menuItem.current{background-color:#fff;color:#1a162d;text-decoration:none}#rStudioFooter.band{background-color:#767381}#rStudioFooter .bandContent #copyright{color:#e3eef8}table tbody tr:nth-child(even){background-color:#f7faff}table tbody tr:nth-child(odd){background-color:#fff}.latest{border-top:.5em solid <no value>}.event{-moz-box-shadow:0 0 0 0 rgba(0,0,0,.1);-webkit-box-shadow:0 0 0 0 rgba(0,0,0,.1);box-shadow:0 0 0 0 rgba(0,0,0,.1)}.section .event{background-color:#eab0c41a}.section .event{border-top:7pt solid #a19ea936}.section .event a{color:#1a162d}.section .event{color:#404040}</style><link rel=stylesheet href=/css/tidyverse.css><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Hugo 0.71.1"><title>haven 2.3.0</title><meta property="og:title" content="haven 2.3.0"><meta property="og:description" content="haven now uses vctrs which means labelled classes will be preserved in tidyr and dplyr operation."><meta property="og:type" content="article"><meta property="og:url" content="https://www.tidyverse.org/blog/2020/06/haven-2-3-0/"><meta property="twitter:card" content="summary_large_image"><meta property="og:title" content="haven 2.3.0 - Tidyverse"><meta property="description" content="haven now uses vctrs which means labelled classes will be preserved in tidyr and dplyr operation."><meta property="og:description" content="haven now uses vctrs which means labelled classes will be preserved in tidyr and dplyr operation."><meta property="og:image" content="https://www.tidyverse.org/blog/2020/06/haven-2-3-0/thumbnail-sq.jpg"><meta name=twitter:image content="https://www.tidyverse.org/blog/2020/06/haven-2-3-0/thumbnail-wd.jpg"><link rel=apple-touch-icon sizes=180x180 href=/images/favicons/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/images/favicons/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/images/favicons/favicon-16x16.png><link rel=manifest href=/images/favicons/site.webmanifest><link rel=mask-icon href=/images/favicons/safari-pinned-tab.svg><link rel="shortcut icon" href=/images/favicons/favicon.ico><meta name=msapplication-TileColor content="#da532c"><meta name=msapplication-config href=/images/favicons/browserconfig.xml><script type=text/javascript src=/js/jquery-3.5.1.min.js></script><script type=text/javascript src=/js/site.js></script><link rel=icon href=/images/favicon.ico><script type=text/javascript src=/js/clipboard.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin=anonymous></script><script defer data-domain=tidyverse.org,all.tidyverse.org src=https://plausible.io/js/plausible.js></script></head><body><div id=appTidyverseSite class="shrinkHeader alwaysShrinkHeader"><div id=main><div id=rStudioHeader><nav class=band><div class="innards bandContent"><div><a class=productName href=/%20/>Tidyverse</a></div><div id=menu><div id=menuToggler></div><div id=menuItems><a class=menuItem href=/packages/>Packages</a>
<a class="menuItem current" href=/blog/>Blog</a>
<a class=menuItem href=/learn/>Learn</a>
<a class=menuItem href=/help/>Help</a>
<a class=menuItem href=/contribute/>Contribute</a></div></div></div></nav></div><main><div class="band padForHeader pushFooter"><div class=bandContent><div class="full splitColumns withMobileMargins"><div class=column75><h1 class=article-title>haven 2.3.0</h1><div class=article-header aria-hidden=true><div class=photo><img src=/blog/2020/06/haven-2-3-0/thumbnail-wd.jpg></div><div class=photoCredit>Photo by <a href=https://unsplash.com/photos/45GmTCcW8Hk>Sergey Nikolaev</a></div></div><span class=article-date><i class="fas fa-calendar-day fa-fw"></i>&nbsp;&nbsp;2020/06/01</span><p style=margin-bottom:.5em;margin-top:.85em><i class="fas fa-tags"></i>&nbsp;
<a href=/tags/tidyverse/>tidyverse</a>,
<a href=/tags/haven/>haven</a></p><p style=margin-top:.5em><i class="fas fa-user-circle fa-fw"></i>&nbsp;
Hadley Wickham</p><div class=article-content><p>We&rsquo;re tickled pink to announce the release of
<a href=https://haven.tidyverse.org target=_blank rel=noopener>haven</a> 2.3.0. haven allows you to read and write SAS, SPSS, and Stata data formats from R, thanks to the wonderful
<a href=https://github.com/WizardMac/ReadStat target=_blank rel=noopener>ReadStat</a> C library written by
<a href=https://www.evanmiller.org/ target=_blank rel=noopener>Evan Miller</a>.</p><p>You can install haven from CRAN with:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf>install.packages</span><span class=p>(</span><span class=s>&#34;haven&#34;</span><span class=p>)</span>
</code></pre></div><p>This release is mainly in preparation for dplyr 1.0.0. It includes improved
<a href=https://www.tidyverse.org/blog/2020/04/dplyr-1-0-0-and-vctrs/ target=_blank rel=noopener>vctrs support</a> for the <code>labelled()</code> class that haven uses to represent labelled vectors that come from SAS, Stata, and SPSS. This is not terribly exciting, but it means that the labelled class is now preserved by every dplyr operation where it makes sense:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf>library</span><span class=p>(</span><span class=n>haven</span><span class=p>)</span>
<span class=nf>library</span><span class=p>(</span><span class=n>dplyr</span><span class=p>,</span> <span class=n>warn.conflicts</span> <span class=o>=</span> <span class=kc>FALSE</span><span class=p>)</span>

<span class=n>x</span> <span class=o>&lt;-</span> <span class=nf>labelled</span><span class=p>(</span><span class=nf>sample</span><span class=p>(</span><span class=m>5</span><span class=p>),</span> <span class=nf>c</span><span class=p>(</span><span class=s>&#34;bad&#34;</span> <span class=o>=</span> <span class=m>1</span><span class=p>,</span> <span class=s>&#34;good&#34;</span> <span class=o>=</span> <span class=m>5</span><span class=p>),</span> <span class=s>&#34;scores&#34;</span><span class=p>)</span>
<span class=n>df</span> <span class=o>&lt;-</span> <span class=nf>tibble</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=kc>letters</span><span class=nf>[c</span><span class=p>(</span><span class=m>1</span><span class=p>,</span> <span class=m>3</span><span class=p>,</span> <span class=m>5</span><span class=p>,</span> <span class=m>7</span><span class=p>,</span> <span class=m>9</span><span class=p>)</span><span class=n>]</span><span class=p>)</span>
<span class=n>df</span>
<span class=c1>#&gt; # A tibble: 5 x 2</span>
<span class=c1>#&gt;           x y    </span>
<span class=c1>#&gt;   &lt;int+lbl&gt; &lt;chr&gt;</span>
<span class=c1>#&gt; 1  5 [good] a    </span>
<span class=c1>#&gt; 2  3        c    </span>
<span class=c1>#&gt; 3  4        e    </span>
<span class=c1>#&gt; 4  1 [bad]  g    </span>
<span class=c1>#&gt; 5  2        i</span>

<span class=n>df</span> <span class=o>%&gt;%</span> <span class=nf>arrange</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
<span class=c1>#&gt; # A tibble: 5 x 2</span>
<span class=c1>#&gt;           x y    </span>
<span class=c1>#&gt;   &lt;int+lbl&gt; &lt;chr&gt;</span>
<span class=c1>#&gt; 1  1 [bad]  g    </span>
<span class=c1>#&gt; 2  2        i    </span>
<span class=c1>#&gt; 3  3        c    </span>
<span class=c1>#&gt; 4  4        e    </span>
<span class=c1>#&gt; 5  5 [good] a</span>
<span class=n>df</span> <span class=o>%&gt;%</span> <span class=nf>filter</span><span class=p>(</span><span class=n>y</span> <span class=o>%in%</span> <span class=nf>c</span><span class=p>(</span><span class=s>&#34;a&#34;</span><span class=p>,</span> <span class=s>&#34;c&#34;</span><span class=p>))</span>
<span class=c1>#&gt; # A tibble: 2 x 2</span>
<span class=c1>#&gt;           x y    </span>
<span class=c1>#&gt;   &lt;int+lbl&gt; &lt;chr&gt;</span>
<span class=c1>#&gt; 1  5 [good] a    </span>
<span class=c1>#&gt; 2  3        c</span>

<span class=nf>bind_rows</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=n>df</span><span class=p>)</span>
<span class=c1>#&gt; # A tibble: 10 x 2</span>
<span class=c1>#&gt;            x y    </span>
<span class=c1>#&gt;    &lt;int+lbl&gt; &lt;chr&gt;</span>
<span class=c1>#&gt;  1  5 [good] a    </span>
<span class=c1>#&gt;  2  3        c    </span>
<span class=c1>#&gt;  3  4        e    </span>
<span class=c1>#&gt;  4  1 [bad]  g    </span>
<span class=c1>#&gt;  5  2        i    </span>
<span class=c1>#&gt;  6  5 [good] a    </span>
<span class=c1>#&gt;  7  3        c    </span>
<span class=c1>#&gt;  8  4        e    </span>
<span class=c1>#&gt;  9  1 [bad]  g    </span>
<span class=c1>#&gt; 10  2        i</span>

<span class=n>df2</span> <span class=o>&lt;-</span> <span class=nf>tibble</span><span class=p>(</span><span class=n>y</span> <span class=o>=</span> <span class=kc>letters</span><span class=n>[1</span><span class=o>:</span><span class=m>10</span><span class=n>]</span><span class=p>)</span>
<span class=n>df2</span> <span class=o>%&gt;%</span> <span class=nf>left_join</span><span class=p>(</span><span class=n>df</span><span class=p>)</span>
<span class=c1>#&gt; Joining, by = &#34;y&#34;</span>
<span class=c1>#&gt; # A tibble: 10 x 2</span>
<span class=c1>#&gt;    y             x</span>
<span class=c1>#&gt;    &lt;chr&gt; &lt;int+lbl&gt;</span>
<span class=c1>#&gt;  1 a      5 [good]</span>
<span class=c1>#&gt;  2 b     NA       </span>
<span class=c1>#&gt;  3 c      3       </span>
<span class=c1>#&gt;  4 d     NA       </span>
<span class=c1>#&gt;  5 e      4       </span>
<span class=c1>#&gt;  6 f     NA       </span>
<span class=c1>#&gt;  7 g      1 [bad] </span>
<span class=c1>#&gt;  8 h     NA       </span>
<span class=c1>#&gt;  9 i      2       </span>
<span class=c1>#&gt; 10 j     NA</span>
</code></pre></div><h2 id=acknowledgements>Acknowledgements
<a href=#acknowledgements><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>As always thanks to the GitHub community who helped make this release happen:
<a href=https://github.com/180312allison target=_blank rel=noopener>@180312allison</a>,
<a href=https://github.com/armenic target=_blank rel=noopener>@armenic</a>,
<a href=https://github.com/batpigandme target=_blank rel=noopener>@batpigandme</a>,
<a href=https://github.com/beckerbenj target=_blank rel=noopener>@beckerbenj</a>,
<a href=https://github.com/bergen288 target=_blank rel=noopener>@bergen288</a>,
<a href=https://github.com/courtiol target=_blank rel=noopener>@courtiol</a>,
<a href=https://github.com/deschen1 target=_blank rel=noopener>@deschen1</a>,
<a href=https://github.com/edvbb target=_blank rel=noopener>@edvbb</a>,
<a href=https://github.com/Ghanshyamsavaliya target=_blank rel=noopener>@Ghanshyamsavaliya</a>,
<a href=https://github.com/hadley target=_blank rel=noopener>@hadley</a>,
<a href=https://github.com/JackLandry target=_blank rel=noopener>@JackLandry</a>,
<a href=https://github.com/Jagadeeshkb target=_blank rel=noopener>@Jagadeeshkb</a>,
<a href=https://github.com/jimhester target=_blank rel=noopener>@jimhester</a>,
<a href=https://github.com/kurt-vd target=_blank rel=noopener>@kurt-vd</a>,
<a href=https://github.com/larmarange target=_blank rel=noopener>@larmarange</a>,
<a href=https://github.com/lionel- target=_blank rel=noopener>@lionel-</a>,
<a href=https://github.com/mayer79 target=_blank rel=noopener>@mayer79</a>,
<a href=https://github.com/mikmart target=_blank rel=noopener>@mikmart</a>,
<a href=https://github.com/mitchelloharawild target=_blank rel=noopener>@mitchelloharawild</a>,
<a href=https://github.com/omsai target=_blank rel=noopener>@omsai</a>,
<a href=https://github.com/pdbailey0 target=_blank rel=noopener>@pdbailey0</a>,
<a href=https://github.com/randrescastaneda target=_blank rel=noopener>@randrescastaneda</a>,
<a href=https://github.com/richarddmorey target=_blank rel=noopener>@richarddmorey</a>,
<a href=https://github.com/romainfrancois target=_blank rel=noopener>@romainfrancois</a>,
<a href=https://github.com/rubenarslan target=_blank rel=noopener>@rubenarslan</a>,
<a href=https://github.com/sda030 target=_blank rel=noopener>@sda030</a>,
<a href=https://github.com/Sdurier target=_blank rel=noopener>@Sdurier</a>, and
<a href=https://github.com/tobwen target=_blank rel=noopener>@tobwen</a>.</p></div></div><div class=column25><div class="section hideOnMobile"><div class=sectionTitle>Contents</div><nav id=TableOfContents><ul><li><a href=#acknowledgements>Acknowledgements</a></li></ul></nav></div><div class=section></div></div></div></div></div><div id=rStudioFooter class=band><div class=bandContent><div id=copyright>The tidyverse is proudly supported by <a class=rstudioLogo href=https://posit.co/ aria-label="Posit Homepage"></a></div><div id=logos><a href=https://www.tidyverse.org/google_privacy_policy>Privacy policy</a>
<a href=https://github.com/tidyverse class="footerLogo gitHub" aria-label="Tidyverse GitHub organization"></a><a href=https://twitter.com/hashtag/rstats class="footerLogo twitter" aria-label="rstats hashtag on twitter.com"></a></div></div></div></div></div><script type=application/javascript>var dnt=(navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack);var doNotTrack=(dnt=="1"||dnt=="yes");if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');if(window.sessionStorage){var GA_SESSION_STORAGE_KEY='ga:clientId';ga('create','UA-115082821-1',{'storage':'none','clientId':sessionStorage.getItem(GA_SESSION_STORAGE_KEY)});ga(function(tracker){sessionStorage.setItem(GA_SESSION_STORAGE_KEY,tracker.get('clientId'));});}
ga('set','anonymizeIp',true);ga('send','pageview');}</script></body></html></div></div></body></html>