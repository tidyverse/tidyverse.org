<!doctype html><html><head><!doctype html><html lang=en-us><link rel=stylesheet href=/css/fonts.css><link rel=stylesheet href=/css/main-site.css><link rel=stylesheet href=/css/fa5-all.css><style type=text/css>body{background-color:#fff;color:#1a1917}a{color:#38577f}a:hover{color:#42709b}a:focus{outline-color:#42709b}.column25-left .sectionTitle a:hover:not(.current),.column16-left .sectionTitle a:hover:not(.current){color:#1a1917}.icon-attribution,.icon-attribution a{color:#1a1917;opacity:75%}#homeContent .band.first{background-color:#fff}#homeContent .band.second{background-color:#fdeba4}#homeContent .band.third{background-color:#fff}#rStudioHeader{background-color:#1a162d;color:#fff}#rStudioHeader .productName{color:#fff}#rStudioHeader .productName:hover,#rStudioHeader .productName:focus{color:#fdeba4}#rStudioHeader #menu .menuItem.a{background-color:#75aadb;color:#fff}#rStudioHeader #menu .menuItem:hover{background-color:#484557;color:#fff}#rStudioHeader #menu .menuItem.current{background-color:#fff;color:#1a162d;text-decoration:none}#rStudioFooter.band{background-color:#767381}#rStudioFooter .bandContent #copyright{color:#e3eef8}table tbody tr:nth-child(even){background-color:#f7faff}table tbody tr:nth-child(odd){background-color:#fff}.latest{border-top:.5em solid <no value>}.event{-moz-box-shadow:0 0 0 0 rgba(0,0,0,.1);-webkit-box-shadow:0 0 0 0 rgba(0,0,0,.1);box-shadow:0 0 0 0 rgba(0,0,0,.1)}.section .event{background-color:#eab0c41a}.section .event{border-top:7pt solid #a19ea936}.section .event a{color:#1a162d}.section .event{color:#404040}</style><link rel=stylesheet href=/css/tidyverse.css><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Hugo 0.71.1"><title>Taking Control of Plot Scaling</title><meta property="og:title" content="Taking Control of Plot Scaling"><meta property="og:description" content="Learn how to control scaling of the content in your plot when you render plots to different sizes."><meta property="og:type" content="article"><meta property="og:url" content="https://www.tidyverse.org/blog/2020/08/taking-control-of-plot-scaling/"><meta property="twitter:card" content="summary_large_image"><meta property="og:title" content="Taking Control of Plot Scaling - Tidyverse"><meta property="description" content="Learn how to control scaling of the content in your plot when you render plots to different sizes."><meta property="og:description" content="Learn how to control scaling of the content in your plot when you render plots to different sizes."><meta property="og:image" content="https://www.tidyverse.org/blog/2020/08/taking-control-of-plot-scaling/thumbnail-sq.jpg"><meta name=twitter:image content="https://www.tidyverse.org/blog/2020/08/taking-control-of-plot-scaling/thumbnail-wd.jpg"><link rel=apple-touch-icon sizes=180x180 href=/images/favicons/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/images/favicons/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/images/favicons/favicon-16x16.png><link rel=manifest href=/images/favicons/site.webmanifest><link rel=mask-icon href=/images/favicons/safari-pinned-tab.svg><link rel="shortcut icon" href=/images/favicons/favicon.ico><meta name=msapplication-TileColor content="#da532c"><meta name=msapplication-config href=/images/favicons/browserconfig.xml><script type=text/javascript src=/js/jquery-3.5.1.min.js></script><script type=text/javascript src=/js/site.js></script><link rel=icon href=/images/favicon.ico><script type=text/javascript src=/js/clipboard.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin=anonymous></script><script defer data-domain=tidyverse.org,all.tidyverse.org src=https://plausible.io/js/plausible.js></script></head><body><div id=appTidyverseSite class="shrinkHeader alwaysShrinkHeader"><div id=main><div id=rStudioHeader><nav class=band><div class="innards bandContent"><div><a class=productName href=/>Tidyverse</a></div><div id=menu><div id=menuToggler></div><div id=menuItems><a class=menuItem href=/packages/>Packages</a>
<a class="menuItem current" href=/blog/>Blog</a>
<a class=menuItem href=/learn/>Learn</a>
<a class=menuItem href=/help/>Help</a>
<a class=menuItem href=/contribute/>Contribute</a></div></div></div></nav></div><main><div class="band padForHeader pushFooter"><div class=bandContent><div class="full splitColumns withMobileMargins"><div class=column75><h1 class=article-title>Taking Control of Plot Scaling</h1><div class=article-header aria-hidden=true><div class=photo><img src=/blog/2020/08/taking-control-of-plot-scaling/thumbnail-wd.jpg></div><div class=photoCredit>Photo by <a href=https://unsplash.com/photos/6GjHwABuci4>Mikael Kristenson</a></div></div><span class=article-date><i class="fas fa-calendar-day fa-fw"></i>&nbsp;&nbsp;2020/08/21</span><p style=margin-bottom:.5em;margin-top:.85em><i class="fas fa-tags"></i>&nbsp;
<a href=/tags/graphics/>graphics</a>,
<a href=/tags/ragg/>ragg</a></p><p style=margin-top:.5em><i class="fas fa-user-circle fa-fw"></i>&nbsp;
Thomas Lin Pedersen</p><div class=article-content><p>Some time ago, while working on the new edition of the ggplot2 book, I asked out to the R twitterverse what part of using ggplot2 was the most incomprehensible for seasoned users. By a very large margin the most &ldquo;popular&rdquo; response revolved around making sure that output had the correct scaling of text, lines, etc.</p><p>The latest release of ragg contains a new functionality that will hopefully make this issue a thing of the past. Read on how to use it.</p><h2 id=some-definitions>Some definitions
<a href=#some-definitions><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Before we delve into the problem we should clarify a few concepts related to graphics and sizing:</p><p><strong>Absolute size:</strong> This is the physical dimensions of the graphic (or, more precisely, the intended physical dimensions). This is measured in centimeters or inches or another absolute length unit.</p><p><strong>Pixel size:</strong> For raster output, the graphic is encoded as a matrix of color values. Each cell in the matrix is a pixel. The pixel size is the number of rows and columns in the matrix. Pixels does not have any inherent physical size.</p><p><strong>Resolution:</strong> This number ties absolute and pixel size together. It is usually given in ppi (pixels per inch), though dpi (dots per inch) is used interchangeably. A resolution of 72 ppi means that an inch is considered 72 pixels long.</p><p><strong>Pointsize:</strong> This is a measure tied to text sizing. When we set a font to size 12, it is given in points. While the actual size of a point has
<a href=https://en.wikipedia.org/wiki/Point_%28typography%29#Varying_standards target=_blank rel=noopener>varied throughout history</a>, the general consensus now is that 1pt = 1/72 inch (this is also adopted by R). Since points is an absolute unit, the resolution of the output will determine the number of pixels it correspond to.</p><h2 id=the-problem>The problem
<a href=#the-problem><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>With formalities out of the way, we can describe the problem more clearly. At its core, this is about ensuring the correct scaling of a plot as we develop it for varying absolute sizes.</p><p>When we develop a graphic we will generally sit in front of a computer and fine tune it while continuously getting previews on the screen. Once we are content with it we will save it to the correct absolute size required by wherever we intend to publish the plot. In the remainder of the text we will assume that we sit in front of a computer developing a plot that should end up on a poster.</p><p>This is the plot, and how it looks on a computer:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf><a href=https://rdrr.io/r/base/library.html>library</a></span>(<span class=k><a href=http://ggplot2.tidyverse.org>ggplot2</a></span>)
<span class=nf><a href=https://rdrr.io/r/base/library.html>library</a></span>(<span class=k><a href=https://ragg.r-lib.org>ragg</a></span>)
<span class=nf><a href=https://rdrr.io/r/base/library.html>library</a></span>(<span class=k><a href=https://allisonhorst.github.io/palmerpenguins>palmerpenguins</a></span>)

<span class=c># plot adapted from https://github.com/allisonhorst/palmerpenguins</span>
<span class=k>p</span> <span class=o>&lt;-</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/ggplot.html>ggplot</a></span>(<span class=nf><a href=https://rdrr.io/r/stats/na.fail.html>na.omit</a></span>(<span class=k>penguins</span>), <span class=nf><a href=https://ggplot2.tidyverse.org/reference/aes.html>aes</a></span>(x = <span class=k>flipper_length_mm</span>, y = <span class=k>body_mass_g</span>)) <span class=o>+</span>
  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/geom_point.html>geom_point</a></span>(
    <span class=nf><a href=https://ggplot2.tidyverse.org/reference/aes.html>aes</a></span>(color = <span class=k>species</span>, shape = <span class=k>species</span>),
    size = <span class=m>3</span>,
    alpha = <span class=m>0.8</span>
  ) <span class=o>+</span> 
  <span class=k>ggforce</span>::<span class=nf><a href=https://ggforce.data-imaginist.com/reference/geom_mark_ellipse.html>geom_mark_ellipse</a></span>(
    <span class=nf><a href=https://ggplot2.tidyverse.org/reference/aes.html>aes</a></span>(filter = <span class=k>species</span> <span class=o>==</span> <span class=s>"Gentoo"</span>, 
        description = <span class=s>"Gentoo penguins are generally bigger in size"</span>)
  ) <span class=o>+</span> 
  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/labs.html>labs</a></span>(x = <span class=s>"Flipper Length [mm]"</span>, y = <span class=s>"Body Mass [g]"</span>,  colour = <span class=s>"Species"</span>, 
       shape = <span class=s>"Species"</span>)

<span class=k>pngfile</span> <span class=o>&lt;-</span> <span class=k>fs</span>::<span class=nf><a href=http://fs.r-lib.org/reference/path.html>path</a></span>(<span class=k>knitr</span>::<span class=nf><a href=https://rdrr.io/pkg/knitr/man/fig_path.html>fig_path</a></span>(),  <span class=s>"basis.png"</span>)

<span class=c># I'm explicitly calling the device functions so you can see the dimensions </span>
<span class=c># used</span>
<span class=nf><a href=https://ragg.r-lib.org/reference/agg_png.html>agg_png</a></span>(<span class=k>pngfile</span>, width = <span class=m>20</span>, height = <span class=m>12</span>, units = <span class=s>"cm"</span>, res = <span class=m>300</span>)
<span class=nf><a href=https://rdrr.io/r/graphics/plot.default.html>plot</a></span>(<span class=k>p</span>)
<span class=nf><a href=https://rdrr.io/r/base/invisible.html>invisible</a></span>(<span class=nf><a href=https://rdrr.io/r/grDevices/dev.html>dev.off</a></span>())
<span class=k>knitr</span>::<span class=nf><a href=https://rdrr.io/pkg/knitr/man/include_graphics.html>include_graphics</a></span>(<span class=k>pngfile</span>)
</code></pre><p><img src=figs/unnamed-chunk-1-1/basis.png width style=display:block;margin:auto></p></div><p>This looks good, but remember we want to use this on a poster. A poster is usually observed at a farther distance than a computer screen, so in order to make it legible the plot should be bigger. How much bigger? Well, if we assume that we are watching our screen at 50 cm distance, and our poster is meant to be observed at 1.5 m distance, then our plot should be 3 times larger to take up the same amount of space in our vision:</p><p><img src=scaling.png alt="Schematic representation of the fact that size must increase by the same factor as distance to object in order to continue taking up the same amount of space in the vision"></p><p>With that in mind we quickly size up our plot:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=k>pngfile</span> <span class=o>&lt;-</span> <span class=k>fs</span>::<span class=nf><a href=http://fs.r-lib.org/reference/path.html>path</a></span>(<span class=k>knitr</span>::<span class=nf><a href=https://rdrr.io/pkg/knitr/man/fig_path.html>fig_path</a></span>(),  <span class=s>"large_basis.png"</span>)
<span class=nf><a href=https://ragg.r-lib.org/reference/agg_png.html>agg_png</a></span>(<span class=k>pngfile</span>, width = <span class=m>60</span>, height = <span class=m>36</span>, units = <span class=s>"cm"</span>, res = <span class=m>300</span>)
<span class=nf><a href=https://rdrr.io/r/graphics/plot.default.html>plot</a></span>(<span class=k>p</span>)
<span class=nf><a href=https://rdrr.io/r/base/invisible.html>invisible</a></span>(<span class=nf><a href=https://rdrr.io/r/grDevices/dev.html>dev.off</a></span>())
<span class=k>knitr</span>::<span class=nf><a href=https://rdrr.io/pkg/knitr/man/include_graphics.html>include_graphics</a></span>(<span class=k>pngfile</span>)
</code></pre><p><img src=figs/unnamed-chunk-2-1/large_basis.png width style=display:block;margin:auto></p></div><p>The plot above doesn&rsquo;t look physically larger, but that is because the webpage downscales it to make it fit. You can download each of the images and open them in a image editor to convince yourself that they are of different absolute size. The downscaling done by the webpage allows us to simulate how looking at our poster may feel like, and it is not pretty; everything seems super small and ineligible.</p><p>Why is that? Our plot is a mix of elements positioned and dimensioned based on both relative and absolute sizes. While the relative sizes expand along with the output size, the absolute sizes does not. The text is given in points which, as you recall, is an absolute dimension. The same is true for the element sizes in the scatterplot, the grid lines, etc. This means that as we scale up the output size, they remain the same size and will thus get smaller relative to the full image.</p><blockquote><p>The reverse can be a problem as well. If you render a plot to a smaller size than the one you&rsquo;ve previewed you may find that text, margins, etc. take up all the available space.</p></blockquote><p>Now, how should we go about correcting this?</p><h2 id=attempt-1-use-vector-graphics>Attempt 1: Use vector graphics
<a href=#attempt-1-use-vector-graphics><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>The discussion above is especially relevant to raster output since they don&rsquo;t resize gracefully and it is thus very important to get the correct dimensions and resolution when it is rendered. One way to resolve this is to not render to raster but use a vector graphic device such as
<a href=https://rdrr.io/r/grDevices/pdf.html target=_blank rel=noopener><code>pdf()</code></a> or <code>svglite()</code>. With these you can simply render the graphic to a size where everything looks as it should and then resize the output to the physical size that you need. There are valid reasons to not want to use vector graphics, however. The look of the output may change depending on which program opens them. Custom fonts may not render correctly on other systems. Or you may have such a large amount of graphical elements that the vector graphic becomes unreasonably large and heavy to display. If none of this applies then using a vector graphic device is definitely a valid and reasonable solution. For the remainder of the post we assume that we want the output in a raster format such as png and explore how we may fix our scaling issues there.</p><h2 id=attempt-2-theming>Attempt 2: Theming
<a href=#attempt-2-theming><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>One approach to fixing this is by changing the theme settings of the plot, so that they work better for a larger size:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=k>p1</span> <span class=o>&lt;-</span> <span class=k>p</span> <span class=o>+</span> 
  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/ggtheme.html>theme_gray</a></span>(base_size = <span class=m>33</span>)
<span class=k>pngfile</span> <span class=o>&lt;-</span> <span class=k>fs</span>::<span class=nf><a href=http://fs.r-lib.org/reference/path.html>path</a></span>(<span class=k>knitr</span>::<span class=nf><a href=https://rdrr.io/pkg/knitr/man/fig_path.html>fig_path</a></span>(),  <span class=s>"theming.png"</span>)
<span class=nf><a href=https://ragg.r-lib.org/reference/agg_png.html>agg_png</a></span>(<span class=k>pngfile</span>, width = <span class=m>60</span>, height = <span class=m>36</span>, units = <span class=s>"cm"</span>, res = <span class=m>300</span>)
<span class=nf><a href=https://rdrr.io/r/graphics/plot.default.html>plot</a></span>(<span class=k>p1</span>)
<span class=nf><a href=https://rdrr.io/r/base/invisible.html>invisible</a></span>(<span class=nf><a href=https://rdrr.io/r/grDevices/dev.html>dev.off</a></span>())
<span class=k>knitr</span>::<span class=nf><a href=https://rdrr.io/pkg/knitr/man/include_graphics.html>include_graphics</a></span>(<span class=k>pngfile</span>)
</code></pre><p><img src=figs/unnamed-chunk-3-1/theming.png width style=display:block;margin:auto></p></div><p>This approach got us surprisingly far. A lot of the theme elements of the plot is derived from the base size argument so many adapts. Not all though, as we can see the legend keys maintaining their relative small size. If you&rsquo;ve been using a custom theme it may also be that you&rsquo;ve overwritten some of the default sizes and will need to change that as well.</p><p>One thing missing is all the non-theme elements (i.e. things part of the layer). Because of this we&rsquo;d have to redo the whole plot in order to get the desired result:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=k>p1</span> <span class=o>&lt;-</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/ggplot.html>ggplot</a></span>(<span class=nf><a href=https://rdrr.io/r/stats/na.fail.html>na.omit</a></span>(<span class=k>penguins</span>), <span class=nf><a href=https://ggplot2.tidyverse.org/reference/aes.html>aes</a></span>(x = <span class=k>flipper_length_mm</span>, y = <span class=k>body_mass_g</span>)) <span class=o>+</span>
  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/geom_point.html>geom_point</a></span>(
    <span class=nf><a href=https://ggplot2.tidyverse.org/reference/aes.html>aes</a></span>(color = <span class=k>species</span>, shape = <span class=k>species</span>),
    size = <span class=m>9</span>,
    alpha = <span class=m>0.8</span>
  ) <span class=o>+</span> 
  <span class=k>ggforce</span>::<span class=nf><a href=https://ggforce.data-imaginist.com/reference/geom_mark_ellipse.html>geom_mark_ellipse</a></span>(
    <span class=nf><a href=https://ggplot2.tidyverse.org/reference/aes.html>aes</a></span>(filter = <span class=k>species</span> <span class=o>==</span> <span class=s>"Gentoo"</span>, 
        description = <span class=s>"Gentoo penguins are generally bigger in size"</span>),
    size = <span class=m>1.5</span>,
    label.fontsize = <span class=m>36</span>
  ) <span class=o>+</span> 
  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/labs.html>labs</a></span>(x = <span class=s>"Flipper Length [mm]"</span>, y = <span class=s>"Body Mass [g]"</span>,  colour = <span class=s>"Species"</span>, 
       shape = <span class=s>"Species"</span>) <span class=o>+</span> 
  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/ggtheme.html>theme_gray</a></span>(base_size = <span class=m>33</span>)
<span class=k>pngfile</span> <span class=o>&lt;-</span> <span class=k>fs</span>::<span class=nf><a href=http://fs.r-lib.org/reference/path.html>path</a></span>(<span class=k>knitr</span>::<span class=nf><a href=https://rdrr.io/pkg/knitr/man/fig_path.html>fig_path</a></span>(),  <span class=s>"theming2.png"</span>)
<span class=nf><a href=https://ragg.r-lib.org/reference/agg_png.html>agg_png</a></span>(<span class=k>pngfile</span>, width = <span class=m>60</span>, height = <span class=m>36</span>, units = <span class=s>"cm"</span>, res = <span class=m>300</span>)
<span class=nf><a href=https://rdrr.io/r/graphics/plot.default.html>plot</a></span>(<span class=k>p1</span>)
<span class=nf><a href=https://rdrr.io/r/base/invisible.html>invisible</a></span>(<span class=nf><a href=https://rdrr.io/r/grDevices/dev.html>dev.off</a></span>())
<span class=k>knitr</span>::<span class=nf><a href=https://rdrr.io/pkg/knitr/man/include_graphics.html>include_graphics</a></span>(<span class=k>pngfile</span>)
</code></pre><p><img src=figs/unnamed-chunk-4-1/theming2.png width style=display:block;margin:auto></p></div><p>We can see that we are getting there, but the journey hasn&rsquo;t been pleasant. Especially for the last part it requires knowledge of all the different settings in a geom that encodes absolute sizes. For the mark geom we only fixed the ellipse line width and the text size, but there are many more settings that needs to be updated as well as is apparent from the weird look of the text box.</p><p>Another issue that arises is that if we need this plot at yet another different scale, we will need to change quite a lot of code in order to get there.</p><h2 id=attempt-3-resolution-scaling>Attempt 3: Resolution scaling
<a href=#attempt-3-resolution-scaling><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Since the resolution is the parameter that ties the pixel size and absolute size together it is possible to use it as a scaling factor, but it requires some non-obvious adjustments:</p><p>The first thing we need to do is convert our physical dimensions to pixel dimensions using our desired resolution. We want to end up with a 60x36cm plot at 300ppi. This gives us:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf><a href=https://rdrr.io/r/base/c.html>c</a></span>(<span class=m>60</span>, <span class=m>36</span>) <span class=o>*</span>
  <span class=m>0.3937</span> <span class=o>*</span> <span class=c># convert to inch</span>
  <span class=m>300</span> <span class=c># convert to pixels</span>
<span class=c>#&gt; [1] 7086.60 4251.96</span></code></pre></div><p>We can now use these values directly in our device and change the resolution of the device to trick it into thinking that text etc should be rendered at a larger size</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=k>pngfile</span> <span class=o>&lt;-</span> <span class=k>fs</span>::<span class=nf><a href=http://fs.r-lib.org/reference/path.html>path</a></span>(<span class=k>knitr</span>::<span class=nf><a href=https://rdrr.io/pkg/knitr/man/fig_path.html>fig_path</a></span>(),  <span class=s>"resolution.png"</span>)
<span class=nf><a href=https://ragg.r-lib.org/reference/agg_png.html>agg_png</a></span>(<span class=k>pngfile</span>, width = <span class=m>7087</span>, height = <span class=m>4252</span>, units = <span class=s>"px"</span>, res = <span class=m>900</span>)
<span class=nf><a href=https://rdrr.io/r/graphics/plot.default.html>plot</a></span>(<span class=k>p</span>)
<span class=nf><a href=https://rdrr.io/r/base/invisible.html>invisible</a></span>(<span class=nf><a href=https://rdrr.io/r/grDevices/dev.html>dev.off</a></span>())
<span class=k>knitr</span>::<span class=nf><a href=https://rdrr.io/pkg/knitr/man/include_graphics.html>include_graphics</a></span>(<span class=k>pngfile</span>)
</code></pre><p><img src=figs/unnamed-chunk-6-1/resolution.png width style=display:block;margin:auto></p></div><p>This actually works exactly as we hoped. We&rsquo;ve gotten our huge version of the plot but with the same exact scaling of all graphic elements.</p><p>Depending on your temperament this may be a perfect solution. To me, I think the conversion from physical dimensions to pixels is tedious, and it has the added drawback that the dimensions of the plot is incorrectly encoded (it will appear as a 20*12cm plot at 900ppi) which may impact how it is presented in different programs. In the end you may have to manually resize it to get the correct physical dimensions in the end.</p><h2 id=the-solution>The solution
<a href=#the-solution><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Seeing that there is no single perfect solution to fixing this with the tools at our disposal, I&rsquo;ve added a new argument to the ragg devices called <code>scaling</code>. It&rsquo;s a multiplier that is applied to all absolute sizes, without interfering with the encoded dimensions of the output. Since we have increased the dimensions 3 times we set <code>scaling = 3</code> to make sure that the absolute sized elements are keeping their relative size.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=k>pngfile</span> <span class=o>&lt;-</span> <span class=k>fs</span>::<span class=nf><a href=http://fs.r-lib.org/reference/path.html>path</a></span>(<span class=k>knitr</span>::<span class=nf><a href=https://rdrr.io/pkg/knitr/man/fig_path.html>fig_path</a></span>(),  <span class=s>"scaling.png"</span>)
<span class=nf><a href=https://ragg.r-lib.org/reference/agg_png.html>agg_png</a></span>(<span class=k>pngfile</span>, width = <span class=m>60</span>, height = <span class=m>36</span>, units = <span class=s>"cm"</span>, res = <span class=m>300</span>, scaling = <span class=m>3</span>)
<span class=nf><a href=https://rdrr.io/r/graphics/plot.default.html>plot</a></span>(<span class=k>p</span>)
<span class=nf><a href=https://rdrr.io/r/base/invisible.html>invisible</a></span>(<span class=nf><a href=https://rdrr.io/r/grDevices/dev.html>dev.off</a></span>())
<span class=k>knitr</span>::<span class=nf><a href=https://rdrr.io/pkg/knitr/man/include_graphics.html>include_graphics</a></span>(<span class=k>pngfile</span>)
</code></pre><p><img src=figs/unnamed-chunk-7-1/scaling.png width style=display:block;margin:auto></p></div><p>As can be seen, the new argument makes it very easy to reclaim the look of the plot after resizing. Hopefully this will remove a good deal of the pain related to generating plots for papers, posters, presentations, etc. You do have to remember to use the same scaling setting for all plots for them to have the same sizing, but apart from that it makes it very easy to fine tune the look for the medium your creating it for.</p><p>Remember that the scaling factor of <code>3</code> was simply chosen to fit our presumed viewing distance and should not be repeated without thought. Another example would be to create a small version of the plot, e.g. for a thumbnail on a webpage. While there is no harm in manually scaling down a raster image, you may find that especially text is more readable when rendered to the desired size directly. To show this off we&rsquo;ll make a half-sized version of our plot as well. To spruce it up we&rsquo;ll use
<a href=https://ggplot2.tidyverse.org/reference/ggsave.html target=_blank rel=noopener><code>ggsave()</code></a> instead of calling the ragg device directly. Let&rsquo;s see how it looks without using scaling first:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=k>pngfile</span> <span class=o>&lt;-</span> <span class=k>fs</span>::<span class=nf><a href=http://fs.r-lib.org/reference/path.html>path</a></span>(<span class=k>knitr</span>::<span class=nf><a href=https://rdrr.io/pkg/knitr/man/fig_path.html>fig_path</a></span>(),  <span class=s>"small"</span>)
<span class=nf><a href=https://ggplot2.tidyverse.org/reference/ggsave.html>ggsave</a></span>(
  <span class=k>pngfile</span>, 
  <span class=k>p</span>, 
  device = <span class=k>agg_png</span>, 
  width = <span class=m>10</span>, height = <span class=m>6</span>, units = <span class=s>"cm"</span>, res = <span class=m>300</span>
)
<span class=k>knitr</span>::<span class=nf><a href=https://rdrr.io/pkg/knitr/man/include_graphics.html>include_graphics</a></span>(<span class=k>pngfile</span>)
</code></pre><p><img src=figs/unnamed-chunk-8-1/small width=50% style=display:block;margin:auto></p></div><p>As we can see, everything feels oversized for the plot, and the margins takes up way too much relative space. Using <code>scaling</code> we quickly resolve this:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=k>pngfile</span> <span class=o>&lt;-</span> <span class=k>fs</span>::<span class=nf><a href=http://fs.r-lib.org/reference/path.html>path</a></span>(<span class=k>knitr</span>::<span class=nf><a href=https://rdrr.io/pkg/knitr/man/fig_path.html>fig_path</a></span>(),  <span class=s>"downscaling.png"</span>)
<span class=nf><a href=https://ggplot2.tidyverse.org/reference/ggsave.html>ggsave</a></span>(
  <span class=k>pngfile</span>, 
  <span class=k>p</span>, 
  device = <span class=k>agg_png</span>, 
  width = <span class=m>10</span>, height = <span class=m>6</span>, units = <span class=s>"cm"</span>, res = <span class=m>300</span>,
  scaling = <span class=m>0.5</span>
)
<span class=k>knitr</span>::<span class=nf><a href=https://rdrr.io/pkg/knitr/man/include_graphics.html>include_graphics</a></span>(<span class=k>pngfile</span>)
</code></pre><p><img src=figs/unnamed-chunk-9-1/downscaling.png width=50% style=display:block;margin:auto></p></div><h2 id=addendum>Addendum
<a href=#addendum><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><ul><li>Preparing graphics for the web presents an additional hurdle. The HTML specification assumes a screen resolution of 96ppi since that was the predominant screen resolution at the time. Modern monitors have a much higher resolution but the assumption is still in effect (though operating systems may mitigate it). This is the reason why plots may look slightly smaller when rendered through Shiny, blogdown, or hugodown. Simply set the resolution to 96ppi and use pixel dimensions for the output to make sure it has the correct scaling.</li><li>Rendering images with RMarkdown requires some care as well since chunk options both take an output dimension in inches as well as a scaling factor for how big the rendered image should appear in the document.
<a href=https://r4ds.had.co.nz/graphics-for-communication.html#figure-sizing target=_blank rel=noopener>R for Data Science</a> has some additional information on this</li></ul></div></div><div class=column25><div class="section hideOnMobile"><div class=sectionTitle>Contents</div><nav id=TableOfContents><ul><li><a href=#some-definitions>Some definitions</a></li><li><a href=#the-problem>The problem</a></li><li><a href=#attempt-1-use-vector-graphics>Attempt 1: Use vector graphics</a></li><li><a href=#attempt-2-theming>Attempt 2: Theming</a></li><li><a href=#attempt-3-resolution-scaling>Attempt 3: Resolution scaling</a></li><li><a href=#the-solution>The solution</a></li><li><a href=#addendum>Addendum</a></li></ul></nav></div><div class=section></div></div></div></div></div><div id=rStudioFooter class=band><div class=bandContent><div id=copyright>The tidyverse is proudly supported by <a class=rstudioLogo href=https://posit.co/ aria-label="Posit Homepage"></a></div><div id=logos><a href=https://www.tidyverse.org/google_privacy_policy>Privacy policy</a>
<a href=https://github.com/tidyverse class="footerLogo gitHub" aria-label="Tidyverse GitHub organization"></a><a href=https://twitter.com/hashtag/rstats class="footerLogo twitter" aria-label="rstats hashtag on twitter.com"></a></div></div></div></div></div><script type=application/javascript>var dnt=(navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack);var doNotTrack=(dnt=="1"||dnt=="yes");if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');if(window.sessionStorage){var GA_SESSION_STORAGE_KEY='ga:clientId';ga('create','UA-115082821-1',{'storage':'none','clientId':sessionStorage.getItem(GA_SESSION_STORAGE_KEY)});ga(function(tracker){sessionStorage.setItem(GA_SESSION_STORAGE_KEY,tracker.get('clientId'));});}
ga('set','anonymizeIp',true);ga('send','pageview');}</script></body></html></div></div></body></html>