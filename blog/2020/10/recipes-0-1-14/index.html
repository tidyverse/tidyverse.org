<!doctype html><html><head><!doctype html><html lang=en-us><link rel=stylesheet href=/css/fonts.css><link rel=stylesheet href=/css/main-site.css><link rel=stylesheet href=/css/fa5-all.css><style type=text/css>body{background-color:#fff;color:#1a1917}a{color:#38577f}a:hover{color:#42709b}a:focus{outline-color:#42709b}.column25-left .sectionTitle a:hover:not(.current),.column16-left .sectionTitle a:hover:not(.current){color:#1a1917}.icon-attribution,.icon-attribution a{color:#1a1917;opacity:75%}#homeContent .band.first{background-color:#fff}#homeContent .band.second{background-color:#fdeba4}#homeContent .band.third{background-color:#fff}#rStudioHeader{background-color:#1a162d;color:#fff}#rStudioHeader .productName{color:#fff}#rStudioHeader .productName:hover,#rStudioHeader .productName:focus{color:#fdeba4}#rStudioHeader #menu .menuItem.a{background-color:#75aadb;color:#fff}#rStudioHeader #menu .menuItem:hover{background-color:#484557;color:#fff}#rStudioHeader #menu .menuItem.current{background-color:#fff;color:#1a162d;text-decoration:none}#rStudioFooter.band{background-color:#767381}#rStudioFooter .bandContent #copyright{color:#e3eef8}table tbody tr:nth-child(even){background-color:#f7faff}table tbody tr:nth-child(odd){background-color:#fff}.latest{border-top:.5em solid <no value>}.event{-moz-box-shadow:0 0 0 0 rgba(0,0,0,.1);-webkit-box-shadow:0 0 0 0 rgba(0,0,0,.1);box-shadow:0 0 0 0 rgba(0,0,0,.1)}.section .event{background-color:#eab0c41a}.section .event{border-top:7pt solid #a19ea936}.section .event a{color:#1a162d}.section .event{color:#404040}</style><link rel=stylesheet href=/css/tidyverse.css><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Hugo 0.71.1"><title>recipes 0.1.14</title><meta property="og:title" content="recipes 0.1.14"><meta property="og:description" content="A new version of the recipes package contains a signficant API update and  some additional features."><meta property="og:type" content="article"><meta property="og:url" content="https://www.tidyverse.org/blog/2020/10/recipes-0-1-14/"><meta property="twitter:card" content="summary_large_image"><meta property="og:title" content="recipes 0.1.14 - Tidyverse"><meta property="description" content="A new version of the recipes package contains a signficant API update and  some additional features."><meta property="og:description" content="A new version of the recipes package contains a signficant API update and  some additional features."><meta property="og:image" content="https://www.tidyverse.org/blog/2020/10/recipes-0-1-14/thumbnail-sq.jpg"><meta name=twitter:image content="https://www.tidyverse.org/blog/2020/10/recipes-0-1-14/thumbnail-wd.jpg"><link rel=apple-touch-icon sizes=180x180 href=/images/favicons/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/images/favicons/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/images/favicons/favicon-16x16.png><link rel=manifest href=/images/favicons/site.webmanifest><link rel=mask-icon href=/images/favicons/safari-pinned-tab.svg><link rel="shortcut icon" href=/images/favicons/favicon.ico><meta name=msapplication-TileColor content="#da532c"><meta name=msapplication-config href=/images/favicons/browserconfig.xml><script type=text/javascript src=/js/jquery-3.5.1.min.js></script><script type=text/javascript src=/js/site.js></script><link rel=icon href=/images/favicon.ico><script type=text/javascript src=/js/clipboard.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin=anonymous></script><script defer data-domain=tidyverse.org,all.tidyverse.org src=https://plausible.io/js/plausible.js></script></head><body><div id=appTidyverseSite class="shrinkHeader alwaysShrinkHeader"><div id=main><div id=rStudioHeader><nav class=band><div class="innards bandContent"><div><a class=productName href=/%20/>Tidyverse</a></div><div id=menu><div id=menuToggler></div><div id=menuItems><a class=menuItem href=/packages/>Packages</a>
<a class="menuItem current" href=/blog/>Blog</a>
<a class=menuItem href=/learn/>Learn</a>
<a class=menuItem href=/help/>Help</a>
<a class=menuItem href=/contribute/>Contribute</a></div></div></div></nav></div><main><div class="band padForHeader pushFooter"><div class=bandContent><div class="full splitColumns withMobileMargins"><div class=column75><h1 class=article-title>recipes 0.1.14</h1><div class=article-header aria-hidden=true><div class=photo><img src=/blog/2020/10/recipes-0-1-14/thumbnail-wd.jpg></div><div class=photoCredit>Photo by <a href=https://unsplash.com/photos/ToswmEekSFI>Holly Stratton</a></div></div><span class=article-date><i class="fas fa-calendar-day fa-fw"></i>&nbsp;&nbsp;2020/10/22</span><p style=margin-bottom:.5em;margin-top:.85em><i class="fas fa-tags"></i>&nbsp;
<a href=/tags/recipes/>recipes</a>,
<a href=/tags/tidymodels/>tidymodels</a></p><p style=margin-top:.5em><i class="fas fa-user-circle fa-fw"></i>&nbsp;
Max Kuhn</p><div class=article-content><p>We&rsquo;re stoked to announce the release of
<a href=https://recipes.tidymodels.org target=_blank rel=noopener>recipes</a> 0.1.14. recipes is an alternative method for creating and preprocessing design matrices that can be used for modeling or visualization.</p><p>You can install it from CRAN with:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf>install.packages</span><span class=p>(</span><span class=s>&#34;recipes&#34;</span><span class=p>)</span>
</code></pre></div><p>You can see a full list of changes in the
<a href=https://recipes.tidymodels.org/news/index.html target=_blank rel=noopener>release notes</a>. There are some improvements and changes to talk about.</p><h2 id=an-alternative-to-juice>An alternative to <code>juice()</code>
<a href=#an-alternative-to-juice><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Now that we have taught with recipes for a few years, we&rsquo;ve realized that there is a lot of confusion about the differences between <code>juice()</code> and <code>bake()</code>:</p><ul><li><code>juice(recipe)</code> returns the preprocessed training set (at very low computational costs).</li><li><code>bake(recipe, new_data)</code> applies the recipe to any data (e.g. training, testing, unknowns, etc.)</li></ul><p>We were not able to find ways to make this distinction clear for many users.</p><p>How could we solve this issue? We decided to come up with a better alternative to <code>juice()</code> that would be more intuitive. As a result, <em>all</em> applications of the recipe can now use <code>bake()</code>:</p><ul><li><code>bake(recipe, new_data = some_data_set)</code> works as before.</li><li><code>bake(recipe, new_data = NULL)</code> now returns the preprocessed training set.</li></ul><p>This is precedented in base R since many <code>predict()</code> methods re-predict the training set when the <code>newdata</code> argument is <code>NULL</code> or missing. Note that there is no default for <code>new_data</code>; you have to set it to <code>NULL</code> to get the training set.</p><p>We felt that this was the best API change that we could make. An external poll showed some agreement:</p><p><img src=juice-poll.png title="plot of chunk poll" alt="plot of chunk poll" width=80% style=display:block;margin:auto></p><p><code>juice()</code>, which is still my favorite R function name of all time, will not be removed; you can still use it. However, we will not use it in training materials or most documentation.</p><h2 id=imputation-with-linear-models>Imputation with linear models
<a href=#imputation-with-linear-models><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Tim Zhou contributed a step to use linear models for imputation. This is a nice, compact method for adding an imputation equation for numeric predictors into the recipe. The syntax is similar to the existing imputation steps. Here&rsquo;s an example from the Ames data:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf>library</span><span class=p>(</span><span class=n>tidymodels</span><span class=p>)</span>
<span class=nf>data</span><span class=p>(</span><span class=n>ames</span><span class=p>)</span>
<span class=n>ames</span><span class=o>$</span><span class=n>Sale_Price</span> <span class=o>&lt;-</span> <span class=nf>log10</span><span class=p>(</span><span class=n>ames</span><span class=o>$</span><span class=n>Sale_Price</span><span class=p>)</span>

<span class=c1># Set some of the latitude values to be missing: </span>

<span class=nf>set.seed</span><span class=p>(</span><span class=m>393</span><span class=p>)</span>
<span class=n>ames_missing</span> <span class=o>&lt;-</span> <span class=n>ames</span>
<span class=n>ames_missing</span><span class=o>$</span><span class=n>Latitude</span><span class=nf>[sample</span><span class=p>(</span><span class=m>1</span><span class=o>:</span><span class=nf>nrow</span><span class=p>(</span><span class=n>ames</span><span class=p>),</span> <span class=m>200</span><span class=p>)</span><span class=n>]</span> <span class=o>&lt;-</span> <span class=kc>NA</span>
</code></pre></div><p>We might be able to reasonably approximate the missing values based on the other geographic predictors (<code>Longitude</code> and <code>Neighborhood</code>) as well as a few aspects of the houses (e.g., <code>MS_Zoning</code> and <code>Alley</code>). A linear model is create with these predictors in order to estimate the missing <code>Latitude</code> data:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=n>imputed_ames</span> <span class=o>&lt;-</span>
  <span class=nf>recipe</span><span class=p>(</span><span class=n>Sale_Price</span> <span class=o>~</span> <span class=n>.,</span> <span class=n>data</span> <span class=o>=</span> <span class=n>ames_missing</span><span class=p>)</span> <span class=o>%&gt;%</span>
  <span class=nf>step_impute_linear</span><span class=p>(</span>
    <span class=n>Latitude</span><span class=p>,</span>
    <span class=n>impute_with</span> <span class=o>=</span> <span class=nf>imp_vars</span><span class=p>(</span><span class=n>Longitude</span><span class=p>,</span> <span class=n>Neighborhood</span><span class=p>,</span> <span class=n>MS_Zoning</span><span class=p>,</span> <span class=n>Alley</span><span class=p>),</span> 
    <span class=n>id</span> <span class=o>=</span> <span class=s>&#34;lm-imp&#34;</span>
  <span class=p>)</span> <span class=o>%&gt;%</span>
  <span class=nf>prep</span><span class=p>(</span><span class=n>ames_missing</span><span class=p>)</span>
</code></pre></div><p>This plot shows the missing data&rsquo;s true values on the x-axis and their imputed values on the y-axis:</p><p><img src=figure/plot-values-1.svg title="plot of chunk plot-values" alt="plot of chunk plot-values" width=70%></p><p>In future versions, we will standardize on the naming convention <code>step_impute_*()</code>. The existing functions will be soft-deprecated for a reasonable time period to ensure backward compatibility.</p><h2 id=other-changes>Other changes
<a href=#other-changes><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>This version of the package has an extra logging option for <code>prep()</code> that will print some information on the differences in the data before and after the step was prepared:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=n>ames_rec</span> <span class=o>&lt;-</span> <span class=nf>recipe</span><span class=p>(</span><span class=n>Sale_Price</span> <span class=o>~</span> <span class=n>.,</span> <span class=n>data</span> <span class=o>=</span> <span class=n>ames</span><span class=p>)</span> <span class=o>%&gt;%</span>
  <span class=nf>step_BoxCox</span><span class=p>(</span><span class=n>Lot_Area</span><span class=p>,</span> <span class=n>Gr_Liv_Area</span><span class=p>)</span> <span class=o>%&gt;%</span>
  <span class=nf>step_other</span><span class=p>(</span><span class=n>Neighborhood</span><span class=p>,</span> <span class=n>threshold</span> <span class=o>=</span> <span class=m>0.05</span><span class=p>)</span>  <span class=o>%&gt;%</span>
  <span class=nf>step_dummy</span><span class=p>(</span><span class=nf>all_nominal</span><span class=p>())</span> <span class=o>%&gt;%</span>
  <span class=nf>step_interact</span><span class=p>(</span><span class=o>~</span> <span class=nf>starts_with</span><span class=p>(</span><span class=s>&#34;Central_Air&#34;</span><span class=p>)</span><span class=o>:</span><span class=n>Year_Built</span><span class=p>)</span> <span class=o>%&gt;%</span>
  <span class=nf>step_ns</span><span class=p>(</span><span class=n>Longitude</span><span class=p>,</span> <span class=n>Latitude</span><span class=p>,</span> <span class=n>deg_free</span> <span class=o>=</span> <span class=m>5</span><span class=p>)</span> <span class=o>%&gt;%</span> 
  <span class=nf>prep</span><span class=p>(</span><span class=n>log_changes</span> <span class=o>=</span> <span class=kc>TRUE</span><span class=p>)</span>
</code></pre></div><pre><code>## step_BoxCox (BoxCox_KMeZW): same number of columns
## 
## step_other (other_b4CM3): same number of columns
## 
## step_dummy (dummy_q3sI4): 
##  new (223): MS_SubClass_One_Story_1945_and_Older, ...
##  removed (40): MS_SubClass, MS_Zoning, Street, Alley, Lot_Shape, ...
## 
## step_interact (interact_xjtSG): 
##  new (1): Central_Air_Y_x_Year_Built
## 
## step_ns (ns_pfpld): 
##  new (10): Longitude_ns_1, Longitude_ns_2, Longitude_ns_3, ...
##  removed (2): Longitude, Latitude
</code></pre><p>Another important change was behind the scenes. Before, there were problems with using PSOCK clusters on Windows because the worker processes were not aware of all the packages that should be loaded. Now, recipes ensures that all of the packages required by each step will be accessible in parallel. A similar change is coming soon to the parsnip package.</p><h2 id=acknowledgements>Acknowledgements
<a href=#acknowledgements><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Thanks to those users who filed issues or contributed a pull request since the previous release:
<a href=https://github.com/AndrewKostandy target=_blank rel=noopener>@AndrewKostandy</a>,
<a href=https://github.com/anks7190 target=_blank rel=noopener>@anks7190</a>,
<a href=https://github.com/AshesITR target=_blank rel=noopener>@AshesITR</a>,
<a href=https://github.com/Bijaelo target=_blank rel=noopener>@Bijaelo</a>,
<a href=https://github.com/brodz target=_blank rel=noopener>@brodz</a>,
<a href=https://github.com/DavisVaughan target=_blank rel=noopener>@DavisVaughan</a>,
<a href=https://github.com/dgkf target=_blank rel=noopener>@dgkf</a>,
<a href=https://github.com/EllaKaye target=_blank rel=noopener>@EllaKaye</a>,
<a href=https://github.com/EmilHvitfeldt target=_blank rel=noopener>@EmilHvitfeldt</a>,
<a href=https://github.com/hamedbh target=_blank rel=noopener>@hamedbh</a>,
<a href=https://github.com/hnagaty target=_blank rel=noopener>@hnagaty</a>,
<a href=https://github.com/irkaal target=_blank rel=noopener>@irkaal</a>,
<a href=https://github.com/jerome-laurent-pro target=_blank rel=noopener>@jerome-laurent-pro</a>,
<a href=https://github.com/juliasilge target=_blank rel=noopener>@juliasilge</a>,
<a href=https://github.com/karaesmen target=_blank rel=noopener>@karaesmen</a>,
<a href=https://github.com/kylegilde target=_blank rel=noopener>@kylegilde</a>,
<a href=https://github.com/LordRudolf target=_blank rel=noopener>@LordRudolf</a>,
<a href=https://github.com/lorenzwalthert target=_blank rel=noopener>@lorenzwalthert</a>,
<a href=https://github.com/mattwarkentin target=_blank rel=noopener>@mattwarkentin</a>,
<a href=https://github.com/mpettis target=_blank rel=noopener>@mpettis</a>,
<a href=https://github.com/mt-edwards target=_blank rel=noopener>@mt-edwards</a>,
<a href=https://github.com/nhward target=_blank rel=noopener>@nhward</a>,
<a href=https://github.com/Nilafhiosagam target=_blank rel=noopener>@Nilafhiosagam</a>,
<a href=https://github.com/NRaillard target=_blank rel=noopener>@NRaillard</a>,
<a href=https://github.com/Paul-Yuchao-Dong target=_blank rel=noopener>@Paul-Yuchao-Dong</a>,
<a href=https://github.com/perluna target=_blank rel=noopener>@perluna</a>,
<a href=https://github.com/RaminZi target=_blank rel=noopener>@RaminZi</a>,
<a href=https://github.com/rorynolan target=_blank rel=noopener>@rorynolan</a>,
<a href=https://github.com/Steviey target=_blank rel=noopener>@Steviey</a>,
<a href=https://github.com/topepo target=_blank rel=noopener>@topepo</a>, and
<a href=https://github.com/ttzhou target=_blank rel=noopener>@ttzhou</a>.</p></div></div><div class=column25><div class="section hideOnMobile"><div class=sectionTitle>Contents</div><nav id=TableOfContents><ul><li><a href=#an-alternative-to-juice>An alternative to <code>juice()</code></a></li><li><a href=#imputation-with-linear-models>Imputation with linear models</a></li><li><a href=#other-changes>Other changes</a></li><li><a href=#acknowledgements>Acknowledgements</a></li></ul></nav></div><div class=section></div></div></div></div></div><div id=rStudioFooter class=band><div class=bandContent><div id=copyright>The tidyverse is proudly supported by <a class=rstudioLogo href=https://posit.co/ aria-label="Posit Homepage"></a></div><div id=logos><a href=https://www.tidyverse.org/google_privacy_policy>Privacy policy</a>
<a href=https://github.com/tidyverse class="footerLogo gitHub" aria-label="Tidyverse GitHub organization"></a><a href=https://twitter.com/hashtag/rstats class="footerLogo twitter" aria-label="rstats hashtag on twitter.com"></a></div></div></div></div></div><script src=/js/math-code.js></script><script type=text/x-mathjax-config>
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    processEscapes: true
  }
});
</script><script async src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><script type=application/javascript>var dnt=(navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack);var doNotTrack=(dnt=="1"||dnt=="yes");if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');if(window.sessionStorage){var GA_SESSION_STORAGE_KEY='ga:clientId';ga('create','UA-115082821-1',{'storage':'none','clientId':sessionStorage.getItem(GA_SESSION_STORAGE_KEY)});ga(function(tracker){sessionStorage.setItem(GA_SESSION_STORAGE_KEY,tracker.get('clientId'));});}
ga('set','anonymizeIp',true);ga('send','pageview');}</script></body></html></div></div></body></html>