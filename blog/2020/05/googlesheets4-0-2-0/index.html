<!doctype html><html><head><!doctype html><html lang=en-us><link rel=stylesheet href=/css/fonts.css><link rel=stylesheet href=/css/main-site.css><link rel=stylesheet href=/css/fa5-all.css><style type=text/css>body{background-color:#fff;color:#1a1917}a{color:#38577f}a:hover{color:#42709b}a:focus{outline-color:#42709b}.column25-left .sectionTitle a:hover:not(.current),.column16-left .sectionTitle a:hover:not(.current){color:#1a1917}.icon-attribution,.icon-attribution a{color:#1a1917;opacity:75%}#homeContent .band.first{background-color:#fff}#homeContent .band.second{background-color:#fdeba4}#homeContent .band.third{background-color:#fff}#rStudioHeader{background-color:#1a162d;color:#fff}#rStudioHeader .productName{color:#fff}#rStudioHeader .productName:hover,#rStudioHeader .productName:focus{color:#fdeba4}#rStudioHeader #menu .menuItem.a{background-color:#75aadb;color:#fff}#rStudioHeader #menu .menuItem:hover{background-color:#484557;color:#fff}#rStudioHeader #menu .menuItem.current{background-color:#fff;color:#1a162d;text-decoration:none}#rStudioFooter.band{background-color:#767381}#rStudioFooter .bandContent #copyright{color:#e3eef8}table tbody tr:nth-child(even){background-color:#f7faff}table tbody tr:nth-child(odd){background-color:#fff}.latest{border-top:.5em solid <no value>}.event{-moz-box-shadow:0 0 0 0 rgba(0,0,0,.1);-webkit-box-shadow:0 0 0 0 rgba(0,0,0,.1);box-shadow:0 0 0 0 rgba(0,0,0,.1)}.section .event{background-color:#eab0c41a}.section .event{border-top:7pt solid #a19ea936}.section .event a{color:#1a162d}.section .event{color:#404040}</style><link rel=stylesheet href=/css/tidyverse.css><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Hugo 0.71.1"><title>googlesheets4 0.2.0</title><meta property="og:title" content="googlesheets4 0.2.0"><meta property="og:description" content="We&rsquo;re ecstatic to announce the release of googlesheets4 0.2.0 on CRAN:
 googlesheets4.tidyverse.org
googlesheets4 is a package to work with Google Sheets from R. Although version 0.1.0 debuted on CRAN in late 2019, I&rsquo;ve waited to blog about it until I considered googlesheet4 a replacement for an older package called googlesheets. That day is here! In particular, googlesheets 0.2.0 can create and edit Sheets.
Install googlesheets4 from CRAN like so:"><meta property="og:type" content="article"><meta property="og:url" content="https://www.tidyverse.org/blog/2020/05/googlesheets4-0-2-0/"><meta property="twitter:card" content="summary_large_image"><meta property="og:title" content="googlesheets4 0.2.0 - Tidyverse"><meta property="description" content><meta property="og:description" content><meta property="og:image" content="https://www.tidyverse.org/blog/2020/05/googlesheets4-0-2-0/thumbnail-sq.jpg"><meta name=twitter:image content="https://www.tidyverse.org/blog/2020/05/googlesheets4-0-2-0/thumbnail-wd.jpg"><link rel=apple-touch-icon sizes=180x180 href=/images/favicons/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/images/favicons/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/images/favicons/favicon-16x16.png><link rel=manifest href=/images/favicons/site.webmanifest><link rel=mask-icon href=/images/favicons/safari-pinned-tab.svg><link rel="shortcut icon" href=/images/favicons/favicon.ico><meta name=msapplication-TileColor content="#da532c"><meta name=msapplication-config href=/images/favicons/browserconfig.xml><script type=text/javascript src=/js/jquery-3.5.1.min.js></script><script type=text/javascript src=/js/site.js></script><link rel=icon href=/images/favicon.ico><script type=text/javascript src=/js/clipboard.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin=anonymous></script><script defer data-domain=tidyverse.org,all.tidyverse.org src=https://plausible.io/js/plausible.js></script></head><body><div id=appTidyverseSite class="shrinkHeader alwaysShrinkHeader"><div id=main><div id=rStudioHeader><nav class=band><div class="innards bandContent"><div><a class=productName href=/%20/>Tidyverse</a></div><div id=menu><div id=menuToggler></div><div id=menuItems><a class=menuItem href=/packages/>Packages</a>
<a class="menuItem current" href=/blog/>Blog</a>
<a class=menuItem href=/learn/>Learn</a>
<a class=menuItem href=/help/>Help</a>
<a class=menuItem href=/contribute/>Contribute</a></div></div></div></nav></div><main><div class="band padForHeader pushFooter"><div class=bandContent><div class="full splitColumns withMobileMargins"><div class=column75><h1 class=article-title>googlesheets4 0.2.0</h1><div class=article-header aria-hidden=true><div class=photo><img src=/blog/2020/05/googlesheets4-0-2-0/thumbnail-wd.jpg></div><div class=photoCredit>Photo by <a href=https://unsplash.com/photos/ufxd6aU0w9U>Stephane YAICH</a></div></div><span class=article-date><i class="fas fa-calendar-day fa-fw"></i>&nbsp;&nbsp;2020/05/10</span><p style=margin-bottom:.5em;margin-top:.85em><i class="fas fa-tags"></i>&nbsp;
<a href=/tags/googlesheets4/>googlesheets4</a>,
<a href=/tags/google/>google</a></p><p style=margin-top:.5em><i class="fas fa-user-circle fa-fw"></i>&nbsp;
Jenny Bryan</p><div class=article-content><p>We&rsquo;re ecstatic to announce the release of googlesheets4 0.2.0 on CRAN:</p><p><a href=https://googlesheets4.tidyverse.org target=_blank rel=noopener>googlesheets4.tidyverse.org</a></p><p>googlesheets4 is a package to work with Google Sheets from R. Although version 0.1.0 debuted on CRAN in late 2019, I&rsquo;ve waited to blog about it until I considered googlesheet4 a replacement for an older package called googlesheets. That day is here! In particular, googlesheets 0.2.0 can create and edit Sheets.</p><p>Install googlesheets4 from CRAN like so:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf>install.packages</span><span class=p>(</span><span class=s>&#34;googlesheets4&#34;</span><span class=p>)</span>
</code></pre></div><p>Then attach it for use via:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf>library</span><span class=p>(</span><span class=n>googlesheets4</span><span class=p>)</span>
</code></pre></div><p>Below we give a brief overview of the basic read and write functionality of googlesheets4. The website has
<a href=https://googlesheets4.tidyverse.org/articles/index.html target=_blank rel=noopener>several articles</a> that document more advanced use and special topics, such as auth. As always, you can find detailed notes about all changes in the
<a href=https://googlesheets4.tidyverse.org/news/index.html target=_blank rel=noopener>change log</a>.</p><h2 id=googlesheets-is-dead-long-live-googlesheets4>googlesheets is dead! Long live googlesheets4!
<a href=#googlesheets-is-dead-long-live-googlesheets4><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>googlesheets4 is a reboot of an earlier package called googlesheets.</p><p><em>Why <strong>4</strong>? Why googlesheets<strong>4</strong>? Did I miss googlesheets1 through 3? No. The idea is to name the package after the corresponding version of the Sheets API. In hindsight, the original googlesheets should have been googlesheets<strong>3</strong>.</em></p><p>googlesheets4 wraps
<a href=https://developers.google.com/sheets target=_blank rel=noopener>v4 of the Sheets API</a>, whereas the original googlesheets wraps v3. The
<a href=https://developers.google.com/sheets/api/v3 target=_blank rel=noopener>v3 API</a> has been deprecated for a long time. Its shut-off has been postponed several times, but its days are clearly numbered. Gradual shutdown of certain endpoints and scopes is already underway, with complete shutdown
<a href=https://cloud.google.com/blog/products/g-suite/migrate-your-apps-use-latest-sheets-api target=_blank rel=noopener>expected on September 30, 2020</a> at the time of writing. If you use googlesheets, you <strong>must</strong> switch to googlesheets4 and the time is now.</p><p>Change is hard, but let&rsquo;s focus on the positive:</p><ul><li>The v4 API has a better design, which makes it easier to wrap, which
translates to a better user experience in client packages.</li><li>I have gotten a lot better at writing R packages. Some of the fiddly parts
of the original googlesheets came from the awkward v3 API, but some of it
came from me.</li><li>The gargle package (
<a href=https://gargle.r-lib.org target=_blank rel=noopener>gargle.r-lib.org</a>) provides
infrastructure common to ~250 Google APIs, including Sheets, Drive, Gmail, and
BigQuery. By using gargle for auth, we can provide a consistent auth
experience across googlesheets4, googledrive, gmailr, and bigrquery.</li><li>The googledrive package (
<a href=https://googledrive.tidyverse.org target=_blank rel=noopener>googledrive.tidyverse.org</a>)
provides a full-featured client for working with files on Google Drive, which
allows googlesheets4 to focus on operations specific to spreadsheets. In the
original googlesheets package, about half of the code and effort was actually
related to Drive, not Sheets.</li></ul><h2 id=read-a-sheet>Read a Sheet
<a href=#read-a-sheet><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Let&rsquo;s say you&rsquo;re staring at a Sheet<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> in the browser and you want to read it into R. Copy the URL to your clipboard and paste it into a call to <code>read_sheet()</code> like this:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf>read_sheet</span><span class=p>(</span><span class=s>&#34;https://docs.google.com/spreadsheets/d/1U6Cf_qEOhiR9AZqTqS3mbMF3zt2db48ZP5v3rkrAEJY/edit#gid=780868077&#34;</span><span class=p>)</span>
<span class=c1>#&gt; Reading from &#34;gapminder&#34;</span>
<span class=c1>#&gt; Range &#34;Africa&#34;</span>
<span class=c1>#&gt; # A tibble: 624 x 6</span>
<span class=c1>#&gt;   country continent  year lifeExp      pop gdpPercap</span>
<span class=c1>#&gt;   &lt;chr&gt;   &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;</span>
<span class=c1>#&gt; 1 Algeria Africa     1952    43.1  9279525     2449.</span>
<span class=c1>#&gt; 2 Algeria Africa     1957    45.7 10270856     3014.</span>
<span class=c1>#&gt; 3 Algeria Africa     1962    48.3 11000948     2551.</span>
<span class=c1>#&gt; 4 Algeria Africa     1967    51.4 12760499     3247.</span>
<span class=c1>#&gt; 5 Algeria Africa     1972    54.5 14760787     4183.</span>
<span class=c1>#&gt; # … with 619 more rows</span>
</code></pre></div><p><em>If you&rsquo;re following along at home, you probably just got a prompt to log in with Google. That&rsquo;s because, in general, you&rsquo;ll want googlesheets4 to be able to do the same things you can do with Sheets in the browser. If you know you only want to read public Sheets, you can use <code>gs4_deauth()</code> to tell googlesheets4 that it should not attempt auth.</em></p><p>I&rsquo;m reading from one of our public example Sheets &mdash; specifically, a Sheet that holds Gapminder data. A browser URL is OK for quick-and-dirty work, but there are other ways to target a Sheet that are more robust and easier on the eyes.</p><p>You will often want to refer to your Sheets by ID or by name. For the public example Sheets, we offer convenience functions <code>gs4_example()</code> and <code>gs4_examples()</code> to get IDs based on name.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=n>gap_id</span> <span class=o>&lt;-</span> <span class=nf>gs4_example</span><span class=p>(</span><span class=s>&#34;gapminder&#34;</span><span class=p>)</span>

<span class=nf>class</span><span class=p>(</span><span class=n>gap_id</span><span class=p>)</span>
<span class=c1>#&gt; [1] &#34;sheets_id&#34; &#34;drive_id&#34;</span>
<span class=nf>unclass</span><span class=p>(</span><span class=n>gap_id</span><span class=p>)</span>
<span class=c1>#&gt;                                      gapminder </span>
<span class=c1>#&gt; &#34;1U6Cf_qEOhiR9AZqTqS3mbMF3zt2db48ZP5v3rkrAEJY&#34;</span>

<span class=n>gap_id</span>
<span class=c1>#&gt;   Spreadsheet name: gapminder</span>
<span class=c1>#&gt;                 ID: 1U6Cf_qEOhiR9AZqTqS3mbMF3zt2db48ZP5v3rkrAEJY</span>
<span class=c1>#&gt;             Locale: en_US</span>
<span class=c1>#&gt;          Time zone: America/Los_Angeles</span>
<span class=c1>#&gt;        # of sheets: 5</span>
<span class=c1>#&gt; </span>
<span class=c1>#&gt; (Sheet name): (Nominal extent in rows x columns)</span>
<span class=c1>#&gt;       Africa: 625 x 6</span>
<span class=c1>#&gt;     Americas: 301 x 6</span>
<span class=c1>#&gt;         Asia: 397 x 6</span>
<span class=c1>#&gt;       Europe: 361 x 6</span>
<span class=c1>#&gt;      Oceania: 25 x 6</span>
<span class=c1>#&gt; </span>
<span class=c1>#&gt; (Named range): (A1 range)        </span>
<span class=c1>#&gt;        canada: &#39;Americas&#39;!A38:F49</span>
</code></pre></div><p>The above demonstrates that printing a Sheet ID (literally, an instance of <code>sheets_id</code>) reveals relevant metadata about the Sheet, such as its name and an overview of its worksheets and named ranges.</p><p><code>read_sheet()</code> is happy to accept a Sheet ID, instead of a URL. Such a Sheet ID might be an instance of <code>sheets_id</code>, but you can also provide the ID as a string. Here we show piping a Sheet ID into <code>read_sheet()</code> and we start to demonstrate other features, e.g. the use of a qualified A1-style <code>range</code>.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf>gs4_example</span><span class=p>(</span><span class=s>&#34;gapminder&#34;</span><span class=p>)</span> <span class=o>%&gt;%</span>
  <span class=nf>read_sheet</span><span class=p>(</span><span class=n>range</span> <span class=o>=</span> <span class=s>&#34;Asia!A:D&#34;</span><span class=p>)</span>
<span class=c1>#&gt; Reading from &#34;gapminder&#34;</span>
<span class=c1>#&gt; Range &#34;&#39;Asia&#39;!A:D&#34;</span>
<span class=c1>#&gt; # A tibble: 396 x 4</span>
<span class=c1>#&gt;   country     continent  year lifeExp</span>
<span class=c1>#&gt;   &lt;chr&gt;       &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;</span>
<span class=c1>#&gt; 1 Afghanistan Asia       1952    28.8</span>
<span class=c1>#&gt; 2 Afghanistan Asia       1957    30.3</span>
<span class=c1>#&gt; 3 Afghanistan Asia       1962    32.0</span>
<span class=c1>#&gt; 4 Afghanistan Asia       1967    34.0</span>
<span class=c1>#&gt; 5 Afghanistan Asia       1972    36.1</span>
<span class=c1>#&gt; # … with 391 more rows</span>
</code></pre></div><p>But how do you get a Sheet ID for your <em>own</em> Sheets? First, you can use <code>as_sheets_id()</code> to extract the ID from various types of input, such as a browser URL. I use <code>as.character()</code> here to suppress the default printing behaviour, so we can just stare at the plain string.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf>as_sheets_id</span><span class=p>(</span><span class=s>&#34;https://docs.google.com/spreadsheets/d/1U6Cf_qEOhiR9AZqTqS3mbMF3zt2db48ZP5v3rkrAEJY/edit#gid=780868077&#34;</span><span class=p>)</span> <span class=o>%&gt;%</span> 
  <span class=nf>as.character</span><span class=p>()</span>
<span class=c1>#&gt; [1] &#34;1U6Cf_qEOhiR9AZqTqS3mbMF3zt2db48ZP5v3rkrAEJY&#34;</span>
</code></pre></div><p>We can also use googledrive&rsquo;s ability to address Drive files by <strong>name</strong><sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup> to help us identify the Sheet of interest. The account I&rsquo;m logged in with owns a Sheet named &ldquo;deaths&rdquo; and <code>googledrive::drive_get()</code> retrieves its metadata as a <code>dribble</code> (&ldquo;Drive tibble&rdquo;). <code>as_sheets_id()</code> is also happy to take a <code>dribble</code> as input, but it must contain exactly 1 row, describing a Drive file that is also a Sheet.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=n>deaths_dribble</span> <span class=o>&lt;-</span> <span class=n>googledrive</span><span class=o>::</span><span class=nf>drive_get</span><span class=p>(</span><span class=s>&#34;deaths&#34;</span><span class=p>)</span>
<span class=n>deaths_dribble</span>
<span class=c1>#&gt; # A tibble: 1 x 4</span>
<span class=c1>#&gt;   name   path     id                                           drive_resource   </span>
<span class=c1>#&gt;   &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt;                                        &lt;list&gt;           </span>
<span class=c1>#&gt; 1 deaths ~/deaths 1VTJjWoP1nshbyxmL9JqXgdVsimaYty21LGxxs018H2Y &lt;named list [35]&gt;</span>

<span class=nf>as_sheets_id</span><span class=p>(</span><span class=n>deaths_dribble</span><span class=p>)</span>
<span class=c1>#&gt;   Spreadsheet name: deaths</span>
<span class=c1>#&gt;                 ID: 1VTJjWoP1nshbyxmL9JqXgdVsimaYty21LGxxs018H2Y</span>
<span class=c1>#&gt;             Locale: en_US</span>
<span class=c1>#&gt;          Time zone: America/Los_Angeles</span>
<span class=c1>#&gt;        # of sheets: 2</span>
<span class=c1>#&gt; </span>
<span class=c1>#&gt; (Sheet name): (Nominal extent in rows x columns)</span>
<span class=c1>#&gt;         arts: 1000 x 26</span>
<span class=c1>#&gt;        other: 1000 x 26</span>
<span class=c1>#&gt; </span>
<span class=c1>#&gt; (Named range): (A1 range)    </span>
<span class=c1>#&gt;    other_data: &#39;other&#39;!A5:F15</span>
<span class=c1>#&gt;     arts_data: &#39;arts&#39;!A5:F15</span>
</code></pre></div><p><code>read_sheet()</code> also accepts a one-row <code>dribble</code> as input. Here I also show the use of <code>range</code> to target a <em>named range</em> and specify some of the column types:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=n>deaths_dribble</span> <span class=o>%&gt;%</span> 
  <span class=nf>read_sheet</span><span class=p>(</span><span class=n>range</span> <span class=o>=</span> <span class=s>&#34;arts_data&#34;</span><span class=p>,</span> <span class=n>col_types</span> <span class=o>=</span> <span class=s>&#34;??i?DD&#34;</span><span class=p>)</span>
<span class=c1>#&gt; Reading from &#34;deaths&#34;</span>
<span class=c1>#&gt; Range &#34;arts_data&#34;</span>
<span class=c1>#&gt; # A tibble: 10 x 6</span>
<span class=c1>#&gt;   Name          Profession   Age `Has kids` `Date of birth` `Date of death`</span>
<span class=c1>#&gt;   &lt;chr&gt;         &lt;chr&gt;      &lt;int&gt; &lt;lgl&gt;      &lt;date&gt;          &lt;date&gt;         </span>
<span class=c1>#&gt; 1 David Bowie   musician      69 TRUE       1947-01-08      2016-01-10     </span>
<span class=c1>#&gt; 2 Carrie Fisher actor         60 TRUE       1956-10-21      2016-12-27     </span>
<span class=c1>#&gt; 3 Chuck Berry   musician      90 TRUE       1926-10-18      2017-03-18     </span>
<span class=c1>#&gt; 4 Bill Paxton   actor         61 TRUE       1955-05-17      2017-02-25     </span>
<span class=c1>#&gt; 5 Prince        musician      57 TRUE       1958-06-07      2016-04-21     </span>
<span class=c1>#&gt; # … with 5 more rows</span>
</code></pre></div><p><code>read_sheet()</code> is the main &ldquo;read&rdquo; function of googlesheets4 and should remind you of other table-reading functions, like <code>readr::read_csv()</code> and <code>readxl::read_excel()</code>. It also goes by another name: <code>range_read()</code>, which is the most correct name according to googlesheets4&rsquo;s naming conventions. Either name is fine! It&rsquo;s OK if you don&rsquo;t care about this, I just want to give you a heads up. If you make extensive use of googlesheets4, you&rsquo;ll notice there are 3 large families of functions, with the prefixes <code>gs4_</code>, <code>sheet_</code>, and <code>range_</code>. The prefix conveys a function&rsquo;s scope of operation.</p><p>Remember there are
<a href=https://googlesheets4.tidyverse.org/articles/index.html target=_blank rel=noopener>articles</a> that go into much more depth on reading Sheets, column types, and using googlesheets4 in concert with googledrive.</p><h2 id=write-and-modify-a-sheet>Write and modify a Sheet
<a href=#write-and-modify-a-sheet><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>I&rsquo;ll go out in a blaze of glory, demonstrating just a few of the functions that can create and edit a Sheet.</p><p>First I create a new Sheet with <code>gs4_create()</code> and send some initial data to two well-named worksheets:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=n>ss</span> <span class=o>&lt;-</span> <span class=nf>gs4_create</span><span class=p>(</span>
  <span class=s>&#34;able-aardvark&#34;</span><span class=p>,</span>
  <span class=n>sheets</span> <span class=o>=</span> <span class=nf>list</span><span class=p>(</span><span class=n>flowers</span> <span class=o>=</span> <span class=nf>head</span><span class=p>(</span><span class=n>iris</span><span class=p>),</span> <span class=n>autos</span> <span class=o>=</span> <span class=nf>head</span><span class=p>(</span><span class=n>mtcars</span><span class=p>))</span>
<span class=p>)</span>
<span class=c1>#&gt; Creating new Sheet: &#34;able-aardvark&#34;</span>
<span class=n>ss</span>
<span class=c1>#&gt;   Spreadsheet name: able-aardvark</span>
<span class=c1>#&gt;                 ID: 1OV9Mxf-NdTyB1ChmlVKEFy0e1AaPAJCahzcWBw1w3qQ</span>
<span class=c1>#&gt;             Locale: en_US</span>
<span class=c1>#&gt;          Time zone: Etc/GMT</span>
<span class=c1>#&gt;        # of sheets: 2</span>
<span class=c1>#&gt; </span>
<span class=c1>#&gt; (Sheet name): (Nominal extent in rows x columns)</span>
<span class=c1>#&gt;      flowers: 7 x 5</span>
<span class=c1>#&gt;        autos: 7 x 11</span>

<span class=nf>read_sheet</span><span class=p>(</span><span class=n>ss</span><span class=p>)</span>
<span class=c1>#&gt; Reading from &#34;able-aardvark&#34;</span>
<span class=c1>#&gt; Range &#34;flowers&#34;</span>
<span class=c1>#&gt; # A tibble: 6 x 5</span>
<span class=c1>#&gt;   Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span>
<span class=c1>#&gt;          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;  </span>
<span class=c1>#&gt; 1          5.1         3.5          1.4         0.2 setosa </span>
<span class=c1>#&gt; 2          4.9         3            1.4         0.2 setosa </span>
<span class=c1>#&gt; 3          4.7         3.2          1.3         0.2 setosa </span>
<span class=c1>#&gt; 4          4.6         3.1          1.5         0.2 setosa </span>
<span class=c1>#&gt; 5          5           3.6          1.4         0.2 setosa </span>
<span class=c1>#&gt; # … with 1 more row</span>
</code></pre></div><p>If you&rsquo;re following along at home, you can use <code>gs4_browse()</code> to open a Sheet in your default web browser. This is especially helpful when you are developing code that writes to a Sheet.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf>gs4_browse</span><span class=p>(</span><span class=n>ss</span><span class=p>)</span>
</code></pre></div><p>Now I send a third data frame to an entirely new (work)sheet within this existing (spread)Sheet with <code>write_sheet()</code>.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=n>my_data</span> <span class=o>&lt;-</span> <span class=nf>data.frame</span><span class=p>(</span>
  <span class=n>numbers</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=m>1</span><span class=p>,</span> <span class=m>5</span><span class=p>,</span> <span class=m>3</span><span class=p>,</span> <span class=m>2</span><span class=p>,</span> <span class=m>4</span><span class=p>,</span> <span class=m>6</span><span class=p>),</span>
  <span class=kc>letters</span> <span class=o>=</span> <span class=kc>letters</span><span class=n>[1</span><span class=o>:</span><span class=m>6</span><span class=n>]</span>
<span class=p>)</span>

<span class=nf>write_sheet</span><span class=p>(</span><span class=n>my_data</span><span class=p>,</span> <span class=n>ss</span> <span class=o>=</span> <span class=n>ss</span><span class=p>)</span>
<span class=c1>#&gt; Writing to &#34;able-aardvark&#34;</span>
<span class=c1>#&gt; Writing to sheet &#34;my_data&#34;</span>
<span class=n>ss</span>
<span class=c1>#&gt;   Spreadsheet name: able-aardvark</span>
<span class=c1>#&gt;                 ID: 1OV9Mxf-NdTyB1ChmlVKEFy0e1AaPAJCahzcWBw1w3qQ</span>
<span class=c1>#&gt;             Locale: en_US</span>
<span class=c1>#&gt;          Time zone: Etc/GMT</span>
<span class=c1>#&gt;        # of sheets: 3</span>
<span class=c1>#&gt; </span>
<span class=c1>#&gt; (Sheet name): (Nominal extent in rows x columns)</span>
<span class=c1>#&gt;      flowers: 7 x 5</span>
<span class=c1>#&gt;        autos: 7 x 11</span>
<span class=c1>#&gt;      my_data: 7 x 2</span>
</code></pre></div><p>Let&rsquo;s append a row to the bottom of <code>my_data</code> and populate it with formulas that summarize the data in each column (hey, a sparkline!).</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=n>my_summaries</span> <span class=o>&lt;-</span> <span class=nf>data.frame</span><span class=p>(</span>
  <span class=n>x</span> <span class=o>=</span> <span class=nf>gs4_formula</span><span class=p>(</span><span class=s>&#39;=SPARKLINE(A2:A7, {&#34;color&#34;, &#34;blue&#34;})&#39;</span><span class=p>),</span>
  <span class=n>y</span> <span class=o>=</span> <span class=nf>gs4_formula</span><span class=p>(</span><span class=s>&#39;=JOIN(&#34;-&#34;, B2:B7)&#39;</span><span class=p>)</span>
<span class=p>)</span>
<span class=n>ss</span> <span class=o>%&gt;%</span>
  <span class=nf>sheet_append</span><span class=p>(</span><span class=n>my_summaries</span><span class=p>,</span> <span class=n>sheet</span> <span class=o>=</span> <span class=s>&#34;my_data&#34;</span><span class=p>)</span>
<span class=c1>#&gt; Writing to &#34;able-aardvark&#34;</span>
<span class=c1>#&gt; Appending 1 row(s) to &#34;my_data&#34;</span>
</code></pre></div><p>Notice that we did not have to specify which row to write the new values into. <code>sheet_append()</code> uses an endpoint that knows how to add rows to the existing table of data. It&rsquo;s true that we used some row knowledge in our formulas, but more often you will just be sending data. Also notice the use of <code>gs4_formula()</code>. This is how you indicate that character data should be sent as Sheets formulas, as opposed to regular strings.</p><p>Let&rsquo;s take one last glance at our creation.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=n>ss</span>
<span class=c1>#&gt;   Spreadsheet name: able-aardvark</span>
<span class=c1>#&gt;                 ID: 1OV9Mxf-NdTyB1ChmlVKEFy0e1AaPAJCahzcWBw1w3qQ</span>
<span class=c1>#&gt;             Locale: en_US</span>
<span class=c1>#&gt;          Time zone: Etc/GMT</span>
<span class=c1>#&gt;        # of sheets: 3</span>
<span class=c1>#&gt; </span>
<span class=c1>#&gt; (Sheet name): (Nominal extent in rows x columns)</span>
<span class=c1>#&gt;      flowers: 7 x 5</span>
<span class=c1>#&gt;        autos: 7 x 11</span>
<span class=c1>#&gt;      my_data: 8 x 2</span>
</code></pre></div><p>In the browser, the <code>my_data</code> sheet looks something like this at this point:</p><p><img src=append-formula-sparkline.png title="plot of chunk unnamed-chunk-15" alt="plot of chunk unnamed-chunk-15" width=40%></p><p>Finally, we clean up. Note that we (must) use googledrive for this. The Sheets API can create a Sheet, but alas it cannot delete one. For that (and most other &ldquo;whole file&rdquo; operations), we must use the Drive API, which is why googlesheets4 is designed to work <em>with</em> googledrive.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=n>googledrive</span><span class=o>::</span><span class=nf>drive_trash</span><span class=p>(</span><span class=n>ss</span><span class=p>)</span>
<span class=c1>#&gt; Files trashed:</span>
<span class=c1>#&gt;   * able-aardvark: 1OV9Mxf-NdTyB1ChmlVKEFy0e1AaPAJCahzcWBw1w3qQ</span>
</code></pre></div><p>Once again, the
<a href=https://googlesheets4.tidyverse.org/articles/index.html target=_blank rel=noopener>articles</a> provide much deeper coverage of topics like identifying and modifying Sheets.</p><h2 id=try-it-out>Try it out
<a href=#try-it-out><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>The googlesheets4 package is marked as experimental, but it&rsquo;s really somewhere between
<a href=https://www.tidyverse.org/lifecycle/#experimental target=_blank rel=noopener>experimental</a> and
<a href=https://www.tidyverse.org/lifecycle/#maturing target=_blank rel=noopener>maturing</a>. This is the first CRAN release that includes write and edit capability, so I want the flexibility to make some relatively quick, modest changes to the interface in response to user feedback. But such changes get more painful for everyone the longer we wait. Now is a great time to take googlesheets4 out for a test drive.</p><p>If you encounter ergonomic problems or spot tasks that were possible with googlesheets but are not yet possible with googlesheet4, please
<a href=https://github.com/tidyverse/googlesheets4/issues target=_blank rel=noopener>open an issue</a>.</p><h2 id=thank-you>Thank you!
<a href=#thank-you><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>A big thanks to all 64 contributors who&rsquo;ve helped to bring googlesheets4 to this point via their contributions on GitHub.
<a href=https://github.com/4marel target=_blank rel=noopener>@4marel</a>,
<a href=https://github.com/AaronGullickson target=_blank rel=noopener>@AaronGullickson</a>,
<a href=https://github.com/adisarid target=_blank rel=noopener>@adisarid</a>,
<a href=https://github.com/ahelgason target=_blank rel=noopener>@ahelgason</a>,
<a href=https://github.com/alex-steiner-next target=_blank rel=noopener>@alex-steiner-next</a>,
<a href=https://github.com/aljrico target=_blank rel=noopener>@aljrico</a>,
<a href=https://github.com/amir2cs target=_blank rel=noopener>@amir2cs</a>,
<a href=https://github.com/antoine-sachet target=_blank rel=noopener>@antoine-sachet</a>,
<a href=https://github.com/batpigandme target=_blank rel=noopener>@batpigandme</a>,
<a href=https://github.com/behrman target=_blank rel=noopener>@behrman</a>,
<a href=https://github.com/ben519 target=_blank rel=noopener>@ben519</a>,
<a href=https://github.com/Biomiha target=_blank rel=noopener>@Biomiha</a>,
<a href=https://github.com/BriBecker target=_blank rel=noopener>@BriBecker</a>,
<a href=https://github.com/ceprdata target=_blank rel=noopener>@ceprdata</a>,
<a href=https://github.com/ChemiKyle target=_blank rel=noopener>@ChemiKyle</a>,
<a href=https://github.com/chrowe target=_blank rel=noopener>@chrowe</a>,
<a href=https://github.com/cneskey target=_blank rel=noopener>@cneskey</a>,
<a href=https://github.com/csnardi target=_blank rel=noopener>@csnardi</a>,
<a href=https://github.com/dan-reznik target=_blank rel=noopener>@dan-reznik</a>,
<a href=https://github.com/dcaley5005 target=_blank rel=noopener>@dcaley5005</a>,
<a href=https://github.com/Flavjack target=_blank rel=noopener>@Flavjack</a>,
<a href=https://github.com/GitHubDoug target=_blank rel=noopener>@GitHubDoug</a>,
<a href=https://github.com/gloignon target=_blank rel=noopener>@gloignon</a>,
<a href=https://github.com/grwhumphries target=_blank rel=noopener>@grwhumphries</a>,
<a href=https://github.com/guhanrv target=_blank rel=noopener>@guhanrv</a>,
<a href=https://github.com/ianformanek target=_blank rel=noopener>@ianformanek</a>,
<a href=https://github.com/j-Rinehart target=_blank rel=noopener>@j-Rinehart</a>,
<a href=https://github.com/jennybc target=_blank rel=noopener>@jennybc</a>,
<a href=https://github.com/jiaoshuo target=_blank rel=noopener>@jiaoshuo</a>,
<a href=https://github.com/jimhester target=_blank rel=noopener>@jimhester</a>,
<a href=https://github.com/jjankowiak target=_blank rel=noopener>@jjankowiak</a>,
<a href=https://github.com/jpawlata target=_blank rel=noopener>@jpawlata</a>,
<a href=https://github.com/jperkel target=_blank rel=noopener>@jperkel</a>,
<a href=https://github.com/juliangilbey target=_blank rel=noopener>@juliangilbey</a>,
<a href=https://github.com/jzadra target=_blank rel=noopener>@jzadra</a>,
<a href=https://github.com/karawoo target=_blank rel=noopener>@karawoo</a>,
<a href=https://github.com/kaveh1000 target=_blank rel=noopener>@kaveh1000</a>,
<a href=https://github.com/lucasmation target=_blank rel=noopener>@lucasmation</a>,
<a href=https://github.com/MarkEdmondson1234 target=_blank rel=noopener>@MarkEdmondson1234</a>,
<a href=https://github.com/mikegunn target=_blank rel=noopener>@mikegunn</a>,
<a href=https://github.com/mine-cetinkaya-rundel target=_blank rel=noopener>@mine-cetinkaya-rundel</a>,
<a href=https://github.com/mitchelloharawild target=_blank rel=noopener>@mitchelloharawild</a>,
<a href=https://github.com/mlamias target=_blank rel=noopener>@mlamias</a>,
<a href=https://github.com/mountainMath target=_blank rel=noopener>@mountainMath</a>,
<a href=https://github.com/mssanjavickovic target=_blank rel=noopener>@mssanjavickovic</a>,
<a href=https://github.com/nacnudus target=_blank rel=noopener>@nacnudus</a>,
<a href=https://github.com/nathanhwangbo target=_blank rel=noopener>@nathanhwangbo</a>,
<a href=https://github.com/nicole-brewer target=_blank rel=noopener>@nicole-brewer</a>,
<a href=https://github.com/ogs22 target=_blank rel=noopener>@ogs22</a>,
<a href=https://github.com/pachamaltese target=_blank rel=noopener>@pachamaltese</a>,
<a href=https://github.com/peeter-t2 target=_blank rel=noopener>@peeter-t2</a>,
<a href=https://github.com/ramirobentes target=_blank rel=noopener>@ramirobentes</a>,
<a href=https://github.com/realauggieheschmeyer target=_blank rel=noopener>@realauggieheschmeyer</a>,
<a href=https://github.com/RSherwoodJr target=_blank rel=noopener>@RSherwoodJr</a>,
<a href=https://github.com/sam-watts target=_blank rel=noopener>@sam-watts</a>,
<a href=https://github.com/schmalte04 target=_blank rel=noopener>@schmalte04</a>,
<a href=https://github.com/seanchrismurphy target=_blank rel=noopener>@seanchrismurphy</a>,
<a href=https://github.com/selesnow target=_blank rel=noopener>@selesnow</a>,
<a href=https://github.com/somnambWl target=_blank rel=noopener>@somnambWl</a>,
<a href=https://github.com/SridharJagannathan target=_blank rel=noopener>@SridharJagannathan</a>,
<a href=https://github.com/Tadge-Analytics target=_blank rel=noopener>@Tadge-Analytics</a>,
<a href=https://github.com/untergeekDE target=_blank rel=noopener>@untergeekDE</a>,
<a href=https://github.com/wildcat47 target=_blank rel=noopener>@wildcat47</a>, and
<a href=https://github.com/yogat3ch target=_blank rel=noopener>@yogat3ch</a>.</p><section class=footnotes role=doc-endnotes><hr><ol><li id=fn:1 role=doc-endnote><p>It&rsquo;s very easy to get confused about vocabulary when talking about spreadsheets and, especially, about Google Sheets. When we say capital-S &ldquo;Sheet&rdquo;, we mean a spreadsheet or (spread)Sheet, i.e. the Google equivalent of an Excel workbook or <code>.xlsx</code> file. Indeed, the actual Sheets API uses the term &ldquo;spreadsheet&rdquo;. An individual &ldquo;tab&rdquo; inside a Sheet is a (work)sheet, i.e. small-s &ldquo;sheet&rdquo;. So one Sheet contains one or more sheets. <a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2 role=doc-endnote><p>Believe it or not, files on Drive don&rsquo;t have to have a unique name. You can have multiple files named &ldquo;foofy&rdquo; on Drive, even in the same folder. In fact, historically, a file can also belong to multiple folders (although this is mercifully being phased out). The main takeaway is that your usual expectations about &ldquo;a name or filepath identifies at most one file&rdquo; and &ldquo;a file is identified by exactly one name or filepath&rdquo; don&rsquo;t hold on Drive. <a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></section></div></div><div class=column25><div class="section hideOnMobile"><div class=sectionTitle>Contents</div><nav id=TableOfContents><ul><li><a href=#googlesheets-is-dead-long-live-googlesheets4>googlesheets is dead! Long live googlesheets4!</a></li><li><a href=#read-a-sheet>Read a Sheet</a></li><li><a href=#write-and-modify-a-sheet>Write and modify a Sheet</a></li><li><a href=#try-it-out>Try it out</a></li><li><a href=#thank-you>Thank you!</a></li></ul></nav></div><div class=section></div></div></div></div></div><div id=rStudioFooter class=band><div class=bandContent><div id=copyright>The tidyverse is proudly supported by <a class=rstudioLogo href=https://posit.co/ aria-label="Posit Homepage"></a></div><div id=logos><a href=https://www.tidyverse.org/google_privacy_policy>Privacy policy</a>
<a href=https://github.com/tidyverse class="footerLogo gitHub" aria-label="Tidyverse GitHub organization"></a><a href=https://twitter.com/hashtag/rstats class="footerLogo twitter" aria-label="rstats hashtag on twitter.com"></a></div></div></div></div></div><script type=application/javascript>var dnt=(navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack);var doNotTrack=(dnt=="1"||dnt=="yes");if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');if(window.sessionStorage){var GA_SESSION_STORAGE_KEY='ga:clientId';ga('create','UA-115082821-1',{'storage':'none','clientId':sessionStorage.getItem(GA_SESSION_STORAGE_KEY)});ga(function(tracker){sessionStorage.setItem(GA_SESSION_STORAGE_KEY,tracker.get('clientId'));});}
ga('set','anonymizeIp',true);ga('send','pageview');}</script></body></html></div></div></body></html>