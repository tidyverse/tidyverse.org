<!doctype html><html><head><!doctype html><html lang=en-us><link rel=stylesheet href=/css/fonts.css><link rel=stylesheet href=/css/main-site.css><link rel=stylesheet href=/css/fa5-all.css><style type=text/css>body{background-color:#fff;color:#1a1917}a{color:#38577f}a:hover{color:#42709b}a:focus{outline-color:#42709b}.column25-left .sectionTitle a:hover:not(.current),.column16-left .sectionTitle a:hover:not(.current){color:#1a1917}.icon-attribution,.icon-attribution a{color:#1a1917;opacity:75%}#homeContent .band.first{background-color:#fff}#homeContent .band.second{background-color:#fdeba4}#homeContent .band.third{background-color:#fff}#rStudioHeader{background-color:#1a162d;color:#fff}#rStudioHeader .productName{color:#fff}#rStudioHeader .productName:hover,#rStudioHeader .productName:focus{color:#fdeba4}#rStudioHeader #menu .menuItem.a{background-color:#75aadb;color:#fff}#rStudioHeader #menu .menuItem:hover{background-color:#484557;color:#fff}#rStudioHeader #menu .menuItem.current{background-color:#fff;color:#1a162d;text-decoration:none}#rStudioFooter.band{background-color:#767381}#rStudioFooter .bandContent #copyright{color:#e3eef8}table tbody tr:nth-child(even){background-color:#f7faff}table tbody tr:nth-child(odd){background-color:#fff}.latest{border-top:.5em solid <no value>}.event{-moz-box-shadow:0 0 0 0 rgba(0,0,0,.1);-webkit-box-shadow:0 0 0 0 rgba(0,0,0,.1);box-shadow:0 0 0 0 rgba(0,0,0,.1)}.section .event{background-color:#eab0c41a}.section .event{border-top:7pt solid #a19ea936}.section .event a{color:#1a162d}.section .event{color:#404040}</style><link rel=stylesheet href=/css/tidyverse.css><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Hugo 0.71.1"><title>parsnip 0.1.2</title><meta property="og:title" content="parsnip 0.1.2"><meta property="og:description" content="A new version of parsnip bring improvements in how predictors are handled and a few other neat features."><meta property="og:type" content="article"><meta property="og:url" content="https://www.tidyverse.org/blog/2020/07/parsnip-0-1-2/"><meta property="twitter:card" content="summary_large_image"><meta property="og:title" content="parsnip 0.1.2 - Tidyverse"><meta property="description" content="A new version of parsnip bring improvements in how predictors are handled and a few other neat features."><meta property="og:description" content="A new version of parsnip bring improvements in how predictors are handled and a few other neat features."><meta property="og:image" content="https://www.tidyverse.org/blog/2020/07/parsnip-0-1-2/thumbnail-sq.jpg"><meta name=twitter:image content="https://www.tidyverse.org/blog/2020/07/parsnip-0-1-2/thumbnail-wd.jpg"><link rel=apple-touch-icon sizes=180x180 href=/images/favicons/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/images/favicons/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/images/favicons/favicon-16x16.png><link rel=manifest href=/images/favicons/site.webmanifest><link rel=mask-icon href=/images/favicons/safari-pinned-tab.svg><link rel="shortcut icon" href=/images/favicons/favicon.ico><meta name=msapplication-TileColor content="#da532c"><meta name=msapplication-config href=/images/favicons/browserconfig.xml><script type=text/javascript src=/js/jquery-3.5.1.min.js></script><script type=text/javascript src=/js/site.js></script><link rel=icon href=/images/favicon.ico><script type=text/javascript src=/js/clipboard.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin=anonymous></script><script defer data-domain=tidyverse.org,all.tidyverse.org src=https://plausible.io/js/plausible.js></script></head><body><div id=appTidyverseSite class="shrinkHeader alwaysShrinkHeader"><div id=main><div id=rStudioHeader><nav class=band><div class="innards bandContent"><div><a class=productName href=/%20/>Tidyverse</a></div><div id=menu><div id=menuToggler></div><div id=menuItems><a class=menuItem href=/packages/>Packages</a>
<a class="menuItem current" href=/blog/>Blog</a>
<a class=menuItem href=/learn/>Learn</a>
<a class=menuItem href=/help/>Help</a>
<a class=menuItem href=/contribute/>Contribute</a></div></div></div></nav></div><main><div class="band padForHeader pushFooter"><div class=bandContent><div class="full splitColumns withMobileMargins"><div class=column75><h1 class=article-title>parsnip 0.1.2</h1><div class=article-header aria-hidden=true><div class=photo><img src=/blog/2020/07/parsnip-0-1-2/thumbnail-wd.jpg></div><div class=photoCredit>Photo by <a href=https://unsplash.com/photos/kJxinkriuB4>Kevin Lanceplaine</a></div></div><span class=article-date><i class="fas fa-calendar-day fa-fw"></i>&nbsp;&nbsp;2020/07/09</span><p style=margin-bottom:.5em;margin-top:.85em><i class="fas fa-tags"></i>&nbsp;
<a href=/tags/tidymodels/>tidymodels</a>,
<a href=/tags/parsnip/>parsnip</a></p><p style=margin-top:.5em><i class="fas fa-user-circle fa-fw"></i>&nbsp;
Max Kuhn</p><div class=article-content><p>We&rsquo;re happy to announce the release of
<a href=https://parsnip.tidymodels.org/ target=_blank rel=noopener>parsnip</a> 0.1.2. parsnip is a unified tidy interface to many modeling techniques.</p><p>You can install it from CRAN with:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf>install.packages</span><span class=p>(</span><span class=s>&#34;parsnip&#34;</span><span class=p>)</span>
</code></pre></div><p>You can see a full list of changes in the
<a href=https://parsnip.tidymodels.org/news/index.html target=_blank rel=noopener>release notes</a>. I&rsquo;ll highlight the big changes here. The primary improvement is related to the brand new versions of the
<a href=https://hardhat.tidymodels.org/news/index.html target=_blank rel=noopener>hardhat</a> and
<a href=https://workflows.tidymodels.org/news/index.html target=_blank rel=noopener>workflows</a> packages.</p><h2 id=predictor-encoding-consistency>Predictor encoding consistency
<a href=#predictor-encoding-consistency><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Normally, when you give a formula to an R modeling function, the standard <code>model.matrix()</code> machinery converts factor predictors to a set of binary indicator columns. However, there are a few notable exceptions:</p><ul><li><p>Tree-based models, such as CART, C5.0, and random forests, don&rsquo;t require binary indicator variables since their splitting methods can create groups of categories. When using a tree-based model function like <code>ranger::ranger()</code>, the formula does <em>not</em> create indicators; the factor predictors are left as factors.</p></li><li><p>Naive Bayes models would rather have the predictors in their native format as well, so that the predictors&rsquo; conditional distributions are estimated using discrete probability distributions.</p></li><li><p>Multi-level models, such as mixed models or Bayesian hierarchical models, would prefer that the columns that are associated with random effects (e.g. subject) remain factors.</p></li></ul><p>When <code>parsnip::fit()</code> is used with a modeling function that takes a formula, the formula is directly passed to the underlying model function (without processing the data). The resulting model is the same as what the underlying model would have produced. For example:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=c1># Using older versions of: </span>
<span class=nf>library</span><span class=p>(</span><span class=n>parsnip</span><span class=p>)</span>
<span class=nf>library</span><span class=p>(</span><span class=n>ranger</span><span class=p>)</span>
<span class=nf>library</span><span class=p>(</span><span class=n>modeldata</span><span class=p>)</span>

<span class=nf>data</span><span class=p>(</span><span class=n>penguins</span><span class=p>)</span>
<span class=n>penguins</span> <span class=o>&lt;-</span> <span class=nf>na.omit</span><span class=p>(</span><span class=n>penguins</span><span class=p>)</span>

<span class=n>rf_spec</span> <span class=o>&lt;-</span>
  <span class=nf>rand_forest</span><span class=p>()</span> <span class=o>%&gt;%</span>
  <span class=nf>set_engine</span><span class=p>(</span><span class=s>&#34;ranger&#34;</span><span class=p>,</span> <span class=n>seed</span> <span class=o>=</span> <span class=m>1221</span><span class=p>)</span> <span class=o>%&gt;%</span>
  <span class=nf>set_mode</span><span class=p>(</span><span class=s>&#34;regression&#34;</span><span class=p>)</span>

<span class=n>rf_spec</span> <span class=o>%&gt;%</span>
  <span class=nf>fit</span><span class=p>(</span><span class=n>body_mass_g</span> <span class=o>~</span> <span class=n>species</span> <span class=o>+</span> <span class=n>island</span><span class=p>,</span> <span class=n>data</span> <span class=o>=</span> <span class=n>penguins</span><span class=p>)</span>
</code></pre></div><pre><code>## parsnip model object
## 
## Fit time:  24ms 
## Ranger result
## 
## Call:
##  ranger::ranger(formula = formula, data = data, seed = ~1221, num.threads = 1, verbose = FALSE) 
## 
## Type:                             Regression 
## Number of trees:                  500 
## Sample size:                      333 
## Number of independent variables:  2 
## Mtry:                             1 
## Target node size:                 5 
## Variable importance mode:         none 
## Splitrule:                        variance 
## OOB prediction error (MSE):       224771.2 
## R squared (OOB):                  0.6533301
</code></pre><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf>ranger</span><span class=p>(</span><span class=n>body_mass_g</span> <span class=o>~</span> <span class=n>species</span> <span class=o>+</span> <span class=n>island</span><span class=p>,</span> <span class=n>data</span> <span class=o>=</span> <span class=n>penguins</span><span class=p>,</span> <span class=n>seed</span> <span class=o>=</span> <span class=m>1221</span><span class=p>)</span>
</code></pre></div><pre><code>## Ranger result
## 
## Call:
##  ranger(body_mass_g ~ species + island, data = penguins, seed = 1221) 
## 
## Type:                             Regression 
## Number of trees:                  500 
## Sample size:                      333 
## Number of independent variables:  2 
## Mtry:                             1 
## Target node size:                 5 
## Variable importance mode:         none 
## Splitrule:                        variance 
## OOB prediction error (MSE):       224771.2 
## R squared (OOB):                  0.6533301
</code></pre><p>(Note the <code>Number of independent variables: 2</code>).</p><p>However, the workflows package <em>does</em> process the data before giving it to the modeling function. In this case using the previous version of these packages, indicators were produced when a formula was used. As a result, instead of two predictor columns, the <code>species</code> variable was expanded and five predictor columns are given to the model:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf>library</span><span class=p>(</span><span class=n>workflows</span><span class=p>)</span>
<span class=nf>library</span><span class=p>(</span><span class=n>hardhat</span><span class=p>)</span>

<span class=n>rf_wflow</span> <span class=o>&lt;-</span>
  <span class=nf>workflow</span><span class=p>()</span> <span class=o>%&gt;%</span>
  <span class=nf>add_model</span><span class=p>(</span><span class=n>rf_spec</span><span class=p>)</span> <span class=o>%&gt;%</span>
  <span class=nf>add_formula</span><span class=p>(</span><span class=n>body_mass_g</span> <span class=o>~</span> <span class=n>species</span> <span class=o>+</span> <span class=n>island</span><span class=p>)</span>

<span class=n>rf_wflow</span> <span class=o>%&gt;%</span>
  <span class=nf>fit</span><span class=p>(</span><span class=n>data</span> <span class=o>=</span> <span class=n>penguins</span><span class=p>)</span>
</code></pre></div><pre><code>## ══ Workflow [trained] ══════════════════════════════════════════════════════════════════════
## Preprocessor: Formula
## Model: rand_forest()
## 
## ── Preprocessor ────────────────────────────────────────────────────────────────────────────
## body_mass_g ~ species + island
## 
## ── Model ───────────────────────────────────────────────────────────────────────────────────
## Ranger result
## 
## Call:
##  ranger::ranger(formula = formula, data = data, seed = ~1221, num.threads = 1, verbose = FALSE) 
## 
## Type:                             Regression 
## Number of trees:                  500 
## Sample size:                      333 
## Number of independent variables:  5 
## Mtry:                             2 
## Target node size:                 5 
## Variable importance mode:         none 
## Splitrule:                        variance 
## OOB prediction error (MSE):       215619.5 
## R squared (OOB):                  0.6674451
</code></pre><p>Not only was the inconsistency of these two interfaces (parsnip vs. workflows) a problem, but ranger is very persnickety about column names and some indicator columns would result in errors (see, for example,
<a href=https://github.com/tidymodels/tune/issues/151 target=_blank rel=noopener>this issue</a>).</p><p>The new set of hardhat/workflows/parsnip versions now fixes this behavior. In parsnip, each model/engine combination has a recommended set of predictor encoding methods attached to them (including a &ldquo;leave my data alone&rdquo; option). These are designed to be consistent with what the underlying model function expects so that there are no inconsistencies.</p><p>You can override these new default encoding methods by using a recipe (instead of a formula) or by using a hardhat <code>blueprint</code>.</p><h2 id=one-hot-encodings>One-hot encodings
<a href=#one-hot-encodings><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>A full one-hot-encoding method is now available via parsnip using a contrast function. This would generate the full set of indicators for <em>each factor predictor</em>. Using <code>model.matrix(~ 0 + factor, data)</code> <em>kind of</em> does this, but only for the first factor:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf>library</span><span class=p>(</span><span class=n>tidymodels</span><span class=p>)</span>
<span class=n>unique_levels</span> <span class=o>&lt;-</span> 
  <span class=n>penguins</span> <span class=o>%&gt;%</span> 
  <span class=nf>select</span><span class=p>(</span><span class=n>species</span><span class=p>,</span> <span class=n>island</span><span class=p>)</span> <span class=o>%&gt;%</span> 
  <span class=nf>distinct</span><span class=p>()</span>

<span class=nf>levels</span><span class=p>(</span><span class=n>unique_levels</span><span class=o>$</span><span class=n>species</span><span class=p>)</span>
</code></pre></div><pre><code>## [1] &quot;Adelie&quot;    &quot;Chinstrap&quot; &quot;Gentoo&quot;
</code></pre><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf>levels</span><span class=p>(</span><span class=n>unique_levels</span><span class=o>$</span><span class=n>island</span><span class=p>)</span>
</code></pre></div><pre><code>## [1] &quot;Biscoe&quot;    &quot;Dream&quot;     &quot;Torgersen&quot;
</code></pre><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf>model.matrix</span><span class=p>(</span><span class=o>~</span> <span class=m>0</span> <span class=o>+</span> <span class=n>species</span> <span class=o>+</span> <span class=n>island</span><span class=p>,</span> <span class=n>data</span> <span class=o>=</span> <span class=n>unique_levels</span><span class=p>)</span>
</code></pre></div><pre><code>##   speciesAdelie speciesChinstrap speciesGentoo islandDream islandTorgersen
## 1             1                0             0           0               1
## 2             1                0             0           0               0
## 3             1                0             0           1               0
## 4             0                0             1           0               0
## 5             0                1             0           1               0
## attr(,&quot;assign&quot;)
## [1] 1 1 1 2 2
## attr(,&quot;contrasts&quot;)
## attr(,&quot;contrasts&quot;)$species
## [1] &quot;contr.treatment&quot;
## 
## attr(,&quot;contrasts&quot;)$island
## [1] &quot;contr.treatment&quot;
</code></pre><p>Notice that there are three indicators for <code>species</code> but two for <code>island</code>.</p><p>parsnip now has a contrast function that produces the whole set:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=n>old_contr</span> <span class=o>&lt;-</span> <span class=nf>options</span><span class=p>(</span><span class=s>&#34;contrasts&#34;</span><span class=p>)</span><span class=o>$</span><span class=n>contrasts</span>
<span class=n>new_contr</span> <span class=o>&lt;-</span> <span class=n>old_contr</span>
<span class=n>new_contr[</span><span class=s>&#34;unordered&#34;</span><span class=n>]</span> <span class=o>&lt;-</span> <span class=s>&#34;contr_one_hot&#34;</span>
<span class=nf>options</span><span class=p>(</span><span class=n>contrasts</span> <span class=o>=</span> <span class=n>new_contr</span><span class=p>)</span>

<span class=nf>model.matrix</span><span class=p>(</span><span class=o>~</span> <span class=n>species</span> <span class=o>+</span> <span class=n>island</span><span class=p>,</span> <span class=n>data</span> <span class=o>=</span> <span class=n>unique_levels</span><span class=p>)</span>
</code></pre></div><pre><code>##   (Intercept) speciesAdelie speciesChinstrap speciesGentoo islandBiscoe
## 1           1             1                0             0            0
## 2           1             1                0             0            1
## 3           1             1                0             0            0
## 4           1             0                0             1            1
## 5           1             0                1             0            0
##   islandDream islandTorgersen
## 1           0               1
## 2           0               0
## 3           1               0
## 4           0               0
## 5           1               0
## attr(,&quot;assign&quot;)
## [1] 0 1 1 1 2 2 2
## attr(,&quot;contrasts&quot;)
## attr(,&quot;contrasts&quot;)$species
## [1] &quot;contr_one_hot&quot;
## 
## attr(,&quot;contrasts&quot;)$island
## [1] &quot;contr_one_hot&quot;
</code></pre><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=c1># return to original options</span>
<span class=nf>options</span><span class=p>(</span><span class=n>contrasts</span> <span class=o>=</span> <span class=n>old_contr</span><span class=p>)</span>
</code></pre></div><p>Now, removing the intercept does not change the nature of the indicator columns.</p><h2 id=better-call-objects>Better call objects
<a href=#better-call-objects><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>In the output above when the the ranger model was fit via parsnip, the model formula in the ranger object what not the same as what we gave to <code>parsnip::fit()</code>:</p><pre><code>## parsnip model object
## 
## Fit time:  24ms 
## Ranger result
## 
## Call:
##  ranger::ranger(formula = formula, data = data, seed = ~1221, num.threads = 1, verbose = FALSE) 
</code></pre><p>In the new version of parsnip, if you use <code>parsnip::fit()</code> and the underlying model uses a formula, the formula is preserved. Here&rsquo;s an example using CART trees:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=n>cart_spec</span> <span class=o>&lt;-</span>
  <span class=nf>decision_tree</span><span class=p>()</span> <span class=o>%&gt;%</span>
  <span class=nf>set_engine</span><span class=p>(</span><span class=s>&#34;rpart&#34;</span><span class=p>)</span> <span class=o>%&gt;%</span>
  <span class=nf>set_mode</span><span class=p>(</span><span class=s>&#34;regression&#34;</span><span class=p>)</span>

<span class=n>cart_fit</span> <span class=o>&lt;-</span> 
  <span class=n>cart_spec</span> <span class=o>%&gt;%</span>
  <span class=nf>fit</span><span class=p>(</span><span class=n>body_mass_g</span> <span class=o>~</span> <span class=n>species</span> <span class=o>+</span> <span class=n>island</span><span class=p>,</span> <span class=n>data</span> <span class=o>=</span> <span class=n>penguins</span><span class=p>)</span>

<span class=n>cart_fit</span>
</code></pre></div><pre><code>## parsnip model object
## 
## Fit time:  2ms 
## n=342 (2 observations deleted due to missingness)
## 
## node), split, n, deviance, yval
##       * denotes terminal node
## 
## 1) root 342 219307700 4201.754  
##   2) species=Adelie,Chinstrap 219  41488530 3710.731 *
##   3) species=Gentoo 123  31004250 5076.016 *
</code></pre><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=n>cart_fit</span><span class=o>$</span><span class=n>fit</span><span class=o>$</span><span class=n>call</span>
</code></pre></div><pre><code>## rpart::rpart(formula = body_mass_g ~ species + island, data = data)
</code></pre><p>The call still uses <code>data</code> instead of <code>penguins</code>. To get the right <code>data</code> name, there is a <code>repair_call()</code> function that can be used to get the exact data set name:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=n>cart_fit</span> <span class=o>&lt;-</span> <span class=nf>repair_call</span><span class=p>(</span><span class=n>cart_fit</span><span class=p>,</span> <span class=n>data</span> <span class=o>=</span> <span class=n>penguins</span><span class=p>)</span>
<span class=n>cart_fit</span><span class=o>$</span><span class=n>fit</span><span class=o>$</span><span class=n>call</span>
</code></pre></div><pre><code>## rpart::rpart(formula = body_mass_g ~ species + island, data = penguins)
</code></pre><p>There are some R packages that use the object&rsquo;s formula in other functions. For example, the new
<a href=https://github.com/martin-borkovec/ggparty target=_blank rel=noopener><code>ggparty</code></a> package has some pretty cool methods for plotting tree-based models. To use them, the model must be converted into a <code>party</code> object and this requires a proper call object. Now that we have one, we can do the conversion from an <code>rpart</code> object to a <code>party</code> object:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf>library</span><span class=p>(</span><span class=n>partykit</span><span class=p>)</span>
<span class=n>cart_party</span> <span class=o>&lt;-</span> <span class=nf>as.party</span><span class=p>(</span><span class=n>cart_fit</span><span class=o>$</span><span class=n>fit</span><span class=p>)</span>
<span class=n>cart_party</span>
</code></pre></div><pre><code>## 
## Model formula:
## body_mass_g ~ species + island
## 
## Fitted party:
## [1] root
## |   [2] species in Adelie, Chinstrap: 3710.731 (n = 219, err = 41488533.1)
## |   [3] species in Gentoo: 5076.016 (n = 123, err = 31004248.0)
## 
## Number of inner nodes:    1
## Number of terminal nodes: 2
</code></pre><p>This can be used with <code>ggparty</code>:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf>library</span><span class=p>(</span><span class=n>ggparty</span><span class=p>)</span>
<span class=nf>ggparty</span><span class=p>(</span><span class=n>cart_party</span><span class=p>)</span> <span class=o>+</span>
  <span class=nf>geom_edge</span><span class=p>()</span> <span class=o>+</span>
  <span class=nf>geom_edge_label</span><span class=p>()</span> <span class=o>+</span>
  <span class=nf>geom_node_splitvar</span><span class=p>()</span> <span class=o>+</span>
  <span class=nf>geom_node_plot</span><span class=p>(</span>
    <span class=n>gglist</span> <span class=o>=</span> <span class=nf>list</span><span class=p>(</span><span class=nf>geom_histogram</span><span class=p>(</span><span class=nf>aes</span><span class=p>(</span><span class=n>x</span> <span class=o>=</span> <span class=n>body_mass_g</span><span class=p>),</span> <span class=n>bins</span> <span class=o>=</span> <span class=m>15</span><span class=p>,</span> <span class=n>col</span> <span class=o>=</span> <span class=s>&#34;white&#34;</span><span class=p>))</span>
  <span class=p>)</span>
</code></pre></div><p><img src=figure/ggparty-1.svg title="plot of chunk ggparty" alt="plot of chunk ggparty" width=60% style=display:block;margin:auto></p><h2 id=other-new-features>Other new features
<a href=#other-new-features><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><ul><li><p>A new main argument was added to
<a href=https://parsnip.tidymodels.org/reference/boost_tree.html target=_blank rel=noopener><code>boost_tree()</code></a> called <code>stop_iter</code> for early stopping. The <code>xgb_train()</code> function gained arguments for early stopping and a percentage of data to leave out for a validation set.</p></li><li><p>The <code>predict()</code> method for <code>model_fit</code>s now checks to see if required modeling packages are installed. The packages are loaded (but not attached).</p></li><li><p>The function <code>req_pkgs()</code> is a user interface to determining the required packages.</p></li></ul><h2 id=acknowledgements>Acknowledgements
<a href=#acknowledgements><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Many thanks to Julia Silge and Davis Vaughan for their patience and insights when discussing strategies for predictor encodings.</p><p>Also, we want to thank everyone who contributed changes or issues since the last release:
<a href=https://github.com/cgoo4 target=_blank rel=noopener>@cgoo4</a>,
<a href=https://github.com/Deleetdk target=_blank rel=noopener>@Deleetdk</a>,
<a href=https://github.com/EllaKaye target=_blank rel=noopener>@EllaKaye</a>,
<a href=https://github.com/EmilHvitfeldt target=_blank rel=noopener>@EmilHvitfeldt</a>,
<a href=https://github.com/enixam target=_blank rel=noopener>@enixam</a>,
<a href=https://github.com/FranciscoPalomares target=_blank rel=noopener>@FranciscoPalomares</a>,
<a href=https://github.com/FrieseWoudloper target=_blank rel=noopener>@FrieseWoudloper</a>,
<a href=https://github.com/hadley target=_blank rel=noopener>@hadley</a>,
<a href=https://github.com/jtelleriar target=_blank rel=noopener>@jtelleriar</a>,
<a href=https://github.com/kylegilde target=_blank rel=noopener>@kylegilde</a>,
<a href=https://github.com/markbneal target=_blank rel=noopener>@markbneal</a>,
<a href=https://github.com/markhwhiteii target=_blank rel=noopener>@markhwhiteii</a>,
<a href=https://github.com/mdancho84 target=_blank rel=noopener>@mdancho84</a>,
<a href=https://github.com/oude-gao target=_blank rel=noopener>@oude-gao</a>,
<a href=https://github.com/ouzor target=_blank rel=noopener>@ouzor</a>,
<a href=https://github.com/RichardPilbery target=_blank rel=noopener>@RichardPilbery</a>,
<a href=https://github.com/rorynolan target=_blank rel=noopener>@rorynolan</a>,
<a href=https://github.com/simonpcouch target=_blank rel=noopener>@simonpcouch</a>,
<a href=https://github.com/StefanBRas target=_blank rel=noopener>@StefanBRas</a>,
<a href=https://github.com/stevenpawley target=_blank rel=noopener>@stevenpawley</a>,
<a href=https://github.com/ThomasWolf0701 target=_blank rel=noopener>@ThomasWolf0701</a>, and
<a href=https://github.com/UnclAlDeveloper target=_blank rel=noopener>@UnclAlDeveloper</a>.</p></div></div><div class=column25><div class="section hideOnMobile"><div class=sectionTitle>Contents</div><nav id=TableOfContents><ul><li><a href=#predictor-encoding-consistency>Predictor encoding consistency</a></li><li><a href=#one-hot-encodings>One-hot encodings</a></li><li><a href=#better-call-objects>Better call objects</a></li><li><a href=#other-new-features>Other new features</a></li><li><a href=#acknowledgements>Acknowledgements</a></li></ul></nav></div><div class=section></div></div></div></div></div><div id=rStudioFooter class=band><div class=bandContent><div id=copyright>The tidyverse is proudly supported by <a class=rstudioLogo href=https://posit.co/ aria-label="Posit Homepage"></a></div><div id=logos><a href=https://www.tidyverse.org/google_privacy_policy>Privacy policy</a>
<a href=https://github.com/tidyverse class="footerLogo gitHub" aria-label="Tidyverse GitHub organization"></a><a href=https://twitter.com/hashtag/rstats class="footerLogo twitter" aria-label="rstats hashtag on twitter.com"></a></div></div></div></div></div><script src=/js/math-code.js></script><script type=text/x-mathjax-config>
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    processEscapes: true
  }
});
</script><script async src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><script type=application/javascript>var dnt=(navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack);var doNotTrack=(dnt=="1"||dnt=="yes");if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');if(window.sessionStorage){var GA_SESSION_STORAGE_KEY='ga:clientId';ga('create','UA-115082821-1',{'storage':'none','clientId':sessionStorage.getItem(GA_SESSION_STORAGE_KEY)});ga(function(tracker){sessionStorage.setItem(GA_SESSION_STORAGE_KEY,tracker.get('clientId'));});}
ga('set','anonymizeIp',true);ga('send','pageview');}</script></body></html></div></div></body></html>