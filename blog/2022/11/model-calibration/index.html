<!doctype html><html><head><!doctype html><html lang=en-us><link rel=stylesheet href=/css/fonts.css><link rel=stylesheet href=/css/main-site.css><link rel=stylesheet href=/css/fa5-all.css><style type=text/css>body{background-color:#fff;color:#1a1917}a{color:#38577f}a:hover{color:#42709b}a:focus{outline-color:#42709b}.column25-left .sectionTitle a:hover:not(.current),.column16-left .sectionTitle a:hover:not(.current){color:#1a1917}.icon-attribution,.icon-attribution a{color:#1a1917;opacity:75%}#homeContent .band.first{background-color:#fff}#homeContent .band.second{background-color:#fdeba4}#homeContent .band.third{background-color:#fff}#rStudioHeader{background-color:#1a162d;color:#fff}#rStudioHeader .productName{color:#fff}#rStudioHeader .productName:hover,#rStudioHeader .productName:focus{color:#fdeba4}#rStudioHeader #menu .menuItem.a{background-color:#75aadb;color:#fff}#rStudioHeader #menu .menuItem:hover{background-color:#484557;color:#fff}#rStudioHeader #menu .menuItem.current{background-color:#fff;color:#1a162d;text-decoration:none}#rStudioFooter.band{background-color:#767381}#rStudioFooter .bandContent #copyright{color:#e3eef8}table tbody tr:nth-child(even){background-color:#f7faff}table tbody tr:nth-child(odd){background-color:#fff}.latest{border-top:.5em solid <no value>}.event{-moz-box-shadow:0 0 0 0 rgba(0,0,0,.1);-webkit-box-shadow:0 0 0 0 rgba(0,0,0,.1);box-shadow:0 0 0 0 rgba(0,0,0,.1)}.section .event{background-color:#eab0c41a}.section .event{border-top:7pt solid #a19ea936}.section .event a{color:#1a162d}.section .event{color:#404040}</style><link rel=stylesheet href=/css/tidyverse.css><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Hugo 0.71.1"><title>Model Calibration</title><meta property="og:title" content="Model Calibration"><meta property="og:description" content="Model Calibration is coming to tidymodels. This post covers the new plotting functions, and our plans for future enhancements."><meta property="og:type" content="article"><meta property="og:url" content="https://www.tidyverse.org/blog/2022/11/model-calibration/"><meta property="twitter:card" content="summary_large_image"><meta property="og:title" content="Model Calibration - Tidyverse"><meta property="description" content="Model Calibration is coming to tidymodels. This post covers the new plotting functions, and our plans for future enhancements."><meta property="og:description" content="Model Calibration is coming to tidymodels. This post covers the new plotting functions, and our plans for future enhancements."><meta property="og:image" content="https://www.tidyverse.org/blog/2022/11/model-calibration/thumbnail-sq.jpg"><meta name=twitter:image content="https://www.tidyverse.org/blog/2022/11/model-calibration/thumbnail-wd.jpg"><link rel=apple-touch-icon sizes=180x180 href=/images/favicons/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/images/favicons/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/images/favicons/favicon-16x16.png><link rel=manifest href=/images/favicons/site.webmanifest><link rel=mask-icon href=/images/favicons/safari-pinned-tab.svg><link rel="shortcut icon" href=/images/favicons/favicon.ico><meta name=msapplication-TileColor content="#da532c"><meta name=msapplication-config href=/images/favicons/browserconfig.xml><script type=text/javascript src=/js/jquery-3.5.1.min.js></script><script type=text/javascript src=/js/site.js></script><link rel=icon href=/images/favicon.ico><script type=text/javascript src=/js/clipboard.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin=anonymous></script><script defer data-domain=tidyverse.org,all.tidyverse.org src=https://plausible.io/js/plausible.js></script></head><body><div id=appTidyverseSite class="shrinkHeader alwaysShrinkHeader"><div id=main><div id=rStudioHeader><nav class=band><div class="innards bandContent"><div><a class=productName href=/%20/>Tidyverse</a></div><div id=menu><div id=menuToggler></div><div id=menuItems><a class=menuItem href=/packages/>Packages</a>
<a class="menuItem current" href=/blog/>Blog</a>
<a class=menuItem href=/learn/>Learn</a>
<a class=menuItem href=/help/>Help</a>
<a class=menuItem href=/contribute/>Contribute</a></div></div></div></nav></div><main><div class="band padForHeader pushFooter"><div class=bandContent><div class="full splitColumns withMobileMargins"><div class=column75><h1 class=article-title>Model Calibration</h1><div class=article-header aria-hidden=true><div class=photo><img src=/blog/2022/11/model-calibration/thumbnail-wd.jpg></div><div class=photoCredit>Photo by <a href=https://unsplash.com/photos/s3B_pjK7UIs>Graphic Node</a></div></div><span class=article-date><i class="fas fa-calendar-day fa-fw"></i>&nbsp;&nbsp;2022/11/29</span><p style=margin-bottom:.5em;margin-top:.85em><i class="fas fa-tags"></i>&nbsp;
<a href=/tags/model/>model</a>,
<a href=/tags/plots/>plots</a></p><p style=margin-top:.5em><i class="fas fa-user-circle fa-fw"></i>&nbsp;
Edgar Ruiz</p><div class=article-content><p>I am very excited to introduce work currently underway on the probably package.<br>We are looking to create early awareness and receive feedback from the community. That is why the enhancements discussed here are not yet on CRAN.</p><p>While the article is meant to introduce new package functionality, we also have the goal of introducing model calibration conceptually. We want to provide sufficient background for those who may not be familiar with model calibration. If you are already familiar with this technique, feel free to skip to the
<a href=#example-data>Setup</a> section to get started.</p><p>To install the version of probably used here:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nf>remotes</span><span class=nf>::</span><span class=nf><a href=https://remotes.r-lib.org/reference/install_github.html>install_github</a></span><span class=o>(</span><span class=s>"tidymodels/probably"</span><span class=o>)</span></span></code></pre></div><h2 id=model-calibration>Model Calibration
<a href=#model-calibration><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p><em>The goal of model calibration is to ensure that the estimated class probabilities are consistent with what would naturally occur.</em> If a model has poor calibration, we might be able to post-process the original predictions to coerce them to have better properties.</p><p>There are two main components to model calibration:</p><ul><li><strong>Diagnosis</strong> - Figuring out how well the original (and re-calibrated) probabilities perform.</li><li><strong>Remediation</strong> - Adjusting the original values to have better properties.</li></ul><h3 id=the-development-plan>The Development Plan
<a href=#the-development-plan><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>As with everything in machine learning, there are several options to consider when calibrating a model. Through the new features in the tidymodels packages, we aspire to make those options as easily accessible as possible.</p><p>Our plan is to implement model calibration in two phases: the first phase will focus on binary models, and the second phase will focus on multi-class models.</p><p>The first batch of enhancements are now available in the development version of the probably package. The enhancements are centered around plotting functions meant for <strong>diagnosing</strong> the prediction&rsquo;s performance. These are more commonly known as <strong>calibration plots</strong>.</p><h2 id=calibration-plots>Calibration Plots
<a href=#calibration-plots><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>The idea behind a calibration plot is that if we group the predictions based on their probability, then we should see a percentage of events <sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> that match such probability.</p><p>For example, if we collect a group of the predictions whose probabilities are estimated to be about 10%, then we should expect that about 10% of the those in the group to indeed be events. The plots shown below can be used as diagnostics to see if our predictions are consistent with the observed event rates.</p><h3 id=example-data>Example Data
<a href=#example-data><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>If you would like to follow along, load the probably and dplyr packages into your R session.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=kr><a href=https://rdrr.io/r/base/library.html>library</a></span><span class=o>(</span><span class=nv><a href=https://tidymodels.tidymodels.org>tidymodels</a></span><span class=o>)</span></span>
<span><span class=kr><a href=https://rdrr.io/r/base/library.html>library</a></span><span class=o>(</span><span class=nv><a href=https://github.com/tidymodels/probably/>probably</a></span><span class=o>)</span></span></code></pre></div><p>The probably package comes with a few data sets. For most of the examples in this post, we will use <code>segment_logistic</code>, an example data set that contains predicted probabilities and classes from a logistic regression model for a binary outcome <code>Class</code>, taking values <code>"good"</code> or <code>"bad"</code>. predictions, and their probabilities. <code>Class</code> contains the outcome of <code>.pred_good</code> contains the probability that the event is &ldquo;good&rdquo;.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>segment_logistic</span></span>
<span><span class=c>#&gt; <span style=color:#555># A tibble: 1,010 × 3</span></span></span>
<span><span class=c>#&gt;    .pred_poor .pred_good Class</span></span>
<span><span class=c>#&gt;  <span style=color:#555>*</span>      <span style=color:#555;font-style:italic>&lt;dbl&gt;</span>      <span style=color:#555;font-style:italic>&lt;dbl&gt;</span> <span style=color:#555;font-style:italic>&lt;fct&gt;</span></span></span>
<span><span class=c>#&gt; <span style=color:#555> 1</span>    0.986      0.014<span style=text-decoration:underline>2</span>  poor </span></span>
<span><span class=c>#&gt; <span style=color:#555> 2</span>    0.897      0.103   poor </span></span>
<span><span class=c>#&gt; <span style=color:#555> 3</span>    0.118      0.882   good </span></span>
<span><span class=c>#&gt; <span style=color:#555> 4</span>    0.102      0.898   good </span></span>
<span><span class=c>#&gt; <span style=color:#555> 5</span>    0.991      0.009<span style=text-decoration:underline>14</span> poor </span></span>
<span><span class=c>#&gt; <span style=color:#555> 6</span>    0.633      0.367   good </span></span>
<span><span class=c>#&gt; <span style=color:#555> 7</span>    0.770      0.230   good </span></span>
<span><span class=c>#&gt; <span style=color:#555> 8</span>    0.008<span style=text-decoration:underline>42</span>    0.992   good </span></span>
<span><span class=c>#&gt; <span style=color:#555> 9</span>    0.995      0.004<span style=text-decoration:underline>58</span> poor </span></span>
<span><span class=c>#&gt; <span style=color:#555>10</span>    0.765      0.235   poor </span></span>
<span><span class=c>#&gt; <span style=color:#555># … with 1,000 more rows</span></span></span></code></pre></div><h3 id=binned-plot>Binned Plot
<a href=#binned-plot><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>On smaller data sets, it is challenging to obtain an accurate <em>event rate</em> for a given probability. For example, if there are 5 predictions with about a 50% probability, and 3 of those are events, the plot would show a 60% event rate. This comparison would not be appropriate because there are not enough predictions to determine how close to 50% the model really is.</p><p>The most common approach is to group the probabilities into bins, or buckets. Usually, the data is split into 10 discrete buckets, from 0 to 1 (0 - 100%). The <em>event rate</em> and the <em>bin midpoint</em> is calculated for each bin.</p><p>In the probably package, binned calibration plots can be created using
<a href=https://probably.tidymodels.org/reference/cal_plot_breaks.html target=_blank rel=noopener><code>cal_plot_breaks()</code></a>. It expects a data set (<code>.data</code>), the un-quoted variable names that contain the events (<code>truth</code>), and the probabilities (<code>estimate</code>). For the example here, we pass the <code>segment_logistic</code> data set, and use <code>Class</code> and <code>.pred_good</code> as the arguments. By default, this function will create a calibration plot with 10 buckets (breaks):</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>segment_logistic</span> <span class=o><a href=https://magrittr.tidyverse.org/reference/pipe.html>%&gt;%</a></span> </span>
<span>  <span class=nf><a href=https://probably.tidymodels.org/reference/cal_plot_breaks.html>cal_plot_breaks</a></span><span class=o>(</span><span class=nv>Class</span>, <span class=nv>.pred_good</span><span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-4-1.png alt="A ggplot line plot with predicted probabilities on the x axis and event rates on the y axis, both ranging from 0 to 1. A dashed line lies on the identity line y equals x, and is loosely followed by a solid line that joins a series of dots representing the midpoint for each of 10 bins. Past predicted probabilities of 0.5, the dots consistently lie below the dashed line." width=700px style=display:block;margin:auto></p></div><p>The calibration plot for the ideal model will essentially be perfect incline line that start at (0,0) and ends in (1,1). In the case of this model, we can see that the seventh point has an event rate of 49.1% despite having estimated probabilities ranging from 60% to 70%. This indicates that the model is not creating predictions in this region that are consistent with the data (i.e., it is under-predicting).</p><p>The number of bins in
<a href=https://probably.tidymodels.org/reference/cal_plot_breaks.html target=_blank rel=noopener><code>cal_plot_breaks()</code></a> can be adjusted using <code>num_breaks</code>. Here is an example of what the plot looks like if we reduce the bins from 10, to 5:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>segment_logistic</span> <span class=o><a href=https://magrittr.tidyverse.org/reference/pipe.html>%&gt;%</a></span> </span>
<span>  <span class=nf><a href=https://probably.tidymodels.org/reference/cal_plot_breaks.html>cal_plot_breaks</a></span><span class=o>(</span><span class=nv>Class</span>, <span class=nv>.pred_good</span>, num_breaks <span class=o>=</span> <span class=m>5</span> <span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-6-1.png alt="A calibration like that above, but with half as many bins. In this version of the plot, the solid line is less jagged, though still shows that dots consistently lie below the dashed line beyond a predicted probability of 0.5." width=700px style=display:block;margin:auto></p></div><p>The number of breaks should be based on ensuring that there is enough data in each bin to adequately estimate the observed event rate. If your data are small, the next version of the calibration plot might be a better solution.</p><h3 id=windowed>Windowed
<a href=#windowed><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>Another approach is to use overlapping ranges, or windows. Like the previous plot, we bin the data and calculate the event rate. However, we can add more bins by allowing them to overlap. If the data set size is small, one strategy is to use a set of wide bins that overlap one another.</p><p>There are two variables that control the windows. The <strong>step size</strong> controls the frequency of the windows. If we set a step size of 5%, windows will be created for each 5% increment in predicted probability (5%, 10%, 15%, etc). The second argument is the (maximum) <strong>window size</strong>. If it is set to 10%&mdash;and the step size is set at 5%&mdash;then a given step will overlap halfway into both the previous step and the next step. Here is a visual representation of this specific scenario:</p><div class=highlight><p><img src=figs/unnamed-chunk-7-1.png alt="Plot illustrating the horizontal location of each step and the size of the window" width=70% style=display:block;margin:auto></p></div><p>In probably, the
<a href=https://probably.tidymodels.org/reference/cal_plot_breaks.html target=_blank rel=noopener><code>cal_plot_windowed()</code></a> function provides this functionality. The default step size is 0.05, and can be changed via the <code>step_size</code> argument. The default window size is 0.1, and can be changed via the <code>window_size</code> argument:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>segment_logistic</span> <span class=o><a href=https://magrittr.tidyverse.org/reference/pipe.html>%&gt;%</a></span> </span>
<span>  <span class=nf><a href=https://probably.tidymodels.org/reference/cal_plot_breaks.html>cal_plot_windowed</a></span><span class=o>(</span><span class=nv>Class</span>, <span class=nv>.pred_good</span><span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-8-1.png alt="Calibration plot with 21 windows, created with the cal_plot_windowed() function" width=700px style=display:block;margin:auto></p></div><p>Here is an example of reducing the <code>step_size</code> from 0.05 to 0.02. There are more than double the windows:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>segment_logistic</span> <span class=o><a href=https://magrittr.tidyverse.org/reference/pipe.html>%&gt;%</a></span> </span>
<span>  <span class=nf><a href=https://probably.tidymodels.org/reference/cal_plot_breaks.html>cal_plot_windowed</a></span><span class=o>(</span><span class=nv>Class</span>, <span class=nv>.pred_good</span>, step_size <span class=o>=</span> <span class=m>0.02</span><span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-9-1.png alt="Calibration plot with more steps than the default, created with the cal_plot_windowed() function" width=700px style=display:block;margin:auto></p></div><h3 id=model-based>Model-Based
<a href=#model-based><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>Another way to visualize the performance is to fit a classification model of the events against the estimated probabilities. This is helpful because it avoids the use of pre-determined groupings. Another difference is that we are not plotting midpoints of actual results, but rather predictions based on those results.</p><p>The
<a href=https://probably.tidymodels.org/reference/cal_plot_breaks.html target=_blank rel=noopener><code>cal_plot_logistic()</code></a> provides this functionality. By default, it uses a logistic regression. There are two possible methods for fitting:</p><ul><li><p><code>smooth = TRUE</code> (the default) fits a generalized additive model using splines. This allows for more flexible model fits.</p></li><li><p><code>smooth = FALSE</code> uses an ordinary logistic regression model with linear terms for the predictor.</p></li></ul><p>As an example:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>segment_logistic</span> <span class=o><a href=https://magrittr.tidyverse.org/reference/pipe.html>%&gt;%</a></span> </span>
<span>  <span class=nf><a href=https://probably.tidymodels.org/reference/cal_plot_breaks.html>cal_plot_logistic</a></span><span class=o>(</span><span class=nv>Class</span>, <span class=nv>.pred_good</span><span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-10-1.png alt="Logistic Spline calibration plot, created with the cal_plot_logistic() function" width=700px style=display:block;margin:auto></p></div><p>The corresponding
<a href=https://rdrr.io/r/stats/glm.html target=_blank rel=noopener><code>glm()</code></a> model produces:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>segment_logistic</span> <span class=o><a href=https://magrittr.tidyverse.org/reference/pipe.html>%&gt;%</a></span> </span>
<span>  <span class=nf><a href=https://probably.tidymodels.org/reference/cal_plot_breaks.html>cal_plot_logistic</a></span><span class=o>(</span><span class=nv>Class</span>, <span class=nv>.pred_good</span>, smooth <span class=o>=</span> <span class=kc>FALSE</span><span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-11-1.png alt="Ordinary logistic calibration plot, created with the cal_plot_logistic() function" width=700px style=display:block;margin:auto></p></div><h3 id=additional-options-and-features>Additional options and features
<a href=#additional-options-and-features><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><h4 id=intervals><strong>Intervals</strong>
<a href=#intervals><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h4><p>The confidence intervals are visualized using the gray ribbon. The default interval is 0.9, but can be changed using the <code>conf_level</code> argument.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>segment_logistic</span> <span class=o><a href=https://magrittr.tidyverse.org/reference/pipe.html>%&gt;%</a></span> </span>
<span>  <span class=nf><a href=https://probably.tidymodels.org/reference/cal_plot_breaks.html>cal_plot_breaks</a></span><span class=o>(</span><span class=nv>Class</span>, <span class=nv>.pred_good</span>, conf_level <span class=o>=</span> <span class=m>0.8</span><span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-12-1.png alt="Calibration plot with a confidence interval set to 0.8" width=700px style=display:block;margin:auto></p></div><p>If desired, the intervals can be removed by setting the <code>include_ribbon</code> argument to <code>FALSE</code>.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>segment_logistic</span> <span class=o><a href=https://magrittr.tidyverse.org/reference/pipe.html>%&gt;%</a></span> </span>
<span>  <span class=nf><a href=https://probably.tidymodels.org/reference/cal_plot_breaks.html>cal_plot_breaks</a></span><span class=o>(</span><span class=nv>Class</span>, <span class=nv>.pred_good</span>, include_ribbon <span class=o>=</span> <span class=kc>FALSE</span><span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-13-1.png alt="Calibration plot with the confidence interval ribbon turned off" width=700px style=display:block;margin:auto></p></div><h4 id=rugs><strong>Rugs</strong>
<a href=#rugs><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h4><p>By default, the calibration plots include a RUGs layer at the top and at the bottom of the visualization. They are meant to give us an idea of the density of events and non-events as the probabilities progress from 0 to 1.</p><div class=highlight><p><img src=figs/unnamed-chunk-14-1.png alt="Calibration plot with arrows pointing to where the RUGS plots are placed in the graph" width=700px style=display:block;margin:auto></p></div><p>This layer can be removed by setting <code>include_rug</code> to <code>FALSE</code>:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>segment_logistic</span> <span class=o><a href=https://magrittr.tidyverse.org/reference/pipe.html>%&gt;%</a></span> </span>
<span>  <span class=nf><a href=https://probably.tidymodels.org/reference/cal_plot_breaks.html>cal_plot_breaks</a></span><span class=o>(</span><span class=nv>Class</span>, <span class=nv>.pred_good</span>, include_rug <span class=o>=</span> <span class=kc>FALSE</span><span class=o>)</span> </span>
</code></pre><p><img src=figs/unnamed-chunk-15-1.png alt="Calibration plot without RUGS" width=700px style=display:block;margin:auto></p></div><h2 id=integration-with-tune>Integration with tune
<a href=#integration-with-tune><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>So far, the inputs to the functions have been data frames. In tidymodels, the tune package has methods for resampling models as well as functions for tuning hyperparameters.</p><p>The calibration plots in the probably package also support the results of these functions (with class <code>tune_results</code>). The functions read the metadata from the tune object, and the <code>truth</code> and <code>estimate</code> arguments automatically.</p><p>To showcase this feature, we will tune a model based on simulated data. In order for the calibration plot to work, the predictions need to be collected. This is done by setting <code>save_pred</code> to <code>TRUE</code> in <code>tune_grid()</code>'s control settings.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nf><a href=https://rdrr.io/r/base/Random.html>set.seed</a></span><span class=o>(</span><span class=m>111</span><span class=o>)</span></span>
<span><span class=nv>sim_data</span> <span class=o>&lt;-</span> <span class=nf>sim_classification</span><span class=o>(</span><span class=m>500</span><span class=o>)</span></span>
<span><span class=nv>sim_folds</span> <span class=o>&lt;-</span> <span class=nf>vfold_cv</span><span class=o>(</span><span class=nv>sim_data</span>, repeats <span class=o>=</span> <span class=m>3</span><span class=o>)</span></span>
<span></span>
<span><span class=nv>rf_mod</span> <span class=o>&lt;-</span> <span class=nf>rand_forest</span><span class=o>(</span>min_n <span class=o>=</span> <span class=nf>tune</span><span class=o>(</span><span class=o>)</span><span class=o>)</span> <span class=o><a href=https://magrittr.tidyverse.org/reference/pipe.html>%&gt;%</a></span> <span class=nf>set_mode</span><span class=o>(</span><span class=s>"classification"</span><span class=o>)</span></span>
<span></span>
<span><span class=nf><a href=https://rdrr.io/r/base/Random.html>set.seed</a></span><span class=o>(</span><span class=m>222</span><span class=o>)</span></span>
<span><span class=nv>tuned_model</span> <span class=o>&lt;-</span> </span>
<span>  <span class=nv>rf_mod</span> <span class=o><a href=https://magrittr.tidyverse.org/reference/pipe.html>%&gt;%</a></span> </span>
<span>  <span class=nf>tune_grid</span><span class=o>(</span></span>
<span>    <span class=nv>class</span> <span class=o>~</span> <span class=nv>.</span>,</span>
<span>    resamples <span class=o>=</span> <span class=nv>sim_folds</span>,</span>
<span>    grid <span class=o>=</span> <span class=m>4</span>,</span>
<span>    <span class=c># Important: `saved_pred` has to be set to TRUE in order for </span></span>
<span>    <span class=c># the plotting to be possible</span></span>
<span>    control <span class=o>=</span> <span class=nf>control_resamples</span><span class=o>(</span>save_pred <span class=o>=</span> <span class=kc>TRUE</span><span class=o>)</span></span>
<span>  <span class=o>)</span></span>
<span></span>
<span><span class=nv>tuned_model</span></span>
<span><span class=c>#&gt; # Tuning results</span></span>
<span><span class=c>#&gt; # 10-fold cross-validation repeated 3 times </span></span>
<span><span class=c>#&gt; <span style=color:#555># A tibble: 30 × 6</span></span></span>
<span><span class=c>#&gt;    splits           id      id2    .metrics         .notes           .predicti…¹</span></span>
<span><span class=c>#&gt;    <span style=color:#555;font-style:italic>&lt;list&gt;</span>           <span style=color:#555;font-style:italic>&lt;chr&gt;</span>   <span style=color:#555;font-style:italic>&lt;chr&gt;</span>  <span style=color:#555;font-style:italic>&lt;list&gt;</span>           <span style=color:#555;font-style:italic>&lt;list&gt;</span>           <span style=color:#555;font-style:italic>&lt;list&gt;</span>     </span></span>
<span><span class=c>#&gt; <span style=color:#555> 1</span> <span style=color:#555>&lt;split [450/50]&gt;</span> Repeat1 Fold01 <span style=color:#555>&lt;tibble [8 × 5]&gt;</span> <span style=color:#555>&lt;tibble [0 × 3]&gt;</span> &lt;tibble&gt;   </span></span>
<span><span class=c>#&gt; <span style=color:#555> 2</span> <span style=color:#555>&lt;split [450/50]&gt;</span> Repeat1 Fold02 <span style=color:#555>&lt;tibble [8 × 5]&gt;</span> <span style=color:#555>&lt;tibble [0 × 3]&gt;</span> &lt;tibble&gt;   </span></span>
<span><span class=c>#&gt; <span style=color:#555> 3</span> <span style=color:#555>&lt;split [450/50]&gt;</span> Repeat1 Fold03 <span style=color:#555>&lt;tibble [8 × 5]&gt;</span> <span style=color:#555>&lt;tibble [0 × 3]&gt;</span> &lt;tibble&gt;   </span></span>
<span><span class=c>#&gt; <span style=color:#555> 4</span> <span style=color:#555>&lt;split [450/50]&gt;</span> Repeat1 Fold04 <span style=color:#555>&lt;tibble [8 × 5]&gt;</span> <span style=color:#555>&lt;tibble [0 × 3]&gt;</span> &lt;tibble&gt;   </span></span>
<span><span class=c>#&gt; <span style=color:#555> 5</span> <span style=color:#555>&lt;split [450/50]&gt;</span> Repeat1 Fold05 <span style=color:#555>&lt;tibble [8 × 5]&gt;</span> <span style=color:#555>&lt;tibble [0 × 3]&gt;</span> &lt;tibble&gt;   </span></span>
<span><span class=c>#&gt; <span style=color:#555> 6</span> <span style=color:#555>&lt;split [450/50]&gt;</span> Repeat1 Fold06 <span style=color:#555>&lt;tibble [8 × 5]&gt;</span> <span style=color:#555>&lt;tibble [0 × 3]&gt;</span> &lt;tibble&gt;   </span></span>
<span><span class=c>#&gt; <span style=color:#555> 7</span> <span style=color:#555>&lt;split [450/50]&gt;</span> Repeat1 Fold07 <span style=color:#555>&lt;tibble [8 × 5]&gt;</span> <span style=color:#555>&lt;tibble [0 × 3]&gt;</span> &lt;tibble&gt;   </span></span>
<span><span class=c>#&gt; <span style=color:#555> 8</span> <span style=color:#555>&lt;split [450/50]&gt;</span> Repeat1 Fold08 <span style=color:#555>&lt;tibble [8 × 5]&gt;</span> <span style=color:#555>&lt;tibble [0 × 3]&gt;</span> &lt;tibble&gt;   </span></span>
<span><span class=c>#&gt; <span style=color:#555> 9</span> <span style=color:#555>&lt;split [450/50]&gt;</span> Repeat1 Fold09 <span style=color:#555>&lt;tibble [8 × 5]&gt;</span> <span style=color:#555>&lt;tibble [0 × 3]&gt;</span> &lt;tibble&gt;   </span></span>
<span><span class=c>#&gt; <span style=color:#555>10</span> <span style=color:#555>&lt;split [450/50]&gt;</span> Repeat1 Fold10 <span style=color:#555>&lt;tibble [8 × 5]&gt;</span> <span style=color:#555>&lt;tibble [0 × 3]&gt;</span> &lt;tibble&gt;   </span></span>
<span><span class=c>#&gt; <span style=color:#555># … with 20 more rows, and abbreviated variable name ¹​.predictions</span></span></span></code></pre></div><p>The plotting functions will automatically collect the predictions. Each of the pre-processing groups will be plotted individually in its own facet.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>tuned_model</span> <span class=o><a href=https://magrittr.tidyverse.org/reference/pipe.html>%&gt;%</a></span> </span>
<span>  <span class=nf><a href=https://probably.tidymodels.org/reference/cal_plot_breaks.html>cal_plot_logistic</a></span><span class=o>(</span><span class=o>)</span> </span>
</code></pre><p><img src=figs/unnamed-chunk-17-1.png alt="Multiple calibration plots presented in a grid" width=700px style=display:block;margin:auto></p></div><p>A panel is produced for each value of <code>min_n</code>, coded with an automatically generated configuration name. This makes sure to use the out-of-sample data to make the plot (instead of just re-predicting the training set).</p><h2 id=preparing-for-the-next-stage>Preparing for the next stage
<a href=#preparing-for-the-next-stage><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>As mentioned in the outset of this post, the goal is to also provide a way to calibrate the model, and to apply the calibration to future predictions. We have made sure that the plotting functions are ready now to accept multiple probability sets.</p><p>In this post, we will showcase that functionality by &ldquo;manually&rdquo; creating a quick calibration model and comparing its output to the original probabilities. We will need both of them in the same data frame, as well as a variable distinguishing the original probabilities from the calibrated probabilities. In this case we will create a variable called <code>source</code>:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>model</span> <span class=o>&lt;-</span> <span class=nf><a href=https://rdrr.io/r/stats/glm.html>glm</a></span><span class=o>(</span><span class=nv>Class</span> <span class=o>~</span> <span class=nv>.pred_good</span>, <span class=nv>segment_logistic</span>, family <span class=o>=</span> <span class=s>"binomial"</span><span class=o>)</span></span>
<span></span>
<span><span class=nv>preds</span> <span class=o>&lt;-</span> <span class=nf><a href=https://rdrr.io/r/stats/predict.html>predict</a></span><span class=o>(</span><span class=nv>model</span>, <span class=nv>segment_logistic</span>, type <span class=o>=</span> <span class=s>"response"</span><span class=o>)</span></span>
<span>  </span>
<span><span class=nv>combined</span> <span class=o>&lt;-</span> <span class=nf><a href=https://dplyr.tidyverse.org/reference/bind.html>bind_rows</a></span><span class=o>(</span></span>
<span>  <span class=nf><a href=https://dplyr.tidyverse.org/reference/mutate.html>mutate</a></span><span class=o>(</span><span class=nv>segment_logistic</span>, source <span class=o>=</span> <span class=s>"original"</span><span class=o>)</span>, </span>
<span>  <span class=nf><a href=https://dplyr.tidyverse.org/reference/mutate.html>mutate</a></span><span class=o>(</span><span class=nv>segment_logistic</span>, .pred_good <span class=o>=</span> <span class=m>1</span> <span class=o>-</span> <span class=nv>preds</span>, source <span class=o>=</span> <span class=s>"glm"</span><span class=o>)</span></span>
<span>  <span class=o>)</span></span>
<span></span>
<span><span class=nv>combined</span> </span>
<span><span class=c>#&gt; <span style=color:#555># A tibble: 2,020 × 4</span></span></span>
<span><span class=c>#&gt;    .pred_poor .pred_good Class source  </span></span>
<span><span class=c>#&gt;         <span style=color:#555;font-style:italic>&lt;dbl&gt;</span>      <span style=color:#555;font-style:italic>&lt;dbl&gt;</span> <span style=color:#555;font-style:italic>&lt;fct&gt;</span> <span style=color:#555;font-style:italic>&lt;chr&gt;</span>   </span></span>
<span><span class=c>#&gt; <span style=color:#555> 1</span>    0.986      0.014<span style=text-decoration:underline>2</span>  poor  original</span></span>
<span><span class=c>#&gt; <span style=color:#555> 2</span>    0.897      0.103   poor  original</span></span>
<span><span class=c>#&gt; <span style=color:#555> 3</span>    0.118      0.882   good  original</span></span>
<span><span class=c>#&gt; <span style=color:#555> 4</span>    0.102      0.898   good  original</span></span>
<span><span class=c>#&gt; <span style=color:#555> 5</span>    0.991      0.009<span style=text-decoration:underline>14</span> poor  original</span></span>
<span><span class=c>#&gt; <span style=color:#555> 6</span>    0.633      0.367   good  original</span></span>
<span><span class=c>#&gt; <span style=color:#555> 7</span>    0.770      0.230   good  original</span></span>
<span><span class=c>#&gt; <span style=color:#555> 8</span>    0.008<span style=text-decoration:underline>42</span>    0.992   good  original</span></span>
<span><span class=c>#&gt; <span style=color:#555> 9</span>    0.995      0.004<span style=text-decoration:underline>58</span> poor  original</span></span>
<span><span class=c>#&gt; <span style=color:#555>10</span>    0.765      0.235   poor  original</span></span>
<span><span class=c>#&gt; <span style=color:#555># … with 2,010 more rows</span></span></span></code></pre></div><p>The new plot functions support dplyr groupings. So, to overlay the two groups, we just need to pass <code>source</code> to
<a href=https://dplyr.tidyverse.org/reference/group_by.html target=_blank rel=noopener><code>group_by()</code></a>:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>combined</span> <span class=o><a href=https://magrittr.tidyverse.org/reference/pipe.html>%&gt;%</a></span></span>
<span>  <span class=nf><a href=https://dplyr.tidyverse.org/reference/group_by.html>group_by</a></span><span class=o>(</span><span class=nv>source</span><span class=o>)</span> <span class=o><a href=https://magrittr.tidyverse.org/reference/pipe.html>%&gt;%</a></span></span>
<span>  <span class=nf><a href=https://probably.tidymodels.org/reference/cal_plot_breaks.html>cal_plot_breaks</a></span><span class=o>(</span><span class=nv>Class</span>, <span class=nv>.pred_good</span><span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-19-1.png alt="Calibration plot with two overlaying probability trends, one is the original and the second is the model" width=700px style=display:block;margin:auto></p></div><p>If we would like to plot them side by side, we can add
<a href=https://ggplot2.tidyverse.org/reference/facet_wrap.html target=_blank rel=noopener><code>facet_wrap()</code></a> as an additional step of the plot:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>combined</span> <span class=o><a href=https://magrittr.tidyverse.org/reference/pipe.html>%&gt;%</a></span> </span>
<span>  <span class=nf><a href=https://dplyr.tidyverse.org/reference/group_by.html>group_by</a></span><span class=o>(</span><span class=nv>source</span><span class=o>)</span> <span class=o><a href=https://magrittr.tidyverse.org/reference/pipe.html>%&gt;%</a></span> </span>
<span>  <span class=nf><a href=https://probably.tidymodels.org/reference/cal_plot_breaks.html>cal_plot_breaks</a></span><span class=o>(</span><span class=nv>Class</span>, <span class=nv>.pred_good</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/facet_wrap.html>facet_wrap</a></span><span class=o>(</span><span class=o>~</span><span class=nv>source</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/theme.html>theme</a></span><span class=o>(</span>legend.position <span class=o>=</span> <span class=s>"none"</span><span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-20-1.png alt="Calibration plot with two side-by-side probability trends" width=700px style=display:block;margin:auto></p></div><p>Our goal in the future is to provide calibration functions that create the models, and provide an easy way to visualize them.</p><h2 id=conclusion>Conclusion
<a href=#conclusion><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>As mentioned at the top of this post, we welcome your feedback as you try out these features and read about our plans for the future. If you wish to send us your thoughts, feel free to open an issue in probably&rsquo;s GitHub repo here: <a href=https://github.com/tidymodels/probably/issues>https://github.com/tidymodels/probably/issues</a>.</p><section class=footnotes role=doc-endnotes><hr><ol><li id=fn:1 role=doc-endnote><p>We can think of an <strong>event</strong> as the outcome that is being tracked by the probability. For example, if a model predicts &ldquo;heads&rdquo; or &ldquo;tails&rdquo; and we want to calibrate the probability for &ldquo;tails&rdquo;, then the <strong>event</strong> is when the column containing the outcome, has the value of &ldquo;tails&rdquo;. <a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></section></div></div><div class=column25><div class="section hideOnMobile"><div class=sectionTitle>Contents</div><nav id=TableOfContents><ul><li><a href=#model-calibration>Model Calibration</a></li><li><a href=#calibration-plots>Calibration Plots</a></li><li><a href=#integration-with-tune>Integration with tune</a></li><li><a href=#preparing-for-the-next-stage>Preparing for the next stage</a></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div><div class=section></div></div></div></div></div><div id=rStudioFooter class=band><div class=bandContent><div id=copyright>The tidyverse is proudly supported by <a class=rstudioLogo href=https://posit.co/ aria-label="Posit Homepage"></a></div><div id=logos><a href=https://www.tidyverse.org/google_privacy_policy>Privacy policy</a>
<a href=https://github.com/tidyverse class="footerLogo gitHub" aria-label="Tidyverse GitHub organization"></a><a href=https://twitter.com/hashtag/rstats class="footerLogo twitter" aria-label="rstats hashtag on twitter.com"></a></div></div></div></div></div><script type=application/javascript>var dnt=(navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack);var doNotTrack=(dnt=="1"||dnt=="yes");if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');if(window.sessionStorage){var GA_SESSION_STORAGE_KEY='ga:clientId';ga('create','UA-115082821-1',{'storage':'none','clientId':sessionStorage.getItem(GA_SESSION_STORAGE_KEY)});ga(function(tracker){sessionStorage.setItem(GA_SESSION_STORAGE_KEY,tracker.get('clientId'));});}
ga('set','anonymizeIp',true);ga('send','pageview');}</script></body></html></div></div></body></html>