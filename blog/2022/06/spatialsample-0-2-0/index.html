<!doctype html><html><head><!doctype html><html lang=en-us><link rel=stylesheet href=/css/fonts.css><link rel=stylesheet href=/css/main-site.css><link rel=stylesheet href=/css/fa5-all.css><style type=text/css>body{background-color:#fff;color:#1a1917}a{color:#38577f}a:hover{color:#42709b}a:focus{outline-color:#42709b}.column25-left .sectionTitle a:hover:not(.current),.column16-left .sectionTitle a:hover:not(.current){color:#1a1917}.icon-attribution,.icon-attribution a{color:#1a1917;opacity:75%}#homeContent .band.first{background-color:#fff}#homeContent .band.second{background-color:#fdeba4}#homeContent .band.third{background-color:#fff}#rStudioHeader{background-color:#1a162d;color:#fff}#rStudioHeader .productName{color:#fff}#rStudioHeader .productName:hover,#rStudioHeader .productName:focus{color:#fdeba4}#rStudioHeader #menu .menuItem.a{background-color:#75aadb;color:#fff}#rStudioHeader #menu .menuItem:hover{background-color:#484557;color:#fff}#rStudioHeader #menu .menuItem.current{background-color:#fff;color:#1a162d;text-decoration:none}#rStudioFooter.band{background-color:#767381}#rStudioFooter .bandContent #copyright{color:#e3eef8}table tbody tr:nth-child(even){background-color:#f7faff}table tbody tr:nth-child(odd){background-color:#fff}.latest{border-top:.5em solid <no value>}.event{-moz-box-shadow:0 0 0 0 rgba(0,0,0,.1);-webkit-box-shadow:0 0 0 0 rgba(0,0,0,.1);box-shadow:0 0 0 0 rgba(0,0,0,.1)}.section .event{background-color:#eab0c41a}.section .event{border-top:7pt solid #a19ea936}.section .event a{color:#1a162d}.section .event{color:#404040}</style><link rel=stylesheet href=/css/tidyverse.css><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Hugo 0.71.1"><title>spatialsample 0.2.0</title><meta property="og:title" content="spatialsample 0.2.0"><meta property="og:description" content="spatialsample 0.2.0 is now on CRAN! This release provides a bunch of new features, including new spatial resampling methods, visualization helpers, and spatial buffering."><meta property="og:type" content="article"><meta property="og:url" content="https://www.tidyverse.org/blog/2022/06/spatialsample-0-2-0/"><meta property="twitter:card" content="summary_large_image"><meta property="og:title" content="spatialsample 0.2.0 - Tidyverse"><meta property="description" content="spatialsample 0.2.0 is now on CRAN! This release provides a bunch of new features, including new spatial resampling methods, visualization helpers, and spatial buffering."><meta property="og:description" content="spatialsample 0.2.0 is now on CRAN! This release provides a bunch of new features, including new spatial resampling methods, visualization helpers, and spatial buffering."><meta property="og:image" content="https://www.tidyverse.org/blog/2022/06/spatialsample-0-2-0/thumbnail-sq.jpg"><meta name=twitter:image content="https://www.tidyverse.org/blog/2022/06/spatialsample-0-2-0/thumbnail-wd.jpg"><link rel=apple-touch-icon sizes=180x180 href=/images/favicons/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/images/favicons/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/images/favicons/favicon-16x16.png><link rel=manifest href=/images/favicons/site.webmanifest><link rel=mask-icon href=/images/favicons/safari-pinned-tab.svg><link rel="shortcut icon" href=/images/favicons/favicon.ico><meta name=msapplication-TileColor content="#da532c"><meta name=msapplication-config href=/images/favicons/browserconfig.xml><script type=text/javascript src=/js/jquery-3.5.1.min.js></script><script type=text/javascript src=/js/site.js></script><link rel=icon href=/images/favicon.ico><script type=text/javascript src=/js/clipboard.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin=anonymous></script><script defer data-domain=tidyverse.org,all.tidyverse.org src=https://plausible.io/js/plausible.js></script></head><body><div id=appTidyverseSite class="shrinkHeader alwaysShrinkHeader"><div id=main><div id=rStudioHeader><nav class=band><div class="innards bandContent"><div><a class=productName href=/>Tidyverse</a></div><div id=menu><div id=menuToggler></div><div id=menuItems><a class=menuItem href=/packages/>Packages</a>
<a class="menuItem current" href=/blog/>Blog</a>
<a class=menuItem href=/learn/>Learn</a>
<a class=menuItem href=/help/>Help</a>
<a class=menuItem href=/contribute/>Contribute</a></div></div></div></nav></div><main><div class="band padForHeader pushFooter"><div class=bandContent><div class="full splitColumns withMobileMargins"><div class=column75><h1 class=article-title>spatialsample 0.2.0</h1><div class=article-header aria-hidden=true><div class=photo><img src=/blog/2022/06/spatialsample-0-2-0/thumbnail-wd.jpg></div><div class=photoCredit>Photo by <a href=https://unsplash.com/photos/1-29wyvvLJA>Andrew Neel</a></div></div><span class=article-date><i class="fas fa-calendar-day fa-fw"></i>&nbsp;&nbsp;2022/06/21</span><p style=margin-bottom:.5em;margin-top:.85em><i class="fas fa-tags"></i>&nbsp;
<a href=/tags/tidymodels/>tidymodels</a>,
<a href=/tags/rsample/>rsample</a>,
<a href=/tags/spatialsample/>spatialsample</a></p><p style=margin-top:.5em><i class="fas fa-user-circle fa-fw"></i>&nbsp;
Mike Mahoney</p><div class=article-content><p>We&rsquo;re positively electrified to announce the release of
<a href=https://spatialsample.tidymodels.org/ target=_blank rel=noopener>spatialsample</a> 0.2.0. spatialsample is a package for spatial resampling, extending the
<a href=https://rsample.tidymodels.org/ target=_blank rel=noopener>rsample</a> framework to help create spatial extrapolation between your analysis and assessment data sets.</p><p>You can install it from CRAN with:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf><a href=https://rdrr.io/r/utils/install.packages.html>install.packages</a></span><span class=o>(</span><span class=s>"spatialsample"</span><span class=o>)</span></code></pre></div><p>This blog post will describe the highlights of what&rsquo;s new. You can see a full list of changes in the
<a href=https://spatialsample.tidymodels.org/news/index.html#spatialsample-020 target=_blank rel=noopener>release notes</a>.</p><h2 id=new-features>New Features
<a href=#new-features><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>This version of spatialsample includes a new data set, made up of 682 hexagons containing data about tree canopy cover change in Boston, Massachusetts:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=kr><a href=https://rdrr.io/r/base/library.html>library</a></span><span class=o>(</span><span class=nv><a href=https://github.com/tidymodels/spatialsample>spatialsample</a></span><span class=o>)</span>
<span class=kr><a href=https://rdrr.io/r/base/library.html>library</a></span><span class=o>(</span><span class=nv><a href=https://ggplot2.tidyverse.org>ggplot2</a></span><span class=o>)</span>

<span class=nf><a href=https://ggplot2.tidyverse.org/reference/ggplot.html>ggplot</a></span><span class=o>(</span><span class=nv>boston_canopy</span><span class=o>)</span> <span class=o>+</span> 
  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/ggsf.html>geom_sf</a></span><span class=o>(</span><span class=o>)</span>
</code></pre><p><img src=figs/unnamed-chunk-2-1.png title="A map showing the spatial arrangement of hexagons making up the boston_canopy data set." alt="A map showing the spatial arrangement of hexagons making up the boston_canopy data set." width=700px style=display:block;margin:auto></p></div><p>This data is stored as an sf object, and as such contains information about the proper coordinate reference system and units of measurement associated with the data.</p><p>This brings us to the first new feature in this release of spatialsample:
<a href=https://spatialsample.tidymodels.org/reference/spatial_clustering_cv.html target=_blank rel=noopener><code>spatial_clustering_cv()</code></a> now supports sf objects, and will calculate distances in a way that respects coordinate reference systems (including using the s2 geometry library for geographic coordinate reference systems):</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf><a href=https://rdrr.io/r/base/Random.html>set.seed</a></span><span class=o>(</span><span class=m>123</span><span class=o>)</span>
<span class=nv>kmeans_clustering</span> <span class=o>&lt;-</span> <span class=nf><a href=https://spatialsample.tidymodels.org/reference/spatial_clustering_cv.html>spatial_clustering_cv</a></span><span class=o>(</span><span class=nv>boston_canopy</span>, v <span class=o>=</span> <span class=m>5</span><span class=o>)</span>
<span class=nv>kmeans_clustering</span>
<span class=c>#&gt; #  5-fold spatial cross-validation </span>
<span class=c>#&gt; <span style=color:#555># A tibble: 5 Ã— 2</span></span>
<span class=c>#&gt;   splits            id   </span>
<span class=c>#&gt;   <span style=color:#555;font-style:italic>&lt;list&gt;</span>            <span style=color:#555;font-style:italic>&lt;chr&gt;</span></span>
<span class=c>#&gt; <span style=color:#555>1</span> <span style=color:#555>&lt;split [524/158]&gt;</span> Fold1</span>
<span class=c>#&gt; <span style=color:#555>2</span> <span style=color:#555>&lt;split [493/189]&gt;</span> Fold2</span>
<span class=c>#&gt; <span style=color:#555>3</span> <span style=color:#555>&lt;split [517/165]&gt;</span> Fold3</span>
<span class=c>#&gt; <span style=color:#555>4</span> <span style=color:#555>&lt;split [605/77]&gt;</span>  Fold4</span>
<span class=c>#&gt; <span style=color:#555>5</span> <span style=color:#555>&lt;split [589/93]&gt;</span>  Fold5</span></code></pre></div><p>This release also provides
<a href=https://ggplot2.tidyverse.org/reference/autoplot.html target=_blank rel=noopener><code>autoplot()</code></a> methods to visualize resamples via ggplot2, making it easy to see how exactly your data is being divided. Just call
<a href=https://ggplot2.tidyverse.org/reference/autoplot.html target=_blank rel=noopener><code>autoplot()</code></a> on the outputs from any spatial clustering function:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf><a href=https://ggplot2.tidyverse.org/reference/autoplot.html>autoplot</a></span><span class=o>(</span><span class=nv>kmeans_clustering</span><span class=o>)</span> <span class=o>+</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/labs.html>labs</a></span><span class=o>(</span>title <span class=o>=</span> <span class=s>"kmeans()"</span><span class=o>)</span>
</code></pre><p><img src=figs/unnamed-chunk-4-1.png title="A map showing the boston_canopy data set broken into five folds through spatial_clustering_cv. The five folds are visibly different sizes, and are grouped by spatial proximity." alt="A map showing the boston_canopy data set broken into five folds through spatial_clustering_cv. The five folds are visibly different sizes, and are grouped by spatial proximity." width=700px style=display:block;margin:auto></p></div><p>In addition to supporting more types of data,
<a href=https://spatialsample.tidymodels.org/reference/spatial_clustering_cv.html target=_blank rel=noopener><code>spatial_clustering_cv()</code></a> has also been extended to support more types of clustering. Set the <code>cluster_function</code> argument to use <code>"hclust"</code> for hierarchical clustering via
<a href=https://rdrr.io/r/stats/hclust.html target=_blank rel=noopener><code>hclust()</code></a> instead of the default
<a href=https://rdrr.io/r/stats/kmeans.html target=_blank rel=noopener><code>kmeans()</code></a>-based clusters:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf><a href=https://rdrr.io/r/base/Random.html>set.seed</a></span><span class=o>(</span><span class=m>123</span><span class=o>)</span>
<span class=nf><a href=https://spatialsample.tidymodels.org/reference/spatial_clustering_cv.html>spatial_clustering_cv</a></span><span class=o>(</span>
  <span class=nv>boston_canopy</span>, 
  v <span class=o>=</span> <span class=m>5</span>, 
  cluster_function <span class=o>=</span> <span class=s>"hclust"</span>
<span class=o>)</span> |&gt; 
  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/autoplot.html>autoplot</a></span><span class=o>(</span><span class=o>)</span> <span class=o>+</span> 
  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/labs.html>labs</a></span><span class=o>(</span>title <span class=o>=</span> <span class=s>"hclust()"</span><span class=o>)</span>
</code></pre><p><img src=figs/unnamed-chunk-5-1.png title="A map showing the boston_canopy data set broken into five folds through spatial_clustering_cv, using the hclust clustering method. The five folds are still visibly different sizes, and are grouped by spatial proximity, but the clusters are notably different from those produced by the default kmeans method." alt="A map showing the boston_canopy data set broken into five folds through spatial_clustering_cv, using the hclust clustering method. The five folds are still visibly different sizes, and are grouped by spatial proximity, but the clusters are notably different from those produced by the default kmeans method." width=700px style=display:block;margin:auto></p></div><p>This argument can also accept functions, letting you plug in clustering methodologies from other packages or that you&rsquo;ve written yourself:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf><a href=https://rdrr.io/r/base/Random.html>set.seed</a></span><span class=o>(</span><span class=m>123</span><span class=o>)</span>

<span class=nv>custom_clusters</span> <span class=o>&lt;-</span> <span class=kr>function</span><span class=o>(</span><span class=nv>dists</span>, <span class=nv>v</span>, <span class=nv>...</span><span class=o>)</span> <span class=o>&#123;</span>
  <span class=nf><a href=https://rdrr.io/r/base/rep.html>rep</a></span><span class=o>(</span><span class=nv>letters</span><span class=o>[</span><span class=m>1</span><span class=o>:</span><span class=nv>v</span><span class=o>]</span>, length.out <span class=o>=</span> <span class=nf><a href=https://rdrr.io/r/base/nrow.html>nrow</a></span><span class=o>(</span><span class=nv>boston_canopy</span><span class=o>)</span><span class=o>)</span>
<span class=o>&#125;</span>

<span class=nf><a href=https://spatialsample.tidymodels.org/reference/spatial_clustering_cv.html>spatial_clustering_cv</a></span><span class=o>(</span>
  <span class=nv>boston_canopy</span>, 
  v <span class=o>=</span> <span class=m>5</span>, 
  cluster_function <span class=o>=</span> <span class=nv>custom_clusters</span>
<span class=o>)</span> |&gt; 
  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/autoplot.html>autoplot</a></span><span class=o>(</span><span class=o>)</span> <span class=o>+</span> 
  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/labs.html>labs</a></span><span class=o>(</span>title <span class=o>=</span> <span class=s>"custom_clusters()"</span><span class=o>)</span>
</code></pre><p><img src=figs/unnamed-chunk-6-1.png title="A map showing the outputs of spatial_clustering_cv when using a custom clustering function. The custom clustering function assigned folds systematically, moving sequentially through rows in the data frame, and as such the output does not look very clustered. However, the functions in spatialsample performed exactly the same with the custom clustering function as they did with the built-in options." alt="A map showing the outputs of spatial_clustering_cv when using a custom clustering function. The custom clustering function assigned folds systematically, moving sequentially through rows in the data frame, and as such the output does not look very clustered. However, the functions in spatialsample performed exactly the same with the custom clustering function as they did with the built-in options." width=700px style=display:block;margin:auto></p></div><p>In addition to the clustering extensions, this version of spatialsample introduces new functions for other popular spatial resampling methods. For instance,
<a href=https://spatialsample.tidymodels.org/reference/spatial_block_cv.html target=_blank rel=noopener><code>spatial_block_cv()</code></a> helps you perform
<a href=https://doi.org/10.1111/ecog.02881 target=_blank rel=noopener>block cross-validation</a>, splitting your data into folds based on a grid of regular polygons. You can assign these polygons to folds at random:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf><a href=https://rdrr.io/r/base/Random.html>set.seed</a></span><span class=o>(</span><span class=m>123</span><span class=o>)</span>
<span class=nf><a href=https://spatialsample.tidymodels.org/reference/spatial_block_cv.html>spatial_block_cv</a></span><span class=o>(</span><span class=nv>boston_canopy</span>, v <span class=o>=</span> <span class=m>5</span><span class=o>)</span> |&gt; 
  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/autoplot.html>autoplot</a></span><span class=o>(</span><span class=o>)</span>
</code></pre><p><img src=figs/unnamed-chunk-7-1.png title="A map showing the outputs of block cross-validation performed using spatial_block_cv. A regular grid of squares has been drawn over the boston_canopy data set, and all data falling into a single block is assigned to the same fold. Blocks are assigned to folds at random, resulting in a patchy distribution of folds across the data set." alt="A map showing the outputs of block cross-validation performed using spatial_block_cv. A regular grid of squares has been drawn over the boston_canopy data set, and all data falling into a single block is assigned to the same fold. Blocks are assigned to folds at random, resulting in a patchy distribution of folds across the data set." width=700px style=display:block;margin:auto></p></div><p>Or systematically, either by assigning folds in order from the bottom-left and proceeding from left to right along each row by setting <code>method = "continuous"</code>:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf><a href=https://spatialsample.tidymodels.org/reference/spatial_block_cv.html>spatial_block_cv</a></span><span class=o>(</span><span class=nv>boston_canopy</span>, v <span class=o>=</span> <span class=m>5</span>, method <span class=o>=</span> <span class=s>"continuous"</span><span class=o>)</span> |&gt; 
  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/autoplot.html>autoplot</a></span><span class=o>(</span><span class=o>)</span>
</code></pre><p><img src=figs/unnamed-chunk-8-1.png title="A map showing the outputs of block cross-validation performed using spatial_block_cv with continuous systematic assignment. Rather than the patchy random assignment before, blocks are now assigned from left to right for each row of the regular grid, resulting in the same folds always being adjacent to one another." alt="A map showing the outputs of block cross-validation performed using spatial_block_cv with continuous systematic assignment. Rather than the patchy random assignment before, blocks are now assigned from left to right for each row of the regular grid, resulting in the same folds always being adjacent to one another." width=700px style=display:block;margin:auto></p></div><p>Or by &ldquo;snaking&rdquo; back and forth up the grid by setting <code>method = "snake"</code>:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf><a href=https://spatialsample.tidymodels.org/reference/spatial_block_cv.html>spatial_block_cv</a></span><span class=o>(</span><span class=nv>boston_canopy</span>, v <span class=o>=</span> <span class=m>5</span>, method <span class=o>=</span> <span class=s>"snake"</span><span class=o>)</span> |&gt; 
  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/autoplot.html>autoplot</a></span><span class=o>(</span><span class=o>)</span>
</code></pre><p><img src=figs/unnamed-chunk-9-1.png title="A map showing the outputs of block cross-validation performed using spatial_block_cv with snaking systematic assignment. Blocks are now assigned alternatively from left to right and right to left, resulting in a similar alignment of folds to the continuous method." alt="A map showing the outputs of block cross-validation performed using spatial_block_cv with snaking systematic assignment. Blocks are now assigned alternatively from left to right and right to left, resulting in a similar alignment of folds to the continuous method." width=700px style=display:block;margin:auto></p></div><p>This release of spatialsample also adds support for
<a href=https://doi.org/10.1111/geb.12161 target=_blank rel=noopener>leave-location-out cross-validation</a> through the new function
<a href=https://spatialsample.tidymodels.org/reference/spatial_vfold.html target=_blank rel=noopener><code>spatial_leave_location_out_cv()</code></a>. You can use this to create resamples when you already have a good idea of what data might be spatially correlated together &ndash; for instance, we can use it to split the Ames housing data from modeldata by neighborhood:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf><a href=https://rdrr.io/r/utils/data.html>data</a></span><span class=o>(</span><span class=nv>ames</span>, package <span class=o>=</span> <span class=s>"modeldata"</span><span class=o>)</span>

<span class=nv>ames_sf</span> <span class=o>&lt;-</span> <span class=nf>sf</span><span class=nf>::</span><span class=nf><a href=https://r-spatial.github.io/sf/reference/st_as_sf.html>st_as_sf</a></span><span class=o>(</span><span class=nv>ames</span>, coords <span class=o>=</span> <span class=nf><a href=https://rdrr.io/r/base/c.html>c</a></span><span class=o>(</span><span class=s>"Longitude"</span>, <span class=s>"Latitude"</span><span class=o>)</span>, crs <span class=o>=</span> <span class=m>4326</span><span class=o>)</span>

<span class=nf><a href=https://rdrr.io/r/base/Random.html>set.seed</a></span><span class=o>(</span><span class=m>123</span><span class=o>)</span>
<span class=nf><a href=https://spatialsample.tidymodels.org/reference/spatial_vfold.html>spatial_leave_location_out_cv</a></span><span class=o>(</span><span class=nv>ames_sf</span>, <span class=nv>Neighborhood</span><span class=o>)</span> |&gt; 
  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/autoplot.html>autoplot</a></span><span class=o>(</span><span class=o>)</span>
</code></pre><p><img src=figs/unnamed-chunk-10-1.png title="A map showing the outputs of leave-location-out cross-validation performed using spatial_leave_location_out_cv on the Ames housing data. Folds are assigned based on what neighborhood each house falls into. Some neighborhoods are entirely contained within another neighborhood, and neighborhoods contain very different numbers of houses." alt="A map showing the outputs of leave-location-out cross-validation performed using spatial_leave_location_out_cv on the Ames housing data. Folds are assigned based on what neighborhood each house falls into. Some neighborhoods are entirely contained within another neighborhood, and neighborhoods contain very different numbers of houses." width=700px style=display:block;margin:auto></p></div><h2 id=buffering>Buffering
<a href=#buffering><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>The last major feature in this release is the introduction of spatial buffering. Spatial buffering enforces a certain minimum distance between your analysis and assessment sets, making sure that you&rsquo;re spatially extrapolating when making predictions with a model.</p><p>While all spatial resampling functions in spatialsample can use spatial buffers, particularly interesting is the new
<a href=https://spatialsample.tidymodels.org/reference/spatial_vfold.html target=_blank rel=noopener><code>spatial_buffer_vfold_cv()</code></a> function. This function makes it easy to add spatial buffers around a standard V-fold cross-validation procedure. When we plot the object returned by this function, it just looks like a standard V-fold cross-validation setup:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf><a href=https://rdrr.io/r/base/Random.html>set.seed</a></span><span class=o>(</span><span class=m>123</span><span class=o>)</span>
<span class=nv>blocks</span> <span class=o>&lt;-</span> <span class=nf><a href=https://spatialsample.tidymodels.org/reference/spatial_vfold.html>spatial_buffer_vfold_cv</a></span><span class=o>(</span>
  <span class=nv>boston_canopy</span>, 
  v <span class=o>=</span> <span class=m>15</span>,
  buffer <span class=o>=</span> <span class=m>100</span>,
  radius <span class=o>=</span> <span class=kc>NULL</span>
<span class=o>)</span>

<span class=nf><a href=https://ggplot2.tidyverse.org/reference/autoplot.html>autoplot</a></span><span class=o>(</span><span class=nv>blocks</span><span class=o>)</span>
</code></pre><p><img src=figs/unnamed-chunk-11-1.png title="A map showing the outputs of spatially buffered cross-validation performed using spatial_buffer_vfold_cv, once again using the boston_canopy data set. When visualizing all folds at once, there does not seem to be any spatial structure to the resamples; folds are distributed randomly throughout the data set, and folds abut one another without any spatial separation." alt="A map showing the outputs of spatially buffered cross-validation performed using spatial_buffer_vfold_cv, once again using the boston_canopy data set. When visualizing all folds at once, there does not seem to be any spatial structure to the resamples; folds are distributed randomly throughout the data set, and folds abut one another without any spatial separation." width=700px style=display:block;margin:auto></p></div><p>However, if we use
<a href=https://ggplot2.tidyverse.org/reference/autoplot.html target=_blank rel=noopener><code>autoplot()</code></a> to visualize the splits themselves, we can see that we&rsquo;ve created an exclusion buffer around each of our assessment sets. Data inside this buffer is assigned to neither the assessment or analysis set, so you can be sure your data is spatially separated:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nv>blocks</span><span class=o>$</span><span class=nv>splits</span> |&gt; 
  <span class=nf>purrr</span><span class=nf>::</span><span class=nf><a href=https://purrr.tidyverse.org/reference/map.html>walk</a></span><span class=o>(</span><span class=kr>function</span><span class=o>(</span><span class=nv>x</span><span class=o>)</span> <span class=nf><a href=https://rdrr.io/r/base/print.html>print</a></span><span class=o>(</span><span class=nf><a href=https://ggplot2.tidyverse.org/reference/autoplot.html>autoplot</a></span><span class=o>(</span><span class=nv>x</span><span class=o>)</span><span class=o>)</span><span class=o>)</span>
</code></pre><p><img src=figs/unnamed-chunk-12-.gif title="An animation showing maps of each individual fold produced using spatial_buffer_vfold_cv. Now it is evident that any data adjacent to the assessment data has been added to a 'buffer' zone, and is part of neither the analysis or the assessment set." alt="An animation showing maps of each individual fold produced using spatial_buffer_vfold_cv. Now it is evident that any data adjacent to the assessment data has been added to a 'buffer' zone, and is part of neither the analysis or the assessment set." width=700px style=display:block;margin:auto></p></div><p>In addition to exclusion buffers, spatialsample now lets you add inclusion radii to any spatial resampling. This will add any points within a certain distance of the original assessment set to the assessment set, letting you create clumped &ldquo;discs&rdquo; of data to assess your models against:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf><a href=https://rdrr.io/r/base/Random.html>set.seed</a></span><span class=o>(</span><span class=m>123</span><span class=o>)</span>
<span class=nv>blocks</span> <span class=o>&lt;-</span> <span class=nf><a href=https://spatialsample.tidymodels.org/reference/spatial_vfold.html>spatial_buffer_vfold_cv</a></span><span class=o>(</span>
  <span class=nv>boston_canopy</span>, 
  v <span class=o>=</span> <span class=m>20</span>,
  buffer <span class=o>=</span> <span class=m>100</span>,
  radius <span class=o>=</span> <span class=m>100</span>
<span class=o>)</span>

<span class=nv>blocks</span><span class=o>$</span><span class=nv>splits</span> |&gt; 
  <span class=nf>purrr</span><span class=nf>::</span><span class=nf><a href=https://purrr.tidyverse.org/reference/map.html>walk</a></span><span class=o>(</span><span class=kr>function</span><span class=o>(</span><span class=nv>x</span><span class=o>)</span> <span class=nf><a href=https://rdrr.io/r/base/print.html>print</a></span><span class=o>(</span><span class=nf><a href=https://ggplot2.tidyverse.org/reference/autoplot.html>autoplot</a></span><span class=o>(</span><span class=nv>x</span><span class=o>)</span><span class=o>)</span><span class=o>)</span>
</code></pre><p><img src=figs/unnamed-chunk-13-.gif title="Another animation showing maps of each individual fold produced using spatial_buffer_vfold_cv. When using the argument radius, points adjacent to the assessment set are themselves added to the assessment set. The buffer is then applied to each data point in the enlarged assessment set." alt="Another animation showing maps of each individual fold produced using spatial_buffer_vfold_cv. When using the argument radius, points adjacent to the assessment set are themselves added to the assessment set. The buffer is then applied to each data point in the enlarged assessment set." width=700px style=display:block;margin:auto></p></div><h2 id=and-more>&mldr;and more!
<a href=#and-more><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>This is just scratching the surface of the new features and improvements in this release of spatialsample. You can see a full list of changes in the the
<a href=https://spatialsample.tidymodels.org/news/index.html#spatialsample-020 target=_blank rel=noopener>release notes</a>.</p><h2 id=acknowledgments>Acknowledgments
<a href=#acknowledgments><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>We&rsquo;d like to thank everyone that has contributed since the last release:
<a href=https://github.com/jennybc target=_blank rel=noopener>@jennybc</a>,
<a href=https://github.com/juliasilge target=_blank rel=noopener>@juliasilge</a>,
<a href=https://github.com/mikemahoney218 target=_blank rel=noopener>@mikemahoney218</a>,
<a href=https://github.com/MxNl target=_blank rel=noopener>@MxNl</a>,
<a href=https://github.com/nipnipj target=_blank rel=noopener>@nipnipj</a>, and
<a href=https://github.com/PathosEthosLogos target=_blank rel=noopener>@PathosEthosLogos</a>.</p></div></div><div class=column25><div class="section hideOnMobile"><div class=sectionTitle>Contents</div><nav id=TableOfContents><ul><li><a href=#new-features>New Features</a></li><li><a href=#buffering>Buffering</a></li><li><a href=#and-more>&mldr;and more!</a></li><li><a href=#acknowledgments>Acknowledgments</a></li></ul></nav></div><div class=section></div></div></div></div></div><div id=rStudioFooter class=band><div class=bandContent><div id=copyright>The tidyverse is proudly supported by <a class=rstudioLogo href=https://posit.co/ aria-label="Posit Homepage"></a></div><div id=logos><a href=https://www.tidyverse.org/google_privacy_policy>Privacy policy</a>
<a href=https://github.com/tidyverse class="footerLogo gitHub" aria-label="Tidyverse GitHub organization"></a><a href=https://twitter.com/hashtag/rstats class="footerLogo twitter" aria-label="rstats hashtag on twitter.com"></a></div></div></div></div></div><script src=/js/math-code.js></script><script type=text/x-mathjax-config>
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    processEscapes: true
  }
});
</script><script async src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><script type=application/javascript>var dnt=(navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack);var doNotTrack=(dnt=="1"||dnt=="yes");if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');if(window.sessionStorage){var GA_SESSION_STORAGE_KEY='ga:clientId';ga('create','UA-115082821-1',{'storage':'none','clientId':sessionStorage.getItem(GA_SESSION_STORAGE_KEY)});ga(function(tracker){sessionStorage.setItem(GA_SESSION_STORAGE_KEY,tracker.get('clientId'));});}
ga('set','anonymizeIp',true);ga('send','pageview');}</script></body></html></div></div></body></html>