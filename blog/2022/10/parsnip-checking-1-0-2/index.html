<!doctype html><html><head><!doctype html><html lang=en-us><link rel=stylesheet href=/css/fonts.css><link rel=stylesheet href=/css/main-site.css><link rel=stylesheet href=/css/fa5-all.css><style type=text/css>body{background-color:#fff;color:#1a1917}a{color:#38577f}a:hover{color:#42709b}a:focus{outline-color:#42709b}.column25-left .sectionTitle a:hover:not(.current),.column16-left .sectionTitle a:hover:not(.current){color:#1a1917}.icon-attribution,.icon-attribution a{color:#1a1917;opacity:75%}#homeContent .band.first{background-color:#fff}#homeContent .band.second{background-color:#fdeba4}#homeContent .band.third{background-color:#fff}#rStudioHeader{background-color:#1a162d;color:#fff}#rStudioHeader .productName{color:#fff}#rStudioHeader .productName:hover,#rStudioHeader .productName:focus{color:#fdeba4}#rStudioHeader #menu .menuItem.a{background-color:#75aadb;color:#fff}#rStudioHeader #menu .menuItem:hover{background-color:#484557;color:#fff}#rStudioHeader #menu .menuItem.current{background-color:#fff;color:#1a162d;text-decoration:none}#rStudioFooter.band{background-color:#767381}#rStudioFooter .bandContent #copyright{color:#e3eef8}table tbody tr:nth-child(even){background-color:#f7faff}table tbody tr:nth-child(odd){background-color:#fff}.latest{border-top:.5em solid <no value>}.event{-moz-box-shadow:0 0 0 0 rgba(0,0,0,.1);-webkit-box-shadow:0 0 0 0 rgba(0,0,0,.1);box-shadow:0 0 0 0 rgba(0,0,0,.1)}.section .event{background-color:#eab0c41a}.section .event{border-top:7pt solid #a19ea936}.section .event a{color:#1a162d}.section .event{color:#404040}</style><link rel=stylesheet href=/css/tidyverse.css><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Hugo 0.71.1"><title>Improvements to model specification checking in tidymodels</title><meta property="og:title" content="Improvements to model specification checking in tidymodels"><meta property="og:description" content="parsnip 1.0.2 includes a number of changes to how the package checks model specifications, improving error messages and tightening integration with its extension packages."><meta property="og:type" content="article"><meta property="og:url" content="https://www.tidyverse.org/blog/2022/10/parsnip-checking-1-0-2/"><meta property="twitter:card" content="summary_large_image"><meta property="og:title" content="Improvements to model specification checking in tidymodels - Tidyverse"><meta property="description" content="parsnip 1.0.2 includes a number of changes to how the package checks model specifications, improving error messages and tightening integration with its extension packages."><meta property="og:description" content="parsnip 1.0.2 includes a number of changes to how the package checks model specifications, improving error messages and tightening integration with its extension packages."><meta property="og:image" content="https://www.tidyverse.org/blog/2022/10/parsnip-checking-1-0-2/thumbnail-sq.jpg"><meta name=twitter:image content="https://www.tidyverse.org/blog/2022/10/parsnip-checking-1-0-2/thumbnail-wd.jpg"><link rel=apple-touch-icon sizes=180x180 href=/images/favicons/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/images/favicons/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/images/favicons/favicon-16x16.png><link rel=manifest href=/images/favicons/site.webmanifest><link rel=mask-icon href=/images/favicons/safari-pinned-tab.svg><link rel="shortcut icon" href=/images/favicons/favicon.ico><meta name=msapplication-TileColor content="#da532c"><meta name=msapplication-config href=/images/favicons/browserconfig.xml><script type=text/javascript src=/js/jquery-3.5.1.min.js></script><script type=text/javascript src=/js/site.js></script><link rel=icon href=/images/favicon.ico><script type=text/javascript src=/js/clipboard.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin=anonymous></script><script defer data-domain=tidyverse.org,all.tidyverse.org src=https://plausible.io/js/plausible.js></script></head><body><div id=appTidyverseSite class="shrinkHeader alwaysShrinkHeader"><div id=main><div id=rStudioHeader><nav class=band><div class="innards bandContent"><div><a class=productName href=/%20/>Tidyverse</a></div><div id=menu><div id=menuToggler></div><div id=menuItems><a class=menuItem href=/packages/>Packages</a>
<a class="menuItem current" href=/blog/>Blog</a>
<a class=menuItem href=/learn/>Learn</a>
<a class=menuItem href=/help/>Help</a>
<a class=menuItem href=/contribute/>Contribute</a></div></div></div></nav></div><main><div class="band padForHeader pushFooter"><div class=bandContent><div class="full splitColumns withMobileMargins"><div class=column75><h1 class=article-title>Improvements to model specification checking in tidymodels</h1><div class=article-header aria-hidden=true><div class=photo><img src=/blog/2022/10/parsnip-checking-1-0-2/thumbnail-wd.jpg></div><div class=photoCredit>Photo by <a href=https://unsplash.com/photos/ry2JvVpR8Ro>Wayne Hollman</a></div></div><span class=article-date><i class="fas fa-calendar-day fa-fw"></i>&nbsp;&nbsp;2022/10/03</span><p style=margin-bottom:.5em;margin-top:.85em><i class="fas fa-tags"></i>&nbsp;
<a href=/tags/tidymodels/>tidymodels</a>,
<a href=/tags/parsnip/>parsnip</a></p><p style=margin-top:.5em><i class="fas fa-user-circle fa-fw"></i>&nbsp;
Simon Couch</p><div class=article-content><p>We&rsquo;re stoked to announce the new release of
<a href=https://parsnip.tidymodels.org/ target=_blank rel=noopener>parsnip</a> v1.0.2 on CRAN! parsnip provides a tidy, unified interface to various statistical and machine learning models. This release includes improvements to errors and warnings that proliferate throughout the tidymodels ecosystem. These changes are meant to better anticipate common mistakes and nudge users informatively when defining model specifications. parsnip v1.0.2 includes a number of other changes that you can read about in the
<a href=https://parsnip.tidymodels.org/news/index.html#parsnip-102 target=_blank rel=noopener>release notes</a>.</p><h2 id=parsnip-and-its-extension-packages>parsnip and its extension packages
<a href=#parsnip-and-its-extension-packages><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>We&rsquo;ll load parsnip, along with other core packages in tidymodels, using the tidymodels meta-package:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf>library</span><span class=p>(</span><span class=n>tidymodels</span><span class=p>)</span>
</code></pre></div><p>parsnip provides a unified interface to machine learning models, supporting a wide array of modeling approaches implemented across numerous R packages. For instance, the code to specify a linear regression model using the <code>glmnet</code> package:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf>linear_reg</span><span class=p>()</span> <span class=o>%&gt;%</span>
  <span class=nf>set_engine</span><span class=p>(</span><span class=s>&#34;glmnet&#34;</span><span class=p>)</span> <span class=o>%&gt;%</span>
  <span class=nf>set_mode</span><span class=p>(</span><span class=s>&#34;regression&#34;</span><span class=p>)</span>
<span class=c1>#&gt; Linear Regression Model Specification (regression)</span>
<span class=c1>#&gt; </span>
<span class=c1>#&gt; Computational engine: glmnet</span>
</code></pre></div><p>&mldr;is quite similar to that needed to specify a boosted tree regression model using <code>xgboost</code>:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf>boost_tree</span><span class=p>()</span> <span class=o>%&gt;%</span>
  <span class=nf>set_engine</span><span class=p>(</span><span class=s>&#34;xgboost&#34;</span><span class=p>)</span> <span class=o>%&gt;%</span>
  <span class=nf>set_mode</span><span class=p>(</span><span class=s>&#34;regression&#34;</span><span class=p>)</span>
<span class=c1>#&gt; Boosted Tree Model Specification (regression)</span>
<span class=c1>#&gt; </span>
<span class=c1>#&gt; Computational engine: xgboost</span>
</code></pre></div><p>We refer to these objects as <em>model specifications</em>. They have three main components:</p><ul><li>The <strong>model type</strong>: In this case, a linear regression or boosted tree.</li><li>The <strong>mode</strong>: The learning task, such as regression or classification.</li><li>The <strong>engine</strong>: The implementation for the given model type and mode, usually an R package.</li></ul><p>This conceptual split of the model specification allows for parsnip&rsquo;s consistent syntax - and it makes it extensible. Anyone (including you!) can write a parsnip <em>extension package</em> that tightly integrates with other tidymodels packages out-of-the-box. We maintain a few of these packages ourselves, such as:</p><ul><li><a href=https://github.com/tidymodels/agua target=_blank rel=noopener>agua</a>: models from the H2O modeling ecosystem</li><li><a href=https://github.com/tidymodels/baguette target=_blank rel=noopener>baguette</a>: bootstrap aggregating ensemble models</li><li><a href=https://github.com/tidymodels/censored target=_blank rel=noopener>censored</a>: censored regression and survival analysis</li></ul><p>Similarly, community members outside of the tidymodels team have written parsnip extension packages, such as:</p><ul><li><a href=https://github.com/business-science/modeltime target=_blank rel=noopener>modeltime</a>: time series forecasting</li><li><a href=https://github.com/hsbadr/additive target=_blank rel=noopener>additive</a>: generalized additive models</li></ul><p>Much of our work on improving errors and warnings in this release has focused on parsnip&rsquo;s integration with its extensions.</p><h2 id=improvements-to-errors-and-warnings>Improvements to errors and warnings
<a href=#improvements-to-errors-and-warnings><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Two &ldquo;big ideas&rdquo; have helped us focus our efforts related to improving errors and messages in the ecosystem.</p><ul><li>The same kind of mistake should raise the same prompt.</li><li>Don&rsquo;t tell the user they did something they didn&rsquo;t do.</li></ul><p>We&rsquo;ll address both in the sections below!</p><h3 id=the-same-kind-of-mistake-should-raise-the-same-prompt>The same kind of mistake should raise the same prompt
<a href=#the-same-kind-of-mistake-should-raise-the-same-prompt><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>The first problem we sought to address with these changes is that, in some cases, the same conceptual mistake could lead to different kinds of errors from parsnip and the packages that depend on it.</p><p>A common mistake that users (and we, as developers) make when defining model specifications is forgetting to load the needed extension package for a given model specification.</p><p>For example, parsnip supports bagged decision tree models via the <code>bag_tree()</code> model type, though requires extension packages for actual implementations of the model. The censored package implements the <code>censored regression</code> mode for bagged decision trees via <code>rpart</code>, and the baguette package implements a few additional engines for <code>regression</code> and <code>classification</code> with this model type.</p><p>In parsnip v1.0.1, if we specified a <code>bag_tree()</code> model without loading any extension packages, we&rsquo;d see:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=n>bt</span> <span class=o>&lt;-</span>
  <span class=nf>bag_tree</span><span class=p>()</span> <span class=o>%&gt;%</span>
  <span class=nf>set_engine</span><span class=p>(</span><span class=s>&#34;rpart&#34;</span><span class=p>)</span>
  
<span class=n>bt</span>
<span class=c1>#&gt; parsnip could not locate an implementation for `bag_tree` model specifications</span>
<span class=c1>#&gt; using the `rpart` engine.</span>
<span class=c1>#&gt;</span>
<span class=c1>#&gt; Bagged Decision Tree Model Specification (unknown)</span>
<span class=c1>#&gt; </span>
<span class=c1>#&gt; Main Arguments:</span>
<span class=c1>#&gt;   cost_complexity = 0</span>
<span class=c1>#&gt;   min_n = 2</span>
<span class=c1>#&gt; </span>
<span class=c1>#&gt; Computational engine: rpart</span>
</code></pre></div><p>After seeing this prompt, we may not remember which extension package was the one that implemented this specification. A reasonable guess might be the censored package:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf>library</span><span class=p>(</span><span class=n>censored</span><span class=p>)</span>
<span class=c1>#&gt; Loading required package: survival</span>
</code></pre></div><p>Then, trying again:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf>bag_tree</span><span class=p>()</span> <span class=o>%&gt;%</span>
  <span class=nf>set_engine</span><span class=p>(</span><span class=s>&#34;rpart&#34;</span><span class=p>)</span> <span class=o>%&gt;%</span>
  <span class=nf>set_mode</span><span class=p>(</span><span class=s>&#34;regression&#34;</span><span class=p>)</span>
<span class=c1>#&gt; Error in `stop_incompatible_mode()`:</span>
<span class=c1>#&gt; ! Available modes for engine rpart are: &#39;unknown&#39;, &#39;censored regression&#39;</span>
</code></pre></div><p>The censored package clearly wasn&rsquo;t the right one to load. Strangely, though, a side effect of loading it was that the prompt then became more cryptic, and it was converted from a message to an error. Perhaps even more strangely, if we instead supply an engine that only has an implementation in baguette and not censored, we see a different error:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf>bag_tree</span><span class=p>()</span> <span class=o>%&gt;%</span>
  <span class=nf>set_engine</span><span class=p>(</span><span class=s>&#34;C5.0&#34;</span><span class=p>)</span>
<span class=c1>#&gt; Error in `check_spec_mode_engine_val()`:</span>
<span class=c1>#&gt; ! Engine &#39;C5.0&#39; is not supported for `bag_tree()`. See `show_engines(&#39;bag_tree&#39;)`.</span>
</code></pre></div><p>Not only is this error different from the one above, but it seems to suggest that there is literally no <code>C5.0</code> implementation anywhere.</p><p>Returning to our <code>bt</code> object, suppose we moved forward with defining tuning parameters, and want to define the grid to optimize over:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=n>bt</span> <span class=o>&lt;-</span> 
  <span class=n>bt</span> <span class=o>%&gt;%</span>
  <span class=nf>update</span><span class=p>(</span><span class=n>cost_complexity</span> <span class=o>=</span> <span class=nf>tune</span><span class=p>())</span>

<span class=nf>extract_parameter_set_dials</span><span class=p>(</span><span class=n>bt</span><span class=p>)</span> <span class=o>%&gt;%</span>
  <span class=nf>grid_random</span><span class=p>(</span><span class=n>size</span> <span class=o>=</span> <span class=m>3</span><span class=p>)</span>
<span class=c1>#&gt; Error in `grid_random()`:</span>
<span class=c1>#&gt; ! At least one parameter object is required.</span>
</code></pre></div><p>So far in this section, we&rsquo;ve made the same mistake&mdash;failing to load the needed parsnip extension package&mdash;four times, and received four different prompts.</p><p>The good news is that, in each of the above cases, the newest version of parsnip always supplies a message, <em>and</em> it&rsquo;s the same kind of message, <em>and</em> it&rsquo;s much more helpful.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf>library</span><span class=p>(</span><span class=n>parsnip</span><span class=p>)</span>

<span class=nf>bag_tree</span><span class=p>()</span> <span class=o>%&gt;%</span>
  <span class=nf>set_engine</span><span class=p>(</span><span class=s>&#34;rpart&#34;</span><span class=p>)</span>
<span class=c1>#&gt; ! parsnip could not locate an implementation for `bag_tree` model</span>
<span class=c1>#&gt;   specifications using the `rpart` engine.</span>
<span class=c1>#&gt; ℹ The parsnip extension packages censored and baguette implement support for</span>
<span class=c1>#&gt;   this specification.</span>
<span class=c1>#&gt; ℹ Please install (if needed) and load to continue.</span>
<span class=c1>#&gt; </span>
<span class=c1>#&gt; Bagged Decision Tree Model Specification (unknown mode)</span>
<span class=c1>#&gt; </span>
<span class=c1>#&gt; Main Arguments:</span>
<span class=c1>#&gt;   cost_complexity = 0</span>
<span class=c1>#&gt;   min_n = 2</span>
<span class=c1>#&gt; </span>
<span class=c1>#&gt; Computational engine: rpart</span>
</code></pre></div><p>Note how the above message now suggests the two possible parsnip extensions that could provide support for this model specification.</p><p>We could load censored, and then this specification is possible; censored implements a <code>censored regression</code> mode for bagged trees:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf>library</span><span class=p>(</span><span class=n>censored</span><span class=p>)</span>
<span class=c1>#&gt; Loading required package: survival</span>

<span class=nf>bag_tree</span><span class=p>()</span> <span class=o>%&gt;%</span>
  <span class=nf>set_engine</span><span class=p>(</span><span class=s>&#34;rpart&#34;</span><span class=p>)</span>
<span class=c1>#&gt; Bagged Decision Tree Model Specification (unknown mode)</span>
<span class=c1>#&gt; </span>
<span class=c1>#&gt; Main Arguments:</span>
<span class=c1>#&gt;   cost_complexity = 0</span>
<span class=c1>#&gt;   min_n = 2</span>
<span class=c1>#&gt; </span>
<span class=c1>#&gt; Computational engine: rpart</span>
</code></pre></div><p>The censored package, however, doesn&rsquo;t implement a <code>regression</code> mode for bagged trees. Thus, if we set the mode to <code>regression</code> but fail to load the package that provides support for that mode, parsnip will again prompt us to load the correct package:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf>bag_tree</span><span class=p>()</span> <span class=o>%&gt;%</span>
  <span class=nf>set_engine</span><span class=p>(</span><span class=s>&#34;rpart&#34;</span><span class=p>)</span> <span class=o>%&gt;%</span>
  <span class=nf>set_mode</span><span class=p>(</span><span class=s>&#34;regression&#34;</span><span class=p>)</span>
<span class=c1>#&gt; ! parsnip could not locate an implementation for `bag_tree` regression model</span>
<span class=c1>#&gt;   specifications using the `rpart` engine.</span>
<span class=c1>#&gt; ℹ The parsnip extension package baguette implements support for this</span>
<span class=c1>#&gt;   specification.</span>
<span class=c1>#&gt; ℹ Please install (if needed) and load to continue.</span>
<span class=c1>#&gt; </span>
<span class=c1>#&gt; Bagged Decision Tree Model Specification (regression)</span>
<span class=c1>#&gt; </span>
<span class=c1>#&gt; Main Arguments:</span>
<span class=c1>#&gt;   cost_complexity = 0</span>
<span class=c1>#&gt;   min_n = 2</span>
<span class=c1>#&gt; </span>
<span class=c1>#&gt; Computational engine: rpart</span>
</code></pre></div><p>That side-effect of loading censored is no longer the case for the <code>C5.0</code> engine, as well:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf>bag_tree</span><span class=p>()</span> <span class=o>%&gt;%</span>
  <span class=nf>set_engine</span><span class=p>(</span><span class=s>&#34;C5.0&#34;</span><span class=p>)</span>
<span class=c1>#&gt; ! parsnip could not locate an implementation for `bag_tree` model</span>
<span class=c1>#&gt;   specifications using the `C5.0` engine.</span>
<span class=c1>#&gt; ℹ The parsnip extension package baguette implements support for this</span>
<span class=c1>#&gt;   specification.</span>
<span class=c1>#&gt; ℹ Please install (if needed) and load to continue.</span>
<span class=c1>#&gt; </span>
<span class=c1>#&gt; Bagged Decision Tree Model Specification (unknown mode)</span>
<span class=c1>#&gt; </span>
<span class=c1>#&gt; Main Arguments:</span>
<span class=c1>#&gt;   cost_complexity = 0</span>
<span class=c1>#&gt;   min_n = 2</span>
<span class=c1>#&gt; </span>
<span class=c1>#&gt; Computational engine: C5.0</span>
</code></pre></div><p>Finally, if we try to extract information about tuning parameters for a model that&rsquo;s not well-specified with parsnip v1.0.2, the message about missing extensions is elevated to an error:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=n>bt</span> <span class=o>&lt;-</span> 
  <span class=n>bt</span> <span class=o>%&gt;%</span>
  <span class=nf>update</span><span class=p>(</span><span class=n>cost_complexity</span> <span class=o>=</span> <span class=nf>tune</span><span class=p>())</span>

<span class=nf>extract_parameter_set_dials</span><span class=p>(</span><span class=n>bt</span><span class=p>)</span> <span class=o>%&gt;%</span>
  <span class=nf>grid_random</span><span class=p>(</span><span class=n>size</span> <span class=o>=</span> <span class=m>3</span><span class=p>)</span>
<span class=c1>#&gt; Error:</span>
<span class=c1>#&gt; ! parsnip could not locate an implementation for `bag_tree` regression</span>
<span class=c1>#&gt;   model specifications using the `rpart` engine.</span>
<span class=c1>#&gt; ℹ The parsnip extension package baguette implements support for this</span>
<span class=c1>#&gt;   specification.</span>
<span class=c1>#&gt; ℹ Please install (if needed) and load to continue.</span>
</code></pre></div><p>Given parsnip&rsquo;s infrastructure, the technical conditions that raise these four prompts are quite different, but <em>the technical reasons don&rsquo;t matter</em>; the mistake being made is the same, and that&rsquo;s what ought to determine the prompt raised.</p><h3 id=dont-tell-the-user-they-did-something-they-didnt-do>Don&rsquo;t tell the user they did something they didn&rsquo;t do
<a href=#dont-tell-the-user-they-did-something-they-didnt-do><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>Another consideration that helped us frame these changes is that we feel error messages shouldn&rsquo;t reference operations that users don&rsquo;t need to know about. We&rsquo;ll return to the example of forgetting to load extension packages to elaborate on what we mean here.</p><p>With parsnip v1.0.1, if we just load the package and initialize a <code>bag_tree()</code> model, we see:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf>library</span><span class=p>(</span><span class=n>parsnip</span><span class=p>)</span>

<span class=nf>bag_tree</span><span class=p>()</span>
<span class=c1>#&gt; parsnip could not locate an implementation for `bag_tree` model specifications</span>
<span class=c1>#&gt; using the `rpart` engine.</span>
<span class=c1>#&gt; </span>
<span class=c1>#&gt; Bagged Decision Tree Model Specification (unknown)</span>
<span class=c1>#&gt; </span>
<span class=c1>#&gt; Main Arguments:</span>
<span class=c1>#&gt;   cost_complexity = 0</span>
<span class=c1>#&gt;   min_n = 2</span>
<span class=c1>#&gt; </span>
<span class=c1>#&gt; Computational engine: rpart</span>
</code></pre></div><p>Note the ending of the message: &ldquo;&mldr;using the <code>rpart</code> engine.&rdquo; We didn&rsquo;t specify that we wanted to use <code>rpart</code> as an engine, yet that seems to be what went wrong!</p><p>Readers who have fitted bagged decision tree models with parsnip before may realize that <code>rpart</code> is the default engine for these models. This shouldn&rsquo;t be requisite knowledge to interpret this message, though, and is not helpful in addressing the issue. With v1.0.2, we only mention the information that users give to us when constructing that message, and tell them exactly which packages they might need to install/load:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf>library</span><span class=p>(</span><span class=n>parsnip</span><span class=p>)</span>

<span class=nf>bag_tree</span><span class=p>()</span>
<span class=c1>#&gt; ! parsnip could not locate an implementation for `bag_tree` model</span>
<span class=c1>#&gt;   specifications.</span>
<span class=c1>#&gt; ℹ The parsnip extension packages censored and baguette implement support for</span>
<span class=c1>#&gt;   this specification.</span>
<span class=c1>#&gt; ℹ Please install (if needed) and load to continue.</span>
<span class=c1>#&gt; </span>
<span class=c1>#&gt; Bagged Decision Tree Model Specification (unknown mode)</span>
<span class=c1>#&gt; </span>
<span class=c1>#&gt; Main Arguments:</span>
<span class=c1>#&gt;   cost_complexity = 0</span>
<span class=c1>#&gt;   min_n = 2</span>
<span class=c1>#&gt; </span>
<span class=c1>#&gt; Computational engine: rpart</span>
</code></pre></div><p>We hinted at another example of this guideline in the previous section; parsnip shouldn&rsquo;t refer to internal functions when it raises error messages. Above, with parsnip v1.0.1, we saw:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf>library</span><span class=p>(</span><span class=n>censored</span><span class=p>)</span>
<span class=c1>#&gt; Loading required package: survival</span>

<span class=nf>bag_tree</span><span class=p>()</span> <span class=o>%&gt;%</span>
  <span class=nf>set_engine</span><span class=p>(</span><span class=s>&#34;rpart&#34;</span><span class=p>)</span> <span class=o>%&gt;%</span>
  <span class=nf>set_mode</span><span class=p>(</span><span class=s>&#34;regression&#34;</span><span class=p>)</span>
<span class=c1>#&gt; Error in `stop_incompatible_mode()`:</span>
<span class=c1>#&gt; ! Available modes for engine rpart are: &#39;unknown&#39;, &#39;censored regression&#39;</span>
</code></pre></div><p>The error points out a function called <code>stop_incompatible_mode()</code>, which is a function used internally by parsnip to check modes. There&rsquo;s a different function, <code>check_spec_mode_engine_val()</code>, that will flag super silly modes:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf>library</span><span class=p>(</span><span class=n>parsnip</span><span class=p>)</span>

<span class=nf>bag_tree</span><span class=p>()</span> <span class=o>%&gt;%</span>
  <span class=nf>set_engine</span><span class=p>(</span><span class=s>&#34;rpart&#34;</span><span class=p>)</span> <span class=o>%&gt;%</span>
  <span class=nf>set_mode</span><span class=p>(</span><span class=s>&#34;beep bop boop&#34;</span><span class=p>)</span>
<span class=c1>#&gt; Error in `check_spec_mode_engine_val()`:</span>
<span class=c1>#&gt; ! &#39;beep bop boop&#39; is not a known mode for model `bag_tree()`.</span>
</code></pre></div><p>The important part, though, is that <em>the technical reasons don&rsquo;t matter</em>. Users don&rsquo;t know&mdash;and don&rsquo;t need to know&mdash;what <code>stop_incompatible_mode()</code> or <code>check_spec_mode_engine_val()</code> do.</p><p>In parsnip v1.0.2, we now point users to the function they actually called that eventually gave rise to the error:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf>bag_tree</span><span class=p>()</span> <span class=o>%&gt;%</span>
  <span class=nf>set_engine</span><span class=p>(</span><span class=s>&#34;rpart&#34;</span><span class=p>)</span> <span class=o>%&gt;%</span>
  <span class=nf>set_mode</span><span class=p>(</span><span class=s>&#34;beep bop boop&#34;</span><span class=p>)</span>
<span class=c1>#&gt; Error in `set_mode()`:</span>
<span class=c1>#&gt; ! &#39;beep bop boop&#39; is not a known mode for model `bag_tree()`.</span>
</code></pre></div><p>We hope these changes improve folks&rsquo; experience when modeling with parsnip in the future!</p><h2 id=acknowledgements>Acknowledgements
<a href=#acknowledgements><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Thanks to the folks who have contributed to this release of parsnip via GitHub:
<a href=https://github.com/gustavomodelli target=_blank rel=noopener>@gustavomodelli</a>,
<a href=https://github.com/joeycouse target=_blank rel=noopener>@joeycouse</a>,
<a href=https://github.com/mrkaye97 target=_blank rel=noopener>@mrkaye97</a>,
<a href=https://github.com/siegfried target=_blank rel=noopener>@siegfried</a>.</p><p>Contributions from many others, in the form of StackOverflow and RStudio Community posts, have been greatly helpful in our work on these improvements.</p></div></div><div class=column25><div class="section hideOnMobile"><div class=sectionTitle>Contents</div><nav id=TableOfContents><ul><li><a href=#parsnip-and-its-extension-packages>parsnip and its extension packages</a></li><li><a href=#improvements-to-errors-and-warnings>Improvements to errors and warnings</a></li><li><a href=#acknowledgements>Acknowledgements</a></li></ul></nav></div><div class=section></div></div></div></div></div><div id=rStudioFooter class=band><div class=bandContent><div id=copyright>The tidyverse is proudly supported by <a class=rstudioLogo href=https://posit.co/ aria-label="Posit Homepage"></a></div><div id=logos><a href=https://www.tidyverse.org/google_privacy_policy>Privacy policy</a>
<a href=https://github.com/tidyverse class="footerLogo gitHub" aria-label="Tidyverse GitHub organization"></a><a href=https://twitter.com/hashtag/rstats class="footerLogo twitter" aria-label="rstats hashtag on twitter.com"></a></div></div></div></div></div><script type=application/javascript>var dnt=(navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack);var doNotTrack=(dnt=="1"||dnt=="yes");if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');if(window.sessionStorage){var GA_SESSION_STORAGE_KEY='ga:clientId';ga('create','UA-115082821-1',{'storage':'none','clientId':sessionStorage.getItem(GA_SESSION_STORAGE_KEY)});ga(function(tracker){sessionStorage.setItem(GA_SESSION_STORAGE_KEY,tracker.get('clientId'));});}
ga('set','anonymizeIp',true);ga('send','pageview');}</script></body></html></div></div></body></html>