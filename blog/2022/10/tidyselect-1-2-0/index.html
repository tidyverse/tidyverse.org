<!doctype html><html><head><!doctype html><html lang=en-us><link rel=stylesheet href=/css/fonts.css><link rel=stylesheet href=/css/main-site.css><link rel=stylesheet href=/css/fa5-all.css><style type=text/css>body{background-color:#fff;color:#1a1917}a{color:#38577f}a:hover{color:#42709b}a:focus{outline-color:#42709b}.column25-left .sectionTitle a:hover:not(.current),.column16-left .sectionTitle a:hover:not(.current){color:#1a1917}.icon-attribution,.icon-attribution a{color:#1a1917;opacity:75%}#homeContent .band.first{background-color:#fff}#homeContent .band.second{background-color:#fdeba4}#homeContent .band.third{background-color:#fff}#rStudioHeader{background-color:#1a162d;color:#fff}#rStudioHeader .productName{color:#fff}#rStudioHeader .productName:hover,#rStudioHeader .productName:focus{color:#fdeba4}#rStudioHeader #menu .menuItem.a{background-color:#75aadb;color:#fff}#rStudioHeader #menu .menuItem:hover{background-color:#484557;color:#fff}#rStudioHeader #menu .menuItem.current{background-color:#fff;color:#1a162d;text-decoration:none}#rStudioFooter.band{background-color:#767381}#rStudioFooter .bandContent #copyright{color:#e3eef8}table tbody tr:nth-child(even){background-color:#f7faff}table tbody tr:nth-child(odd){background-color:#fff}.latest{border-top:.5em solid <no value>}.event{-moz-box-shadow:0 0 0 0 rgba(0,0,0,.1);-webkit-box-shadow:0 0 0 0 rgba(0,0,0,.1);box-shadow:0 0 0 0 rgba(0,0,0,.1)}.section .event{background-color:#eab0c41a}.section .event{border-top:7pt solid #a19ea936}.section .event a{color:#1a162d}.section .event{color:#404040}</style><link rel=stylesheet href=/css/tidyverse.css><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Hugo 0.71.1"><title>tidyselect 1.2.0</title><meta property="og:title" content="tidyselect 1.2.0"><meta property="og:description" content="tidyselect 1.2.0 hit CRAN last week and includes a few updates to the syntax of selections in tidyverse functions."><meta property="og:type" content="article"><meta property="og:url" content="https://www.tidyverse.org/blog/2022/10/tidyselect-1-2-0/"><meta property="twitter:card" content="summary_large_image"><meta property="og:title" content="tidyselect 1.2.0 - Tidyverse"><meta property="description" content="tidyselect 1.2.0 hit CRAN last week and includes a few updates to the syntax of selections in tidyverse functions."><meta property="og:description" content="tidyselect 1.2.0 hit CRAN last week and includes a few updates to the syntax of selections in tidyverse functions."><meta property="og:image" content="https://www.tidyverse.org/blog/2022/10/tidyselect-1-2-0/thumbnail-sq.jpg"><meta name=twitter:image content="https://www.tidyverse.org/blog/2022/10/tidyselect-1-2-0/thumbnail-wd.jpg"><link rel=apple-touch-icon sizes=180x180 href=/images/favicons/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/images/favicons/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/images/favicons/favicon-16x16.png><link rel=manifest href=/images/favicons/site.webmanifest><link rel=mask-icon href=/images/favicons/safari-pinned-tab.svg><link rel="shortcut icon" href=/images/favicons/favicon.ico><meta name=msapplication-TileColor content="#da532c"><meta name=msapplication-config href=/images/favicons/browserconfig.xml><script type=text/javascript src=/js/jquery-3.5.1.min.js></script><script type=text/javascript src=/js/site.js></script><link rel=icon href=/images/favicon.ico><script type=text/javascript src=/js/clipboard.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin=anonymous></script><script defer data-domain=tidyverse.org,all.tidyverse.org src=https://plausible.io/js/plausible.js></script></head><body><div id=appTidyverseSite class="shrinkHeader alwaysShrinkHeader"><div id=main><div id=rStudioHeader><nav class=band><div class="innards bandContent"><div><a class=productName href=/>Tidyverse</a></div><div id=menu><div id=menuToggler></div><div id=menuItems><a class=menuItem href=/packages/>Packages</a>
<a class="menuItem current" href=/blog/>Blog</a>
<a class=menuItem href=/learn/>Learn</a>
<a class=menuItem href=/help/>Help</a>
<a class=menuItem href=/contribute/>Contribute</a></div></div></div></nav></div><main><div class="band padForHeader pushFooter"><div class=bandContent><div class="full splitColumns withMobileMargins"><div class=column75><h1 class=article-title>tidyselect 1.2.0</h1><div class=article-header aria-hidden=true><div class=photo><img src=/blog/2022/10/tidyselect-1-2-0/thumbnail-wd.jpg></div><div class=photoCredit>Photo by <a href=https://unsplash.com/photos/xZxZxiceD8s>Laura Gilchrist</a></div></div><span class=article-date><i class="fas fa-calendar-day fa-fw"></i>&nbsp;&nbsp;2022/10/18</span><p style=margin-bottom:.5em;margin-top:.85em><i class="fas fa-tags"></i>&nbsp;
<a href=/tags/lifecycle/>lifecycle</a>,
<a href=/tags/tidyselect/>tidyselect</a></p><p style=margin-top:.5em><i class="fas fa-user-circle fa-fw"></i>&nbsp;
Lionel Henry and Hadley Wickham</p><div class=article-content><p><a href=https://tidyselect.r-lib.org/ target=_blank rel=noopener>tidyselect</a> 1.2.0 hit CRAN last week and includes a few updates to the syntax of selections in tidyverse functions like <code>dplyr::select(...)</code> and <code>tidyr::pivot_longer(cols = )</code>.</p><p>tidyselect is a low-level package that provides the backend for selection contexts in tidyverse functions. A selection context is an argument like <code>cols</code> in
<a href=https://tidyr.tidyverse.org/reference/pivot_longer.html target=_blank rel=noopener><code>pivot_longer()</code></a> or a set of arguments like <code>...</code> in
<a href=https://dplyr.tidyverse.org/reference/select.html target=_blank rel=noopener><code>select()</code></a> <sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>. In these special contexts, you can use a domain specific language that helps you create a selection of columns. For example, you can select multiple columns with
<a href=https://rdrr.io/r/base/c.html target=_blank rel=noopener><code>c()</code></a>, a range of columns with <code>:</code>, and complex matches with selection helpers such as
<a href=https://tidyselect.r-lib.org/reference/starts_with.html target=_blank rel=noopener><code>starts_with()</code></a>. Under the hood, this selection syntax is interpreted and processed by the tidyselect package.</p><p>In this post, we&rsquo;ll cover the most important
<a href=https://lifecycle.r-lib.org/articles/stages.html target=_blank rel=noopener>lifecycle changes</a> in the selection syntax that tidyverse users (package developers in particular) should know about. You can see a full list of changes in the
<a href=https://tidyselect.r-lib.org/news/index.html#tidyselect-120 target=_blank rel=noopener>release notes</a>. We&rsquo;ll start with a quick recap of what it means in practice for a feature to be deprecated or soft-deprecated.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=kr><a href=https://rdrr.io/r/base/library.html>library</a></span><span class=o>(</span><span class=nv><a href=https://tidyverse.tidyverse.org>tidyverse</a></span><span class=o>)</span></span></code></pre></div><p>Note: With this release of tidyselect, some error messages will be suboptimal until dplyr 1.1.0 is released (planned in late October). We recommend waiting until then before updating tidyselect (though it&rsquo;s not a big deal if you have already updated).</p><h2 id=about-soft-deprecation>About soft-deprecation
<a href=#about-soft-deprecation><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Deprecation of features in tidyverse packages is handled by the lifecycle package. See <a href=https://www.tidyverse.org/blog/2021/02/lifecycle-1-0-0/>https://www.tidyverse.org/blog/2021/02/lifecycle-1-0-0/</a> for an introduction.</p><p>The main feature of lifecycle is to distinguish between two stages of deprecation and two usage modes, direct and indirect.</p><ul><li><p>For script users, <strong>direct usage</strong> is when you use a deprecated feature from the global environment. If the deprecated feature was used inside a package function that you are calling, it is considered <strong>indirect usage</strong>.</p></li><li><p>For package developers, the distinction between direct and indirect usages is made by testthat in unit tests. If a function in your package calls the feature, it is considered direct usage. If that&rsquo;s a function in another package that you are calling, it&rsquo;s indirect usage.</p></li></ul><p>To sum up, direct usage is when your own code uses the deprecated feature, and indirect usage is when someone else&rsquo;s code uses it. This distinction matters because it determines how verbose (and thus how annoying) the deprecation warnings are.</p><ul><li><p>For <strong>soft-deprecation</strong>, indirect usage is always silent because we only want to alert people who are actually able to fix the problem.</p><p>Direct usage only generates one warning every 8 hours to avoid being too annoying during this transition period, so that you can continue to work with existing code, ignore the warnings, and update to the new patterns on your own time.</p></li><li><p>For <strong>deprecation</strong>, it&rsquo;s now really time to update the code. Direct usage gives a warning every time so that deprecated features can no longer be ignored.</p><p>Indirect usage will now also warn, but only once every 8 hours since indirect users can&rsquo;t fix the problem themselves. The warning message automatically picks up the package URL where the usage was detected so that you can easily report the deprecation to the relevant maintainers.</p></li></ul><p>lifecycle warnings are set up to helpfully inform you about upcoming changes while being as discreet as possible. All of the features deprecated in tidyselect in this blog post are in the <strong>soft-deprecation</strong> stage, and will remain this way for at least one year.</p><h2 id=supplying-character-vectors-of-column-names-outside-of-all_of-and-any_of>Supplying character vectors of column names outside of <code>all_of()</code> and <code>any_of()</code>
<a href=#supplying-character-vectors-of-column-names-outside-of-all_of-and-any_of><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>To specify a column selection using a character vector of names, you normally use
<a href=https://tidyselect.r-lib.org/reference/all_of.html target=_blank rel=noopener><code>all_of()</code></a> or
<a href=https://tidyselect.r-lib.org/reference/all_of.html target=_blank rel=noopener><code>any_of()</code></a>.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>vars</span> <span class=o>&lt;-</span> <span class=nf><a href=https://rdrr.io/r/base/c.html>c</a></span><span class=o>(</span><span class=s>"cyl"</span>, <span class=s>"am"</span><span class=o>)</span></span>
<span><span class=nv>mtcars</span> <span class=o>|&gt;</span> <span class=nf><a href=https://dplyr.tidyverse.org/reference/select.html>select</a></span><span class=o>(</span><span class=nf><a href=https://tidyselect.r-lib.org/reference/all_of.html>all_of</a></span><span class=o>(</span><span class=nv>vars</span><span class=o>)</span><span class=o>)</span> <span class=o>|&gt;</span> <span class=nf><a href=https://pillar.r-lib.org/reference/glimpse.html>glimpse</a></span><span class=o>(</span><span class=o>)</span></span>
<span><span class=c>#&gt; Rows: 32</span></span>
<span><span class=c>#&gt; Columns: 2</span></span>
<span><span class=c>#&gt; $ cyl <span style=color:#555;font-style:italic>&lt;dbl&gt;</span> 6, 6, 4, 6, 8, 6, 8, 4, 4, 6, 6, 8, 8, 8, 8, 8, 8, 4, 4…</span></span>
<span><span class=c>#&gt; $ am  <span style=color:#555;font-style:italic>&lt;dbl&gt;</span> 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1…</span></span></code></pre></div><p><a href=https://tidyselect.r-lib.org/reference/all_of.html target=_blank rel=noopener><code>all_of()</code></a> is adamant that it <em>must</em> select all of the requested columns:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>mtcars</span> <span class=o>|&gt;</span> <span class=nf><a href=https://dplyr.tidyverse.org/reference/select.html>select</a></span><span class=o>(</span><span class=nf><a href=https://tidyselect.r-lib.org/reference/all_of.html>all_of</a></span><span class=o>(</span><span class=nv>letters</span><span class=o>)</span><span class=o>)</span></span>
<span><span class=c>#&gt; <span style=color:#bb0;font-weight:700>Error</span><span style=font-weight:700> in `select()`:</span></span></span>
<span><span class=c>#&gt; <span style=color:#0bb>ℹ</span> In argument: `all_of(letters)`.</span></span>
<span><span class=c>#&gt; <span style=font-weight:700>Caused by error in `all_of()`:</span></span></span>
<span><span class=c>#&gt; <span style=color:#bb0>!</span> Can't subset elements that don't exist.</span></span>
<span><span class=c>#&gt; <span style=color:#b00>✖</span> Elements `a`, `b`, `c`, `d`, `e`, etc. don't exist.</span></span></code></pre></div><p><a href=https://tidyselect.r-lib.org/reference/all_of.html target=_blank rel=noopener><code>any_of()</code></a> is more lenient and ignores any names that are not present in the data frame. In this case, it ends up selecting nothing:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>mtcars</span> <span class=o>|&gt;</span> <span class=nf><a href=https://dplyr.tidyverse.org/reference/select.html>select</a></span><span class=o>(</span><span class=nf><a href=https://tidyselect.r-lib.org/reference/all_of.html>any_of</a></span><span class=o>(</span><span class=nv>letters</span><span class=o>)</span><span class=o>)</span></span>
<span><span class=c>#&gt; data frame with 0 columns and 32 rows</span></span></code></pre></div><p>Another feature of
<a href=https://tidyselect.r-lib.org/reference/all_of.html target=_blank rel=noopener><code>all_of()</code></a> and
<a href=https://tidyselect.r-lib.org/reference/all_of.html target=_blank rel=noopener><code>any_of()</code></a> is that they remove all ambiguity between variables in your environment like <code>vars</code> or <code>letters</code> (env-variables) and variables inside the data frame like <code>cyl</code> or <code>am</code> (data-variables). Let&rsquo;s add <code>vars</code> in the data frame to see what happens:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>my_data</span> <span class=o>&lt;-</span> <span class=nv>mtcars</span> <span class=o>|&gt;</span> <span class=nf><a href=https://dplyr.tidyverse.org/reference/mutate.html>mutate</a></span><span class=o>(</span>vars <span class=o>=</span> <span class=m>1</span><span class=o>:</span><span class=nf><a href=https://dplyr.tidyverse.org/reference/context.html>n</a></span><span class=o>(</span><span class=o>)</span><span class=o>)</span></span>
<span><span class=nv>my_data</span> <span class=o>|&gt;</span> <span class=nf><a href=https://dplyr.tidyverse.org/reference/select.html>select</a></span><span class=o>(</span><span class=nf><a href=https://tidyselect.r-lib.org/reference/all_of.html>all_of</a></span><span class=o>(</span><span class=nv>vars</span><span class=o>)</span><span class=o>)</span> <span class=o>|&gt;</span> <span class=nf><a href=https://pillar.r-lib.org/reference/glimpse.html>glimpse</a></span><span class=o>(</span><span class=o>)</span></span>
<span><span class=c>#&gt; Rows: 32</span></span>
<span><span class=c>#&gt; Columns: 2</span></span>
<span><span class=c>#&gt; $ cyl <span style=color:#555;font-style:italic>&lt;dbl&gt;</span> 6, 6, 4, 6, 8, 6, 8, 4, 4, 6, 6, 8, 8, 8, 8, 8, 8, 4, 4…</span></span>
<span><span class=c>#&gt; $ am  <span style=color:#555;font-style:italic>&lt;dbl&gt;</span> 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1…</span></span></code></pre></div><p>Because <code>vars</code> was supplied to
<a href=https://tidyselect.r-lib.org/reference/all_of.html target=_blank rel=noopener><code>all_of()</code></a>,
<a href=https://dplyr.tidyverse.org/reference/select.html target=_blank rel=noopener><code>select()</code></a> will never confuse it with <code>mtcars$vars</code>. In technical terms, there is no <strong>data-masking</strong> within selection helpers like
<a href=https://tidyselect.r-lib.org/reference/all_of.html target=_blank rel=noopener><code>all_of()</code></a>,
<a href=https://tidyselect.r-lib.org/reference/all_of.html target=_blank rel=noopener><code>any_of()</code></a>, or even
<a href=https://tidyselect.r-lib.org/reference/starts_with.html target=_blank rel=noopener><code>starts_with()</code></a>. It is safe to supply env-variables to these functions without worrying about data-masking ambiguity.</p><p>This is not the case however if you supply a character vector outside of
<a href=https://tidyselect.r-lib.org/reference/all_of.html target=_blank rel=noopener><code>all_of()</code></a>:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>my_data</span> <span class=o>|&gt;</span> <span class=nf><a href=https://dplyr.tidyverse.org/reference/select.html>select</a></span><span class=o>(</span><span class=nv>vars</span><span class=o>)</span> <span class=o>|&gt;</span> <span class=nf><a href=https://pillar.r-lib.org/reference/glimpse.html>glimpse</a></span><span class=o>(</span><span class=o>)</span></span>
<span><span class=c>#&gt; Rows: 32</span></span>
<span><span class=c>#&gt; Columns: 1</span></span>
<span><span class=c>#&gt; $ vars <span style=color:#555;font-style:italic>&lt;int&gt;</span> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16,…</span></span></code></pre></div><p>This is why we have decided to deprecate direct supply of character vectors in favour of using
<a href=https://tidyselect.r-lib.org/reference/all_of.html target=_blank rel=noopener><code>all_of()</code></a> and
<a href=https://tidyselect.r-lib.org/reference/all_of.html target=_blank rel=noopener><code>any_of()</code></a>. You will now get a soft-deprecation warning recommending to use
<a href=https://tidyselect.r-lib.org/reference/all_of.html target=_blank rel=noopener><code>all_of()</code></a>:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>mtcars</span> <span class=o>|&gt;</span> <span class=nf><a href=https://dplyr.tidyverse.org/reference/select.html>select</a></span><span class=o>(</span><span class=nv>vars</span><span class=o>)</span> <span class=o>|&gt;</span> <span class=nf><a href=https://pillar.r-lib.org/reference/glimpse.html>glimpse</a></span><span class=o>(</span><span class=o>)</span></span>
<span><span class=c>#&gt; Warning: Using an external vector in selections was deprecated in tidyselect 1.1.0.</span></span>
<span><span class=c>#&gt; <span style=color:#0bb>ℹ</span> Please use `all_of()` or `any_of()` instead.</span></span>
<span><span class=c>#&gt;   # Was:</span></span>
<span><span class=c>#&gt;   data %&gt;% select(vars)</span></span>
<span><span class=c>#&gt; </span></span>
<span><span class=c>#&gt;   # Now:</span></span>
<span><span class=c>#&gt;   data %&gt;% select(all_of(vars))</span></span>
<span><span class=c>#&gt; </span></span>
<span><span class=c>#&gt; See &lt;https://tidyselect.r-lib.org/reference/faq-external-vector.html&gt;.</span></span><span><span class=c>#&gt; Rows: 32</span></span>
<span><span class=c>#&gt; Columns: 2</span></span>
<span><span class=c>#&gt; $ cyl <span style=color:#555;font-style:italic>&lt;dbl&gt;</span> 6, 6, 4, 6, 8, 6, 8, 4, 4, 6, 6, 8, 8, 8, 8, 8, 8, 4, 4…</span></span>
<span><span class=c>#&gt; $ am  <span style=color:#555;font-style:italic>&lt;dbl&gt;</span> 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1…</span></span></code></pre></div><h2 id=using-data-inside-selections>Using <code>.data</code> inside selections
<a href=#using-data-inside-selections><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>The <code>.data</code> pronoun is a convenient way of programming with data-masking functions like
<a href=https://dplyr.tidyverse.org/reference/mutate.html target=_blank rel=noopener><code>mutate()</code></a> and
<a href=https://dplyr.tidyverse.org/reference/filter.html target=_blank rel=noopener><code>filter()</code></a>. It has two main functions:</p><ol><li><p>Retrieve a data frame column from a name stored in a variable with <code>[[</code>.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>var</span> <span class=o>&lt;-</span> <span class=s>"am"</span></span>
<span><span class=nv>mtcars</span> <span class=o>|&gt;</span> <span class=nf><a href=https://dplyr.tidyverse.org/reference/transmute.html>transmute</a></span><span class=o>(</span>am <span class=o>=</span> <span class=nv>.data</span><span class=o>[[</span><span class=nv>var</span><span class=o>]</span><span class=o>]</span> <span class=o>*</span> <span class=m>10</span><span class=o>)</span> <span class=o>|&gt;</span> <span class=nf><a href=https://pillar.r-lib.org/reference/glimpse.html>glimpse</a></span><span class=o>(</span><span class=o>)</span></span>
<span><span class=c>#&gt; Rows: 32</span></span>
<span><span class=c>#&gt; Columns: 1</span></span>
<span><span class=c>#&gt; $ am <span style=color:#555;font-style:italic>&lt;dbl&gt;</span> 10, 10, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10…</span></span></code></pre></div></li><li><p>For package developers, <code>.data</code> is helpful to silence R CMD check notes about unknown variables. When the static analysis checker of R encounters an expression like <code>mtcars |> mutate(am * 2)</code>, it has no way of knowing that <code>am</code> is a data frame variable. Since it doesn&rsquo;t see any variable <code>am</code> in your environment, it emits a warning about a potential typo in the code.</p><p>The <code>.data$col</code> pattern is used to work around this issue: <code>mtcars |> mutate(.data$am * 2)</code> doesn&rsquo;t produce any warnings.</p></li></ol><p>Whereas <code>.data</code> is very useful in data-masking functions, its usage in selections is much more limited. As we have seen in the previous section, retrieving a variable from character vector should be done with
<a href=https://tidyselect.r-lib.org/reference/all_of.html target=_blank rel=noopener><code>all_of()</code></a>:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>var</span> <span class=o>&lt;-</span> <span class=s>"am"</span></span>
<span><span class=nv>mtcars</span> <span class=o>|&gt;</span> <span class=nf><a href=https://dplyr.tidyverse.org/reference/select.html>select</a></span><span class=o>(</span><span class=nf><a href=https://tidyselect.r-lib.org/reference/all_of.html>all_of</a></span><span class=o>(</span><span class=nv>var</span><span class=o>)</span><span class=o>)</span> <span class=o>|&gt;</span> <span class=nf><a href=https://pillar.r-lib.org/reference/glimpse.html>glimpse</a></span><span class=o>(</span><span class=o>)</span></span>
<span><span class=c>#&gt; Rows: 32</span></span>
<span><span class=c>#&gt; Columns: 1</span></span>
<span><span class=c>#&gt; $ am <span style=color:#555;font-style:italic>&lt;dbl&gt;</span> 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1,…</span></span></code></pre></div><p>And to avoid the R CMD check note about unknown variables, it is much cleaner to wrap the column name in quotes:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>mtcars</span> <span class=o>|&gt;</span> <span class=nf><a href=https://dplyr.tidyverse.org/reference/select.html>select</a></span><span class=o>(</span><span class=s>"am"</span><span class=o>)</span> <span class=o>|&gt;</span> <span class=nf><a href=https://pillar.r-lib.org/reference/glimpse.html>glimpse</a></span><span class=o>(</span><span class=o>)</span></span>
<span><span class=c>#&gt; Rows: 32</span></span>
<span><span class=c>#&gt; Columns: 1</span></span>
<span><span class=c>#&gt; $ am <span style=color:#555;font-style:italic>&lt;dbl&gt;</span> 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1,…</span></span></code></pre></div><p>Allowing the <code>.data</code> pronoun in selection contexts also makes the distinction between tidy-selections and data-masking blurrier. And so we have decided to deprecate it in selections:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>var</span> <span class=o>&lt;-</span> <span class=s>"am"</span></span>
<span><span class=nv>mtcars</span> <span class=o>|&gt;</span> <span class=nf><a href=https://dplyr.tidyverse.org/reference/select.html>select</a></span><span class=o>(</span><span class=nv>.data</span><span class=o>[[</span><span class=nv>var</span><span class=o>]</span><span class=o>]</span><span class=o>)</span> <span class=o>|&gt;</span> <span class=nf><a href=https://rdrr.io/r/base/invisible.html>invisible</a></span><span class=o>(</span><span class=o>)</span></span>
<span><span class=c>#&gt; Warning: Use of .data in tidyselect expressions was deprecated in tidyselect 1.2.0.</span></span>
<span><span class=c>#&gt; <span style=color:#0bb>ℹ</span> Please use `all_of(var)` (or `any_of(var)`) instead of `.data[[var]]`</span></span></code></pre></div><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>mtcars</span> <span class=o>|&gt;</span> <span class=nf><a href=https://dplyr.tidyverse.org/reference/select.html>select</a></span><span class=o>(</span><span class=nv>.data</span><span class=o>$</span><span class=nv>am</span><span class=o>)</span> <span class=o>|&gt;</span> <span class=nf><a href=https://rdrr.io/r/base/invisible.html>invisible</a></span><span class=o>(</span><span class=o>)</span></span>
<span><span class=c>#&gt; Warning: Use of .data in tidyselect expressions was deprecated in tidyselect 1.2.0.</span></span>
<span><span class=c>#&gt; <span style=color:#0bb>ℹ</span> Please use `"am"` instead of `.data$am`</span></span></code></pre></div><p>This deprecation does not affect the use of <code>.data</code> in data-masking contexts.</p><h2 id=acknowledgements>Acknowledgements
<a href=#acknowledgements><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Many thanks to all contributors (issues and PRs) to this release!</p><p><a href=https://github.com/alexpghayes target=_blank rel=noopener>@alexpghayes</a>,
<a href=https://github.com/angela-li target=_blank rel=noopener>@angela-li</a>,
<a href=https://github.com/apreshill target=_blank rel=noopener>@apreshill</a>,
<a href=https://github.com/arneschillert target=_blank rel=noopener>@arneschillert</a>,
<a href=https://github.com/batpigandme target=_blank rel=noopener>@batpigandme</a>,
<a href=https://github.com/behrman target=_blank rel=noopener>@behrman</a>,
<a href=https://github.com/bensoltoff target=_blank rel=noopener>@bensoltoff</a>,
<a href=https://github.com/braceandbracket target=_blank rel=noopener>@braceandbracket</a>,
<a href=https://github.com/brshallo target=_blank rel=noopener>@brshallo</a>,
<a href=https://github.com/bwalsh5 target=_blank rel=noopener>@bwalsh5</a>,
<a href=https://github.com/carneybill target=_blank rel=noopener>@carneybill</a>,
<a href=https://github.com/ChrisDunleavy target=_blank rel=noopener>@ChrisDunleavy</a>,
<a href=https://github.com/ColinFay target=_blank rel=noopener>@ColinFay</a>,
<a href=https://github.com/courtiol target=_blank rel=noopener>@courtiol</a>,
<a href=https://github.com/csgillespie target=_blank rel=noopener>@csgillespie</a>,
<a href=https://github.com/DavisVaughan target=_blank rel=noopener>@DavisVaughan</a>,
<a href=https://github.com/dgrtwo target=_blank rel=noopener>@dgrtwo</a>,
<a href=https://github.com/DivadNojnarg target=_blank rel=noopener>@DivadNojnarg</a>,
<a href=https://github.com/dpprdan target=_blank rel=noopener>@dpprdan</a>,
<a href=https://github.com/dpseidel target=_blank rel=noopener>@dpseidel</a>,
<a href=https://github.com/drmowinckels target=_blank rel=noopener>@drmowinckels</a>,
<a href=https://github.com/dylan-cooper target=_blank rel=noopener>@dylan-cooper</a>,
<a href=https://github.com/EconomiCurtis target=_blank rel=noopener>@EconomiCurtis</a>,
<a href=https://github.com/edgararuiz-zz target=_blank rel=noopener>@edgararuiz-zz</a>,
<a href=https://github.com/EdwinTh target=_blank rel=noopener>@EdwinTh</a>,
<a href=https://github.com/elben10 target=_blank rel=noopener>@elben10</a>,
<a href=https://github.com/EmilHvitfeldt target=_blank rel=noopener>@EmilHvitfeldt</a>,
<a href=https://github.com/espinielli target=_blank rel=noopener>@espinielli</a>,
<a href=https://github.com/fenguoerbian target=_blank rel=noopener>@fenguoerbian</a>,
<a href=https://github.com/gaborcsardi target=_blank rel=noopener>@gaborcsardi</a>,
<a href=https://github.com/giocomai target=_blank rel=noopener>@giocomai</a>,
<a href=https://github.com/gregrs-uk target=_blank rel=noopener>@gregrs-uk</a>,
<a href=https://github.com/gregswinehart target=_blank rel=noopener>@gregswinehart</a>,
<a href=https://github.com/gvelasq target=_blank rel=noopener>@gvelasq</a>,
<a href=https://github.com/hadley target=_blank rel=noopener>@hadley</a>,
<a href=https://github.com/hfrick target=_blank rel=noopener>@hfrick</a>,
<a href=https://github.com/hplieninger target=_blank rel=noopener>@hplieninger</a>,
<a href=https://github.com/ismayc target=_blank rel=noopener>@ismayc</a>,
<a href=https://github.com/jameslairdsmith target=_blank rel=noopener>@jameslairdsmith</a>,
<a href=https://github.com/jayhesselberth target=_blank rel=noopener>@jayhesselberth</a>,
<a href=https://github.com/jemus42 target=_blank rel=noopener>@jemus42</a>,
<a href=https://github.com/jennybc target=_blank rel=noopener>@jennybc</a>,
<a href=https://github.com/jimhester target=_blank rel=noopener>@jimhester</a>,
<a href=https://github.com/juliasilge target=_blank rel=noopener>@juliasilge</a>,
<a href=https://github.com/justmytwospence target=_blank rel=noopener>@justmytwospence</a>,
<a href=https://github.com/karawoo target=_blank rel=noopener>@karawoo</a>,
<a href=https://github.com/krlmlr target=_blank rel=noopener>@krlmlr</a>,
<a href=https://github.com/leafyoung target=_blank rel=noopener>@leafyoung</a>,
<a href=https://github.com/lionel- target=_blank rel=noopener>@lionel-</a>,
<a href=https://github.com/lorenzwalthert target=_blank rel=noopener>@lorenzwalthert</a>,
<a href=https://github.com/LucyMcGowan target=_blank rel=noopener>@LucyMcGowan</a>,
<a href=https://github.com/maelle target=_blank rel=noopener>@maelle</a>,
<a href=https://github.com/markdly target=_blank rel=noopener>@markdly</a>,
<a href=https://github.com/martin-ueding target=_blank rel=noopener>@martin-ueding</a>,
<a href=https://github.com/maurolepore target=_blank rel=noopener>@maurolepore</a>,
<a href=https://github.com/MichaelChirico target=_blank rel=noopener>@MichaelChirico</a>,
<a href=https://github.com/mikemahoney218 target=_blank rel=noopener>@mikemahoney218</a>,
<a href=https://github.com/mine-cetinkaya-rundel target=_blank rel=noopener>@mine-cetinkaya-rundel</a>,
<a href=https://github.com/mitchelloharawild target=_blank rel=noopener>@mitchelloharawild</a>,
<a href=https://github.com/pkq target=_blank rel=noopener>@pkq</a>,
<a href=https://github.com/PursuitOfDataScience target=_blank rel=noopener>@PursuitOfDataScience</a>,
<a href=https://github.com/rgerecke target=_blank rel=noopener>@rgerecke</a>,
<a href=https://github.com/richierocks target=_blank rel=noopener>@richierocks</a>,
<a href=https://github.com/Robinlovelace target=_blank rel=noopener>@Robinlovelace</a>,
<a href=https://github.com/robinsones target=_blank rel=noopener>@robinsones</a>,
<a href=https://github.com/romainfrancois target=_blank rel=noopener>@romainfrancois</a>,
<a href=https://github.com/rosseji target=_blank rel=noopener>@rosseji</a>,
<a href=https://github.com/rudeboybert target=_blank rel=noopener>@rudeboybert</a>,
<a href=https://github.com/saghirb target=_blank rel=noopener>@saghirb</a>,
<a href=https://github.com/sbearrows target=_blank rel=noopener>@sbearrows</a>,
<a href=https://github.com/sharlagelfand target=_blank rel=noopener>@sharlagelfand</a>,
<a href=https://github.com/simonpcouch target=_blank rel=noopener>@simonpcouch</a>,
<a href=https://github.com/stedy target=_blank rel=noopener>@stedy</a>,
<a href=https://github.com/stephlocke target=_blank rel=noopener>@stephlocke</a>,
<a href=https://github.com/stragu target=_blank rel=noopener>@stragu</a>,
<a href=https://github.com/sysilviakim target=_blank rel=noopener>@sysilviakim</a>,
<a href=https://github.com/thisisdaryn target=_blank rel=noopener>@thisisdaryn</a>,
<a href=https://github.com/thomasp85 target=_blank rel=noopener>@thomasp85</a>,
<a href=https://github.com/thuettel target=_blank rel=noopener>@thuettel</a>,
<a href=https://github.com/tmstauss target=_blank rel=noopener>@tmstauss</a>,
<a href=https://github.com/topepo target=_blank rel=noopener>@topepo</a>,
<a href=https://github.com/tracykteal target=_blank rel=noopener>@tracykteal</a>,
<a href=https://github.com/tyluRp target=_blank rel=noopener>@tyluRp</a>,
<a href=https://github.com/vspinu target=_blank rel=noopener>@vspinu</a>,
<a href=https://github.com/warint target=_blank rel=noopener>@warint</a>,
<a href=https://github.com/wibeasley target=_blank rel=noopener>@wibeasley</a>,
<a href=https://github.com/yitao-li target=_blank rel=noopener>@yitao-li</a>, and
<a href=https://github.com/yutannihilation target=_blank rel=noopener>@yutannihilation</a>.</p><section class=footnotes role=doc-endnotes><hr><ol><li id=fn:1 role=doc-endnote><p>If you are wondering whether a particular argument supports selections, look in the function documentation. Arguments tagged with <code>&lt;tidy-select></code> implement the selection dialect. By contrast, arguments tagged with <code>&lt;data-masking></code> only allow to refer to data frame columns directly. <a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></section></div></div><div class=column25><div class="section hideOnMobile"><div class=sectionTitle>Contents</div><nav id=TableOfContents><ul><li><a href=#about-soft-deprecation>About soft-deprecation</a></li><li><a href=#supplying-character-vectors-of-column-names-outside-of-all_of-and-any_of>Supplying character vectors of column names outside of <code>all_of()</code> and <code>any_of()</code></a></li><li><a href=#using-data-inside-selections>Using <code>.data</code> inside selections</a></li><li><a href=#acknowledgements>Acknowledgements</a></li></ul></nav></div><div class=section></div></div></div></div></div><div id=rStudioFooter class=band><div class=bandContent><div id=copyright>The tidyverse is proudly supported by <a class=rstudioLogo href=https://posit.co/ aria-label="Posit Homepage"></a></div><div id=logos><a href=https://www.tidyverse.org/google_privacy_policy>Privacy policy</a>
<a href=https://github.com/tidyverse class="footerLogo gitHub" aria-label="Tidyverse GitHub organization"></a><a href=https://twitter.com/hashtag/rstats class="footerLogo twitter" aria-label="rstats hashtag on twitter.com"></a></div></div></div></div></div><script src=/js/math-code.js></script><script type=text/x-mathjax-config>
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    processEscapes: true
  }
});
</script><script async src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><script type=application/javascript>var dnt=(navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack);var doNotTrack=(dnt=="1"||dnt=="yes");if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');if(window.sessionStorage){var GA_SESSION_STORAGE_KEY='ga:clientId';ga('create','UA-115082821-1',{'storage':'none','clientId':sessionStorage.getItem(GA_SESSION_STORAGE_KEY)});ga(function(tracker){sessionStorage.setItem(GA_SESSION_STORAGE_KEY,tracker.get('clientId'));});}
ga('set','anonymizeIp',true);ga('send','pageview');}</script></body></html></div></div></body></html>