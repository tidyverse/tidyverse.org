<!doctype html><html><head><!doctype html><html lang=en-us><link rel=stylesheet href=/css/fonts.css><link rel=stylesheet href=/css/main-site.css><link rel=stylesheet href=/css/fa5-all.css><style type=text/css>body{background-color:#fff;color:#1a1917}a{color:#38577f}a:hover{color:#42709b}a:focus{outline-color:#42709b}.column25-left .sectionTitle a:hover:not(.current),.column16-left .sectionTitle a:hover:not(.current){color:#1a1917}.icon-attribution,.icon-attribution a{color:#1a1917;opacity:75%}#homeContent .band.first{background-color:#fff}#homeContent .band.second{background-color:#fdeba4}#homeContent .band.third{background-color:#fff}#rStudioHeader{background-color:#1a162d;color:#fff}#rStudioHeader .productName{color:#fff}#rStudioHeader .productName:hover,#rStudioHeader .productName:focus{color:#fdeba4}#rStudioHeader #menu .menuItem.a{background-color:#75aadb;color:#fff}#rStudioHeader #menu .menuItem:hover{background-color:#484557;color:#fff}#rStudioHeader #menu .menuItem.current{background-color:#fff;color:#1a162d;text-decoration:none}#rStudioFooter.band{background-color:#767381}#rStudioFooter .bandContent #copyright{color:#e3eef8}table tbody tr:nth-child(even){background-color:#f7faff}table tbody tr:nth-child(odd){background-color:#fff}.latest{border-top:.5em solid <no value>}.event{-moz-box-shadow:0 0 0 0 rgba(0,0,0,.1);-webkit-box-shadow:0 0 0 0 rgba(0,0,0,.1);box-shadow:0 0 0 0 rgba(0,0,0,.1)}.section .event{background-color:#eab0c41a}.section .event{border-top:7pt solid #a19ea936}.section .event a{color:#1a162d}.section .event{color:#404040}</style><link rel=stylesheet href=/css/tidyverse.css><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Hugo 0.71.1"><title>New CRAN requirements for packages with C and C++</title><meta property="og:title" content="New CRAN requirements for packages with C and C++"><meta property="og:description" content="A few recent changes in CRAN requirements for packages containing C or C++ code have caused package developers some headaches. This post outlines the issues and provides solutions the tidyverse team has used to address them."><meta property="og:type" content="article"><meta property="og:url" content="https://www.tidyverse.org/blog/2023/03/cran-checks-compiled-code/"><meta property="twitter:card" content="summary_large_image"><meta property="og:title" content="New CRAN requirements for packages with C and C++ - Tidyverse"><meta property="description" content="A few recent changes in CRAN requirements for packages containing C or C++ code have caused package developers some headaches. This post outlines the issues and provides solutions the tidyverse team has used to address them."><meta property="og:description" content="A few recent changes in CRAN requirements for packages containing C or C++ code have caused package developers some headaches. This post outlines the issues and provides solutions the tidyverse team has used to address them."><meta property="og:image" content="https://www.tidyverse.org/blog/2023/03/cran-checks-compiled-code/thumbnail-sq.jpg"><meta name=twitter:image content="https://www.tidyverse.org/blog/2023/03/cran-checks-compiled-code/thumbnail-wd.jpg"><link rel=apple-touch-icon sizes=180x180 href=/images/favicons/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/images/favicons/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/images/favicons/favicon-16x16.png><link rel=manifest href=/images/favicons/site.webmanifest><link rel=mask-icon href=/images/favicons/safari-pinned-tab.svg><link rel="shortcut icon" href=/images/favicons/favicon.ico><meta name=msapplication-TileColor content="#da532c"><meta name=msapplication-config href=/images/favicons/browserconfig.xml><script type=text/javascript src=/js/jquery-3.5.1.min.js></script><script type=text/javascript src=/js/site.js></script><link rel=icon href=/images/favicon.ico><script type=text/javascript src=/js/clipboard.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin=anonymous></script><script defer data-domain=tidyverse.org,all.tidyverse.org src=https://plausible.io/js/plausible.js></script></head><body><div id=appTidyverseSite class="shrinkHeader alwaysShrinkHeader"><div id=main><div id=rStudioHeader><nav class=band><div class="innards bandContent"><div><a class=productName href=/>Tidyverse</a></div><div id=menu><div id=menuToggler></div><div id=menuItems><a class=menuItem href=/packages/>Packages</a>
<a class="menuItem current" href=/blog/>Blog</a>
<a class=menuItem href=/learn/>Learn</a>
<a class=menuItem href=/help/>Help</a>
<a class=menuItem href=/contribute/>Contribute</a></div></div></div></nav></div><main><div class="band padForHeader pushFooter"><div class=bandContent><div class="full splitColumns withMobileMargins"><div class=column75><h1 class=article-title>New CRAN requirements for packages with C and C++</h1><div class=article-header aria-hidden=true><div class=photo><img src=/blog/2023/03/cran-checks-compiled-code/thumbnail-wd.jpg></div><div class=photoCredit>Photo by <a href=https://unsplash.com/photos/dhGFLj3rI0Q>Quino Al</a></div></div><span class=article-date><i class="fas fa-calendar-day fa-fw"></i>&nbsp;&nbsp;2023/03/30</span></p><p style=margin-top:.5em><i class="fas fa-user-circle fa-fw"></i>&nbsp;
Andy Teucher</p><div class=article-content><p>The R package landscape is dynamic, with changes in infrastructure common, especially when CRAN makes changes to their policies and requirements. This is particularly true for packages that include low-level compiled code, requiring developers to be nimble in responding to these changes.</p><p>The tidyverse team at Posit is in the unique situation where we have a concentration of developers working full-time on creating and maintaining open source packages. This internal community provides the opportunity to collaborate to develop shared practices and discover solutions to problems that arise. When we can, we like to share what we&rsquo;ve learned so other developers can benefit.</p><p>There have been a few recent changes at CRAN for packages containing C and C++ code that developers have had to adapt to, and we would like to share some of our learning:</p><h2 id=note-regarding-systemrequirements-c11>NOTE regarding <code>SystemRequirements: C++11</code>
<a href=#note-regarding-systemrequirements-c11><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Many package authors might have noticed a new NOTE on R-devel when submitting a package to CRAN containing C++ code:</p><pre><code>* checking C++ specification ...
  NOTE Specified C++11: please drop specification unless essential
</code></pre><p>This NOTE is now appearing during <code>R CMD check</code> on R-devel for packages where the DESCRIPTION file has the following:</p><pre><code>SystemRequirements: C++11 
</code></pre><p>Packages that use C++11 would also usually have set <code>CXX_STD=CXX11</code> in the <code>src/Makevars</code> and <code>src/Makevars.win</code> files (and <code>src/Makevars.ucrt</code>, if present). These specifications tell R to use the C++11 standard when compiling the code.</p><p>To understand the NOTE, a bit of history will be helpful (thanks to Winston Chang for
<a href=https://gist.github.com/wch/849ca79c9416795d99c48cc06a44ca1e target=_blank rel=noopener>writing this up</a>):</p><ul><li>In R 3.5 and below, on systems with an old compiler, R would default to using the C++98 standard when compiling the code. If a package needed a C++11 compiler, the DESCRIPTION file needed to have <code>SystemRequirements: C++11</code>, and the various <code>src/Makevars*</code> files needed to set <code>CXX_STD=CXX11</code>.</li><li>In R 3.6.2, R began defaulting to compiling packages with the C++11 standard, as long as the compiler supported C++11 (which was true on most systems).</li><li>In R 4.0, C++11 became the minimum supported compiler, so <code>SystemRequirements: C++11</code> was no longer necessary.</li><li>In (the forthcoming) R 4.3, the
<a href=https://developer.r-project.org/blosxom.cgi/R-devel/NEWS/2023/01/27#n2023-01-27 target=_blank rel=noopener>default C++ standard is C++17</a> where available. <code>R CMD check</code> now
<a href=https://developer.r-project.org/blosxom.cgi/R-devel/NEWS/2023/01/31 target=_blank rel=noopener>raises a NOTE</a> if anything older than the default is specified in <code>SystemRequirements:</code> or <code>CXX_STD</code> in the various <code>src/Makevars*</code> files. This NOTE will block submission to CRAN &mdash; if the standard you specify is necessary for your package you will likely need to explain why.</li></ul><h3 id=how-to-fix-it>How to fix it
<a href=#how-to-fix-it><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><ol><li>Edit the DESCRIPTION file and remove <code>SystemRequirements: C++11</code>.</li><li>Edit <code>src/Makevars</code>, <code>src/Makevars.win</code>, and <code>src/Makevars.ucrt</code> and remove <code>CXX_STD=CXX11</code>.</li></ol><p>After making these changes, the package should install without trouble on R 3.6 and above. It may not build on R &lt;= 3.5 on systems with very old compilers, though it is likely that the vast majority of users will have a newer version of R and/or have recent enough compilers. If you want to be confident that your package will be installable on R 3.5 and below with old compilers, there are several options; we offer two of the simplest approaches here:</p><ul><li>You can use a configure script at the top level of the package, and have it add <code>CXX_STD=CXX11</code> for R 3.5 and below. An example (unmerged)
<a href=https://github.com/tidyverse/readxl/pull/722/files target=_blank rel=noopener>pull request to the readxl</a> package demonstrates this approach. You will also need to add <code>Biarch: true</code> in your DESCRIPTION file. This appears to be the approach preferred by CRAN.</li><li>For users with R &lt;= 3.5 on a system with an older compiler, package authors can instruct users to edit their <code>~/.R/Makevars</code> file to include this line: <code>CXX_STD=CXX11</code>.</li></ul><p>The tidyverse has a
<a href=https://www.tidyverse.org/blog/2019/04/r-version-support/ target=_blank rel=noopener>policy of supporting four previous versions</a> of R. Currently that includes R 3.5, but with the upcoming release of R 4.3 (which should be this Spring some time) the minimum version we will support is R 3.6. As we won&rsquo;t be supporting R 3.5 in the near future, you should not feel pressured to either.</p><h2 id=warning-regarding-the-use-of-codesprintfcode-in-cc>WARNING regarding the use of <code>sprintf()</code> in C/C++
<a href=#warning-regarding-the-use-of-codesprintfcode-in-cc><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Another recent change in CRAN checks on R-devel that authors might encounter is the disallowing of the use of the C functions <code>sprintf()</code> and <code>vsprintf()</code>. <code>R CMD check</code> on R-devel may throw warnings that look something like this:</p><pre><code>checking compiled code ... WARNING
File 'fs/libs/fs.so':
  Found 'sprintf', possibly from 'sprintf' (C)
    Object: 'file.o'
Compiled code should not call entry points which might 
terminate R nor write to stdout/stderr instead of to the 
console, nor use Fortran I/O nor system RNGs nor [v]sprintf.
See 'Writing portable packages' in the 'Writing R Extensions' manual.
</code></pre><p>According to the
<a href=https://developer.r-project.org/blosxom.cgi/R-devel/NEWS/2022/12/24#n2022-12-24 target=_blank rel=noopener>NEWS for R-devel</a> (which will be R 4.3):</p><blockquote><p>The use of sprintf and vsprintf from C/C++ has been deprecated in macOS 13 and is a known security risk. <code>R CMD check</code> now reports (on all platforms) if their use is found in compiled code: replace by snprintf or vsnprintf respectively.</p></blockquote><p>These are considered to be a security risk because they potentially allow
<a href=https://en.wikipedia.org/wiki/Buffer_overflow target=_blank rel=noopener>buffer overflows</a> that write more bytes than are available in the output buffer. This is a risk if the text that is being passed to <code>sprintf()</code> comes from an uncontrolled source.</p><p>Here is a very simple example:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=kr><a href=https://rdrr.io/r/base/library.html>library</a></span><span class=o>(</span><span class=nv><a href=https://cpp11.r-lib.org>cpp11</a></span><span class=o>)</span></span>
<span></span>
<span><span class=nf><a href=https://cpp11.r-lib.org/reference/cpp_source.html>cpp_function</a></span><span class=o>(</span><span class=s>'</span></span>
<span><span class=s>  int say_height(int height) &#123;</span></span>
<span><span class=s>    // "My height is xxx cm" is 19 characters but we need</span></span>
<span><span class=s>    // to add one for the null-terminator</span></span>
<span><span class=s>    char out[19 + 1];</span></span>
<span><span class=s>    int n;</span></span>
<span><span class=s>    n = sprintf(out, "My height is %i cm", height);</span></span>
<span><span class=s>    Rprintf(out);</span></span>
<span><span class=s>    return n;</span></span>
<span><span class=s>  &#125;</span></span>
<span><span class=s>'</span></span>
<span><span class=o>)</span></span>
<span></span>
<span><span class=nf>say_height</span><span class=o>(</span><span class=m>182</span><span class=o>)</span></span>
<span><span class=c>#&gt; My height is 182 cm</span></span>
<span></span><span><span class=c>#&gt; [1] 19</span></span>
<span></span></code></pre></div><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nf>say_height</span><span class=o>(</span><span class=m>1824</span><span class=o>)</span> <span class=c># This will abort due to buffer overflow</span></span></code></pre></div><h3 id=how-to-fix-it-1>How to fix it
<a href=#how-to-fix-it-1><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>In most cases, this should be a simple fix: replace <code>sprintf()</code> with <code>snprintf()</code> and <code>vsprintf()</code> with <code>vsnprintf()</code>. These <code>n</code> variants take a second parameter <code>size</code>, that specifies the maximum number of bytes to be written, <em>including the automatically appended null-terminator</em>. If the output is a static buffer, you can use <code>sizeof()</code>:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nf><a href=https://cpp11.r-lib.org/reference/cpp_source.html>cpp_function</a></span><span class=o>(</span><span class=s>'</span></span>
<span><span class=s>  int say_height_safely(int height) &#123;</span></span>
<span><span class=s>    // "My height is xxx cm\\n" is 20 characters but we need </span></span>
<span><span class=s>    // to add one for the null-terminator</span></span>
<span><span class=s>    char out[20 + 1];</span></span>
<span><span class=s>    int n;</span></span>
<span><span class=s>    n = snprintf(out, sizeof(out), "My height is %i cm\\n", height);</span></span>
<span><span class=s>    Rprintf(out);</span></span>
<span><span class=s>    return n;</span></span>
<span><span class=s>  &#125;</span></span>
<span><span class=s>'</span><span class=o>)</span></span>
<span></span>
<span><span class=nf>say_height_safely</span><span class=o>(</span><span class=m>182</span><span class=o>)</span></span>
<span><span class=c>#&gt; My height is 182 cm</span></span>
<span></span><span><span class=c>#&gt; [1] 20</span></span>
<span></span><span><span class=nf>say_height_safely</span><span class=o>(</span><span class=m>1824567</span><span class=o>)</span></span>
<span><span class=c>#&gt; My height is 1824567</span></span>
<span></span><span><span class=c>#&gt; [1] 24</span></span>
<span></span></code></pre></div><p>Notice that the return value of <code>sprintf()</code> and <code>snprintf()</code> are slightly different. <code>sprintf()</code> returns the total number of characters written (excluding the null-terminator), while <code>snprintf()</code> returns the length of the formatted string, whether or not it has been truncated to match <code>size</code>.</p><p>It is a bit trickier if the destination is not a static buffer, so you&rsquo;ll have to determine the maximum <code>size</code> by carefully thinking about the code.</p><h2 id=warning-regarding-the-use-of-strict-prototypes-in-c>WARNING regarding the use of strict prototypes in C
<a href=#warning-regarding-the-use-of-strict-prototypes-in-c><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Many maintainers with packages containing C code have also been getting hit with this warning:</p><pre><code>warning: a function declaration without a prototype is deprecated in all versions of C [-Wstrict-prototypes]
</code></pre><p>This usually comes from C function declarations that look like this, with no arguments specified (which is very common):</p><div class=highlight><pre class=chroma><code class=language-c data-lang=c><span class=kt>int</span> <span class=nf>myfun</span><span class=p>()</span> <span class=p>{</span>
  <span class=p>...</span>
<span class=p>};</span>
</code></pre></div><p>This new warning is because CRAN is now running checks on R-devel with the <code>-Wstrict-prototypes</code> compiler flag set. In R we define functions that take no arguments with <code>myfun &lt;- function() {...}</code> all the time. In C, with this flag set, the fact that a function takes no arguments must be explicitly stated (i.e., the arguments list cannot be empty). In the upcoming C23 standard, empty function signatures will be considered valid and not ambiguous, however at this point it is likely to be the reason you encounter this warning from CRAN.</p><h3 id=how-to-fix-it-2>How to fix it
<a href=#how-to-fix-it-2><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>This can be fixed by placing the <code>void</code> keyword in the previously empty argument list:</p><div class=highlight><pre class=chroma><code class=language-c data-lang=c><span class=kt>int</span> <span class=nf>myfun</span><span class=p>(</span><span class=kt>void</span><span class=p>)</span> <span class=p>{</span>
  <span class=p>...</span>
<span class=p>};</span>
</code></pre></div><p>Here is an example where the authors of
<a href=https://topepo.github.io/Cubist/ target=_blank rel=noopener>Cubist</a> applied the
<a href=https://github.com/topepo/Cubist/pull/46 target=_blank rel=noopener>necessary patches</a>, and
<a href=https://github.com/r-lib/rlang/pull/1508 target=_blank rel=noopener>another one in rlang</a>.</p><h3 id=vendored-code>Vendored code
<a href=#vendored-code><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>Function declarations without a prototype are very common, and unfortunately are thus likely to appear in libraries that you include in your package. This may require you to patch that code in your package. The
<a href=https://readxl.tidyverse.org target=_blank rel=noopener>readxl</a> package includes the
<a href=https://github.com/libxls/libxls target=_blank rel=noopener>libxls C library</a>, which was patched
<a href=https://github.com/tidyverse/readxl/commit/afdc9b90cfc2bb1e1c5490c7ba3af5ecfc4a7876 target=_blank rel=noopener>in readxl here</a> to deal with this issue.</p><p>The ideal solution in cases like this would be to submit patches to the upstream libraries so you don&rsquo;t have to deal with the ongoing maintenance of your local patches, but that is not always possible. Generally, you can explain this problem when submitting your package, and as long as you&rsquo;ve have notified the upstream maintainer, CRAN should accept your updated package.</p><h3 id=unspecified-types-in-function-signature>Unspecified types in function signature
<a href=#unspecified-types-in-function-signature><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>The <code>-Wstrict-prototypes</code> compiler flag will also catch deprecated function definitions where the types of the arguments are not declared. This is actually likely the primary purpose for CRAN enabling this flag, as it is ambiguous and much more dangerous than empty function signatures.</p><p>These take the form:</p><div class=highlight><pre class=chroma><code class=language-c data-lang=c><span class=kt>void</span> <span class=nf>myfun</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span> <span class=p>{</span>
  <span class=p>...</span>
<span class=p>};</span>
</code></pre></div><p>where the argument types are not declared. This is solved by declaring the types of the arguments:</p><div class=highlight><pre class=chroma><code class=language-c data-lang=c><span class=kt>void</span> <span class=nf>myfun</span><span class=p>(</span><span class=kt>int</span> <span class=n>x</span><span class=p>,</span> <span class=kt>char</span><span class=o>*</span> <span class=n>y</span><span class=p>)</span> <span class=p>{</span>
  <span class=p>...</span>
<span class=p>};</span>
</code></pre></div></div></div><div class=column25><div class="section hideOnMobile"><div class=sectionTitle>Contents</div><nav id=TableOfContents><ul><li><a href=#note-regarding-systemrequirements-c11>NOTE regarding <code>SystemRequirements: C++11</code></a></li><li><a href=#warning-regarding-the-use-of-codesprintfcode-in-cc>WARNING regarding the use of <code>sprintf()</code> in C/C++</a></li><li><a href=#warning-regarding-the-use-of-strict-prototypes-in-c>WARNING regarding the use of strict prototypes in C</a></li></ul></nav></div><div class=section></div></div></div></div></div><div id=rStudioFooter class=band><div class=bandContent><div id=copyright>The tidyverse is proudly supported by <a class=rstudioLogo href=https://posit.co/ aria-label="Posit Homepage"></a></div><div id=logos><a href=https://www.tidyverse.org/google_privacy_policy>Privacy policy</a>
<a href=https://github.com/tidyverse class="footerLogo gitHub" aria-label="Tidyverse GitHub organization"></a><a href=https://twitter.com/hashtag/rstats class="footerLogo twitter" aria-label="rstats hashtag on twitter.com"></a></div></div></div></div></div><script src=/js/math-code.js></script><script type=text/x-mathjax-config>
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    processEscapes: true
  }
});
</script><script async src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><script type=application/javascript>var dnt=(navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack);var doNotTrack=(dnt=="1"||dnt=="yes");if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');if(window.sessionStorage){var GA_SESSION_STORAGE_KEY='ga:clientId';ga('create','UA-115082821-1',{'storage':'none','clientId':sessionStorage.getItem(GA_SESSION_STORAGE_KEY)});ga(function(tracker){sessionStorage.setItem(GA_SESSION_STORAGE_KEY,tracker.get('clientId'));});}
ga('set','anonymizeIp',true);ga('send','pageview');}</script></body></html></div></div></body></html>