<!doctype html><html><head><!doctype html><html lang=en-us><link rel=stylesheet href=/css/fonts.css><link rel=stylesheet href=/css/main-site.css><link rel=stylesheet href=/css/fa5-all.css><style type=text/css>body{background-color:#fff;color:#1a1917}a{color:#38577f}a:hover{color:#42709b}a:focus{outline-color:#42709b}.column25-left .sectionTitle a:hover:not(.current),.column16-left .sectionTitle a:hover:not(.current){color:#1a1917}.icon-attribution,.icon-attribution a{color:#1a1917;opacity:75%}#homeContent .band.first{background-color:#fff}#homeContent .band.second{background-color:#fdeba4}#homeContent .band.third{background-color:#fff}#rStudioHeader{background-color:#1a162d;color:#fff}#rStudioHeader .productName{color:#fff}#rStudioHeader .productName:hover,#rStudioHeader .productName:focus{color:#fdeba4}#rStudioHeader #menu .menuItem.a{background-color:#75aadb;color:#fff}#rStudioHeader #menu .menuItem:hover{background-color:#484557;color:#fff}#rStudioHeader #menu .menuItem.current{background-color:#fff;color:#1a162d;text-decoration:none}#rStudioFooter.band{background-color:#767381}#rStudioFooter .bandContent #copyright{color:#e3eef8}table tbody tr:nth-child(even){background-color:#f7faff}table tbody tr:nth-child(odd){background-color:#fff}.latest{border-top:.5em solid <no value>}.event{-moz-box-shadow:0 0 0 0 rgba(0,0,0,.1);-webkit-box-shadow:0 0 0 0 rgba(0,0,0,.1);box-shadow:0 0 0 0 rgba(0,0,0,.1)}.section .event{background-color:#eab0c41a}.section .event{border-top:7pt solid #a19ea936}.section .event a{color:#1a162d}.section .event{color:#404040}</style><link rel=stylesheet href=/css/tidyverse.css><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Hugo 0.71.1"><title>httr2 1.0.0</title><meta property="og:title" content="httr2 1.0.0"><meta property="og:description" content="httr2 is the successor to httr, providing a pipeable interface to generate HTTP requests and handle the responses. It's focussed on the needs of an R user wrapping a modern web API, but is flexible enough to handle just about any HTTP related task."><meta property="og:type" content="article"><meta property="og:url" content="https://www.tidyverse.org/blog/2023/11/httr2-1-0-0/"><meta property="twitter:card" content="summary_large_image"><meta property="og:title" content="httr2 1.0.0 - Tidyverse"><meta property="description" content="httr2 is the successor to httr, providing a pipeable interface to generate HTTP requests and handle the responses. It's focussed on the needs of an R user wrapping a modern web API, but is flexible enough to handle just about any HTTP related task."><meta property="og:description" content="httr2 is the successor to httr, providing a pipeable interface to generate HTTP requests and handle the responses. It's focussed on the needs of an R user wrapping a modern web API, but is flexible enough to handle just about any HTTP related task."><meta property="og:image" content="https://www.tidyverse.org/blog/2023/11/httr2-1-0-0/thumbnail-sq.jpg"><meta name=twitter:image content="https://www.tidyverse.org/blog/2023/11/httr2-1-0-0/thumbnail-wd.jpg"><link rel=apple-touch-icon sizes=180x180 href=/images/favicons/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/images/favicons/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/images/favicons/favicon-16x16.png><link rel=manifest href=/images/favicons/site.webmanifest><link rel=mask-icon href=/images/favicons/safari-pinned-tab.svg><link rel="shortcut icon" href=/images/favicons/favicon.ico><meta name=msapplication-TileColor content="#da532c"><meta name=msapplication-config href=/images/favicons/browserconfig.xml><script type=text/javascript src=/js/jquery-3.5.1.min.js></script><script type=text/javascript src=/js/site.js></script><link rel=icon href=/images/favicon.ico><script type=text/javascript src=/js/clipboard.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin=anonymous></script><script defer data-domain=tidyverse.org,all.tidyverse.org src=https://plausible.io/js/plausible.js></script></head><body><div id=appTidyverseSite class="shrinkHeader alwaysShrinkHeader"><div id=main><div id=rStudioHeader><nav class=band><div class="innards bandContent"><div><a class=productName href=/%20/>Tidyverse</a></div><div id=menu><div id=menuToggler></div><div id=menuItems><a class=menuItem href=/packages/>Packages</a>
<a class="menuItem current" href=/blog/>Blog</a>
<a class=menuItem href=/learn/>Learn</a>
<a class=menuItem href=/help/>Help</a>
<a class=menuItem href=/contribute/>Contribute</a></div></div></div></nav></div><main><div class="band padForHeader pushFooter"><div class=bandContent><div class="full splitColumns withMobileMargins"><div class=column75><h1 class=article-title>httr2 1.0.0</h1><div class=article-header aria-hidden=true><div class=photo><img src=/blog/2023/11/httr2-1-0-0/thumbnail-wd.jpg></div><div class=photoCredit>Photo by <a href=https://unsplash.com/photos/xKShyIiTNJk>Mike Bowman</a></div></div><span class=article-date><i class="fas fa-calendar-day fa-fw"></i>&nbsp;&nbsp;2023/11/14</span><p style=margin-bottom:.5em;margin-top:.85em><i class="fas fa-tags"></i>&nbsp;
<a href=/tags/httr2/>httr2</a>,
<a href=/tags/httr/>httr</a></p><p style=margin-top:.5em><i class="fas fa-user-circle fa-fw"></i>&nbsp;
Hadley Wickham</p><div class=article-content><p>We&rsquo;re delighted to announce the release of
<a href=https://httr2.r-lib.org target=_blank rel=noopener>httr2</a><sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> 1.0.0. httr2 is the second generation of httr: it helps you generate HTTP requests and process the responses, designed with an eye towards modern web APIs and potentially putting your code in a package.</p><p>You can install it from CRAN with:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nf><a href=https://rdrr.io/r/utils/install.packages.html>install.packages</a></span><span class=o>(</span><span class=s>"httr2"</span><span class=o>)</span></span></code></pre></div><p>httr2 has been under development for the last two years, but this is the first time we&rsquo;ve blogged about it because we&rsquo;ve been waiting until the user interface felt stable. It now does, and we&rsquo;re ready to encourage you to use httr2 whenever you need to talk to a web server. Most importantly httr2 is now a &ldquo;real&rdquo; package because it has a wonderful new logo, thanks to a collaborative effort involving Julie Jung, Greg Swineheart, and DALLâ€¢E 3.</p><div class=highlight><p><img src=httr2.png alt='The new httr2 logo is a dark blue hexagon with httr2 written in bright white at the top of logo. Underneath the text is a vibrant magenta baseball player hitting a ball emblazoned with the letters "www".' width=200px style=display:block;margin:auto></p></div><p>httr2 is the successor to httr. The biggest difference is that it has an explicit request object which you can build up over multiple function calls. This makes the interface fit more naturally with the pipe, and generally makes life easier because you can iteratively build up a complex request. httr2 also builds on the 10 years of package development experience we&rsquo;ve accrued since creating httr, so it should all around be more enjoyable to use. If you&rsquo;re a current httr user, there&rsquo;s no need to switch, as we&rsquo;ll continue to maintain the package for many years to come, but if you start on a new project, I&rsquo;d recommend that you give httr2 a shot.</p><p>If you&rsquo;ve been following httr2 development for a while, you might want to jump to the
<a href=https://github.com/r-lib/httr2/releases/tag/v1.0.0 target=_blank rel=noopener>release notes</a> to see what&rsquo;s new (a lot!). The most important change in this release is that
<a href=https://github.com/mgirlich target=_blank rel=noopener>Maximilian Girlich</a> is now a httr2 author, in recognition of his many contributions to the package. This release also features improved tools for performing multiple requests (more on that below) and a bunch of bug fixes and minor improvements for OAuth.</p><p>For the rest of this blog post, I&rsquo;ll assume that you&rsquo;re familiar with the basics of HTTP. If you&rsquo;re not, you might want to start with <code>vignette("httr2")</code> which introduces you to HTTP using httr2.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=kr><a href=https://rdrr.io/r/base/library.html>library</a></span><span class=o>(</span><span class=nv><a href=https://httr2.r-lib.org>httr2</a></span><span class=o>)</span></span></code></pre></div><h2 id=making-a-request>Making a request
<a href=#making-a-request><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>httr2 is designed around the two big pieces of HTTP: requests and responses. First you&rsquo;ll create a request, with a URL:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>req</span> <span class=o>&lt;-</span> <span class=nf><a href=https://httr2.r-lib.org/reference/request.html>request</a></span><span class=o>(</span><span class=nf><a href=https://httr2.r-lib.org/reference/example_url.html>example_url</a></span><span class=o>(</span><span class=o>)</span><span class=o>)</span></span>
<span><span class=nv>req</span></span>
<span><span class=c>#&gt; <span style=color:#00b>&lt;httr2_request&gt;</span></span></span>
<span></span><span><span class=c>#&gt; <span style=font-weight:700>GET</span> http://127.0.0.1:51981/</span></span>
<span></span><span><span class=c>#&gt; <span style=font-weight:700>Body</span>: empty</span></span>
<span></span></code></pre></div><p>Instead of using an external website, here we&rsquo;re using a test server that&rsquo;s built in to httr2. This ensures that this blog post, and many httr2 examples, work independently from the rest of the internet.</p><p>You can see the HTTP request that httr2 will send, without actually sending it<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>, by doing a dry run:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>req</span> <span class=o>|&gt;</span> <span class=nf><a href=https://httr2.r-lib.org/reference/req_dry_run.html>req_dry_run</a></span><span class=o>(</span><span class=o>)</span></span>
<span><span class=c>#&gt; GET / HTTP/1.1</span></span>
<span><span class=c>#&gt; <span style=font-weight:700>Host</span>: 127.0.0.1:51981</span></span>
<span><span class=c>#&gt; <span style=font-weight:700>User-Agent</span>: httr2/0.2.3.9000 r-curl/5.1.0 libcurl/8.1.2</span></span>
<span><span class=c>#&gt; <span style=font-weight:700>Accept</span>: */*</span></span>
<span><span class=c>#&gt; <span style=font-weight:700>Accept-Encoding</span>: deflate, gzip</span></span>
<span></span></code></pre></div><p>As you can see, this request object will perform a simple <code>GET</code> request with automatic user agent and accept headers.</p><p>To make more complex requests, you modify the request object with functions that start with <code>req_</code>. For example, you could make it a <code>HEAD</code> request, with some query parameters, and a custom user agent:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>req</span> <span class=o>|&gt;</span> </span>
<span>  <span class=nf><a href=https://httr2.r-lib.org/reference/req_url.html>req_url_query</a></span><span class=o>(</span>param <span class=o>=</span> <span class=s>"value"</span><span class=o>)</span> <span class=o>|&gt;</span> </span>
<span>  <span class=nf><a href=https://httr2.r-lib.org/reference/req_user_agent.html>req_user_agent</a></span><span class=o>(</span><span class=s>"My user agent"</span><span class=o>)</span> <span class=o>|&gt;</span> </span>
<span>  <span class=nf><a href=https://httr2.r-lib.org/reference/req_method.html>req_method</a></span><span class=o>(</span><span class=s>"HEAD"</span><span class=o>)</span> <span class=o>|&gt;</span> </span>
<span>  <span class=nf><a href=https://httr2.r-lib.org/reference/req_dry_run.html>req_dry_run</a></span><span class=o>(</span><span class=o>)</span></span>
<span><span class=c>#&gt; HEAD /?param=value HTTP/1.1</span></span>
<span><span class=c>#&gt; <span style=font-weight:700>Host</span>: 127.0.0.1:51981</span></span>
<span><span class=c>#&gt; <span style=font-weight:700>User-Agent</span>: My user agent</span></span>
<span><span class=c>#&gt; <span style=font-weight:700>Accept</span>: */*</span></span>
<span><span class=c>#&gt; <span style=font-weight:700>Accept-Encoding</span>: deflate, gzip</span></span>
<span></span></code></pre></div><p>Or you could send some JSON in the body of the request:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>req</span> <span class=o>|&gt;</span> </span>
<span>  <span class=nf><a href=https://httr2.r-lib.org/reference/req_body.html>req_body_json</a></span><span class=o>(</span><span class=nf><a href=https://rdrr.io/r/base/list.html>list</a></span><span class=o>(</span>x <span class=o>=</span> <span class=m>1</span>, y <span class=o>=</span> <span class=s>"a"</span><span class=o>)</span><span class=o>)</span> <span class=o>|&gt;</span> </span>
<span>  <span class=nf><a href=https://httr2.r-lib.org/reference/req_dry_run.html>req_dry_run</a></span><span class=o>(</span><span class=o>)</span></span>
<span><span class=c>#&gt; POST / HTTP/1.1</span></span>
<span><span class=c>#&gt; <span style=font-weight:700>Host</span>: 127.0.0.1:51981</span></span>
<span><span class=c>#&gt; <span style=font-weight:700>User-Agent</span>: httr2/0.2.3.9000 r-curl/5.1.0 libcurl/8.1.2</span></span>
<span><span class=c>#&gt; <span style=font-weight:700>Accept</span>: */*</span></span>
<span><span class=c>#&gt; <span style=font-weight:700>Accept-Encoding</span>: deflate, gzip</span></span>
<span><span class=c>#&gt; <span style=font-weight:700>Content-Type</span>: application/json</span></span>
<span><span class=c>#&gt; <span style=font-weight:700>Content-Length</span>: 15</span></span>
<span><span class=c>#&gt; </span></span>
<span><span class=c>#&gt; &#123;"x":1,"y":"a"&#125;</span></span>
<span></span></code></pre></div><p>httr2 provides a
<a href=https://httr2.r-lib.org/dev/reference/index.html#requests target=_blank rel=noopener>wide range of <code>req_</code> function</a> to customise the request in common ways; if there&rsquo;s something you need that httr2 doesn&rsquo;t support, please
<a href=https://github.com/r-lib/httr2/issues/new target=_blank rel=noopener>file an issue</a>!</p><h2 id=performing-the-request-and-handling-the-response>Performing the request and handling the response
<a href=#performing-the-request-and-handling-the-response><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Once you have a request that you are happy with, you can send it to the server with
<a href=https://httr2.r-lib.org/reference/req_perform.html target=_blank rel=noopener><code>req_perform()</code></a>:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>req_json</span> <span class=o>&lt;-</span> <span class=nv>req</span> <span class=o>|&gt;</span> <span class=nf><a href=https://httr2.r-lib.org/reference/req_url.html>req_url_path</a></span><span class=o>(</span><span class=s>"/json"</span><span class=o>)</span></span>
<span><span class=nv>resp</span> <span class=o>&lt;-</span> <span class=nv>req_json</span> <span class=o>|&gt;</span> <span class=nf><a href=https://httr2.r-lib.org/reference/req_perform.html>req_perform</a></span><span class=o>(</span><span class=o>)</span></span></code></pre></div><p>Performing a request will return a response object (or throw an error, which we&rsquo;ll talk about next). You can see the basic details of the request by printing it or you can see the raw response with
<a href=https://httr2.r-lib.org/reference/resp_raw.html target=_blank rel=noopener><code>resp_raw()</code></a><sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup>:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>resp</span></span>
<span><span class=c>#&gt; <span style=color:#00b>&lt;httr2_response&gt;</span></span></span>
<span></span><span><span class=c>#&gt; <span style=font-weight:700>GET</span> http://127.0.0.1:51981/json</span></span>
<span></span><span><span class=c>#&gt; <span style=color:#0b0>Status</span>: 200 OK</span></span>
<span></span><span><span class=c>#&gt; <span style=color:#0b0>Content-Type</span>: application/json</span></span>
<span></span><span><span class=c>#&gt; <span style=color:#0b0>Body</span>: In memory (407 bytes)</span></span>
<span></span><span></span>
<span><span class=nv>resp</span> <span class=o>|&gt;</span> <span class=nf><a href=https://httr2.r-lib.org/reference/resp_raw.html>resp_raw</a></span><span class=o>(</span><span class=o>)</span></span>
<span><span class=c>#&gt; HTTP/1.1 200 OK</span></span>
<span><span class=c>#&gt; <span style=font-weight:700>Connection</span>: close</span></span>
<span><span class=c>#&gt; <span style=font-weight:700>Date</span>: Tue, 14 Nov 2023 14:41:32 GMT</span></span>
<span><span class=c>#&gt; <span style=font-weight:700>Content-Type</span>: application/json</span></span>
<span><span class=c>#&gt; <span style=font-weight:700>Content-Length</span>: 407</span></span>
<span><span class=c>#&gt; <span style=font-weight:700>ETag</span>: "de760e6d"</span></span>
<span><span class=c>#&gt; </span></span>
<span><span class=c>#&gt; &#123;</span></span>
<span><span class=c>#&gt;   "firstName": "John",</span></span>
<span><span class=c>#&gt;   "lastName": "Smith",</span></span>
<span><span class=c>#&gt;   "isAlive": true,</span></span>
<span><span class=c>#&gt;   "age": 27,</span></span>
<span><span class=c>#&gt;   "address": &#123;</span></span>
<span><span class=c>#&gt;     "streetAddress": "21 2nd Street",</span></span>
<span><span class=c>#&gt;     "city": "New York",</span></span>
<span><span class=c>#&gt;     "state": "NY",</span></span>
<span><span class=c>#&gt;     "postalCode": "10021-3100"</span></span>
<span><span class=c>#&gt;   &#125;,</span></span>
<span><span class=c>#&gt;   "phoneNumbers": [</span></span>
<span><span class=c>#&gt;     &#123;</span></span>
<span><span class=c>#&gt;       "type": "home",</span></span>
<span><span class=c>#&gt;       "number": "212 555-1234"</span></span>
<span><span class=c>#&gt;     &#125;,</span></span>
<span><span class=c>#&gt;     &#123;</span></span>
<span><span class=c>#&gt;       "type": "office",</span></span>
<span><span class=c>#&gt;       "number": "646 555-4567"</span></span>
<span><span class=c>#&gt;     &#125;</span></span>
<span><span class=c>#&gt;   ],</span></span>
<span><span class=c>#&gt;   "children": [],</span></span>
<span><span class=c>#&gt;   "spouse": null</span></span>
<span><span class=c>#&gt; &#125;</span></span>
<span></span></code></pre></div><p>But generally, you&rsquo;ll want to use the <code>resp_</code> functions to extract parts of the response for further processing. For example, you could parse the JSON body into an R data structure:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>resp</span> <span class=o>|&gt;</span> </span>
<span>  <span class=nf><a href=https://httr2.r-lib.org/reference/resp_body_raw.html>resp_body_json</a></span><span class=o>(</span><span class=o>)</span> <span class=o>|&gt;</span> </span>
<span>  <span class=nf><a href=https://rdrr.io/r/utils/str.html>str</a></span><span class=o>(</span><span class=o>)</span></span>
<span><span class=c>#&gt; List of 8</span></span>
<span><span class=c>#&gt;  $ firstName   : chr "John"</span></span>
<span><span class=c>#&gt;  $ lastName    : chr "Smith"</span></span>
<span><span class=c>#&gt;  $ isAlive     : logi TRUE</span></span>
<span><span class=c>#&gt;  $ age         : int 27</span></span>
<span><span class=c>#&gt;  $ address     :List of 4</span></span>
<span><span class=c>#&gt;   ..$ streetAddress: chr "21 2nd Street"</span></span>
<span><span class=c>#&gt;   ..$ city         : chr "New York"</span></span>
<span><span class=c>#&gt;   ..$ state        : chr "NY"</span></span>
<span><span class=c>#&gt;   ..$ postalCode   : chr "10021-3100"</span></span>
<span><span class=c>#&gt;  $ phoneNumbers:List of 2</span></span>
<span><span class=c>#&gt;   ..$ :List of 2</span></span>
<span><span class=c>#&gt;   .. ..$ type  : chr "home"</span></span>
<span><span class=c>#&gt;   .. ..$ number: chr "212 555-1234"</span></span>
<span><span class=c>#&gt;   ..$ :List of 2</span></span>
<span><span class=c>#&gt;   .. ..$ type  : chr "office"</span></span>
<span><span class=c>#&gt;   .. ..$ number: chr "646 555-4567"</span></span>
<span><span class=c>#&gt;  $ children    : list()</span></span>
<span><span class=c>#&gt;  $ spouse      : NULL</span></span>
<span></span></code></pre></div><p>Or get the value of a header:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>resp</span> <span class=o>|&gt;</span> <span class=nf><a href=https://httr2.r-lib.org/reference/resp_headers.html>resp_header</a></span><span class=o>(</span><span class=s>"Content-Length"</span><span class=o>)</span></span>
<span><span class=c>#&gt; [1] "407"</span></span>
<span></span></code></pre></div><h2 id=error-handling>Error handling
<a href=#error-handling><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>You can use
<a href=https://httr2.r-lib.org/reference/resp_status.html target=_blank rel=noopener><code>resp_status()</code></a> to see the returned status:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>resp</span> <span class=o>|&gt;</span> <span class=nf><a href=https://httr2.r-lib.org/reference/resp_status.html>resp_status</a></span><span class=o>(</span><span class=o>)</span></span>
<span><span class=c>#&gt; [1] 200</span></span>
<span></span></code></pre></div><p>But this will almost always be 200, because httr2 automatically follows redirects (statuses in the 300s) and turns HTTP failures (statuses in the 400s and 500s) into R errors. The following example shows what error handling looks like using an example endpoint that returns a response with the status defined in the URL:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>req</span> <span class=o>|&gt;</span> </span>
<span>  <span class=nf><a href=https://httr2.r-lib.org/reference/req_url.html>req_url_path</a></span><span class=o>(</span><span class=s>"/status/404"</span><span class=o>)</span> <span class=o>|&gt;</span> </span>
<span>  <span class=nf><a href=https://httr2.r-lib.org/reference/req_perform.html>req_perform</a></span><span class=o>(</span><span class=o>)</span></span>
<span><span class=c>#&gt; <span style=color:#bb0;font-weight:700>Error</span><span style=font-weight:700> in `req_perform()`:</span></span></span>
<span><span class=c>#&gt; <span style=color:#bb0>!</span> HTTP 404 Not Found.</span></span>
<span></span><span></span>
<span><span class=nv>req</span> <span class=o>|&gt;</span> </span>
<span>  <span class=nf><a href=https://httr2.r-lib.org/reference/req_url.html>req_url_path</a></span><span class=o>(</span><span class=s>"/status/500"</span><span class=o>)</span> <span class=o>|&gt;</span> </span>
<span>  <span class=nf><a href=https://httr2.r-lib.org/reference/req_perform.html>req_perform</a></span><span class=o>(</span><span class=o>)</span></span>
<span><span class=c>#&gt; <span style=color:#bb0;font-weight:700>Error</span><span style=font-weight:700> in `req_perform()`:</span></span></span>
<span><span class=c>#&gt; <span style=color:#bb0>!</span> HTTP 500 Internal Server Error.</span></span>
<span></span></code></pre></div><p>Turning HTTP failures into R errors can make debugging hard, so httr2 provides the
<a href=https://httr2.r-lib.org/reference/last_response.html target=_blank rel=noopener><code>last_request()</code></a> and
<a href=https://httr2.r-lib.org/reference/last_response.html target=_blank rel=noopener><code>last_response()</code></a> helpers which you can use to figure out what went wrong:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nf><a href=https://httr2.r-lib.org/reference/last_response.html>last_request</a></span><span class=o>(</span><span class=o>)</span></span>
<span><span class=c>#&gt; <span style=color:#00b>&lt;httr2_request&gt;</span></span></span>
<span></span><span><span class=c>#&gt; <span style=font-weight:700>GET</span> http://127.0.0.1:51981/status/500</span></span>
<span></span><span><span class=c>#&gt; <span style=font-weight:700>Body</span>: empty</span></span>
<span></span><span></span>
<span><span class=nf><a href=https://httr2.r-lib.org/reference/last_response.html>last_response</a></span><span class=o>(</span><span class=o>)</span></span>
<span><span class=c>#&gt; <span style=color:#00b>&lt;httr2_response&gt;</span></span></span>
<span></span><span><span class=c>#&gt; <span style=font-weight:700>GET</span> http://127.0.0.1:51981/status/500</span></span>
<span></span><span><span class=c>#&gt; <span style=color:#0b0>Status</span>: 500 Internal Server Error</span></span>
<span></span><span><span class=c>#&gt; <span style=color:#0b0>Content-Type</span>: text/plain</span></span>
<span></span><span><span class=c>#&gt; <span style=color:#0b0>Body</span>: None</span></span>
<span></span></code></pre></div><p>httr2 provides two other tools to customise error handling:</p><ul><li><a href=https://httr2.r-lib.org/reference/req_error.html target=_blank rel=noopener><code>req_error()</code></a> gives you full control over what responses should be turned into R errors, and allows you to add additional information to the error message.</li><li><a href=https://httr2.r-lib.org/reference/req_retry.html target=_blank rel=noopener><code>req_retry()</code></a> helps deal with transient errors, where you need to wait a bit and try again. For example, many APIs are rate limited and will return a 429 status if you have made too many requests.</li></ul><p>You can learn more about both of these functions in &ldquo;
<a href=https://httr2.r-lib.org/articles/wrapping-apis.html target=_blank rel=noopener>Wrapping APIs</a>&rdquo; as they are particularly important when creating an R package (or script) that wraps a web API.</p><h2 id=control-the-request-process>Control the request process
<a href=#control-the-request-process><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>There are a number of other <code>req_</code> functions that don&rsquo;t directly affect the HTTP request but instead control the overall process of submitting a request and handling the response. These include:</p><ul><li><p><a href=https://httr2.r-lib.org/reference/req_cache.html target=_blank rel=noopener><code>req_cache()</code></a>, which sets up a cache so if repeated requests return the same results, and you can avoid a trip to the server.</p></li><li><p><a href=https://httr2.r-lib.org/reference/req_throttle.html target=_blank rel=noopener><code>req_throttle()</code></a>, which automatically adds a small delay before each request so you can avoid hammering a server with many requests.</p></li><li><p><a href=https://httr2.r-lib.org/reference/req_progress.html target=_blank rel=noopener><code>req_progress()</code></a>, which adds a progress bar for long downloads or uploads.</p></li><li><p><a href=https://httr2.r-lib.org/reference/req_cookie_preserve.html target=_blank rel=noopener><code>req_cookie_preserve()</code></a>, which lets you preserve cookies across requests.</p></li></ul><p>Additionally, httr2 provides rich support for authenticating with OAuth, implementing many more OAuth flows than httr. You&rsquo;ve probably used OAuth a bunch without knowing what it&rsquo;s called: you use it when you login to a non-Google website using your Google account, when you give your phone access to your twitter account, or when you login to a streaming app on your smart TV. OAuth is a big, complex, topic, and is documented in &ldquo;
<a href=https://httr2.r-lib.org/articles/oauth.html target=_blank rel=noopener>OAuth</a>".</p><h2 id=multiple-requests>Multiple requests
<a href=#multiple-requests><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>httr2 includes three functions to perform multiple requests:</p><ul><li><p><a href=https://httr2.r-lib.org/reference/req_perform_sequential.html target=_blank rel=noopener><code>req_perform_sequential()</code></a> takes a list of requests and performs them one at a time.</p></li><li><p><a href=https://httr2.r-lib.org/reference/req_perform_parallel.html target=_blank rel=noopener><code>req_perform_parallel()</code></a> takes a list of requests and performs them in parallel (up to 6 at a time by default). It&rsquo;s similar to
<a href=https://httr2.r-lib.org/reference/req_perform_sequential.html target=_blank rel=noopener><code>req_perform_sequential()</code></a>, but is obviously faster, at the expense of potentially hammering a server. It also has some limitations: most importantly it can&rsquo;t refresh an expired OAuth token and it doesn&rsquo;t respect
<a href=https://httr2.r-lib.org/reference/req_retry.html target=_blank rel=noopener><code>req_retry()</code></a> or
<a href=https://httr2.r-lib.org/reference/req_throttle.html target=_blank rel=noopener><code>req_throttle()</code></a>.</p></li><li><p><a href=https://httr2.r-lib.org/reference/req_perform_iterative.html target=_blank rel=noopener><code>req_perform_iterative()</code></a> takes a single request and a callback function to generate the next request from previous response. It&rsquo;ll keep going until the callback function returns <code>NULL</code> or <code>max_reqs</code> requests have been performed. This is very useful for paginated APIs that only tell you the URL for the <em>next</em> page.</p></li></ul><p>For example, imagine we wanted to download each person from the
<a href=https://swapi.dev target=_blank rel=noopener>Star Wars API</a>. The URLs have a very consistent structure so we can generate a bunch of them, then create the corresponding requests:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>urls</span> <span class=o>&lt;-</span> <span class=nf><a href=https://rdrr.io/r/base/paste.html>paste0</a></span><span class=o>(</span><span class=s>"https://swapi.dev/api/people/"</span>, <span class=m>1</span><span class=o>:</span><span class=m>10</span><span class=o>)</span></span>
<span><span class=nv>reqs</span> <span class=o>&lt;-</span> <span class=nf><a href=https://rdrr.io/r/base/lapply.html>lapply</a></span><span class=o>(</span><span class=nv>urls</span>, <span class=nv>request</span><span class=o>)</span></span></code></pre></div><p>Now I can perform those requests, collecting a list of responses:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>resps</span> <span class=o>&lt;-</span> <span class=nf><a href=https://httr2.r-lib.org/reference/req_perform_sequential.html>req_perform_sequential</a></span><span class=o>(</span><span class=nv>reqs</span><span class=o>)</span></span>
<span><span class=c>#&gt; Iterating <span style=color:#0b0>â– â– â– â–                             </span>  10% | ETA: 40s</span></span>
<span></span><span><span class=c>#&gt; Iterating <span style=color:#0b0>â– â– â– â– â– â– â–                          </span>  20% | ETA:  3m</span></span>
<span></span><span><span class=c>#&gt; Iterating <span style=color:#0b0>â– â– â– â– â– â– â– â– â– â–                       </span>  30% | ETA:  2m</span></span>
<span></span><span><span class=c>#&gt; Iterating <span style=color:#0b0>â– â– â– â– â– â– â– â– â– â– â– â– â–                    </span>  40% | ETA:  1m</span></span>
<span></span><span><span class=c>#&gt; Iterating <span style=color:#0b0>â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â–                 </span>  50% | ETA: 46s</span></span>
<span></span><span><span class=c>#&gt; Iterating <span style=color:#0b0>â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â–              </span>  60% | ETA: 33s</span></span>
<span></span><span><span class=c>#&gt; Iterating <span style=color:#0b0>â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â–           </span>  70% | ETA: 22s</span></span>
<span></span><span><span class=c>#&gt; Iterating <span style=color:#0b0>â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â–        </span>  80% | ETA: 13s</span></span>
<span></span><span><span class=c>#&gt; Iterating <span style=color:#0b0>â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â–     </span>  90% | ETA:  6s</span></span>
<span></span><span><span class=c>#&gt; Iterating <span style=color:#0b0>â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â– â–  </span> 100% | ETA:  0s</span></span>
<span></span></code></pre></div><p>These responses contain their data in a JSON body:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>resps</span> <span class=o>|&gt;</span> </span>
<span>  <span class=nv>_</span><span class=o>[[</span><span class=m>1</span><span class=o>]</span><span class=o>]</span> <span class=o>|&gt;</span> </span>
<span>  <span class=nf><a href=https://httr2.r-lib.org/reference/resp_body_raw.html>resp_body_json</a></span><span class=o>(</span><span class=o>)</span> <span class=o>|&gt;</span> </span>
<span>  <span class=nf><a href=https://rdrr.io/r/utils/str.html>str</a></span><span class=o>(</span><span class=o>)</span></span>
<span><span class=c>#&gt; List of 16</span></span>
<span><span class=c>#&gt;  $ name      : chr "Luke Skywalker"</span></span>
<span><span class=c>#&gt;  $ height    : chr "172"</span></span>
<span><span class=c>#&gt;  $ mass      : chr "77"</span></span>
<span><span class=c>#&gt;  $ hair_color: chr "blond"</span></span>
<span><span class=c>#&gt;  $ skin_color: chr "fair"</span></span>
<span><span class=c>#&gt;  $ eye_color : chr "blue"</span></span>
<span><span class=c>#&gt;  $ birth_year: chr "19BBY"</span></span>
<span><span class=c>#&gt;  $ gender    : chr "male"</span></span>
<span><span class=c>#&gt;  $ homeworld : chr "https://swapi.dev/api/planets/1/"</span></span>
<span><span class=c>#&gt;  $ films     :List of 4</span></span>
<span><span class=c>#&gt;   ..$ : chr "https://swapi.dev/api/films/1/"</span></span>
<span><span class=c>#&gt;   ..$ : chr "https://swapi.dev/api/films/2/"</span></span>
<span><span class=c>#&gt;   ..$ : chr "https://swapi.dev/api/films/3/"</span></span>
<span><span class=c>#&gt;   ..$ : chr "https://swapi.dev/api/films/6/"</span></span>
<span><span class=c>#&gt;  $ species   : list()</span></span>
<span><span class=c>#&gt;  $ vehicles  :List of 2</span></span>
<span><span class=c>#&gt;   ..$ : chr "https://swapi.dev/api/vehicles/14/"</span></span>
<span><span class=c>#&gt;   ..$ : chr "https://swapi.dev/api/vehicles/30/"</span></span>
<span><span class=c>#&gt;  $ starships :List of 2</span></span>
<span><span class=c>#&gt;   ..$ : chr "https://swapi.dev/api/starships/12/"</span></span>
<span><span class=c>#&gt;   ..$ : chr "https://swapi.dev/api/starships/22/"</span></span>
<span><span class=c>#&gt;  $ created   : chr "2014-12-09T13:50:51.644000Z"</span></span>
<span><span class=c>#&gt;  $ edited    : chr "2014-12-20T21:17:56.891000Z"</span></span>
<span><span class=c>#&gt;  $ url       : chr "https://swapi.dev/api/people/1/"</span></span>
<span></span></code></pre></div><p>There&rsquo;s lots of ways to deal with this sort of data (e.g.Â for loops or functional programming) but to make life easier, httr2 comes with its own helper,
<a href=https://httr2.r-lib.org/reference/resps_successes.html target=_blank rel=noopener><code>resps_data()</code></a>. This function takes a callback that retrieves the data for each response, then concatenates all the data into a single object. In this case, we need to wrap
<a href=https://httr2.r-lib.org/reference/resp_body_raw.html target=_blank rel=noopener><code>resp_body_json()</code></a> in a list, so we get one list for each person, rather than one list in total:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>resps</span> <span class=o>|&gt;</span> </span>
<span>  <span class=nf><a href=https://httr2.r-lib.org/reference/resps_successes.html>resps_data</a></span><span class=o>(</span>\<span class=o>(</span><span class=nv>resp</span><span class=o>)</span> <span class=nf><a href=https://rdrr.io/r/base/list.html>list</a></span><span class=o>(</span><span class=nf><a href=https://httr2.r-lib.org/reference/resp_body_raw.html>resp_body_json</a></span><span class=o>(</span><span class=nv>resp</span><span class=o>)</span><span class=o>)</span><span class=o>)</span> <span class=o>|&gt;</span> </span>
<span>  <span class=nv>_</span><span class=o>[</span><span class=m>1</span><span class=o>:</span><span class=m>3</span><span class=o>]</span> <span class=o>|&gt;</span> </span>
<span>  <span class=nf><a href=https://rdrr.io/r/utils/str.html>str</a></span><span class=o>(</span>list.len <span class=o>=</span> <span class=m>10</span><span class=o>)</span></span>
<span><span class=c>#&gt; List of 3</span></span>
<span><span class=c>#&gt;  $ :List of 16</span></span>
<span><span class=c>#&gt;   ..$ name      : chr "Luke Skywalker"</span></span>
<span><span class=c>#&gt;   ..$ height    : chr "172"</span></span>
<span><span class=c>#&gt;   ..$ mass      : chr "77"</span></span>
<span><span class=c>#&gt;   ..$ hair_color: chr "blond"</span></span>
<span><span class=c>#&gt;   ..$ skin_color: chr "fair"</span></span>
<span><span class=c>#&gt;   ..$ eye_color : chr "blue"</span></span>
<span><span class=c>#&gt;   ..$ birth_year: chr "19BBY"</span></span>
<span><span class=c>#&gt;   ..$ gender    : chr "male"</span></span>
<span><span class=c>#&gt;   ..$ homeworld : chr "https://swapi.dev/api/planets/1/"</span></span>
<span><span class=c>#&gt;   ..$ films     :List of 4</span></span>
<span><span class=c>#&gt;   .. ..$ : chr "https://swapi.dev/api/films/1/"</span></span>
<span><span class=c>#&gt;   .. ..$ : chr "https://swapi.dev/api/films/2/"</span></span>
<span><span class=c>#&gt;   .. ..$ : chr "https://swapi.dev/api/films/3/"</span></span>
<span><span class=c>#&gt;   .. ..$ : chr "https://swapi.dev/api/films/6/"</span></span>
<span><span class=c>#&gt;   .. [list output truncated]</span></span>
<span><span class=c>#&gt;  $ :List of 16</span></span>
<span><span class=c>#&gt;   ..$ name      : chr "C-3PO"</span></span>
<span><span class=c>#&gt;   ..$ height    : chr "167"</span></span>
<span><span class=c>#&gt;   ..$ mass      : chr "75"</span></span>
<span><span class=c>#&gt;   ..$ hair_color: chr "n/a"</span></span>
<span><span class=c>#&gt;   ..$ skin_color: chr "gold"</span></span>
<span><span class=c>#&gt;   ..$ eye_color : chr "yellow"</span></span>
<span><span class=c>#&gt;   ..$ birth_year: chr "112BBY"</span></span>
<span><span class=c>#&gt;   ..$ gender    : chr "n/a"</span></span>
<span><span class=c>#&gt;   ..$ homeworld : chr "https://swapi.dev/api/planets/1/"</span></span>
<span><span class=c>#&gt;   ..$ films     :List of 6</span></span>
<span><span class=c>#&gt;   .. ..$ : chr "https://swapi.dev/api/films/1/"</span></span>
<span><span class=c>#&gt;   .. ..$ : chr "https://swapi.dev/api/films/2/"</span></span>
<span><span class=c>#&gt;   .. ..$ : chr "https://swapi.dev/api/films/3/"</span></span>
<span><span class=c>#&gt;   .. ..$ : chr "https://swapi.dev/api/films/4/"</span></span>
<span><span class=c>#&gt;   .. ..$ : chr "https://swapi.dev/api/films/5/"</span></span>
<span><span class=c>#&gt;   .. ..$ : chr "https://swapi.dev/api/films/6/"</span></span>
<span><span class=c>#&gt;   .. [list output truncated]</span></span>
<span><span class=c>#&gt;  $ :List of 16</span></span>
<span><span class=c>#&gt;   ..$ name      : chr "R2-D2"</span></span>
<span><span class=c>#&gt;   ..$ height    : chr "96"</span></span>
<span><span class=c>#&gt;   ..$ mass      : chr "32"</span></span>
<span><span class=c>#&gt;   ..$ hair_color: chr "n/a"</span></span>
<span><span class=c>#&gt;   ..$ skin_color: chr "white, blue"</span></span>
<span><span class=c>#&gt;   ..$ eye_color : chr "red"</span></span>
<span><span class=c>#&gt;   ..$ birth_year: chr "33BBY"</span></span>
<span><span class=c>#&gt;   ..$ gender    : chr "n/a"</span></span>
<span><span class=c>#&gt;   ..$ homeworld : chr "https://swapi.dev/api/planets/8/"</span></span>
<span><span class=c>#&gt;   ..$ films     :List of 6</span></span>
<span><span class=c>#&gt;   .. ..$ : chr "https://swapi.dev/api/films/1/"</span></span>
<span><span class=c>#&gt;   .. ..$ : chr "https://swapi.dev/api/films/2/"</span></span>
<span><span class=c>#&gt;   .. ..$ : chr "https://swapi.dev/api/films/3/"</span></span>
<span><span class=c>#&gt;   .. ..$ : chr "https://swapi.dev/api/films/4/"</span></span>
<span><span class=c>#&gt;   .. ..$ : chr "https://swapi.dev/api/films/5/"</span></span>
<span><span class=c>#&gt;   .. ..$ : chr "https://swapi.dev/api/films/6/"</span></span>
<span><span class=c>#&gt;   .. [list output truncated]</span></span>
<span></span></code></pre></div><p>Another option would be to convert each response into a data frame or tibble. That&rsquo;s a little tricky here because of the nested lists that will need to become list-columns<sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup>, so we&rsquo;ll avoid that challenge here by focussing on the first nine columns:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>sw_data</span> <span class=o>&lt;-</span> <span class=kr>function</span><span class=o>(</span><span class=nv>resp</span><span class=o>)</span> <span class=o>&#123;</span></span>
<span>  <span class=nf>tibble</span><span class=nf>::</span><span class=nf><a href=https://tibble.tidyverse.org/reference/as_tibble.html>as_tibble</a></span><span class=o>(</span><span class=nf><a href=https://httr2.r-lib.org/reference/resp_body_raw.html>resp_body_json</a></span><span class=o>(</span><span class=nv>resp</span><span class=o>)</span><span class=o>[</span><span class=m>1</span><span class=o>:</span><span class=m>9</span><span class=o>]</span><span class=o>)</span></span>
<span><span class=o>&#125;</span></span>
<span><span class=nv>resps</span> <span class=o>|&gt;</span> <span class=nf><a href=https://httr2.r-lib.org/reference/resps_successes.html>resps_data</a></span><span class=o>(</span><span class=nv>sw_data</span><span class=o>)</span></span>
<span><span class=c>#&gt; <span style=color:#555># A tibble: 10 Ã— 9</span></span></span>
<span><span class=c>#&gt;    <span style=font-weight:700>name</span>           <span style=font-weight:700>height</span> <span style=font-weight:700>mass</span>  <span style=font-weight:700>hair_color</span> <span style=font-weight:700>skin_color</span> <span style=font-weight:700>eye_color</span> <span style=font-weight:700>birth_year</span> <span style=font-weight:700>gender</span></span></span>
<span><span class=c>#&gt;    <span style=color:#555;font-style:italic>&lt;chr&gt;</span>          <span style=color:#555;font-style:italic>&lt;chr&gt;</span>  <span style=color:#555;font-style:italic>&lt;chr&gt;</span> <span style=color:#555;font-style:italic>&lt;chr&gt;</span>      <span style=color:#555;font-style:italic>&lt;chr&gt;</span>      <span style=color:#555;font-style:italic>&lt;chr&gt;</span>     <span style=color:#555;font-style:italic>&lt;chr&gt;</span>      <span style=color:#555;font-style:italic>&lt;chr&gt;</span> </span></span>
<span><span class=c>#&gt; <span style=color:#555> 1</span> Luke Skywalker 172    77    blond      fair       blue      19BBY      male  </span></span>
<span><span class=c>#&gt; <span style=color:#555> 2</span> C-3PO          167    75    n/a        gold       yellow    112BBY     n/a   </span></span>
<span><span class=c>#&gt; <span style=color:#555> 3</span> R2-D2          96     32    n/a        white, blâ€¦ red       33BBY      n/a   </span></span>
<span><span class=c>#&gt; <span style=color:#555> 4</span> Darth Vader    202    136   none       white      yellow    41.9BBY    male  </span></span>
<span><span class=c>#&gt; <span style=color:#555> 5</span> Leia Organa    150    49    brown      light      brown     19BBY      female</span></span>
<span><span class=c>#&gt; <span style=color:#555> 6</span> Owen Lars      178    120   brown, grâ€¦ light      blue      52BBY      male  </span></span>
<span><span class=c>#&gt; <span style=color:#555> 7</span> Beru Whitesunâ€¦ 165    75    brown      light      blue      47BBY      female</span></span>
<span><span class=c>#&gt; <span style=color:#555> 8</span> R5-D4          97     32    n/a        white, red red       unknown    n/a   </span></span>
<span><span class=c>#&gt; <span style=color:#555> 9</span> Biggs Darkligâ€¦ 183    84    black      light      brown     24BBY      male  </span></span>
<span><span class=c>#&gt; <span style=color:#555>10</span> Obi-Wan Kenobi 182    77    auburn, wâ€¦ fair       blue-gray 57BBY      male  </span></span>
<span><span class=c>#&gt; <span style=color:#555># â„¹ 1 more variable: </span><span style=color:#555;font-weight:700>homeworld</span><span style=color:#555> &lt;chr&gt;</span></span></span>
<span></span></code></pre></div><p>When you&rsquo;re performing large numbers of requests, it&rsquo;s almost inevitable that something will go wrong. By default, all three functions will bubble up errors, causing you to lose all of the work that&rsquo;s been done so far. You can, however, use the <code>on_error</code> argument to change what happens, either ignoring errors, or returning when you hit the first error. This will changes the return value: instead of a list of responses, the list might now also contain error objects. httr2 provides other helpers to work with this object:</p><ul><li><a href=https://httr2.r-lib.org/reference/resps_successes.html target=_blank rel=noopener><code>resps_successes()</code></a> filters the list to find the successful responses. You&rsquo;ll can then pair this with
<a href=https://httr2.r-lib.org/reference/resps_successes.html target=_blank rel=noopener><code>resps_data()</code></a> to get the data from the successful request.</li><li><a href=https://httr2.r-lib.org/reference/resps_successes.html target=_blank rel=noopener><code>resps_failures()</code></a> filters the list to find the failed responses. You&rsquo;ll can then pair this with
<a href=https://httr2.r-lib.org/reference/resps_successes.html target=_blank rel=noopener><code>resps_requests()</code></a> to find the requests that generated them and figure out what went wrong,.</li></ul><h2 id=acknowledgements>Acknowledgements
<a href=#acknowledgements><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>A big thanks to all 87 folks who have helped make httr2 possible!</p><p><a href=https://github.com/allenbaron target=_blank rel=noopener>@allenbaron</a>,
<a href=https://github.com/asadow target=_blank rel=noopener>@asadow</a>,
<a href=https://github.com/atheriel target=_blank rel=noopener>@atheriel</a>,
<a href=https://github.com/boshek target=_blank rel=noopener>@boshek</a>,
<a href=https://github.com/casa-henrym target=_blank rel=noopener>@casa-henrym</a>,
<a href=https://github.com/cderv target=_blank rel=noopener>@cderv</a>,
<a href=https://github.com/colmanhumphrey target=_blank rel=noopener>@colmanhumphrey</a>,
<a href=https://github.com/cstjohn810 target=_blank rel=noopener>@cstjohn810</a>,
<a href=https://github.com/cwang23 target=_blank rel=noopener>@cwang23</a>,
<a href=https://github.com/DavidRLovell target=_blank rel=noopener>@DavidRLovell</a>,
<a href=https://github.com/DMerch target=_blank rel=noopener>@DMerch</a>,
<a href=https://github.com/dpprdan target=_blank rel=noopener>@dpprdan</a>,
<a href=https://github.com/ECOSchulz target=_blank rel=noopener>@ECOSchulz</a>,
<a href=https://github.com/edavidaja target=_blank rel=noopener>@edavidaja</a>,
<a href=https://github.com/elipousson target=_blank rel=noopener>@elipousson</a>,
<a href=https://github.com/emmansh target=_blank rel=noopener>@emmansh</a>,
<a href=https://github.com/Enchufa2 target=_blank rel=noopener>@Enchufa2</a>,
<a href=https://github.com/ErdaradunGaztea target=_blank rel=noopener>@ErdaradunGaztea</a>,
<a href=https://github.com/fangzhou-xie target=_blank rel=noopener>@fangzhou-xie</a>,
<a href=https://github.com/fh-mthomson target=_blank rel=noopener>@fh-mthomson</a>,
<a href=https://github.com/fkohrt target=_blank rel=noopener>@fkohrt</a>,
<a href=https://github.com/flahn target=_blank rel=noopener>@flahn</a>,
<a href=https://github.com/gregleleu target=_blank rel=noopener>@gregleleu</a>,
<a href=https://github.com/guga31bb target=_blank rel=noopener>@guga31bb</a>,
<a href=https://github.com/gvelasq target=_blank rel=noopener>@gvelasq</a>,
<a href=https://github.com/hadley target=_blank rel=noopener>@hadley</a>,
<a href=https://github.com/hongooi73 target=_blank rel=noopener>@hongooi73</a>,
<a href=https://github.com/howardbaek target=_blank rel=noopener>@howardbaek</a>,
<a href=https://github.com/jameslairdsmith target=_blank rel=noopener>@jameslairdsmith</a>,
<a href=https://github.com/JBGruber target=_blank rel=noopener>@JBGruber</a>,
<a href=https://github.com/jchrom target=_blank rel=noopener>@jchrom</a>,
<a href=https://github.com/jemus42 target=_blank rel=noopener>@jemus42</a>,
<a href=https://github.com/jennybc target=_blank rel=noopener>@jennybc</a>,
<a href=https://github.com/jimrothstein target=_blank rel=noopener>@jimrothstein</a>,
<a href=https://github.com/jjesusfilho target=_blank rel=noopener>@jjesusfilho</a>,
<a href=https://github.com/jjfantini target=_blank rel=noopener>@jjfantini</a>,
<a href=https://github.com/jl5000 target=_blank rel=noopener>@jl5000</a>,
<a href=https://github.com/jonthegeek target=_blank rel=noopener>@jonthegeek</a>,
<a href=https://github.com/JosiahParry target=_blank rel=noopener>@JosiahParry</a>,
<a href=https://github.com/judith-bourque target=_blank rel=noopener>@judith-bourque</a>,
<a href=https://github.com/juliasilge target=_blank rel=noopener>@juliasilge</a>,
<a href=https://github.com/kasperwelbers target=_blank rel=noopener>@kasperwelbers</a>,
<a href=https://github.com/kelvindso target=_blank rel=noopener>@kelvindso</a>,
<a href=https://github.com/kieran-mace target=_blank rel=noopener>@kieran-mace</a>,
<a href=https://github.com/KoderKow target=_blank rel=noopener>@KoderKow</a>,
<a href=https://github.com/lassehjorthmadsen target=_blank rel=noopener>@lassehjorthmadsen</a>,
<a href=https://github.com/llrs target=_blank rel=noopener>@llrs</a>,
<a href=https://github.com/lyndon-bird target=_blank rel=noopener>@lyndon-bird</a>,
<a href=https://github.com/m-mohr target=_blank rel=noopener>@m-mohr</a>,
<a href=https://github.com/maelle target=_blank rel=noopener>@maelle</a>,
<a href=https://github.com/maxheld83 target=_blank rel=noopener>@maxheld83</a>,
<a href=https://github.com/mgirlich target=_blank rel=noopener>@mgirlich</a>,
<a href=https://github.com/MichaelChirico target=_blank rel=noopener>@MichaelChirico</a>,
<a href=https://github.com/michaelgfalk target=_blank rel=noopener>@michaelgfalk</a>,
<a href=https://github.com/misea target=_blank rel=noopener>@misea</a>,
<a href=https://github.com/MislavSag target=_blank rel=noopener>@MislavSag</a>,
<a href=https://github.com/mkoohafkan target=_blank rel=noopener>@mkoohafkan</a>,
<a href=https://github.com/mmuurr target=_blank rel=noopener>@mmuurr</a>,
<a href=https://github.com/multimeric target=_blank rel=noopener>@multimeric</a>,
<a href=https://github.com/nbenn target=_blank rel=noopener>@nbenn</a>,
<a href=https://github.com/nclsbarreto target=_blank rel=noopener>@nclsbarreto</a>,
<a href=https://github.com/nealrichardson target=_blank rel=noopener>@nealrichardson</a>,
<a href=https://github.com/Nelson-Gon target=_blank rel=noopener>@Nelson-Gon</a>,
<a href=https://github.com/olivroy target=_blank rel=noopener>@olivroy</a>,
<a href=https://github.com/owenjonesuob target=_blank rel=noopener>@owenjonesuob</a>,
<a href=https://github.com/paul-carteron target=_blank rel=noopener>@paul-carteron</a>,
<a href=https://github.com/pbulsink target=_blank rel=noopener>@pbulsink</a>,
<a href=https://github.com/ramiromagno target=_blank rel=noopener>@ramiromagno</a>,
<a href=https://github.com/rplati target=_blank rel=noopener>@rplati</a>,
<a href=https://github.com/rressler target=_blank rel=noopener>@rressler</a>,
<a href=https://github.com/samterfa target=_blank rel=noopener>@samterfa</a>,
<a href=https://github.com/schnee target=_blank rel=noopener>@schnee</a>,
<a href=https://github.com/sckott target=_blank rel=noopener>@sckott</a>,
<a href=https://github.com/sebastian-c target=_blank rel=noopener>@sebastian-c</a>,
<a href=https://github.com/selesnow target=_blank rel=noopener>@selesnow</a>,
<a href=https://github.com/Shaunson26 target=_blank rel=noopener>@Shaunson26</a>,
<a href=https://github.com/SokolovAnatoliy target=_blank rel=noopener>@SokolovAnatoliy</a>,
<a href=https://github.com/spotrh target=_blank rel=noopener>@spotrh</a>,
<a href=https://github.com/stefanedwards target=_blank rel=noopener>@stefanedwards</a>,
<a href=https://github.com/taerwin target=_blank rel=noopener>@taerwin</a>,
<a href=https://github.com/vanhry target=_blank rel=noopener>@vanhry</a>,
<a href=https://github.com/wing328 target=_blank rel=noopener>@wing328</a>,
<a href=https://github.com/xinzhuohkust target=_blank rel=noopener>@xinzhuohkust</a>,
<a href=https://github.com/yogat3ch target=_blank rel=noopener>@yogat3ch</a>,
<a href=https://github.com/yogesh-bansal target=_blank rel=noopener>@yogesh-bansal</a>,
<a href=https://github.com/yutannihilation target=_blank rel=noopener>@yutannihilation</a>, and
<a href=https://github.com/zacdav-db target=_blank rel=noopener>@zacdav-db</a>.</p><section class=footnotes role=doc-endnotes><hr><ol><li id=fn:1 role=doc-endnote><p>Pronounced &ldquo;hitter 2&rdquo;. <a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2 role=doc-endnote><p>Well, technically, it does send the request, just to another test server that returns the request that it received. <a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3 role=doc-endnote><p>This is only an approximation. For example, it only shows the final response if there were redirects, and it automatically uncompresses the body if it was compressed. Nevertheless, it&rsquo;s still pretty useful. <a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4 role=doc-endnote><p>To turn these into list-columns, you need to wrap each list in another list, something like <code>is_list &lt;- map_lgl(json, is.list); json[is_list] &lt;- map(json[is_list], list)</code>. This ensures that each element has length 1, the invariant for a row in a tibble. <a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></section></div></div><div class=column25><div class="section hideOnMobile"><div class=sectionTitle>Contents</div><nav id=TableOfContents><ul><li><a href=#making-a-request>Making a request</a></li><li><a href=#performing-the-request-and-handling-the-response>Performing the request and handling the response</a></li><li><a href=#error-handling>Error handling</a></li><li><a href=#control-the-request-process>Control the request process</a></li><li><a href=#multiple-requests>Multiple requests</a></li><li><a href=#acknowledgements>Acknowledgements</a></li></ul></nav></div><div class=section></div></div></div></div></div><div id=rStudioFooter class=band><div class=bandContent><div id=copyright>The tidyverse is proudly supported by <a class=rstudioLogo href=https://posit.co/ aria-label="Posit Homepage"></a></div><div id=logos><a href=https://www.tidyverse.org/google_privacy_policy>Privacy policy</a>
<a href=https://github.com/tidyverse class="footerLogo gitHub" aria-label="Tidyverse GitHub organization"></a><a href=https://twitter.com/hashtag/rstats class="footerLogo twitter" aria-label="rstats hashtag on twitter.com"></a></div></div></div></div></div><script src=/js/math-code.js></script><script type=text/x-mathjax-config>
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    processEscapes: true
  }
});
</script><script async src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><script type=application/javascript>var dnt=(navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack);var doNotTrack=(dnt=="1"||dnt=="yes");if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');if(window.sessionStorage){var GA_SESSION_STORAGE_KEY='ga:clientId';ga('create','UA-115082821-1',{'storage':'none','clientId':sessionStorage.getItem(GA_SESSION_STORAGE_KEY)});ga(function(tracker){sessionStorage.setItem(GA_SESSION_STORAGE_KEY,tracker.get('clientId'));});}
ga('set','anonymizeIp',true);ga('send','pageview');}</script></body></html></div></div></body></html>