<!doctype html><html><head><!doctype html><html lang=en-us><link rel=stylesheet href=/css/fonts.css><link rel=stylesheet href=/css/main-site.css><link rel=stylesheet href=/css/fa5-all.css><style type=text/css>body{background-color:#fff;color:#1a1917}a{color:#38577f}a:hover{color:#42709b}a:focus{outline-color:#42709b}.column25-left .sectionTitle a:hover:not(.current),.column16-left .sectionTitle a:hover:not(.current){color:#1a1917}.icon-attribution,.icon-attribution a{color:#1a1917;opacity:75%}#homeContent .band.first{background-color:#fff}#homeContent .band.second{background-color:#fdeba4}#homeContent .band.third{background-color:#fff}#rStudioHeader{background-color:#1a162d;color:#fff}#rStudioHeader .productName{color:#fff}#rStudioHeader .productName:hover,#rStudioHeader .productName:focus{color:#fdeba4}#rStudioHeader #menu .menuItem.a{background-color:#75aadb;color:#fff}#rStudioHeader #menu .menuItem:hover{background-color:#484557;color:#fff}#rStudioHeader #menu .menuItem.current{background-color:#fff;color:#1a162d;text-decoration:none}#rStudioFooter.band{background-color:#767381}#rStudioFooter .bandContent #copyright{color:#e3eef8}table tbody tr:nth-child(even){background-color:#f7faff}table tbody tr:nth-child(odd){background-color:#fff}.latest{border-top:.5em solid <no value>}.event{-moz-box-shadow:0 0 0 0 rgba(0,0,0,.1);-webkit-box-shadow:0 0 0 0 rgba(0,0,0,.1);box-shadow:0 0 0 0 rgba(0,0,0,.1)}.section .event{background-color:#eab0c41a}.section .event{border-top:7pt solid #a19ea936}.section .event a{color:#1a162d}.section .event{color:#404040}</style><link rel=stylesheet href=/css/tidyverse.css><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Hugo 0.71.1"><title>Package spring cleaning</title><meta property="og:title" content="Package spring cleaning"><meta property="og:description" content="When Spring comes around, it's time to embark on some Spring Cleaning to take care of the package maintenance tasks  that you never seem to get around to. This post outlines the processes and tools that the tidyverse team uses to make  this job fun and efficient."><meta property="og:type" content="article"><meta property="og:url" content="https://www.tidyverse.org/blog/2023/06/spring-cleaning-2023/"><meta property="twitter:card" content="summary_large_image"><meta property="og:title" content="Package spring cleaning - Tidyverse"><meta property="description" content="When Spring comes around, it's time to embark on some Spring Cleaning to take care of the package maintenance tasks  that you never seem to get around to. This post outlines the processes and tools that the tidyverse team uses to make  this job fun and efficient."><meta property="og:description" content="When Spring comes around, it's time to embark on some Spring Cleaning to take care of the package maintenance tasks  that you never seem to get around to. This post outlines the processes and tools that the tidyverse team uses to make  this job fun and efficient."><meta property="og:image" content="https://www.tidyverse.org/blog/2023/06/spring-cleaning-2023/thumbnail-sq.jpg"><meta name=twitter:image content="https://www.tidyverse.org/blog/2023/06/spring-cleaning-2023/thumbnail-wd.jpg"><link rel=apple-touch-icon sizes=180x180 href=/images/favicons/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/images/favicons/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/images/favicons/favicon-16x16.png><link rel=manifest href=/images/favicons/site.webmanifest><link rel=mask-icon href=/images/favicons/safari-pinned-tab.svg><link rel="shortcut icon" href=/images/favicons/favicon.ico><meta name=msapplication-TileColor content="#da532c"><meta name=msapplication-config href=/images/favicons/browserconfig.xml><script type=text/javascript src=/js/jquery-3.5.1.min.js></script><script type=text/javascript src=/js/site.js></script><link rel=icon href=/images/favicon.ico><script type=text/javascript src=/js/clipboard.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin=anonymous></script><script defer data-domain=tidyverse.org,all.tidyverse.org src=https://plausible.io/js/plausible.js></script></head><body><div id=appTidyverseSite class="shrinkHeader alwaysShrinkHeader"><div id=main><div id=rStudioHeader><nav class=band><div class="innards bandContent"><div><a class=productName href=/>Tidyverse</a></div><div id=menu><div id=menuToggler></div><div id=menuItems><a class=menuItem href=/packages/>Packages</a>
<a class="menuItem current" href=/blog/>Blog</a>
<a class=menuItem href=/learn/>Learn</a>
<a class=menuItem href=/help/>Help</a>
<a class=menuItem href=/contribute/>Contribute</a></div></div></div></nav></div><main><div class="band padForHeader pushFooter"><div class=bandContent><div class="full splitColumns withMobileMargins"><div class=column75><h1 class=article-title>Package spring cleaning</h1><div class=article-header aria-hidden=true><div class=photo><img src=/blog/2023/06/spring-cleaning-2023/thumbnail-wd.jpg></div><div class=photoCredit>Photo by <a href=https://unsplash.com/photos/urUdKCxsTUI>Anthony Delanoix</a></div></div><span class=article-date><i class="fas fa-calendar-day fa-fw"></i>&nbsp;&nbsp;2023/06/07</span><p style=margin-bottom:.5em;margin-top:.85em><i class="fas fa-tags"></i>&nbsp;
<a href=/tags/package-maintenance/>package maintenance</a>,
<a href=/tags/spring-cleaning/>spring cleaning</a></p><p style=margin-top:.5em><i class="fas fa-user-circle fa-fw"></i>&nbsp;
Andy Teucher</p><div class=article-content><style>p.caption{color:#696969;font-style:italic}</style><p>When Spring arrives in the Northern hemisphere, the sun&rsquo;s rays reach into the dark corners and illuminate the dust that has been gathering over the winter. This is when our thoughts start to turn to Spring cleaning &mdash; a time to clear out the clutter that has accumulated over the past year. It represents a fresh start and a new beginning, and leaves us feeling rejuvenated and ready to take on the rest of the year. This applies not only to our homes, but also to the code that we maintain &mdash; there are often bits and pieces that we know need attention but never seem to make it to the top of the priority list.</p><p>Doing this kind of work isn&rsquo;t necessarily only about adopting good practices or increasing the quality of your code &mdash; it can also be about adding value through standardization. Most developers only work sporadically on a particular package. For some it&rsquo;s because they work on a lot of packages, while for many it&rsquo;s because package development is not their main job. When you return to a package after a long gap, there is potential for a lot of friction (and dread/procrastination) as you get re-oriented to its idiosyncrasies. Making the occasional pass through your packages and looking for opportunities to adopt current, shared practices can make it easier to dip in and out of different packages.</p><p>The tidyverse team at Posit has a practice of tackling Spring Cleaning together - we set aside a week every year to work in a semi-structured way to efficiently take care of a common list of package maintenance tasks. We find that setting a time for them and doing them all together during one week is an effective, and more fun, way to get them done. We recently completed our 2023 Spring Cleaning and thought it might be fun to share our process.</p><p>I&rsquo;ll also show off a new feature we&rsquo;ve built in to the
<a href=https://usethis.r-lib.org/news/index.html#usethis-220 target=_blank rel=noopener>latest version of usethis</a> that will help you organize your own Spring Cleaning. Feel free to
<a href=#spring-cleaning-and-you>jump straight there</a> if you want to skip the back story (don&rsquo;t you wish recipe blogs had this feature?).</p><h2 id=preparation>Preparation
<a href=#preparation><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Early in the new year, we set aside the time in our calendars for Spring Cleaning &mdash; this way everyone knows that it&rsquo;s coming up and can make sure they have cleared the space in their schedules (and their minds) to focus on it.</p><p>We prepare for the week by creating a list of things we want to take care of in our packages. Rather than adding features or fixing bugs, these tasks are usually about bringing things up to current standards or best practices, and include things like updating tests to the latest testthat version, updating pkgdown templates, and adding alt-text to images in pkgdown sites. Not surprisingly, this year a lot of the upkeep was related to our
<a href=https://posit.co/blog/rstudio-is-now-posit/ target=_blank rel=noopener>recent rebrand from RStudio to Posit</a> &mdash; things like updating the copyright holder and author email addresses, and using updated logos without the old rstudio.com website on them.</p><p>We start off the week with a kickoff meeting on Monday morning. We go through the checklist with everybody and refine what&rsquo;s in it, making sure everybody has had input. Because we maintain so many packages, we have a spreadsheet where we keep track of the packages that are undergoing spring cleaning, and people can assign themselves to packages and mark them as completed when they&rsquo;re done.</p><h2 id=checklists-checklists-checklists>Checklists, checklists, checklists
<a href=#checklists-checklists-checklists><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>We formalize these tasks into a checklist (
<a href=https://atulgawande.com/book/the-checklist-manifesto/ target=_blank rel=noopener>who doesn&rsquo;t love checklists</a>) via a tidyverse-focused function in usethis called <code>use_tidy_upkeep_issue()</code>. If you&rsquo;re a package developer and you use
<a href=https://usethis.r-lib.org/reference/use_release_issue.html target=_blank rel=noopener><code>use_release_issue()</code></a>, this will look familiar: it opens an issue in the package&rsquo;s GitHub repository with a checklist of tasks to guide us through what needs to be done to bring it up to current tidyverse standards. We update the function with the current year&rsquo;s checklist just prior to starting (and sometimes during) Spring Cleaning.</p><p>Package maintainers then install the development version of usethis to get the current checklist, and call <code>usethis::use_tidy_upkeep_issue()</code> in their package to create the issue. If there are any tasks that aren&rsquo;t relevant to that particular repo it&rsquo;s easy to just edit the issue and remove it. To be really meta, here is the 2023 Spring Cleaning
<a href=https://github.com/r-lib/usethis/issues/1791 target=_blank rel=noopener>upkeep issue for usethis</a>, created by usethis:</p><div class=highlight><div class=figure style=text-align:center><p><a href=https://github.com/r-lib/usethis/issues/1791 target=_blank><img src=img/usethis-upkeep-issue.png alt="2023 Upkeep Issue for usethis" width=700px></a></p><p class=caption>2023 Upkeep Issue for usethis</p></div></div><p>We separated the tasks into &ldquo;Necessary&rdquo; and &ldquo;Optional&rdquo;. The necessary tasks were those we needed to complete for all of our packages, and also were simple enough that we could be sure we would able to complete them. The optional items were those that were nice to have, and/or would take longer to complete. We try to complete the work, including reviewing and merging any related
<a href=https://github.com/tidymodels/dials/pull/275 target=_blank rel=noopener>pull requests</a>, all within the week, with the intention of closing the upkeep issue by Friday.</p><h2 id=wrapup>Wrapup
<a href=#wrapup><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Finally, we end the week with a wrap-up meeting - we do a retrospective on what worked, what didn&rsquo;t, and what we would change for next time. For example, we found that a couple of items on this year&rsquo;s checklist that were too complex to complete within the week, especially across many repos. So we decided to start a practice of converting those &ldquo;too big&rdquo; tasks into issues of their own &mdash; you can see an example in the
<a href=https://github.com/r-lib/testthat/issues/1749 target=_blank rel=noopener>testthat upkeep issue</a>. This makes it more likely that we can cleanly complete the checklist but still flag those lingering things we would like to finish.</p><p>We also try to have a little fun during the wrap-up meeting! I made a small R package called
<a href=https://github.com/ateucher/chatrbox target=_blank rel=noopener>chatrbox</a> that uses
<a href=https://openai.com/blog/chatgpt target=_blank rel=noopener>ChatGPT</a> to generate R-themed Spring Cleaning text snippets. And Tracy Teal used
<a href=https://quarto.org/ target=_blank rel=noopener>quarto</a> to make certificates of achievement for each of us, complete with inspirational messages made with chatrbox!</p><div class=highlight><p><img src=img/george-certificate.png alt='A certificate of excellence in Spring Cleaning for George Stagg, with AI-generated text in the form of a tweet about software licensing in the style of Shakespeare. The generated text says: "Of software fair, be wary and take heed, For licensing terms doth often mislead. Choose wisely, lest thou shouldst freely bruise." #SoftwareLicensing #ShakespeareanTweets' width=700px style=display:block;margin:auto></p></div><h2 id=spring-cleaning-and-you>Spring cleaning and you!
<a href=#spring-cleaning-and-you><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>In
<a href=https://usethis.r-lib.org/news/index.html#usethis-220 target=_blank rel=noopener>version 2.2.0 of usethis</a>, we have created a general purpose
<a href=https://usethis.r-lib.org/reference/use_upkeep_issue.html target=_blank rel=noopener><code>use_upkeep_issue()</code></a> function for package authors to use if they wish to do a Spring Cleaning of their own. It is a fairly opinionated list of tasks but we believe taking care of them will generally make your package better, easier to maintain, and more enjoyable for your users. Some of the tasks are meant to be performed only once (and once completed shouldn&rsquo;t show up in subsequent lists), and some should be reviewed periodically. If you want to include additional tasks, you can add an (unexported) function named <code>upkeep_bullets()</code> to your own package that returns a character vector of tasks. These will be added to your upkeep checklist.</p><p>Here is an example of an upkeep issue I created for my package rmapshaper. I created an internal function <code>upkeep_bullets()</code> in the package, with an extra bullet I wanted to add to the upkeep issue:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>upkeep_bullets</span> <span class=o>&lt;-</span> <span class=kr>function</span><span class=o>(</span><span class=o>)</span> <span class=s>"Update bundled mapshaper node library."</span></span></code></pre></div><p>And then called <code>use_upkeep_issue()</code> in my rmapshaper package directory:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nf>devtools</span><span class=nf>::</span><span class=nf><a href=https://devtools.r-lib.org/reference/load_all.html>load_all</a></span><span class=o>(</span><span class=o>)</span></span>
<span><span class=c>#&gt; ℹ Loading rmapshaper</span></span>
<span><span class=nf>usethis</span><span class=nf>::</span><span class=nf><a href=https://usethis.r-lib.org/reference/use_upkeep_issue.html>use_upkeep_issue</a></span><span class=o>(</span><span class=o>)</span></span>
<span><span class=c>#&gt; ✔ Setting active project to '/Users/andyteucher/dev/ateucher/rmapshaper'</span></span>
<span><span class=c>#&gt; • Open URL 'https://github.com/ateucher/rmapshaper/issues/160'</span></span></code></pre></div><div class=highlight><div class=figure style=text-align:center><p><a href=https://github.com/ateucher/rmapshaper/issues/160 target=_blank><img src=img/rmapshaper-upkeep-issue.png alt="Upkeep issue for rmapshaper" width=700px></a></p><p class=caption>Upkeep issue for rmapshaper</p></div></div><p>In a fun confluence of events, while working on this post I attended an
<a href=https://ropensci.org/events/coworking-2023-05/ target=_blank rel=noopener>rOpenSci coworking session</a> where the topic of the day was spring cleaning! We chatted about the benefits of regular upkeep, and what types of tasks make good spring cleaning issues. It was really inspiring and validating to connect with other people tackling maintenance like this.</p><p>We hope that this will provide a starting point, and motivate you to take care of those nagging maintenance issues, whether it be in the Spring (whenever that is in your part of the world), or any other time of the year. We&rsquo;d love to hear if you find this helpful, or if there&rsquo;s a way that it could be better, please
<a href=https://github.com/r-lib/usethis/issues target=_blank rel=noopener>let us know</a>.</p></div></div><div class=column25><div class="section hideOnMobile"><div class=sectionTitle>Contents</div><nav id=TableOfContents><ul><li><a href=#preparation>Preparation</a></li><li><a href=#checklists-checklists-checklists>Checklists, checklists, checklists</a></li><li><a href=#wrapup>Wrapup</a></li><li><a href=#spring-cleaning-and-you>Spring cleaning and you!</a></li></ul></nav></div><div class=section></div></div></div></div></div><div id=rStudioFooter class=band><div class=bandContent><div id=copyright>The tidyverse is proudly supported by <a class=rstudioLogo href=https://posit.co/ aria-label="Posit Homepage"></a></div><div id=logos><a href=https://www.tidyverse.org/google_privacy_policy>Privacy policy</a>
<a href=https://github.com/tidyverse class="footerLogo gitHub" aria-label="Tidyverse GitHub organization"></a><a href=https://twitter.com/hashtag/rstats class="footerLogo twitter" aria-label="rstats hashtag on twitter.com"></a></div></div></div></div></div><script type=application/javascript>var dnt=(navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack);var doNotTrack=(dnt=="1"||dnt=="yes");if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');if(window.sessionStorage){var GA_SESSION_STORAGE_KEY='ga:clientId';ga('create','UA-115082821-1',{'storage':'none','clientId':sessionStorage.getItem(GA_SESSION_STORAGE_KEY)});ga(function(tracker){sessionStorage.setItem(GA_SESSION_STORAGE_KEY,tracker.get('clientId'));});}
ga('set','anonymizeIp',true);ga('send','pageview');}</script></body></html></div></div></body></html>