<!doctype html><html><head><!doctype html><html lang=en-us><link rel=stylesheet href=/css/fonts.css><link rel=stylesheet href=/css/main-site.css><link rel=stylesheet href=/css/fa5-all.css><style type=text/css>body{background-color:#fff;color:#1a1917}a{color:#38577f}a:hover{color:#42709b}a:focus{outline-color:#42709b}.column25-left .sectionTitle a:hover:not(.current),.column16-left .sectionTitle a:hover:not(.current){color:#1a1917}.icon-attribution,.icon-attribution a{color:#1a1917;opacity:75%}#homeContent .band.first{background-color:#fff}#homeContent .band.second{background-color:#fdeba4}#homeContent .band.third{background-color:#fff}#rStudioHeader{background-color:#1a162d;color:#fff}#rStudioHeader .productName{color:#fff}#rStudioHeader .productName:hover,#rStudioHeader .productName:focus{color:#fdeba4}#rStudioHeader #menu .menuItem.a{background-color:#75aadb;color:#fff}#rStudioHeader #menu .menuItem:hover{background-color:#484557;color:#fff}#rStudioHeader #menu .menuItem.current{background-color:#fff;color:#1a162d;text-decoration:none}#rStudioFooter.band{background-color:#767381}#rStudioFooter .bandContent #copyright{color:#e3eef8}table tbody tr:nth-child(even){background-color:#f7faff}table tbody tr:nth-child(odd){background-color:#fff}.latest{border-top:.5em solid <no value>}.event{-moz-box-shadow:0 0 0 0 rgba(0,0,0,.1);-webkit-box-shadow:0 0 0 0 rgba(0,0,0,.1);box-shadow:0 0 0 0 rgba(0,0,0,.1)}.section .event{background-color:#eab0c41a}.section .event{border-top:7pt solid #a19ea936}.section .event a{color:#1a162d}.section .event{color:#404040}</style><link rel=stylesheet href=/css/tidyverse.css><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Hugo 0.71.1"><title>WebAssembly roundup part 1: webR 0.4.2</title><meta property="og:title" content="WebAssembly roundup part 1: webR 0.4.2"><meta property="og:description" content="First in a series of blog posts about what's new in R for WebAssembly. The latest release of webR 0.4.2 is now available, with updates to the viewer mechanism, support for displaying htmlwidgets, an IndexedDB virtual filesystem driver, and improved packaging for WebAssembly R binaries."><meta property="og:type" content="article"><meta property="og:url" content="https://www.tidyverse.org/blog/2024/10/webr-0-4-2/"><meta property="twitter:card" content="summary_large_image"><meta property="og:title" content="WebAssembly roundup part 1: webR 0.4.2 - Tidyverse"><meta property="description" content="First in a series of blog posts about what's new in R for WebAssembly. The latest release of webR 0.4.2 is now available, with updates to the viewer mechanism, support for displaying htmlwidgets, an IndexedDB virtual filesystem driver, and improved packaging for WebAssembly R binaries."><meta property="og:description" content="First in a series of blog posts about what's new in R for WebAssembly. The latest release of webR 0.4.2 is now available, with updates to the viewer mechanism, support for displaying htmlwidgets, an IndexedDB virtual filesystem driver, and improved packaging for WebAssembly R binaries."><meta property="og:image" content="https://www.tidyverse.org/blog/2024/10/webr-0-4-2/thumbnail-sq.jpg"><meta name=twitter:image content="https://www.tidyverse.org/blog/2024/10/webr-0-4-2/thumbnail-wd.jpg"><link rel=apple-touch-icon sizes=180x180 href=/images/favicons/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/images/favicons/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/images/favicons/favicon-16x16.png><link rel=manifest href=/images/favicons/site.webmanifest><link rel=mask-icon href=/images/favicons/safari-pinned-tab.svg><link rel="shortcut icon" href=/images/favicons/favicon.ico><meta name=msapplication-TileColor content="#da532c"><meta name=msapplication-config href=/images/favicons/browserconfig.xml><script type=text/javascript src=/js/jquery-3.5.1.min.js></script><script type=text/javascript src=/js/site.js></script><link rel=icon href=/images/favicon.ico><script type=text/javascript src=/js/clipboard.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin=anonymous></script><script defer data-domain=tidyverse.org,all.tidyverse.org src=https://plausible.io/js/plausible.js></script></head><body><div id=appTidyverseSite class="shrinkHeader alwaysShrinkHeader"><div id=main><div id=rStudioHeader><nav class=band><div class="innards bandContent"><div><a class=productName href=/%20/>Tidyverse</a></div><div id=menu><div id=menuToggler></div><div id=menuItems><a class=menuItem href=/packages/>Packages</a>
<a class="menuItem current" href=/blog/>Blog</a>
<a class=menuItem href=/learn/>Learn</a>
<a class=menuItem href=/help/>Help</a>
<a class=menuItem href=/contribute/>Contribute</a></div></div></div></nav></div><main><div class="band padForHeader pushFooter"><div class=bandContent><div class="full splitColumns withMobileMargins"><div class=column75><h1 class=article-title>WebAssembly roundup part 1: webR 0.4.2</h1><div class=article-header aria-hidden=true><div class=photo><img src=/blog/2024/10/webr-0-4-2/thumbnail-wd.jpg></div><div class=photoCredit>Photo by <a href=https://unsplash.com/@gatisv>Gatis Vilaks</a></div></div><span class=article-date><i class="fas fa-calendar-day fa-fw"></i>&nbsp;&nbsp;2024/10/11</span><p style=margin-bottom:.5em;margin-top:.85em><i class="fas fa-tags"></i>&nbsp;
<a href=/tags/wasm/>wasm</a>,
<a href=/tags/webr/>webr</a></p><p style=margin-top:.5em><i class="fas fa-user-circle fa-fw"></i>&nbsp;
George Stagg</p><div class=article-content><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/codemirror.min.css><style>.CodeMirror pre{background-color:unset!important}.btn-webr{background-color:#eee;border-bottom-left-radius:0;border-bottom-right-radius:0}</style><script src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/codemirror.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/mode/r/r.js></script><script type=module>
  import { WebR } from 'https://webr.r-wasm.org/v0.4.2/webr.mjs';
  globalThis.webR = new WebR();
  await globalThis.webR.init();
  await webR.FS.mkdir('/persist');
  await webR.FS.mount('IDBFS', {}, '/persist');
  await webR.FS.syncfs(true);
  await webR.evalRVoid("webr::shim_install()");
  await webR.evalRVoid("webr::global_prompt_install()", { withHandlers: false });

  globalThis.webRCodeShelter = await new globalThis.webR.Shelter();
  document.querySelectorAll(".btn-webr").forEach((btn) => {
    btn.innerText = 'Run code';
    btn.disabled = false;
  });
</script><div class=highlight></div><div class=highlight><style type=text/css>.output>pre,.output code{background-color:#fff!important;margin-top:-17px;border-top-left-radius:0;border-top-right-radius:0}.error>pre,.error code{background-color:#fcebeb!important;color:#410e0e!important}</style></div><p>We&rsquo;re totally stoked to announce the release of
<a href=https://docs.r-wasm.org/webr/v0.4.2/ target=_blank rel=noopener>webr</a> 0.4.2!</p><p>It&rsquo;s been a little while since I&rsquo;ve written about webR here, and a few releases between my last blog post and this one. In this post I&rsquo;ll cover some of the exciting changes to the core webR distribution, and also include some interesting tidbits for JavaScript developers using webR in their own applications. You can see a full list of changes in the
<a href=https://github.com/r-wasm/webr/releases target=_blank rel=noopener>release notes</a>.</p><p>This post is the first in an R for WebAssembly roundup series. The next posts will cover updates to Shinylive for R, and introduce new a new Quarto extension that uses the power of webR and WebAssembly to elevate your documents with interactivity.</p><ul><li><a href=/blog/2024/10/shinylive-0-8-0/>WebAssembly roundup part 2: Shinylive 0.8.0</a></li><li><a href=/blog/2024/10/quarto-live-0-1-1/>WebAssembly roundup part 3: Quarto Live 0.1.1</a></li></ul><h2 id=supporting-html-and-widget-display>Supporting HTML and widget display
<a href=#supporting-html-and-widget-display><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>The base R distribution may be run using nothing but a text console, but some additional options can be implemented by frontends to provide system-dependent display of content. Previously, we implemented the
<a href=https://stat.ethz.ch/R-manual/R-devel/library/base/html/file.show.html target=_blank rel=noopener><code>pager</code></a> option so that R&rsquo;s help system can be better displayed within the
<a href=https://webr.r-wasm.org/latest/ target=_blank rel=noopener>webR application</a>. Using the pager we can show R function and package documentation outside of the text console in dedicated tabbed windows.</p><p>In recent releases of webR we have expanded our support for such display systems, providing an implementation both for the
<a href=https://stat.ethz.ch/R-manual/R-devel/library/utils/html/View.html target=_blank rel=noopener><code>View()</code></a> function and the <code>viewer</code> global option used by
<a href=https://www.htmlwidgets.org/ target=_blank rel=noopener>htmlwidgets</a>.</p><p>This gives us the ability to show a tabular data viewer for <code>data.frame</code>-like R objects and an <code>iframe</code> based HTML content viewer, enabling dynamic web-based output from R packages like
<a href=https://rstudio.github.io/leaflet/articles/leaflet.html target=_blank rel=noopener><code>leaflet</code></a> and
<a href=https://gt.rstudio.com/ target=_blank rel=noopener><code>gt</code></a>.</p><img src=images/viewer.png alt="Screenshots of the webR REPL showing a tabular data viewer, an interactive map using the leaflet package, and a HTML table rendered using the gt package."><p>The implementation of <code>viewer</code> is fairly general, making use of webR&rsquo;s
<a href=https://docs.r-wasm.org/webr/latest/communication.html#output-messages target=_blank rel=noopener>output messages</a> mechanism to send the required information to the main JavaScript thread for display. That way, any application using webR may choose to listen for those messages and how to show the resulting content on the page. We&rsquo;ll make use of this in a later post where I introduce using webR to generate dynamic content in a new Quarto extension.</p><h2 id=improvements-to-the-webr-app-ui>Improvements to the webR app UI
<a href=#improvements-to-the-webr-app-ui><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Recent webR releases have also made some other quality of life improvements to the webR app. Some minor improvements include making each UI panel resizeable, and offering <code>.zip</code> download of an entire directory in the Files panel.</p><img src=images/download.png alt="Screenshot showing the 'Download directory' feature in the webR REPL app."><h3 id=r-source-syntax-highlighting-and-parsing>R source syntax highlighting and parsing
<a href=#r-source-syntax-highlighting-and-parsing><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>The webR app&rsquo;s code editor is powered by
<a href=https://codemirror.net/ target=_blank rel=noopener>CodeMirror</a> with R parsing provided by the
<a href=https://github.com/TravisYeah/lang-r target=_blank rel=noopener>codemirror-lang-r</a> package. CodeMirror&rsquo;s extensibility is excellent, and the library is well suited for integrating into a wider project like this. However, we noticed that the <code>codemirror-lang-r</code> package had a few issues highlighting certain types of R syntax. In particular, in our application highlighting matrix operations such as <code>%*%</code> would crash the parser!</p><img src=images/parser-crash.png alt="Screenshots comparing syntax highlighting of R source code before and after the changes discussed above."><p>As well as fixing this bug, we&rsquo;ve worked to improve the R parser to better support some other types of R syntax and have
<a href=https://github.com/TravisYeah/lezer-r/pull/1 target=_blank rel=noopener>contributed these changes upstream</a> so as to benefit other users of <code>codemirror-lang-r</code>.</p><img src=images/parser-new.png alt="Screenshots comparing syntax highlighting of R source code before and after the changes discussed above."><h2 id=webassembly-r-package-binary-format>WebAssembly R package binary format
<a href=#webassembly-r-package-binary-format><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>One of R&rsquo;s greatest strengths is its vibrant community of R packages and their developers, and so one of the development goals of webR is that packages are downloaded and installed as fast as possible. In the latest release of webR, some joint work with
<a href=https://github.com/jeroen target=_blank rel=noopener>Jeroen Ooms</a> improving the performance of loading WebAssembly binary R packages has landed.</p><p>R packages and other filesystem data is efficiently made available to the R WebAssembly process using
<a href=https://emscripten.org/docs/porting/files/packaging_files.html#packaging-using-the-file-packager-tool target=_blank rel=noopener>Emscripten&rsquo;s file packager</a> and the
<a href=https://emscripten.org/docs/api_reference/Filesystem-API.html#filesystem-api-workerfs target=_blank rel=noopener><code>WORKERFS</code></a> filesystem driver. Previously we used uncompressed filesystem data, with the intention of serving content using
<a href=https://en.wikipedia.org/wiki/HTTP_compression target=_blank rel=noopener>HTTP compression</a>. However, web services do not always compress files automatically<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>, especially if they are large. So, in the latest release of webR, filesystem data may now be mounted from a <code>gzip</code> compressed file<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>, and the base R filesystem is also distributed in compressed form.</p><p>R package developers might recognise that traditional R package binaries are <em>already</em> produced as a <code>gzip</code> compressed archive. And, as pointed out to me by Jeroen, the format of a <code>.tar</code> archive is very similar to Emscripten&rsquo;s <code>.data</code> files. With some
<a href=https://r-wasm.github.io/rwasm/articles/tar-metadata.html target=_blank rel=noopener>clever arrangement</a> of R package archive data and Emscripten filesystem metadata, pre-processed WebAssembly R package binaries may now be directly mounted to the virtual filesystem by webR.</p><p>Mounting R packages in this way is more efficient than installing <code>.tgz</code> archives in the usual manner because the decompression step happens in the browser, rather than using R&rsquo;s slower internal routines, and the <code>WORKERFS</code> filesystem driver also avoids memory copies with the archive files until they are actually opened and read by the WebAssembly R process.</p><p>Both the
<a href=repo.r-wasm.org>webR default repository</a> and
<a href=https://r-universe.dev/ target=_blank rel=noopener>R-Universe</a> now serve binary R packages for WebAssembly in this new format. These packages can be installed and loaded interactively in the webR application, or used as dependencies in a deployed Shinylive for R app. For your own custom R packages, the
<a href=https://r-wasm.github.io/rwasm/index.html target=_blank rel=noopener>rwasm</a> package can be used to compile WebAssembly binaries using a pre-configured Docker container. However, I&rsquo;d actually recommend
<a href=https://ropensci.org/blog/2021/06/22/setup-runiverse/ target=_blank rel=noopener>creating a personal R-Universe repository</a> for your packages instead, since this will automatically build binaries for multiple targets including WebAssembly.</p><p>A much simpler but effective change has also been made: R packages listed only as <code>LinkingTo</code> dependencies are no longer downloaded by webR on package installation. These are packages are required for building an R package from source, but <em>not at runtime</em>. The change saves network resources when installing WebAssembly R packages. In one particular worst-case scenario, this change avoided downloading about 100 megabytes of data!</p><h2 id=virtual-file-system-drivers>Virtual file system drivers
<a href=#virtual-file-system-drivers><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>A nice side-effect of the work in the previous section is that
<a href=https://github.com/r-wasm/webr/issues/328 target=_blank rel=noopener>mounting filesystem data with <code>WORKERFS</code></a> now also works correctly under Node.js, fixing a fairly painful and long-standing bug for our server-side users of webR.</p><p>We&rsquo;ve also introduced mounting with Emscripten&rsquo;s
<a href=https://emscripten.org/docs/api_reference/Filesystem-API.html#filesystem-api-idbfs target=_blank rel=noopener><code>IDBFS</code></a> filesystem driver when running webR in the browser<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup>. This driver makes use of the low-level
<a href=https://developer.mozilla.org/en-US/docs/Web/API/IndexedDB_API target=_blank rel=noopener>IndexedDB API</a> provided by the JavaScript environment to write virtual filesystem contents to a form of local storage on the device.</p><p>With this, files that have been written to the virtual filesystem can be persisted over page reloads and automatically made available again to the WebAssembly R process when the page is revisited in the future, without needing to re-download the content.</p><p>You can try it out right here! Any files written to the <code>/persist</code> directory in the interactive R console below should be persisted. The first time you load this page, the directory will be empty. However, if files are written they will remain available after you refresh the page or revisit in the future.</p><div class=highlight><button class="btn btn-default btn-webr" disabled type=button id=webr-run-button-1>Loading webR...</button><div id=webr-editor-1></div><div id=webr-code-output-1><pre style=visibility:hidden></pre></div><script type=module>
  const runButton = document.getElementById('webr-run-button-1');
  const outputDiv = document.getElementById('webr-code-output-1');
  const editorDiv = document.getElementById('webr-editor-1');

  const editor = CodeMirror((elt) => {
    elt.style.border = '1px solid #eee';
    elt.style.height = 'auto';
    editorDiv.append(elt);
  },{
    value: `install.packages('cli', quiet = TRUE)\n\nfiles <- list.files("/persist")\nfiles\n\nif (length(files) == 0) {\n  cli::cli_alert_warning("No files found in '/persist', I'll create one...")\n  write.csv(mtcars, "/persist/mtcars.csv")\n} else {\n  cli::cli_alert_success("Nice! Some existing files were found in '/persist'.")\n}`,
    lineNumbers: true,
    mode: 'r',
    theme: 'light default',
    viewportMargin: Infinity,
  });

  runButton.onclick = async () => {
    runButton.disabled = true;
    let canvas = undefined;
    await webR.init();
    await webR.evalRVoid('webr::canvas(width=504, height=311.472)');
    await webR.FS.syncfs(false);
    const result = await webRCodeShelter.captureR(editor.getValue(), {
      withAutoprint: true,
      captureStreams: true,
      captureConditions: false,
      captureGraphics: false,
      env: {},
    });
    try {
      await webR.evalRVoid("dev.off()");
      const out = result.output.filter(
        evt => evt.type == 'stdout' || evt.type == 'stderr'
      ).map((evt) => evt.data).join('\n');

      outputDiv.innerHTML = '';
      const pre = document.createElement("pre");
      if (/\S/.test(out)) {
        const code = document.createElement("code");
        code.innerText = out;
        pre.appendChild(code);
      } else {
        pre.style.visibility = 'hidden';
      }
      outputDiv.appendChild(pre);

      const msgs = await webR.flush();
      msgs.forEach(msg => {
        if (msg.type === 'canvas'){
          if (msg.data.event === 'canvasImage') {
            
            canvas.getContext('2d').drawImage(msg.data.image, 0, 0);
          } else if (msg.data.event === 'canvasNewPage') {
            
            canvas = document.createElement('canvas');
            canvas.setAttribute('width', 2 * 504);
            canvas.setAttribute('height', 2 * 311.472);
            canvas.style.width="700px";
            canvas.style.display="block";
            canvas.style.margin="auto";
            
            const p = document.createElement("p");
            p.appendChild(canvas);
            outputDiv.appendChild(p);
          }
        }
      });
    } finally {
      webRCodeShelter.purge();
      runButton.disabled = false;
    }
  }
</script></div><p>It should be noted that filesystem data stored in an IndexedDB database can only be accessed within the same
<a href=https://developer.mozilla.org/en-US/docs/Glossary/Origin target=_blank rel=noopener>origin</a>, essentially across the current web page&rsquo;s domain. Also, browsers may decide the amount of storage space provided, what content is deleted when quotas are reached, and when exactly that deletion occurs. In private browsing mode, for example, data is usually removed when the private session ends.</p><p>Even with these caveats, I expect developers working with webR will be able to make use of the <code>IDBFS</code> driver to selectively cache content or R packages that are too large to download over the network on every single page load, further improving start up times in their own apps as a result.</p><h2 id=developing-with-webr>Developing with webR
<a href=#developing-with-webr><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><h3 id=deprecating-the-serviceworker-channel>Deprecating the <code>ServiceWorker</code> channel
<a href=#deprecating-the-serviceworker-channel><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>The <code>ServiceWorker</code>
<a href=https://docs.r-wasm.org/webr/v0.3.2/communication.html target=_blank rel=noopener>communication channel</a>, a method webR offered to handle message passing between the main browser thread and the
<a href=https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Using_web_workers target=_blank rel=noopener>JavaScript Web Worker</a> running the R WebAssembly binary, has been deprecated. The communication channel was originally devised as a way to allow use of webR in cases where the <code>SharedArrayBuffer</code> API is not available. This includes any use of webR with an origin that is not
<a href=https://developer.mozilla.org/en-US/docs/Web/API/Window/crossOriginIsolated target=_blank rel=noopener>Cross-Origin Isolated</a>, such as when content is hosted by GitHub Pages.</p><p>The channel was implemented using a
<a href=https://developer.mozilla.org/en-US/docs/Web/API/Service_Worker_API target=_blank rel=noopener>JavaScript Service Worker</a> proxy and synchronous
<a href=https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest target=_blank rel=noopener>XHR</a> requests. Unfortunately, with the overhead of message serialisation and capturing network requests, performance was significantly impacted. The channel was also not compatible with applications that make use of a service worker for genuine network proxy functionality, such as Shinylive.</p><p>An alternative method has since been developed in the form of the <code>PostMessage</code> communication channel. This instead uses the
<a href=https://developer.mozilla.org/en-US/docs/Web/API/Worker/postMessage target=_blank rel=noopener>JavaScript <code>PostMessage</code> API</a>, which is designed to handle communication between workers efficiently. It has much better performance and even provides a way to
<a href=https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Transferable_objects target=_blank rel=noopener>transfer objects</a> using zero-copy operations. There are some minor downsides when using the <code>PostMessage</code> channel, mostly related to taking input using tools like
<a href=https://rdrr.io/r/base/readline.html target=_blank rel=noopener><code>readline()</code></a>, or nested REPLs like R&rsquo;s
<a href=https://rdrr.io/r/base/browser.html target=_blank rel=noopener><code>browser()</code></a>, but for most applications we find that this is not catastrophic and a reasonable price to pay for what is intended as a fallback method.</p><p>If you are working on a webR application where
<a href=https://rdrr.io/r/base/readline.html target=_blank rel=noopener><code>readline()</code></a> functionality <em>is absolutely</em> required, but you cannot set your web server headers to enable cross-origin isolation, an alternative implementation of using a service worker to solve the problem can be found with the
<a href=https://github.com/gzuidhof/coi-serviceworker target=_blank rel=noopener>coi-serviceworker</a> package. When enabled, the web page will appear to webR to be cross-origin isolated and so <code>SharedArrayBuffer</code> can be used. This still has the other drawbacks of requiring a service worker, but will have much better performance than using webR&rsquo;s <code>ServiceWorker</code> channel directly.</p><p>For these reasons, the <code>PostMessage</code> communication channel is now the default fallback when the web page is not cross-origin isolated. The <code>ServiceWorker</code> channel will continue to be available in the short-term, if explicitly requested, but will eventually be removed in a future version of webR.</p><h3 id=api-additions>API additions
<a href=#api-additions><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>We&rsquo;ve made some minor changes to the webR JavaScript API. There&rsquo;s nothing ground breaking here, but some new tools that we hope to be useful.</p><h5 id=report-current-version>Report current version
<a href=#report-current-version><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h5><p>With the aim of providing functionality similar to the
<a href=https://rdrr.io/r/base/Version.html target=_blank rel=noopener><code>R.Version()</code></a> and
<a href=https://rdrr.io/r/utils/packageDescription.html target=_blank rel=noopener><code>packageVersion()</code></a> R functions, the version of the currently running webR session may now be obtained from the JavaScript environment.</p><div class=highlight><pre class=chroma><code class=language-js data-lang=js><span class=o>&gt;</span> <span class=kr>const</span> <span class=nx>webR</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>WebR</span><span class=p>();</span>
<span class=o>&gt;</span> <span class=nx>webR</span><span class=p>.</span><span class=nx>version</span><span class=p>;</span>
<span class=c1>// &#39;0.4.3-dev+d1fb4f4&#39;
</span></code></pre></div><h5 id=discover-an-objects-class>Discover an object&rsquo;s class
<a href=#discover-an-objects-class><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h5><p>An R object&rsquo;s
<a href=https://rdrr.io/r/base/class.html target=_blank rel=noopener><code>class()</code></a> may be inspected from an <code>RObject</code> proxy. The returned value is an <code>RCharacter</code> vector of classes from which the object inherits.</p><div class=highlight><pre class=chroma><code class=language-js data-lang=js><span class=o>&gt;</span> <span class=nx>await</span> <span class=nx>webR</span><span class=p>.</span><span class=nx>evalR</span><span class=p>(</span><span class=s2>&#34;mtcars&#34;</span><span class=p>)</span>
    <span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>obj</span> <span class=p>=&gt;</span> <span class=nx>obj</span><span class=p>.</span><span class=kr>class</span><span class=p>())</span>
    <span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>cls</span> <span class=p>=&gt;</span> <span class=nx>cls</span><span class=p>.</span><span class=nx>toArray</span><span class=p>());</span>
<span class=c1>// [&#39;data.frame&#39;]
</span></code></pre></div><h5 id=explicitly-construct-an-r-dataframe>Explicitly construct an R <code>data.frame</code>
<a href=#explicitly-construct-an-r-dataframe><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h5><p>In a previous version of webR, we introduced creating new R <code>data.frame</code> objects from JavaScript using the generic <code>RObject</code> constructor. WebR will build a <code>data.frame</code> for arguments with compatible shape: either an object with named columns, or an array with objects for each row.</p><div class=highlight><pre class=chroma><code class=language-js data-lang=js><span class=o>&gt;</span> <span class=kd>let</span> <span class=nx>source1</span> <span class=o>=</span> <span class=p>{</span> <span class=nx>abc</span><span class=o>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span> <span class=nx>xyz</span><span class=o>:</span> <span class=p>[</span><span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>]</span> <span class=p>};</span>
<span class=o>&gt;</span> <span class=nx>await</span> <span class=k>new</span> <span class=nx>webR</span><span class=p>.</span><span class=nx>RObject</span><span class=p>(</span><span class=nx>source1</span><span class=p>)</span>
   <span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>obj</span> <span class=p>=&gt;</span> <span class=nx>obj</span><span class=p>.</span><span class=kr>class</span><span class=p>())</span>
   <span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>cls</span> <span class=p>=&gt;</span> <span class=nx>cls</span><span class=p>.</span><span class=nx>toArray</span><span class=p>());</span>
<span class=c1>// [&#39;data.frame&#39;]
</span><span class=c1></span>
<span class=o>&gt;</span> <span class=kd>let</span> <span class=nx>source2</span> <span class=o>=</span> <span class=p>[</span> <span class=p>{</span> <span class=nx>abc</span><span class=o>:</span> <span class=mi>1</span><span class=p>,</span> <span class=nx>xyz</span><span class=o>:</span> <span class=mi>4</span> <span class=p>},</span> <span class=p>{</span> <span class=nx>abc</span><span class=o>:</span> <span class=mi>2</span><span class=p>,</span> <span class=nx>xyz</span><span class=o>:</span> <span class=mi>5</span> <span class=p>},</span> <span class=p>{</span> <span class=nx>abc</span><span class=o>:</span> <span class=mi>3</span><span class=p>,</span> <span class=nx>xyz</span><span class=o>:</span> <span class=mi>6</span> <span class=p>}];</span>
<span class=o>&gt;</span> <span class=nx>await</span> <span class=k>new</span> <span class=nx>webR</span><span class=p>.</span><span class=nx>RObject</span><span class=p>(</span><span class=nx>source2</span><span class=p>)</span>
   <span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>obj</span> <span class=p>=&gt;</span> <span class=nx>obj</span><span class=p>.</span><span class=kr>class</span><span class=p>())</span>
   <span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>cls</span> <span class=p>=&gt;</span> <span class=nx>cls</span><span class=p>.</span><span class=nx>toArray</span><span class=p>());</span>
<span class=c1>// [&#39;data.frame&#39;]
</span></code></pre></div><p>You might ask why not create an R list object by default? The reason is that we expect a common situation to be taking datasets defined in the JavaScript environment and processing them using R. With <code>data.frame</code> as the default, JavaScript objects that have been formatted for use with existing JavaScript frameworks can be almost transparently passed to R.</p><div class=highlight><pre class=chroma><code class=language-js data-lang=js><span class=o>&gt;</span> <span class=nx>penguins</span><span class=p>;</span>
<span class=c1>//  Array(344) [
</span><span class=c1>//  0: { species: &#39;Adelie&#39;, island: &#39;Torgersen&#39;, flipper_length_mm: 181, ... }
</span><span class=c1>//   ... more
</span><span class=c1>// ]
</span><span class=c1></span><span class=o>&gt;</span> <span class=kr>const</span> <span class=nx>sample_mass</span> <span class=o>=</span> <span class=nx>await</span> <span class=nx>webR</span><span class=p>.</span><span class=nx>evalR</span><span class=p>(</span><span class=sb>`
</span><span class=sb>    \\(x) x |&gt; dplyr::sample_n(5) |&gt; dplyr::pull(&#34;body_mass_g&#34;)
</span><span class=sb>  `</span><span class=p>);</span>
<span class=o>&gt;</span> <span class=nx>await</span> <span class=nx>sample_mass</span><span class=p>(</span><span class=nx>penguins</span><span class=p>);</span>
<span class=c1>// { type: &#39;double&#39;, names: null, values: [3300, 3250, 4000, 4700, 3750] }
</span></code></pre></div><p>The generic constructor throws an exception for JavaScript objects that cannot be coerced as a <code>data.frame</code>. If you&rsquo;d prefer to create an R list, you must instead be explicit by using the <code>RList</code> constructor,</p><div class=highlight><pre class=chroma><code class=language-js data-lang=js><span class=o>&gt;</span> <span class=kd>let</span> <span class=nx>source</span> <span class=o>=</span> <span class=p>{</span> <span class=nx>def</span><span class=o>:</span> <span class=p>[</span><span class=mi>123</span><span class=p>,</span> <span class=mi>456</span><span class=p>],</span> <span class=nx>uvw</span><span class=o>:</span> <span class=s1>&#39;hello&#39;</span> <span class=p>};</span>
<span class=o>&gt;</span> <span class=nx>await</span> <span class=k>new</span> <span class=nx>webR</span><span class=p>.</span><span class=nx>RObject</span><span class=p>(</span><span class=nx>source</span><span class=p>);</span>
<span class=c1>// Uncaught WebRWorkerError: Can&#39;t construct `data.frame`. Source object is not eligible.
</span><span class=c1></span>
<span class=o>&gt;</span> <span class=kd>let</span> <span class=nx>obj</span> <span class=o>=</span> <span class=nx>await</span> <span class=k>new</span> <span class=nx>webR</span><span class=p>.</span><span class=nx>RList</span><span class=p>(</span><span class=nx>source</span><span class=p>);</span>
<span class=o>&gt;</span> <span class=nx>await</span> <span class=nx>obj</span><span class=p>.</span><span class=nx>type</span><span class=p>();</span>
<span class=c1>// &#39;list&#39;
</span></code></pre></div><p>The <code>RObject</code> constructor is designed to be a useful default for interactive work at a JavaScript console. However, production applications should be
<a href=https://docs.r-wasm.org/webr/latest/api/js/modules/RWorker.html#classes target=_blank rel=noopener>explicit in the choice of constructor</a>. With this in mind we have added a new class
<a href=https://docs.r-wasm.org/webr/latest/api/js/classes/RWorker.RDataFrame.html target=_blank rel=noopener><code>RDataFrame</code></a>, a subclass of <code>RList</code>, so that users may be explicit in their choice of creating a <code>data.frame</code>, rather than relying on the generic <code>RObject</code> constructor.</p><div class=highlight><pre class=chroma><code class=language-js data-lang=js><span class=o>&gt;</span> <span class=kd>let</span> <span class=nx>source</span> <span class=o>=</span> <span class=p>{</span> <span class=nx>abc</span><span class=o>:</span> <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span> <span class=nx>xyz</span><span class=o>:</span> <span class=p>[</span><span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>]</span> <span class=p>};</span>
<span class=o>&gt;</span> <span class=nx>await</span> <span class=k>new</span> <span class=nx>webR</span><span class=p>.</span><span class=nx>RDataFrame</span><span class=p>(</span><span class=nx>source</span><span class=p>)</span>
   <span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>obj</span> <span class=p>=&gt;</span> <span class=nx>obj</span><span class=p>.</span><span class=kr>class</span><span class=p>())</span>
   <span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>cls</span> <span class=p>=&gt;</span> <span class=nx>cls</span><span class=p>.</span><span class=nx>toArray</span><span class=p>());</span>
<span class=c1>// [&#39;data.frame&#39;]
</span></code></pre></div><p>Now, if your source object is not quite as you expect, rather than continuing silently without error an exception will be thrown. We hope this will reduce the chance of type-related bugs and unexpected behaviour, and aid in debugging when issues do occur.</p><div class=highlight><pre class=chroma><code class=language-js data-lang=js><span class=c1>// Say we _expect_ a JS object here, but something went wrong...
</span><span class=c1></span><span class=o>&gt;</span> <span class=kd>let</span> <span class=nx>bug</span> <span class=o>=</span> <span class=kc>undefined</span><span class=p>;</span>

<span class=o>&gt;</span> <span class=kr>const</span> <span class=nx>obj1</span> <span class=o>=</span> <span class=nx>await</span> <span class=k>new</span> <span class=nx>webR</span><span class=p>.</span><span class=nx>RObject</span><span class=p>(</span><span class=nx>bug</span><span class=p>);</span>
<span class=c1>// [No error and webR silently continues with an unexpected R object]
</span><span class=c1></span>
<span class=o>&gt;</span> <span class=kr>const</span> <span class=nx>obj2</span> <span class=o>=</span> <span class=nx>await</span> <span class=k>new</span> <span class=nx>webR</span><span class=p>.</span><span class=nx>RDataFrame</span><span class=p>(</span><span class=nx>bug</span><span class=p>);</span>
<span class=c1>// Uncaught WebRWorkerError: Can&#39;t construct `data.frame`. Source object is not eligible.
</span></code></pre></div><h2 id=acknowledgements>Acknowledgements
<a href=#acknowledgements><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Special thanks to
<a href=https://github.com/jeroen target=_blank rel=noopener>@jeroen</a>, for helpful conversations when it comes to packaging for webR. And thank you, as always, to the users and developers contributing to webR in the form of discussion, bug reports, and pull requests.</p><p><a href=https://github.com/027xiguapi target=_blank rel=noopener>@027xiguapi</a>,
<a href=https://github.com/adrianolszewski target=_blank rel=noopener>@adrianolszewski</a>,
<a href=https://github.com/alekrutkowski target=_blank rel=noopener>@alekrutkowski</a>,
<a href=https://github.com/andrjohns target=_blank rel=noopener>@andrjohns</a>,
<a href=https://github.com/baogorek target=_blank rel=noopener>@baogorek</a>,
<a href=https://github.com/bugzpodder target=_blank rel=noopener>@bugzpodder</a>,
<a href=https://github.com/christianp target=_blank rel=noopener>@christianp</a>,
<a href=https://github.com/coatless target=_blank rel=noopener>@coatless</a>,
<a href=https://github.com/codingthemystery target=_blank rel=noopener>@codingthemystery</a>,
<a href=https://github.com/ColinFay target=_blank rel=noopener>@ColinFay</a>,
<a href=https://github.com/derrickstaten target=_blank rel=noopener>@derrickstaten</a>,
<a href=https://github.com/dipterix target=_blank rel=noopener>@dipterix</a>,
<a href=https://github.com/EduardBel target=_blank rel=noopener>@EduardBel</a>,
<a href=https://github.com/gregvolny target=_blank rel=noopener>@gregvolny</a>,
<a href=https://github.com/guillaumechaumet target=_blank rel=noopener>@guillaumechaumet</a>,
<a href=https://github.com/gyanaranjans target=_blank rel=noopener>@gyanaranjans</a>,
<a href=https://github.com/helgasoft target=_blank rel=noopener>@helgasoft</a>,
<a href=https://github.com/HenrikBengtsson target=_blank rel=noopener>@HenrikBengtsson</a>,
<a href=https://github.com/isbool target=_blank rel=noopener>@isbool</a>,
<a href=https://github.com/JosiahParry target=_blank rel=noopener>@JosiahParry</a>,
<a href=https://github.com/luisDVA target=_blank rel=noopener>@luisDVA</a>,
<a href=https://github.com/minhaj57sorder target=_blank rel=noopener>@minhaj57sorder</a>,
<a href=https://github.com/olivroy target=_blank rel=noopener>@olivroy</a>,
<a href=https://github.com/oranwutang target=_blank rel=noopener>@oranwutang</a>,
<a href=https://github.com/pawelru target=_blank rel=noopener>@pawelru</a>,
<a href=https://github.com/psychemedia target=_blank rel=noopener>@psychemedia</a>,
<a href=https://github.com/rainer-rq-koelle target=_blank rel=noopener>@rainer-rq-koelle</a>,
<a href=https://github.com/richarddmorey target=_blank rel=noopener>@richarddmorey</a>,
<a href=https://github.com/richardjtelford target=_blank rel=noopener>@richardjtelford</a>,
<a href=https://github.com/seanbirchall target=_blank rel=noopener>@seanbirchall</a>,
<a href=https://github.com/shalom-lab target=_blank rel=noopener>@shalom-lab</a>,
<a href=https://github.com/StaffanBetner target=_blank rel=noopener>@StaffanBetner</a>,
<a href=https://github.com/stobor827 target=_blank rel=noopener>@stobor827</a>,
<a href=https://github.com/SugarRayLua target=_blank rel=noopener>@SugarRayLua</a>,
<a href=https://github.com/tavosansal target=_blank rel=noopener>@tavosansal</a>,
<a href=https://github.com/thomascwells target=_blank rel=noopener>@thomascwells</a>,
<a href=https://github.com/timelyportfolio target=_blank rel=noopener>@timelyportfolio</a>, and
<a href=https://github.com/zpinocchio target=_blank rel=noopener>@zpinocchio</a>.</p><section class=footnotes role=doc-endnotes><hr><ol><li id=fn:1 role=doc-endnote><p>It depends a lot on how the hosting service has configured their production web server and the files themselves; both size and content type can make a difference to behaviour. Some services allow for pre-compressed content, while others do not. The
<a href=https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/ServingCompressedFiles.html target=_blank rel=noopener>AWS CloudFront documentation</a> gives a good overview of how this all fits together. <a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2 role=doc-endnote><p>Emscripten&rsquo;s <code>file_packager</code> tool also supports built-in <code>LZ4</code> compression with the <code>--lz4</code> flag. While generally useful for bundling files for WebAssembly applications, we avoid using this feature since it writes important data to a <code>.js</code> output file that must be executed. Ideally, we&rsquo;d prefer our package loading mechanism to only require a single file download, similar to traditional R package archives. <a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3 role=doc-endnote><p>Note that currently users wanting to make use of <code>IDBFS</code> mounting must configure webR to use the
<a href=https://docs.r-wasm.org/webr/latest/communication.html target=_blank rel=noopener><code>PostMessage</code> Communication Channel</a>. <a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></section></div></div><div class=column25><div class="section hideOnMobile"><div class=sectionTitle>Contents</div><nav id=TableOfContents><ul><li><a href=#supporting-html-and-widget-display>Supporting HTML and widget display</a></li><li><a href=#improvements-to-the-webr-app-ui>Improvements to the webR app UI</a></li><li><a href=#webassembly-r-package-binary-format>WebAssembly R package binary format</a></li><li><a href=#virtual-file-system-drivers>Virtual file system drivers</a></li><li><a href=#developing-with-webr>Developing with webR</a></li><li><a href=#acknowledgements>Acknowledgements</a></li></ul></nav></div><div class=section></div></div></div></div></div><div id=rStudioFooter class=band><div class=bandContent><div id=copyright>The tidyverse is proudly supported by <a class=rstudioLogo href=https://posit.co/ aria-label="Posit Homepage"></a></div><div id=logos><a href=https://www.tidyverse.org/google_privacy_policy>Privacy policy</a>
<a href=https://github.com/tidyverse class="footerLogo gitHub" aria-label="Tidyverse GitHub organization"></a><a href=https://twitter.com/hashtag/rstats class="footerLogo twitter" aria-label="rstats hashtag on twitter.com"></a></div></div></div></div></div><script src=/js/math-code.js></script><script type=text/x-mathjax-config>
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    processEscapes: true
  }
});
</script><script async src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><script type=application/javascript>var dnt=(navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack);var doNotTrack=(dnt=="1"||dnt=="yes");if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');if(window.sessionStorage){var GA_SESSION_STORAGE_KEY='ga:clientId';ga('create','UA-115082821-1',{'storage':'none','clientId':sessionStorage.getItem(GA_SESSION_STORAGE_KEY)});ga(function(tracker){sessionStorage.setItem(GA_SESSION_STORAGE_KEY,tracker.get('clientId'));});}
ga('set','anonymizeIp',true);ga('send','pageview');}</script></body></html></div></div></body></html>