<!doctype html><html><head><!doctype html><html lang=en-us><link rel=stylesheet href=/css/fonts.css><link rel=stylesheet href=/css/main-site.css><link rel=stylesheet href=/css/fa5-all.css><style type=text/css>body{background-color:#fff;color:#1a1917}a{color:#38577f}a:hover{color:#42709b}a:focus{outline-color:#42709b}.column25-left .sectionTitle a:hover:not(.current),.column16-left .sectionTitle a:hover:not(.current){color:#1a1917}.icon-attribution,.icon-attribution a{color:#1a1917;opacity:75%}#homeContent .band.first{background-color:#fff}#homeContent .band.second{background-color:#fdeba4}#homeContent .band.third{background-color:#fff}#rStudioHeader{background-color:#1a162d;color:#fff}#rStudioHeader .productName{color:#fff}#rStudioHeader .productName:hover,#rStudioHeader .productName:focus{color:#fdeba4}#rStudioHeader #menu .menuItem.a{background-color:#75aadb;color:#fff}#rStudioHeader #menu .menuItem:hover{background-color:#484557;color:#fff}#rStudioHeader #menu .menuItem.current{background-color:#fff;color:#1a162d;text-decoration:none}#rStudioFooter.band{background-color:#767381}#rStudioFooter .bandContent #copyright{color:#e3eef8}table tbody tr:nth-child(even){background-color:#f7faff}table tbody tr:nth-child(odd){background-color:#fff}.latest{border-top:.5em solid <no value>}.event{-moz-box-shadow:0 0 0 0 rgba(0,0,0,.1);-webkit-box-shadow:0 0 0 0 rgba(0,0,0,.1);box-shadow:0 0 0 0 rgba(0,0,0,.1)}.section .event{background-color:#eab0c41a}.section .event{border-top:7pt solid #a19ea936}.section .event a{color:#1a162d}.section .event{color:#404040}</style><link rel=stylesheet href=/css/tidyverse.css><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Hugo 0.71.1"><title>marquee 0.1.0</title><meta property="og:title" content="marquee 0.1.0"><meta property="og:description" content="The initial release brings markdown awareness to grid and ggplot2 to allow  for rich text formatting in R graphics."><meta property="og:type" content="article"><meta property="og:url" content="https://www.tidyverse.org/blog/2024/05/marquee-0-1-0/"><meta property="twitter:card" content="summary_large_image"><meta property="og:title" content="marquee 0.1.0 - Tidyverse"><meta property="description" content="The initial release brings markdown awareness to grid and ggplot2 to allow  for rich text formatting in R graphics."><meta property="og:description" content="The initial release brings markdown awareness to grid and ggplot2 to allow  for rich text formatting in R graphics."><meta property="og:image" content="https://www.tidyverse.org/blog/2024/05/marquee-0-1-0/thumbnail-sq.jpg"><meta name=twitter:image content="https://www.tidyverse.org/blog/2024/05/marquee-0-1-0/thumbnail-wd.jpg"><link rel=apple-touch-icon sizes=180x180 href=/images/favicons/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/images/favicons/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/images/favicons/favicon-16x16.png><link rel=manifest href=/images/favicons/site.webmanifest><link rel=mask-icon href=/images/favicons/safari-pinned-tab.svg><link rel="shortcut icon" href=/images/favicons/favicon.ico><meta name=msapplication-TileColor content="#da532c"><meta name=msapplication-config href=/images/favicons/browserconfig.xml><script type=text/javascript src=/js/jquery-3.5.1.min.js></script><script type=text/javascript src=/js/site.js></script><link rel=icon href=/images/favicon.ico><script type=text/javascript src=/js/clipboard.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin=anonymous></script><script defer data-domain=tidyverse.org,all.tidyverse.org src=https://plausible.io/js/plausible.js></script></head><body><div id=appTidyverseSite class="shrinkHeader alwaysShrinkHeader"><div id=main><div id=rStudioHeader><nav class=band><div class="innards bandContent"><div><a class=productName href=/%20/>Tidyverse</a></div><div id=menu><div id=menuToggler></div><div id=menuItems><a class=menuItem href=/packages/>Packages</a>
<a class="menuItem current" href=/blog/>Blog</a>
<a class=menuItem href=/learn/>Learn</a>
<a class=menuItem href=/help/>Help</a>
<a class=menuItem href=/contribute/>Contribute</a></div></div></div></nav></div><main><div class="band padForHeader pushFooter"><div class=bandContent><div class="full splitColumns withMobileMargins"><div class=column75><h1 class=article-title>marquee 0.1.0</h1><div class=article-header aria-hidden=true><div class=photo><img src=/blog/2024/05/marquee-0-1-0/thumbnail-wd.jpg></div><div class=photoCredit>Photo by <a href=https://unsplash.com/photos/a-close-up-of-a-metal-grate-on-a-table-9jfpVAhGC1g>Etienne Girardet</a></div></div><span class=article-date><i class="fas fa-calendar-day fa-fw"></i>&nbsp;&nbsp;2024/05/29</span><p style=margin-bottom:.5em;margin-top:.85em><i class="fas fa-tags"></i>&nbsp;
<a href=/tags/ggplot2/>ggplot2</a>,
<a href=/tags/marquee/>marquee</a></p><p style=margin-top:.5em><i class="fas fa-user-circle fa-fw"></i>&nbsp;
Thomas Lin Pedersen</p><div class=article-content><p>I am super excited to announce the initial release of
<a href=https://marquee.r-lib.org target=_blank rel=noopener>marquee</a>, a markdown parser and renderer for R graphics that allows native rich text formatting of text in graphics created with grid (which includes ggplot2 and lattice).</p><p>The inception of this package goes all the way back to 2017:</p><blockquote class=twitter-tweet><p lang=en dir=ltr><p>May I present: Text wrapping of theme elements in <a href="https://twitter.com/hashtag/ggplot2?src=hash&ref_src=twsrc%5Etfw">#ggplot2</a> with the new (experimental) element_textbox in <a href="https://twitter.com/hashtag/ggforce?src=hash&ref_src=twsrc%5Etfw">#ggforce</a><a href="https://twitter.com/hashtag/rstats?src=hash&ref_src=twsrc%5Etfw">#rstats</a> <a href="https://twitter.com/hashtag/dataviz?src=hash&ref_src=twsrc%5Etfw">#dataviz</a> <a href=https://t.co/JJMLcuTBqx>pic.twitter.com/JJMLcuTBqx</a></p></p><p>&mdash; Thomas Lin Pedersen (@thomasp85) <a href="https://twitter.com/thomasp85/status/816967301014634497?ref_src=twsrc%5Etfw">January 5, 2017</a></p></blockquote><script async src=https://platform.twitter.com/widgets.js></script><p>(yeah&mldr;) where I developed an experimental feature for ggforce that allowed automatic text wrapping in
<a href=https://ggplot2.tidyverse.org/reference/element.html target=_blank rel=noopener><code>element_text()</code></a>. Years passed, slowly improving the text rendering capabilities in R until we are finally at a point in the toolchain where something like marquee can deliver on my initial plans.</p><p>If this has you intrigued you can install it from CRAN with:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nf><a href=https://rdrr.io/r/utils/install.packages.html>install.packages</a></span><span class=o>(</span><span class=s>"marquee"</span><span class=o>)</span></span></code></pre></div><p>This blog post will go through the features of marquee, along with discussing some of its current limitations, all of which are hopefully transient.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=kr><a href=https://rdrr.io/r/base/library.html>library</a></span><span class=o>(</span><span class=nv><a href=https://marquee.r-lib.org>marquee</a></span><span class=o>)</span></span></code></pre></div><h2 id=an-example>An example
<a href=#an-example><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Since the use of markdown is second-hand nature for most people at this point, there shouldn&rsquo;t be much surprise in what marquee is capable off, so let&rsquo;s start with an example to show the main use:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>md_text</span> <span class=o>&lt;-</span> </span>
<span><span class=s>"# Intro</span></span>
<span><span class=s>markdown has been *quite* succesful in creating a unified way of specifying </span></span>
<span><span class=s>_semantic_ rich text. While limited, it provides both &#123;.steelblue readability&#125; and</span></span>
<span><span class=s>just enough ~power~ features.</span></span>
<span><span class=s></span></span>
<span><span class=s>    text &lt;- \"markdown **text**\"</span></span>
<span><span class=s>    marquee_grob(text)</span></span>
<span><span class=s></span></span>
<span><span class=s>It features, among others:</span></span>
<span><span class=s></span></span>
<span><span class=s>1. lists</span></span>
<span><span class=s></span></span>
<span><span class=s>2. code blocks</span></span>
<span><span class=s></span></span>
<span><span class=s>   * Indented lists</span></span>
<span><span class=s>   </span></span>
<span><span class=s>3. and more...</span></span>
<span><span class=s>"</span></span>
<span></span>
<span><span class=nf>grid</span><span class=nf>::</span><span class=nf><a href=https://rdrr.io/r/grid/grid.draw.html>grid.draw</a></span><span class=o>(</span><span class=nf><a href=https://marquee.r-lib.org/reference/marquee_grob.html>marquee_grob</a></span><span class=o>(</span><span class=nv>md_text</span><span class=o>)</span><span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-3-1.png width=700px style=display:block;margin:auto></p></div><p>The above illustrates a couple of things. First and foremost, that markdown works in very unsurprising ways and you get what you type. In fact, the full CommonMark syntax is supported along with extensions for underline and strikethrough. Further, it shows that marquee provides its own extension for specifying custom span elements in the form of the <code>{.class &lt;text>}</code> syntax. The renderer is clever in interpreting the class so that if it corresponds to a colour name, the colour is automatically applied to the text. Lastly, it shows that the default styling of markdown closely follows the look you&rsquo;ve come to expect from markdown rendered to HTML.</p><h2 id=use-in-ggplot2>Use in ggplot2
<a href=#use-in-ggplot2><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>The number of people using this directly in grid is probably small. It is more likely that you access the functionality of marquee through higher level functions. Marquee provides two such functions aimed at making it easy to use marquee in ggplot2. The aim is to eventually move these into ggplot2 proper, but while we are in the initial phase of development they will stay in this package.</p><h3 id=geom_marquee><code>geom_marquee()</code>
<a href=#geom_marquee><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>The first function is (obviously) a geom. It is intended as a stand-in replacement for both
<a href=https://ggplot2.tidyverse.org/reference/geom_text.html target=_blank rel=noopener><code>geom_text()</code></a> and
<a href=https://ggplot2.tidyverse.org/reference/geom_text.html target=_blank rel=noopener><code>geom_label()</code></a>. As with
<a href=https://marquee.r-lib.org/reference/marquee_grob.html target=_blank rel=noopener><code>marquee_grob()</code></a> it works very unsurprisingly:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=kr><a href=https://rdrr.io/r/base/library.html>library</a></span><span class=o>(</span><span class=nv><a href=https://ggplot2.tidyverse.org>ggplot2</a></span><span class=o>)</span></span>
<span><span class=c># Add styling around the first word</span></span>
<span><span class=nv>red_bold_names</span> <span class=o>&lt;-</span> <span class=nf><a href=https://rdrr.io/r/base/grep.html>sub</a></span><span class=o>(</span><span class=s>"(\\w+)"</span>, <span class=s>"&#123;.red **\\1**&#125;"</span>, <span class=nf><a href=https://rdrr.io/r/base/colnames.html>rownames</a></span><span class=o>(</span><span class=nv>mtcars</span><span class=o>)</span><span class=o>)</span></span>
<span></span>
<span><span class=nf><a href=https://ggplot2.tidyverse.org/reference/ggplot.html>ggplot</a></span><span class=o>(</span><span class=nv>mtcars</span><span class=o>)</span> <span class=o>+</span> </span>
<span>  <span class=nf><a href=https://marquee.r-lib.org/reference/geom_marquee.html>geom_marquee</a></span><span class=o>(</span><span class=nf><a href=https://ggplot2.tidyverse.org/reference/aes.html>aes</a></span><span class=o>(</span>x <span class=o>=</span> <span class=nv>mpg</span>, y <span class=o>=</span> <span class=nv>disp</span>, label <span class=o>=</span> <span class=nv>red_bold_names</span><span class=o>)</span><span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-4-1.png width=700px style=display:block;margin:auto></p></div><p>Apart from standard, but markdown-aware,
<a href=https://ggplot2.tidyverse.org/reference/geom_text.html target=_blank rel=noopener><code>geom_text()</code></a> behaviour, the geom also gains a <code>width</code> aesthetic that allows you to turn on automatic soft wrapping of the text. In addition to this it gains a <code>style</code> aesthetic to finely control the style (more about styling below)</p><h3 id=element_marquee><code>element_marquee()</code>
<a href=#element_marquee><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>The second obvious use for marquee in ggplot2 is in formatting text elements.
<a href=https://marquee.r-lib.org/reference/element_marquee.html target=_blank rel=noopener><code>element_marquee()</code></a> is a replacement for
<a href=https://ggplot2.tidyverse.org/reference/element.html target=_blank rel=noopener><code>element_text()</code></a> that does just that.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nf><a href=https://ggplot2.tidyverse.org/reference/ggplot.html>ggplot</a></span><span class=o>(</span><span class=nv>mtcars</span><span class=o>)</span> <span class=o>+</span> </span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/geom_point.html>geom_point</a></span><span class=o>(</span><span class=nf><a href=https://ggplot2.tidyverse.org/reference/aes.html>aes</a></span><span class=o>(</span>x <span class=o>=</span> <span class=nv>mpg</span>, y <span class=o>=</span> <span class=nv>disp</span><span class=o>)</span><span class=o>)</span> <span class=o>+</span> </span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/labs.html>ggtitle</a></span><span class=o>(</span><span class=nv>md_text</span><span class=o>)</span> <span class=o>+</span> </span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/theme.html>theme</a></span><span class=o>(</span>plot.title <span class=o>=</span> <span class=nf><a href=https://marquee.r-lib.org/reference/element_marquee.html>element_marquee</a></span><span class=o>(</span>size <span class=o>=</span> <span class=m>8</span>, width <span class=o>=</span> <span class=nf><a href=https://rdrr.io/r/grid/unit.html>unit</a></span><span class=o>(</span><span class=m>16</span>, <span class=s>"cm"</span><span class=o>)</span><span class=o>)</span><span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-5-1.png width=700px style=display:block;margin:auto></p></div><h2 id=styling>Styling
<a href=#styling><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>As alluded to above, marquee comes with a styling API that is reminiscent of CSS but completely its own. In some sense it takes the &ldquo;simplicity over power&rdquo; approach from markdown and applies it to styling.</p><p>In marquee, each element type (e.g. a code block) has its own style. This style can be incomplete in which case it inherits the remaining specifications from the parent element in the document. As an example, the <code>em</code> element has the following default style <code>style(italic = TRUE)</code>, that is, take whatever style is currently in effect but also make the text italic.</p><p>Apart from the direct inheritance of the marquee styling, it is also possible to use relative inheritance for numeric specifications (e.g. <code>lineheight = relative(2)</code> to double the current lineheight) or set sizes based on the current or root element font size (using
<a href=https://marquee.r-lib.org/reference/style_helpers.html target=_blank rel=noopener><code>em()</code></a> and
<a href=https://marquee.r-lib.org/reference/style_helpers.html target=_blank rel=noopener><code>rem()</code></a> respectively). Lastly, you can also mark a specification as &ldquo;non-inheritable&rdquo; using
<a href=https://marquee.r-lib.org/reference/style_helpers.html target=_blank rel=noopener><code>skip_inherit()</code></a>. This essentially instructs any children to not inherit the value but instead inherit the value from the grand-parent element.</p><h2 id=images>Images
<a href=#images><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Markdown (famously) supports adding images through the <code>![alt text](path/to/image)</code> syntax. Since marquee supports the full CommonMark spec, this is of course also supported. The only limitation is that the &ldquo;alt text&rdquo; is ignored since hovering tool-tips or screen-readers are not supported for the output types that marquee renders to.</p><p>If an image is placed on a line together with surrounding text it will be rendered to fit the line height of the line. If it is placed by itself on its own line it will span the width available:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>logo</span> <span class=o>&lt;-</span> <span class=nf><a href=https://rdrr.io/r/base/system.file.html>system.file</a></span><span class=o>(</span><span class=s>"help"</span>, <span class=s>"figures"</span>, <span class=s>"logo.png"</span>, package <span class=o>=</span> <span class=s>"marquee"</span><span class=o>)</span></span>
<span><span class=nv>header_img</span> <span class=o>&lt;-</span> <span class=s>"thumbnail-wd.jpg"</span></span>
<span></span>
<span><span class=nv>md_img</span> <span class=o>&lt;-</span> </span>
<span><span class=s>"# About marquee ![](&#123;logo&#125;)</span></span>
<span><span class=s></span></span>
<span><span class=s>Both PNG (above), JPEG (below), and SVG (not shown) are supported</span></span>
<span><span class=s></span></span>
<span><span class=s>![](&#123;header_img&#125;)</span></span>
<span><span class=s></span></span>
<span><span class=s>The above image is treated like a block element</span></span>
<span><span class=s>"</span></span>
<span></span>
<span><span class=nv>md_img</span> <span class=o>&lt;-</span> <span class=nf><a href=https://marquee.r-lib.org/reference/marquee_glue.html>marquee_glue</a></span><span class=o>(</span><span class=nv>md_img</span><span class=o>)</span></span>
<span></span>
<span><span class=nf>grid</span><span class=nf>::</span><span class=nf><a href=https://rdrr.io/r/grid/grid.draw.html>grid.draw</a></span><span class=o>(</span><span class=nf><a href=https://marquee.r-lib.org/reference/marquee_grob.html>marquee_grob</a></span><span class=o>(</span><span class=nv>md_img</span><span class=o>)</span><span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-6-1.png width=700px style=display:block;margin:auto></p></div><p>Apart from showing support for images we also introduce a new function above,
<a href=https://marquee.r-lib.org/reference/marquee_glue.html target=_blank rel=noopener><code>marquee_glue()</code></a>. It is a function that works very much like
<a href=https://glue.tidyverse.org/reference/glue.html target=_blank rel=noopener><code>glue::glue()</code></a> and performs text interpolation. However, this variant understands the custom span syntax of marquee so that these will not be treated as interpolation sites. Further, it turns off the <code>#</code> interpretation as a comment character as this interferes with the markdown header syntax.</p><p>All of the above is pretty standard markdown and since I prefixed this whole blog post with &ldquo;full markdown support&rdquo; it shouldn&rsquo;t come as a big surprise. However, marquee has one last trick up its sleeve: R graphics interpolation. Quite simply, if you, instead of providing a path to a file, provide the name of an R variable holding a graphic object, this will be included as an image. Here&rsquo;s how it works:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>plot</span> <span class=o>&lt;-</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/ggplot.html>ggplot</a></span><span class=o>(</span><span class=nv>mtcars</span><span class=o>)</span> <span class=o>+</span> </span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/geom_point.html>geom_point</a></span><span class=o>(</span><span class=nf><a href=https://ggplot2.tidyverse.org/reference/aes.html>aes</a></span><span class=o>(</span><span class=nv>mpg</span>, <span class=nv>disp</span><span class=o>)</span><span class=o>)</span> <span class=o>+</span> </span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/geom_point.html>geom_point</a></span><span class=o>(</span><span class=nf><a href=https://ggplot2.tidyverse.org/reference/aes.html>aes</a></span><span class=o>(</span><span class=nv>mpg</span>, <span class=nv>disp</span><span class=o>)</span>, <span class=nv>mtcars</span><span class=o>[</span><span class=m>1</span>,<span class=o>]</span>, colour <span class=o>=</span> <span class=s>"red"</span>, size <span class=o>=</span> <span class=m>3</span><span class=o>)</span></span>
<span></span>
<span><span class=nv>point</span> <span class=o>&lt;-</span> <span class=nf>grid</span><span class=nf>::</span><span class=nf><a href=https://rdrr.io/r/grid/grid.points.html>pointsGrob</a></span><span class=o>(</span>x <span class=o>=</span> <span class=m>0.5</span>, y <span class=o>=</span> <span class=m>0.5</span>, pch <span class=o>=</span> <span class=m>19</span>, gp <span class=o>=</span> <span class=nf>grid</span><span class=nf>::</span><span class=nf><a href=https://rdrr.io/r/grid/gpar.html>gpar</a></span><span class=o>(</span>col <span class=o>=</span> <span class=s>"red"</span><span class=o>)</span><span class=o>)</span></span>
<span></span>
<span><span class=nv>md_plots</span> <span class=o>&lt;-</span> </span>
<span><span class=s>"# Plots</span></span>
<span><span class=s>In the plot below, the red dot (![](point)) shows the Mazda RX4</span></span>
<span><span class=s></span></span>
<span><span class=s>![](plot)</span></span>
<span><span class=s>"</span></span>
<span></span>
<span><span class=nf>grid</span><span class=nf>::</span><span class=nf><a href=https://rdrr.io/r/grid/grid.draw.html>grid.draw</a></span><span class=o>(</span><span class=nf><a href=https://marquee.r-lib.org/reference/marquee_grob.html>marquee_grob</a></span><span class=o>(</span><span class=nv>md_plots</span><span class=o>)</span><span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-7-1.png width=700px style=display:block;margin:auto></p></div><p>This also means that your ggplots can contain additional ggplots (or other graphics) anywhere you are allowed to place text (using
<a href=https://marquee.r-lib.org/reference/geom_marquee.html target=_blank rel=noopener><code>geom_marquee()</code></a> and
<a href=https://marquee.r-lib.org/reference/element_marquee.html target=_blank rel=noopener><code>element_marquee()</code></a>) - for better or worse&mldr;</p><p><img src=figs/they_didnt_stop.gif style=display:block;margin:auto></p><h2 id=limitations>Limitations
<a href=#limitations><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Marquee&rsquo;s biggest limitation is its reliance on very new features in the graphics engine. The rendering will <em>not</em> work on anything before R 4.3, but even then it requires the graphics device to support a range of new features, most importantly the new glyph specification introduced in R 4.3. While several graphics devices do support the required features, most notably those powered by Cairo as well as all devices in ragg, many do not. The default Windows graphics device continues to lag behind and the default on macOS, while supporting glyphs, can crash in some situations bringing the whole R session down with it (this is still being investigated). So we are in no doubt threading the frontier here. All of this is set to resolve itself (maybe except for the default Windows device) as time passes.</p><p>A limitation of great interest to me is the lack of support in svglite. svglite is build on a core idea of post-editability and thus wants all its text to be selectable and editable when opened in a capable program such as Adobe Illustrator. However, the graphics engine API that powers the new capabilities does not really allow this and I&rsquo;m still figuring out how to reconcile it. It will eventually be solved though.</p><p>Lastly, while not really part of HTML syntax directly, many people rely on HTML inside markdown documents to solve layout and styling tasks that markdown doesn&rsquo;t support. The way it works is that markdown passes the HTML through unmodified and then the HTML is parsed by the HTML renderer (often the browser) used to display the rendered markdown document. This makes it seem like understanding HTML is part of markdown, while it&rsquo;s really not. The reason I&rsquo;m going through all this explanation is to say that marquee has no understanding of HTML and will not render it as expected. While some HTML tags and CSS settings have clear counterparts in markdown and the marquee styling system it is much better to have a clear &ldquo;no-support&rdquo; over an arbitrary limited support.
<a href=https://marquee.r-lib.org/reference/marquee_grob.html target=_blank rel=noopener><code>marquee_grob()</code></a>/
<a href=https://marquee.r-lib.org/reference/marquee_parse.html target=_blank rel=noopener><code>marquee_parse()</code></a> have an argument (<code>ignore_html</code>) that controls whether HTML are outright removed from the output (default), or if it is included verbatim.</p><h2 id=acknowledgements>Acknowledgements
<a href=#acknowledgements><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Marquee is the latest in a stream of advancements when it comes to text rendering and font support in R. It builds on top of my work with
<a href=https://systemfonts.r-lib.org/index.html target=_blank rel=noopener>systemfonts</a>,
<a href=https://github.com/r-lib/textshaping target=_blank rel=noopener>textshaping</a>, and
<a href=https://ragg.r-lib.org/index.html target=_blank rel=noopener>ragg</a>, but also pays great debt to Paul Murrell&rsquo;s work on adding a new, more low level API for text rendering to grid and the graphics engine. Lastly, Claus Wilke&rsquo;s work on
<a href=https://wilkelab.org/gridtext/ target=_blank rel=noopener>gridtext</a> and
<a href=https://wilkelab.org/ggtext/ target=_blank rel=noopener>ggtext</a> showed the power and need for rich text support in R and filled a gap until the technical foundation for marquee was built out.</p></div></div><div class=column25><div class="section hideOnMobile"><div class=sectionTitle>Contents</div><nav id=TableOfContents><ul><li><a href=#an-example>An example</a></li><li><a href=#use-in-ggplot2>Use in ggplot2</a></li><li><a href=#styling>Styling</a></li><li><a href=#images>Images</a></li><li><a href=#limitations>Limitations</a></li><li><a href=#acknowledgements>Acknowledgements</a></li></ul></nav></div><div class=section></div></div></div></div></div><div id=rStudioFooter class=band><div class=bandContent><div id=copyright>The tidyverse is proudly supported by <a class=rstudioLogo href=https://posit.co/ aria-label="Posit Homepage"></a></div><div id=logos><a href=https://www.tidyverse.org/google_privacy_policy>Privacy policy</a>
<a href=https://github.com/tidyverse class="footerLogo gitHub" aria-label="Tidyverse GitHub organization"></a><a href=https://twitter.com/hashtag/rstats class="footerLogo twitter" aria-label="rstats hashtag on twitter.com"></a></div></div></div></div></div><script src=/js/math-code.js></script><script type=text/x-mathjax-config>
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    processEscapes: true
  }
});
</script><script async src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><script type=application/javascript>var dnt=(navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack);var doNotTrack=(dnt=="1"||dnt=="yes");if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');if(window.sessionStorage){var GA_SESSION_STORAGE_KEY='ga:clientId';ga('create','UA-115082821-1',{'storage':'none','clientId':sessionStorage.getItem(GA_SESSION_STORAGE_KEY)});ga(function(tracker){sessionStorage.setItem(GA_SESSION_STORAGE_KEY,tracker.get('clientId'));});}
ga('set','anonymizeIp',true);ga('send','pageview');}</script></body></html></div></div></body></html>