<!doctype html><html><head><!doctype html><html lang=en-us><link rel=stylesheet href=/css/fonts.css><link rel=stylesheet href=/css/main-site.css><link rel=stylesheet href=/css/fa5-all.css><style type=text/css>body{background-color:#fff;color:#1a1917}a{color:#38577f}a:hover{color:#42709b}a:focus{outline-color:#42709b}.column25-left .sectionTitle a:hover:not(.current),.column16-left .sectionTitle a:hover:not(.current){color:#1a1917}.icon-attribution,.icon-attribution a{color:#1a1917;opacity:75%}#homeContent .band.first{background-color:#fff}#homeContent .band.second{background-color:#fdeba4}#homeContent .band.third{background-color:#fff}#rStudioHeader{background-color:#1a162d;color:#fff}#rStudioHeader .productName{color:#fff}#rStudioHeader .productName:hover,#rStudioHeader .productName:focus{color:#fdeba4}#rStudioHeader #menu .menuItem.a{background-color:#75aadb;color:#fff}#rStudioHeader #menu .menuItem:hover{background-color:#484557;color:#fff}#rStudioHeader #menu .menuItem.current{background-color:#fff;color:#1a162d;text-decoration:none}#rStudioFooter.band{background-color:#767381}#rStudioFooter .bandContent #copyright{color:#e3eef8}table tbody tr:nth-child(even){background-color:#f7faff}table tbody tr:nth-child(odd){background-color:#fff}.latest{border-top:.5em solid <no value>}.event{-moz-box-shadow:0 0 0 0 rgba(0,0,0,.1);-webkit-box-shadow:0 0 0 0 rgba(0,0,0,.1);box-shadow:0 0 0 0 rgba(0,0,0,.1)}.section .event{background-color:#eab0c41a}.section .event{border-top:7pt solid #a19ea936}.section .event a{color:#1a162d}.section .event{color:#404040}</style><link rel=stylesheet href=/css/tidyverse.css><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Hugo 0.71.1"><title>patchwork 1.3.0</title><meta property="og:title" content="patchwork 1.3.0"><meta property="og:description" content="patchwork 1.3.0 has just been released bringing refinements to the `free()` function and full on support for gt tables"><meta property="og:type" content="article"><meta property="og:url" content="https://www.tidyverse.org/blog/2024/09/patchwork-1-3-0/"><meta property="twitter:card" content="summary_large_image"><meta property="og:title" content="patchwork 1.3.0 - Tidyverse"><meta property="description" content="patchwork 1.3.0 has just been released bringing refinements to the `free()` function and full on support for gt tables"><meta property="og:description" content="patchwork 1.3.0 has just been released bringing refinements to the `free()` function and full on support for gt tables"><meta property="og:image" content="https://www.tidyverse.org/blog/2024/09/patchwork-1-3-0/thumbnail-sq.jpg"><meta name=twitter:image content="https://www.tidyverse.org/blog/2024/09/patchwork-1-3-0/thumbnail-wd.jpg"><link rel=apple-touch-icon sizes=180x180 href=/images/favicons/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/images/favicons/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/images/favicons/favicon-16x16.png><link rel=manifest href=/images/favicons/site.webmanifest><link rel=mask-icon href=/images/favicons/safari-pinned-tab.svg><link rel="shortcut icon" href=/images/favicons/favicon.ico><meta name=msapplication-TileColor content="#da532c"><meta name=msapplication-config href=/images/favicons/browserconfig.xml><script type=text/javascript src=/js/jquery-3.5.1.min.js></script><script type=text/javascript src=/js/site.js></script><link rel=icon href=/images/favicon.ico><script type=text/javascript src=/js/clipboard.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin=anonymous></script><script defer data-domain=tidyverse.org,all.tidyverse.org src=https://plausible.io/js/plausible.js></script></head><body><div id=appTidyverseSite class="shrinkHeader alwaysShrinkHeader"><div id=main><div id=rStudioHeader><nav class=band><div class="innards bandContent"><div><a class=productName href=/%20/>Tidyverse</a></div><div id=menu><div id=menuToggler></div><div id=menuItems><a class=menuItem href=/packages/>Packages</a>
<a class="menuItem current" href=/blog/>Blog</a>
<a class=menuItem href=/learn/>Learn</a>
<a class=menuItem href=/help/>Help</a>
<a class=menuItem href=/contribute/>Contribute</a></div></div></div></nav></div><main><div class="band padForHeader pushFooter"><div class=bandContent><div class="full splitColumns withMobileMargins"><div class=column75><h1 class=article-title>patchwork 1.3.0</h1><div class=article-header aria-hidden=true><div class=photo><img src=/blog/2024/09/patchwork-1-3-0/thumbnail-wd.jpg></div><div class=photoCredit>Photo by <a href=https://unsplash.com/photos/sewing-silk-and-scissors-dG35-kUxv34>Dihn Pham</a></div></div><span class=article-date><i class="fas fa-calendar-day fa-fw"></i>&nbsp;&nbsp;2024/09/13</span><p style=margin-bottom:.5em;margin-top:.85em><i class="fas fa-tags"></i>&nbsp;
<a href=/tags/ggplot2/>ggplot2</a>,
<a href=/tags/gt/>gt</a>,
<a href=/tags/patchwork/>patchwork</a></p><p style=margin-top:.5em><i class="fas fa-user-circle fa-fw"></i>&nbsp;
Thomas Lin Pedersen</p><div class=article-content><p>I&rsquo;m excited to present
<a href=https://patchwork.data-imaginist.com target=_blank rel=noopener>patchwork</a> 1.3.0, our package for creating multifigure plot compositions. This versions adds table support and improves support for &ldquo;free"ing components to span across multiple grid cells.</p><p>You can install patchwork from CRAN with:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nf><a href=https://rdrr.io/r/utils/install.packages.html>install.packages</a></span><span class=o>(</span><span class=s>"patchwork"</span><span class=o>)</span></span></code></pre></div><p>You can see a full list of changes in the
<a href=https://patchwork.data-imaginist.com/news/index.html target=_blank rel=noopener>release notes</a></p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=kr><a href=https://rdrr.io/r/base/library.html>library</a></span><span class=o>(</span><span class=nv><a href=https://patchwork.data-imaginist.com>patchwork</a></span><span class=o>)</span></span>
<span><span class=kr><a href=https://rdrr.io/r/base/library.html>library</a></span><span class=o>(</span><span class=nv><a href=https://ggplot2.tidyverse.org>ggplot2</a></span><span class=o>)</span></span>
<span><span class=kr><a href=https://rdrr.io/r/base/library.html>library</a></span><span class=o>(</span><span class=nv><a href=https://gt.rstudio.com>gt</a></span><span class=o>)</span></span></code></pre></div><h2 id=tables-are-figures-too>Tables are figures too
<a href=#tables-are-figures-too><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>The new and shiny feature of the release is that patchwork now has native support for gt objects, making it possible to compose beautifully formatted tables together with your figures. This has been made possible through Teun Van den Brand&rsquo;s effort to provide grob output to gt. While this means that you can now pass in gt objects to
<a href=https://patchwork.data-imaginist.com/reference/wrap_elements.html target=_blank rel=noopener><code>wrap_elements()</code></a> in the same way as other supported data types, it also goes one step further, using the semantics of the table design to add table specific formatting options through the new
<a href=https://patchwork.data-imaginist.com/reference/wrap_table.html target=_blank rel=noopener><code>wrap_table()</code></a> function.</p><p>But let&rsquo;s take a step back and see how the simplest support works in reality:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>p1</span> <span class=o>&lt;-</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/ggplot.html>ggplot</a></span><span class=o>(</span><span class=nv>airquality</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/geom_path.html>geom_line</a></span><span class=o>(</span><span class=nf><a href=https://ggplot2.tidyverse.org/reference/aes.html>aes</a></span><span class=o>(</span>x <span class=o>=</span> <span class=nv>Day</span>, y <span class=o>=</span> <span class=nv>Temp</span>, colour <span class=o>=</span> <span class=nv>month.name</span><span class=o>[</span><span class=nv>Month</span><span class=o>]</span><span class=o>)</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/labs.html>labs</a></span><span class=o>(</span>colour <span class=o>=</span> <span class=s>"Month"</span><span class=o>)</span></span>
<span></span>
<span><span class=nv>aq</span> <span class=o>&lt;-</span> <span class=nv>airquality</span><span class=o>[</span><span class=nf><a href=https://rdrr.io/r/base/sample.html>sample</a></span><span class=o>(</span><span class=nf><a href=https://rdrr.io/r/base/nrow.html>nrow</a></span><span class=o>(</span><span class=nv>airquality</span><span class=o>)</span>, <span class=m>10</span><span class=o>)</span>, <span class=o>]</span></span>
<span><span class=nv>p1</span> <span class=o>+</span> <span class=nf><a href=https://gt.rstudio.com/reference/gt.html>gt</a></span><span class=o>(</span><span class=nv>aq</span><span class=o>)</span> <span class=o>+</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/labs.html>ggtitle</a></span><span class=o>(</span><span class=s>"Sample of the dataset"</span><span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-2-1.png width=700px style=display:block;margin:auto></p></div><p>A few things can be gathered already from this small example. Tables can have titles (and subtitles, captions, and tags) like regular plots (in that sense they behave like
<a href=https://patchwork.data-imaginist.com/reference/wrap_elements.html target=_blank rel=noopener><code>wrap_elements()</code></a> output). Also, and this is perhaps more interesting, patchwork is aware that the first row is special (a header row), and thus places that on top of the panel area so that the plot region of the left plot is aligned with the body of the table, not the full table.</p><p>Lastly, we see that tables often have a fixed size, contrary to plots which can shrink and expand based on how much room they have. Because of this, our table is overflowing it&rsquo;s region in the plot above creating a not-so-great look.</p><p>Let&rsquo;s see how we can use
<a href=https://patchwork.data-imaginist.com/reference/wrap_table.html target=_blank rel=noopener><code>wrap_table()</code></a> to control some of these behaviors. First, while we could decrease the font size in the table to make it smaller, we could also allow it some more space instead. We could do this by using <code>plot_layout(widths = ...)</code> but it would require a fair amount of guessing on our side to get it just right. Thankfully, patchwork is smart enough to figure it out for us and we can instruct it to do so using the <code>space</code> argument in
<a href=https://patchwork.data-imaginist.com/reference/wrap_table.html target=_blank rel=noopener><code>wrap_table()</code></a>. Setting it to <code>"free_y"</code> instructs it to fix the width to the table width but keep the height free:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>p1</span> <span class=o>+</span> <span class=nf><a href=https://patchwork.data-imaginist.com/reference/wrap_table.html>wrap_table</a></span><span class=o>(</span><span class=nv>aq</span>, space <span class=o>=</span> <span class=s>"free_y"</span><span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-3-1.png width=700px style=display:block;margin:auto></p></div><p>Setting <code>space</code> to <code>"fixed"</code> would constrain both the width and the height of the area it occupies. Since we only have a single row in our layout this would leave us with some empty horizontal space:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>p1</span> <span class=o>+</span> <span class=nf><a href=https://patchwork.data-imaginist.com/reference/wrap_table.html>wrap_table</a></span><span class=o>(</span><span class=nv>aq</span>, space <span class=o>=</span> <span class=s>"fixed"</span><span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-4-1.png width=700px style=display:block;margin:auto></p></div><p>If the space is fixed in the y direction and the table has any source notes or footnotes, these will behave like the column header and be placed outside the panel area depending on the <code>panel</code> setting</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>aq_footer</span> <span class=o>&lt;-</span> <span class=nf><a href=https://gt.rstudio.com/reference/gt.html>gt</a></span><span class=o>(</span><span class=nv>aq</span><span class=o>)</span> <span class=o>|&gt;</span></span>
<span>  <span class=nf><a href=https://gt.rstudio.com/reference/tab_source_note.html>tab_source_note</a></span><span class=o>(</span><span class=s>"This is not part of the table body"</span><span class=o>)</span></span>
<span><span class=nv>p1</span> <span class=o>+</span> <span class=nf><a href=https://patchwork.data-imaginist.com/reference/wrap_table.html>wrap_table</a></span><span class=o>(</span><span class=nv>aq_footer</span>, space <span class=o>=</span> <span class=s>"fixed"</span><span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-5-1.png width=700px style=display:block;margin:auto></p></div><p>While the space argument is great for making the composition look good and the table well placed in the whole, it can also serve a different purpose of making sure that rows (or columns) are aligned with the axis of a plot. There are no facilities to ensure that the breaks order matches between plots and tables so that is the responsibility of the user, but otherwise this is a great way to use tables to directly augment a plot:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>p2</span> <span class=o>&lt;-</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/ggplot.html>ggplot</a></span><span class=o>(</span><span class=nv>airquality</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/geom_boxplot.html>geom_boxplot</a></span><span class=o>(</span><span class=nf><a href=https://ggplot2.tidyverse.org/reference/aes.html>aes</a></span><span class=o>(</span>x <span class=o>=</span> <span class=nv>month.name</span><span class=o>[</span><span class=nv>Month</span><span class=o>]</span>, y <span class=o>=</span> <span class=nv>Temp</span><span class=o>)</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/theme.html>theme</a></span><span class=o>(</span>axis.text.x <span class=o>=</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/element.html>element_blank</a></span><span class=o>(</span><span class=o>)</span>, axis.title.x <span class=o>=</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/element.html>element_blank</a></span><span class=o>(</span><span class=o>)</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/scale_discrete.html>scale_x_discrete</a></span><span class=o>(</span>expand <span class=o>=</span> <span class=nf><a href=https://rdrr.io/r/base/c.html>c</a></span><span class=o>(</span><span class=m>0</span>, <span class=m>0.5</span><span class=o>)</span><span class=o>)</span></span>
<span></span>
<span><span class=c># Construct our table</span></span>
<span><span class=nv>table</span> <span class=o>&lt;-</span> <span class=nf><a href=https://rdrr.io/r/base/cbind.html>rbind</a></span><span class=o>(</span></span>
<span>  <span class=nf><a href=https://rdrr.io/r/base/tapply.html>tapply</a></span><span class=o>(</span><span class=nv>airquality</span><span class=o>$</span><span class=nv>Temp</span>, <span class=nv>airquality</span><span class=o>$</span><span class=nv>Month</span>, <span class=nv>max</span><span class=o>)</span>,</span>
<span>  <span class=nf><a href=https://rdrr.io/r/base/tapply.html>tapply</a></span><span class=o>(</span><span class=nv>airquality</span><span class=o>$</span><span class=nv>Temp</span>, <span class=nv>airquality</span><span class=o>$</span><span class=nv>Month</span>, <span class=nv>median</span><span class=o>)</span>,</span>
<span>  <span class=nf><a href=https://rdrr.io/r/base/tapply.html>tapply</a></span><span class=o>(</span><span class=nv>airquality</span><span class=o>$</span><span class=nv>Temp</span>, <span class=nv>airquality</span><span class=o>$</span><span class=nv>Month</span>, <span class=nv>min</span><span class=o>)</span></span>
<span><span class=o>)</span></span>
<span><span class=nf><a href=https://rdrr.io/r/base/colnames.html>colnames</a></span><span class=o>(</span><span class=nv>table</span><span class=o>)</span> <span class=o>&lt;-</span> <span class=nv>month.name</span><span class=o>[</span><span class=m>5</span><span class=o>:</span><span class=m>9</span><span class=o>]</span></span>
<span><span class=nv>table</span> <span class=o>&lt;-</span> <span class=nf><a href=https://rdrr.io/r/base/data.frame.html>data.frame</a></span><span class=o>(</span></span>
<span>  Measure <span class=o>=</span> <span class=nf><a href=https://rdrr.io/r/base/c.html>c</a></span><span class=o>(</span><span class=s>"Max"</span>, <span class=s>"Median"</span>, <span class=s>"Min"</span><span class=o>)</span>,</span>
<span>  <span class=nv>table</span></span>
<span><span class=o>)</span></span>
<span><span class=nv>table</span> <span class=o>&lt;-</span> <span class=nf><a href=https://gt.rstudio.com/reference/gt.html>gt</a></span><span class=o>(</span><span class=nv>table</span>, rowname_col <span class=o>=</span> <span class=s>"Measure"</span><span class=o>)</span> <span class=o>|&gt;</span></span>
<span>  <span class=nf><a href=https://gt.rstudio.com/reference/cols_width.html>cols_width</a></span><span class=o>(</span><span class=nf><a href=https://tidyselect.r-lib.org/reference/starts_with.html>contains</a></span><span class=o>(</span><span class=nv>month.name</span><span class=o>)</span> <span class=o>~</span> <span class=nf><a href=https://gt.rstudio.com/reference/px.html>px</a></span><span class=o>(</span><span class=m>100</span><span class=o>)</span><span class=o>)</span> <span class=o>|&gt;</span></span>
<span>  <span class=nf><a href=https://gt.rstudio.com/reference/cols_align.html>cols_align</a></span><span class=o>(</span>align <span class=o>=</span> <span class=s>"center"</span><span class=o>)</span> <span class=o>|&gt;</span></span>
<span>  <span class=nf><a href=https://gt.rstudio.com/reference/cols_align.html>cols_align</a></span><span class=o>(</span>align <span class=o>=</span> <span class=s>"right"</span>, columns <span class=o>=</span> <span class=s>"Measure"</span><span class=o>)</span></span>
<span></span>
<span><span class=nv>p2</span> <span class=o>/</span> <span class=nf><a href=https://patchwork.data-imaginist.com/reference/wrap_table.html>wrap_table</a></span><span class=o>(</span><span class=nv>table</span>, space <span class=o>=</span> <span class=s>"fixed"</span><span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-6-1.png width=700px style=display:block;margin:auto></p></div><p>Circling back, there was another argument to
<a href=https://patchwork.data-imaginist.com/reference/wrap_table.html target=_blank rel=noopener><code>wrap_table()</code></a> we didn&rsquo;t get into yet. In the plot above, we see that the row names are conveniently aligned with the axis rather than the panel of the plot above, in the same way as the headers where placed outside the panel area. This is a nice default and generally makes sense for the semantics of a table, but you might want something different. The <code>panel</code> argument allows you to control this exact behavior. It takes <code>"body"</code>, <code>"full"</code>, <code>"rows"</code>, or <code>"cols"</code> which indicate what portion of the table should be inside the panel area. The default is <code>"body"</code> which places row and column names outside the panel. <code>"full"</code>, on the contrary, places everything inside, while <code>"rows"</code> and <code>"cols"</code> are half versions that allows you to keep either column <em>or</em> row names outside the panel respectively.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=c># Place all rows (including the header row) inside the panel area</span></span>
<span><span class=nv>p1</span> <span class=o>+</span> <span class=nf><a href=https://patchwork.data-imaginist.com/reference/wrap_table.html>wrap_table</a></span><span class=o>(</span><span class=nv>aq</span>, panel <span class=o>=</span> <span class=s>"rows"</span>, space <span class=o>=</span> <span class=s>"free_y"</span><span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-7-1.png width=700px style=display:block;margin:auto></p></div><p>Just like the tables support ggplot2-like titles, they also support tags, meaning that patchworks auto-tagging works as expected. It can be turned off using the <code>ignore_tag</code> argument but often you&rsquo;d want to treat it as a figure in the figure text:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>p1</span> <span class=o>+</span> <span class=nf><a href=https://patchwork.data-imaginist.com/reference/wrap_table.html>wrap_table</a></span><span class=o>(</span><span class=nv>aq</span>, panel <span class=o>=</span> <span class=s>"rows"</span>, space <span class=o>=</span> <span class=s>"free_y"</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://patchwork.data-imaginist.com/reference/plot_annotation.html>plot_annotation</a></span><span class=o>(</span>tag_levels <span class=o>=</span> <span class=s>"A"</span><span class=o>)</span> <span class=o>&amp;</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/theme.html>theme</a></span><span class=o>(</span>plot.tag <span class=o>=</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/element.html>element_text</a></span><span class=o>(</span>margin <span class=o>=</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/element.html>margin</a></span><span class=o>(</span><span class=m>0</span>, <span class=m>6</span>, <span class=m>6</span>, <span class=m>0</span><span class=o>)</span><span class=o>)</span><span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-8-1.png width=700px style=display:block;margin:auto></p></div><h3 id=accesibility>Accesibility
<a href=#accesibility><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>We truly believe that the features laid out above will be a boon for augmenting your data visualisation with data that can be read precisely at a glance. However, we would be remiss to not note how tables that are part of a patchwork visualisation doesn&rsquo;t have the same accessibility featurees as a gt table included directly in e.g. an HTML output. This is because graphics are rasterised into a PNG file and thus looses all semantical information that is inherent in a table. This should be kept in mind when providing Alt text for your figures so you ensure they are legible for everyone.</p><h3 id=future>Future
<a href=#future><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>The support on the patchwork end is likely done at this point, but the conversion to grobs that has been added to gt is still somewhat young and will improve over time. It is likely that markdown formatting (through marquee) and other niceties will get added, leading to even more power in composing tables with plots using patchwork as the glue between them. As with the
<a href=https://quarto.org/docs/blog/posts/2024-07-02-beautiful-tables-in-typst/ target=_blank rel=noopener>support for gt in typst</a> the support for gt in patchwork is part of our larger effort to bring the power of gt to more environments and create a single unified solution to table styling.</p><h2 id=with-freedom-comes-great-responsibility>With freedom comes great responsibility
<a href=#with-freedom-comes-great-responsibility><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>The second leg of this release concerns the
<a href=https://patchwork.data-imaginist.com/reference/free.html target=_blank rel=noopener><code>free()</code></a> function which was introduced in the last release. I devoted a whole section of my posit::conf talk this year to talk about
<a href=https://patchwork.data-imaginist.com/reference/free.html target=_blank rel=noopener><code>free()</code></a> and how it was a good thing to say no to requests for functionality until you have a solution that fits into your API and doesn&rsquo;t add clutter. I really like how the API for
<a href=https://patchwork.data-imaginist.com/reference/free.html target=_blank rel=noopener><code>free()</code></a> turned out but I also knew it could do more. In this release it delivers on those promises with two additional arguments.</p><h3 id=which-side>Which side?
<a href=#which-side><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>As it were,
<a href=https://patchwork.data-imaginist.com/reference/free.html target=_blank rel=noopener><code>free()</code></a> could only be used to completely turn off alignment of a plot, e.g. like below:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>p1</span> <span class=o>&lt;-</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/ggplot.html>ggplot</a></span><span class=o>(</span><span class=nv>mtcars</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/geom_bar.html>geom_bar</a></span><span class=o>(</span><span class=nf><a href=https://ggplot2.tidyverse.org/reference/aes.html>aes</a></span><span class=o>(</span>y <span class=o>=</span> <span class=nf><a href=https://rdrr.io/r/base/factor.html>factor</a></span><span class=o>(</span><span class=nv>gear</span><span class=o>)</span>, fill <span class=o>=</span> <span class=nf><a href=https://rdrr.io/r/base/factor.html>factor</a></span><span class=o>(</span><span class=nv>gear</span><span class=o>)</span><span class=o>)</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/scale_discrete.html>scale_y_discrete</a></span><span class=o>(</span></span>
<span>    <span class=s>""</span>,</span>
<span>    labels <span class=o>=</span> <span class=nf><a href=https://rdrr.io/r/base/c.html>c</a></span><span class=o>(</span><span class=s>"3 gears are often enough"</span>,</span>
<span>               <span class=s>"But, you know, 4 is a nice number"</span>,</span>
<span>               <span class=s>"I would def go with 5 gears in a modern car"</span><span class=o>)</span></span>
<span>  <span class=o>)</span></span>
<span><span class=nv>p2</span> <span class=o>&lt;-</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/ggplot.html>ggplot</a></span><span class=o>(</span><span class=nv>mtcars</span><span class=o>)</span> <span class=o>+</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/geom_point.html>geom_point</a></span><span class=o>(</span><span class=nf><a href=https://ggplot2.tidyverse.org/reference/aes.html>aes</a></span><span class=o>(</span><span class=nv>mpg</span>, <span class=nv>disp</span><span class=o>)</span><span class=o>)</span></span>
<span></span>
<span><span class=nf><a href=https://patchwork.data-imaginist.com/reference/free.html>free</a></span><span class=o>(</span><span class=nv>p1</span><span class=o>)</span> <span class=o>/</span> <span class=nv>p2</span></span>
</code></pre><p><img src=figs/unnamed-chunk-9-1.png width=700px style=display:block;margin:auto></p></div><p>We can see that panel alignment has been turned off both to the left and to the right (and top and bottom if it were visible). But perhaps you are only interested in un-aligning the left side, keeping the legend to the right of both plots. Now you can, thanks to the <code>side</code> argument which takes a string containing one or more of the <code>t</code>, <code>r</code>, <code>b</code>, and <code>l</code> characters to indicate which sides to apply the freeing to (default is <code>"trbl"</code> meaning &ldquo;target all sides&rdquo;).</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nf><a href=https://patchwork.data-imaginist.com/reference/free.html>free</a></span><span class=o>(</span><span class=nv>p1</span>, side <span class=o>=</span> <span class=s>"l"</span><span class=o>)</span> <span class=o>/</span> <span class=nv>p2</span></span>
</code></pre><p><img src=figs/unnamed-chunk-10-1.png width=700px style=display:block;margin:auto></p></div><p>Freeing works inside nested patchworks, where you can target various sides at various levels:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>p3</span> <span class=o>&lt;-</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/ggplot.html>ggplot</a></span><span class=o>(</span><span class=nv>mtcars</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/geom_boxplot.html>geom_boxplot</a></span><span class=o>(</span><span class=nf><a href=https://ggplot2.tidyverse.org/reference/aes.html>aes</a></span><span class=o>(</span>y <span class=o>=</span> <span class=nf><a href=https://rdrr.io/r/base/factor.html>factor</a></span><span class=o>(</span><span class=nv>gear</span><span class=o>)</span>, <span class=nv>disp</span><span class=o>)</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/scale_discrete.html>scale_y_discrete</a></span><span class=o>(</span></span>
<span>    <span class=s>""</span>,</span>
<span>    labels <span class=o>=</span> <span class=nf><a href=https://rdrr.io/r/base/c.html>c</a></span><span class=o>(</span><span class=s>"... and 3"</span>,</span>
<span>               <span class=s>"4 of them"</span>,</span>
<span>               <span class=s>"5 gears"</span><span class=o>)</span></span>
<span>  <span class=o>)</span></span>
<span></span>
<span></span>
<span><span class=nv>nested</span> <span class=o>&lt;-</span> <span class=nv>p2</span> <span class=o>/</span> <span class=nf><a href=https://patchwork.data-imaginist.com/reference/free.html>free</a></span><span class=o>(</span><span class=nv>p1</span>, side <span class=o>=</span> <span class=s>"l"</span><span class=o>)</span></span>
<span></span>
<span><span class=nf><a href=https://patchwork.data-imaginist.com/reference/free.html>free</a></span><span class=o>(</span><span class=nv>nested</span>, side <span class=o>=</span> <span class=s>"r"</span><span class=o>)</span> <span class=o>/</span></span>
<span>  <span class=nv>p3</span></span>
</code></pre><p><img src=figs/unnamed-chunk-11-1.png width=700px style=display:block;margin:auto></p></div><h3 id=what-does-freeing-means-anyway>What does &ldquo;freeing&rdquo; means anyway?
<a href=#what-does-freeing-means-anyway><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>While being able to target specific sides is pretty great in and off itself, we are not done yet. After being able to <em>not</em> align panels the most requested feature was the possibility of moving the axis title closer to the axis text if alignment had pushed it apart. Consider again our unfreed patchwork:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>p1</span> <span class=o>/</span> <span class=nv>p2</span></span>
</code></pre><p><img src=figs/unnamed-chunk-12-1.png width=700px style=display:block;margin:auto></p></div><p>While we can &ldquo;fix&rdquo; it by letting the top panel stretch, another way to improve upon it would be to move the dangling y-axis title of the bottom plot closer to the axis. Enter the <code>type</code> argument to
<a href=https://patchwork.data-imaginist.com/reference/free.html target=_blank rel=noopener><code>free()</code></a> which informs patchwork how to not align the input. The default (<code>"panel"</code>) works just as
<a href=https://patchwork.data-imaginist.com/reference/free.html target=_blank rel=noopener><code>free()</code></a> always has, but the other two values opens up some new nifty goodies. Setting <code>type = "label"</code> does exactly what we discussed above, freeing the label from alignment so it sticks together with the axis and axis text:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>p1</span> <span class=o>/</span></span>
<span>  <span class=nf><a href=https://patchwork.data-imaginist.com/reference/free.html>free</a></span><span class=o>(</span><span class=nv>p2</span>, type <span class=o>=</span> <span class=s>"label"</span><span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-13-1.png width=700px style=display:block;margin:auto></p></div><p>The other type is <code>"space"</code> which works slightly different. Using this you tell patchwork to not reserve any space for what the side(s) contain. This is perfect in situation where you already have empty space next to it that can fit the content. Consider this plot:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nf><a href=https://patchwork.data-imaginist.com/reference/plot_spacer.html>plot_spacer</a></span><span class=o>(</span><span class=o>)</span> <span class=o>+</span> <span class=nv>p1</span> <span class=o>+</span></span>
<span>  <span class=nv>p2</span> <span class=o>+</span> <span class=nv>p2</span></span>
</code></pre><p><img src=figs/unnamed-chunk-14-1.png width=700px style=display:block;margin:auto></p></div><p>Ugh, the axis text of the top plot pushes everything apart even though there is ample of space for it in the empty region on the left. This is where <code>type = "space"</code> comes in handy:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nf><a href=https://patchwork.data-imaginist.com/reference/plot_spacer.html>plot_spacer</a></span><span class=o>(</span><span class=o>)</span> <span class=o>+</span> <span class=nf><a href=https://patchwork.data-imaginist.com/reference/free.html>free</a></span><span class=o>(</span><span class=nv>p1</span>, type <span class=o>=</span> <span class=s>"space"</span>, side <span class=o>=</span> <span class=s>"l"</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nv>p2</span> <span class=o>+</span> <span class=nv>p2</span></span>
</code></pre><p><img src=figs/unnamed-chunk-15-1.png width=700px style=display:block;margin:auto></p></div><p>Of course, such power comes with the responsibility of you ensuring there is actually space for it &mdash; otherwise it will escape out of the figure area:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nf><a href=https://patchwork.data-imaginist.com/reference/free.html>free</a></span><span class=o>(</span><span class=nv>p1</span>, type <span class=o>=</span> <span class=s>"space"</span>, side <span class=o>=</span> <span class=s>"l"</span><span class=o>)</span> <span class=o>/</span></span>
<span>  <span class=nv>p2</span></span>
</code></pre><p><img src=figs/unnamed-chunk-16-1.png width=700px style=display:block;margin:auto></p></div><p>All the different types of freeing can be stacked on top of each other so you can have a plot that keeps the left axis label together with the axis while also stretches the right side to take up empty space:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>p1</span> <span class=o>/</span></span>
<span>  <span class=nf><a href=https://patchwork.data-imaginist.com/reference/free.html>free</a></span><span class=o>(</span><span class=nf><a href=https://patchwork.data-imaginist.com/reference/free.html>free</a></span><span class=o>(</span><span class=nv>p2</span>, <span class=s>"panel"</span>, <span class=s>"r"</span><span class=o>)</span>, <span class=s>"label"</span>, <span class=s>"l"</span><span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-17-1.png width=700px style=display:block;margin:auto></p></div><p>But as always, don&rsquo;t go overboard. If you find yourself needing to use an elaborate combination of stacked
<a href=https://patchwork.data-imaginist.com/reference/free.html target=_blank rel=noopener><code>free()</code></a> calls there is a good chance that something with your core composition needs rethinking.</p><h2 id=the-rest>The rest
<a href=#the-rest><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>The above are the clear highlights of this release. It also contains the standard bug fixes &mdash; especially in the area of axis collecting which was introduced in the last release and came with a bunch of edge cases that were unaccounted for. There is also a new utility function:
<a href=https://rdrr.io/r/base/merge.html target=_blank rel=noopener><code>merge()</code></a> which is an alternative to the <code>-</code> operator that I don&rsquo;t think many users understood or used. It allows you to merge all plots together into a nested patchwork so that the right hand side is added to a new composition.</p><h2 id=acknowledgements>Acknowledgements
<a href=#acknowledgements><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Thank you to all people who have contributed issues, code and comments to this release:</p><p><a href=https://github.com/BenVolpe94 target=_blank rel=noopener>@BenVolpe94</a>,
<a href=https://github.com/daniellembecker target=_blank rel=noopener>@daniellembecker</a>,
<a href=https://github.com/dchiu911 target=_blank rel=noopener>@dchiu911</a>,
<a href=https://github.com/ericKuo722 target=_blank rel=noopener>@ericKuo722</a>,
<a href=https://github.com/Fan-iX target=_blank rel=noopener>@Fan-iX</a>,
<a href=https://github.com/IndrajeetPatil target=_blank rel=noopener>@IndrajeetPatil</a>,
<a href=https://github.com/jack-davison target=_blank rel=noopener>@jack-davison</a>,
<a href=https://github.com/karchern target=_blank rel=noopener>@karchern</a>,
<a href=https://github.com/laresbernardo target=_blank rel=noopener>@laresbernardo</a>,
<a href=https://github.com/marchtaylor target=_blank rel=noopener>@marchtaylor</a>,
<a href=https://github.com/mariadelmarq target=_blank rel=noopener>@mariadelmarq</a>,
<a href=https://github.com/Maschette target=_blank rel=noopener>@Maschette</a>,
<a href=https://github.com/michaeltopper1 target=_blank rel=noopener>@michaeltopper1</a>,
<a href=https://github.com/mkoohafkan target=_blank rel=noopener>@mkoohafkan</a>,
<a href=https://github.com/n-kall target=_blank rel=noopener>@n-kall</a>,
<a href=https://github.com/person-c target=_blank rel=noopener>@person-c</a>,
<a href=https://github.com/pettyalex target=_blank rel=noopener>@pettyalex</a>,
<a href=https://github.com/petzi53 target=_blank rel=noopener>@petzi53</a>,
<a href=https://github.com/phispu target=_blank rel=noopener>@phispu</a>,
<a href=https://github.com/psychelzh target=_blank rel=noopener>@psychelzh</a>,
<a href=https://github.com/rinivarg target=_blank rel=noopener>@rinivarg</a>,
<a href=https://github.com/selkamand target=_blank rel=noopener>@selkamand</a>,
<a href=https://github.com/Soham6298 target=_blank rel=noopener>@Soham6298</a>,
<a href=https://github.com/svraka target=_blank rel=noopener>@svraka</a>,
<a href=https://github.com/teng-gao target=_blank rel=noopener>@teng-gao</a>,
<a href=https://github.com/teunbrand target=_blank rel=noopener>@teunbrand</a>,
<a href=https://github.com/thomasp85 target=_blank rel=noopener>@thomasp85</a>,
<a href=https://github.com/timz0605 target=_blank rel=noopener>@timz0605</a>,
<a href=https://github.com/wish1832 target=_blank rel=noopener>@wish1832</a>, and
<a href=https://github.com/Yunuuuu target=_blank rel=noopener>@Yunuuuu</a>.</p></div></div><div class=column25><div class="section hideOnMobile"><div class=sectionTitle>Contents</div><nav id=TableOfContents><ul><li><a href=#tables-are-figures-too>Tables are figures too</a></li><li><a href=#with-freedom-comes-great-responsibility>With freedom comes great responsibility</a></li><li><a href=#the-rest>The rest</a></li><li><a href=#acknowledgements>Acknowledgements</a></li></ul></nav></div><div class=section></div></div></div></div></div><div id=rStudioFooter class=band><div class=bandContent><div id=copyright>The tidyverse is proudly supported by <a class=rstudioLogo href=https://posit.co/ aria-label="Posit Homepage"></a></div><div id=logos><a href=https://www.tidyverse.org/google_privacy_policy>Privacy policy</a>
<a href=https://github.com/tidyverse class="footerLogo gitHub" aria-label="Tidyverse GitHub organization"></a><a href=https://twitter.com/hashtag/rstats class="footerLogo twitter" aria-label="rstats hashtag on twitter.com"></a></div></div></div></div></div><script src=/js/math-code.js></script><script type=text/x-mathjax-config>
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    processEscapes: true
  }
});
</script><script async src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><script type=application/javascript>var dnt=(navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack);var doNotTrack=(dnt=="1"||dnt=="yes");if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');if(window.sessionStorage){var GA_SESSION_STORAGE_KEY='ga:clientId';ga('create','UA-115082821-1',{'storage':'none','clientId':sessionStorage.getItem(GA_SESSION_STORAGE_KEY)});ga(function(tracker){sessionStorage.setItem(GA_SESSION_STORAGE_KEY,tracker.get('clientId'));});}
ga('set','anonymizeIp',true);ga('send','pageview');}</script></body></html></div></div></body></html>