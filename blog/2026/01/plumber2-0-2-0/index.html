<!doctype html><html><head><!doctype html><html lang=en-us><link rel=stylesheet href=/css/fonts.css><link rel=stylesheet href=/css/main-site.css><link rel=stylesheet href=/css/fa5-all.css><style type=text/css>body{background-color:#fff;color:#1a1917}a{color:#38577f}a:hover{color:#42709b}a:focus{outline-color:#42709b}.column25-left .sectionTitle a:hover:not(.current),.column16-left .sectionTitle a:hover:not(.current){color:#1a1917}.icon-attribution,.icon-attribution a{color:#1a1917;opacity:75%}#homeContent .band.first{background-color:#fff}#homeContent .band.second{background-color:#fdeba4}#homeContent .band.third{background-color:#fff}#rStudioHeader{background-color:#1a162d;color:#fff}#rStudioHeader .productName{color:#fff}#rStudioHeader .productName:hover,#rStudioHeader .productName:focus{color:#fdeba4}#rStudioHeader #menu .menuItem.a{background-color:#75aadb;color:#fff}#rStudioHeader #menu .menuItem:hover{background-color:#484557;color:#fff}#rStudioHeader #menu .menuItem.current{background-color:#fff;color:#1a162d;text-decoration:none}#rStudioFooter.band{background-color:#767381}#rStudioFooter .bandContent #copyright{color:#e3eef8}table tbody tr:nth-child(even){background-color:#f7faff}table tbody tr:nth-child(odd){background-color:#fff}.latest{border-top:.5em solid <no value>}.event{-moz-box-shadow:0 0 0 0 rgba(0,0,0,.1);-webkit-box-shadow:0 0 0 0 rgba(0,0,0,.1);box-shadow:0 0 0 0 rgba(0,0,0,.1)}.section .event{background-color:#eab0c41a}.section .event{border-top:7pt solid #a19ea936}.section .event a{color:#1a162d}.section .event{color:#404040}</style><link rel=stylesheet href=/css/tidyverse.css><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Hugo 0.71.1"><title>plumber2 0.2.0</title><meta property="og:title" content="plumber2 0.2.0"><meta property="og:description" content="The next version of plumber2 has hit CRAN. Read all about the new features  such as OpenTelemetry (OTEL) support, authentication, new tags, and performance  improvements here."><meta property="og:type" content="article"><meta property="og:url" content="https://www.tidyverse.org/blog/2026/01/plumber2-0-2-0/"><meta property="twitter:card" content="summary_large_image"><meta property="og:title" content="plumber2 0.2.0 - Tidyverse"><meta property="description" content="The next version of plumber2 has hit CRAN. Read all about the new features  such as OpenTelemetry (OTEL) support, authentication, new tags, and performance  improvements here."><meta property="og:description" content="The next version of plumber2 has hit CRAN. Read all about the new features  such as OpenTelemetry (OTEL) support, authentication, new tags, and performance  improvements here."><meta property="og:image" content="https://www.tidyverse.org/blog/2026/01/plumber2-0-2-0/thumbnail-sq.jpg"><meta name=twitter:image content="https://www.tidyverse.org/blog/2026/01/plumber2-0-2-0/thumbnail-wd.jpg"><link rel=apple-touch-icon sizes=180x180 href=/images/favicons/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/images/favicons/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/images/favicons/favicon-16x16.png><link rel=manifest href=/images/favicons/site.webmanifest><link rel=mask-icon href=/images/favicons/safari-pinned-tab.svg><link rel="shortcut icon" href=/images/favicons/favicon.ico><meta name=msapplication-TileColor content="#da532c"><meta name=msapplication-config href=/images/favicons/browserconfig.xml><script type=text/javascript src=/js/jquery-3.5.1.min.js></script><script type=text/javascript src=/js/site.js></script><link rel=icon href=/images/favicon.ico><script type=text/javascript src=/js/clipboard.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin=anonymous></script><script defer data-domain=tidyverse.org,all.tidyverse.org src=https://plausible.io/js/plausible.js></script></head><body><div id=appTidyverseSite class="shrinkHeader alwaysShrinkHeader"><div id=main><div id=rStudioHeader><nav class=band><div class="innards bandContent"><div><a class=productName href=/>Tidyverse</a></div><div id=menu><div id=menuToggler></div><div id=menuItems><a class=menuItem href=/packages/>Packages</a>
<a class="menuItem current" href=/blog/>Blog</a>
<a class=menuItem href=/learn/>Learn</a>
<a class=menuItem href=/help/>Help</a>
<a class=menuItem href=/contribute/>Contribute</a></div></div></div></nav></div><main><div class="band padForHeader pushFooter"><div class=bandContent><div class="full splitColumns withMobileMargins"><div class=column75><h1 class=article-title>plumber2 0.2.0</h1><div class=article-header aria-hidden=true><div class=photo><img src=/blog/2026/01/plumber2-0-2-0/thumbnail-wd.jpg></div><div class=photoCredit>Photo by <a href=https://unsplash.com/photos/black-and-gray-metal-pipe-4CNNH2KEjhc>Sigmund</a></div></div><span class=article-date><i class="fas fa-calendar-day fa-fw"></i>&nbsp;&nbsp;2026/01/20</span><p style=margin-bottom:.5em;margin-top:.85em><i class="fas fa-tags"></i>&nbsp;
<a href=/tags/plumber2/>plumber2</a>,
<a href=/tags/web/>web</a></p><p style=margin-top:.5em><i class="fas fa-user-circle fa-fw"></i>&nbsp;
Thomas Lin Pedersen</p><div class=article-content><p>We&rsquo;re stoked to announce the release of
<a href=https://plumber2.posit.co target=_blank rel=noopener>plumber2</a> 0.2.0. plumber2 is a package for creating webservers in R based on either an annotation-based or programmatic workflow. It is the successor to the
<a href=https://www.rplumber.io/ target=_blank rel=noopener>plumber</a> package who has empowered the R community for 10 years and allowed them to share their R based functionalities with their organizations and the world.</p><p>You can install it from CRAN with:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nf>pak</span><span class=nf>::</span><span class=nf><a href=https://pak.r-lib.org/reference/pak.html>pak</a></span><span class=o>(</span><span class=s>"plumber2"</span><span class=o>)</span></span></code></pre></div><p>This release covers both a bunch of new features as well as some tangible improvements to performance. The headlining features are OpenTelemetry (OTEL) support and support for authentication which we will dive into below. In the end we will also provide a grab-bag of miscellaneous improvements for your enjoyment.</p><p>You can see a full list of changes in the
<a href=/news/index.html>release notes</a></p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=kr><a href=https://rdrr.io/r/base/library.html>library</a></span><span class=o>(</span><span class=nv><a href=https://plumber2.posit.co/>plumber2</a></span><span class=o>)</span></span></code></pre></div><h2 id=otel-support>OTEL support
<a href=#otel-support><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>We have been hard at work at adding support for
<a href=https://opentelemetry.io/ target=_blank rel=noopener>OpenTelemetry (OTEL)</a> for our tools to allow easy instrumentation across our offerings, see e.g. the
<a href=https://shiny.posit.co/blog/posts/shiny-r-1.12/ target=_blank rel=noopener>shiny blog post</a> announcing support for it there. If you do not know what OTEL is, here is a short introduction to the subject:</p><p>OTEL describes itself as &ldquo;high-quality, ubiquitous, and portable telemetry to enable effective observability&rdquo;. In simpler terms, OpenTelemetry is a set of tools, APIs, and SDKs that help you collect and export telemetry data (like traces, logs, and metrics) from your applications. This data provides insights into how your applications are performing and behaving in real-world scenarios.</p><p>It captures three key types of data:</p><ol><li><strong>Traces:</strong> These show the path of a request through your application.</li><li><strong>Logs:</strong> These are detailed event records that capture what happened at specific moments.</li><li><strong>Metrics:</strong> These are numerical measurements over time, like how many users are connected or how long outputs take to render.</li></ol><p>These data types were standardized under the OTEL project,
<a href=https://opentelemetry.io/community/marketing-guidelines/#i-opentelemetry-is-a-joint-effort target=_blank rel=noopener>which is supported by a large community and many companies</a>. The goal is to provide a consistent way to collect and export observability data, making it easier to monitor and troubleshoot applications.</p><p>OTEL is vendor-neutral, meaning you can send your telemetry data to various local backends like
<a href=https://www.jaegertracing.io/ target=_blank rel=noopener>Jaeger</a>,
<a href=https://zipkin.io/ target=_blank rel=noopener>Zipkin</a>,
<a href=https://prometheus.io/ target=_blank rel=noopener>Prometheus</a>, or cloud-based services like
<a href=https://grafana.com/products/cloud/ target=_blank rel=noopener>Grafana Cloud</a>,
<a href=https://pydantic.dev/logfire target=_blank rel=noopener>Logfire</a>, and
<a href=https://langfuse.com/ target=_blank rel=noopener>Langfuse</a>. This flexibility means you&rsquo;re not locked into any particular monitoring solution.</p><p>While that may be somewhat of a mouthful the <em>tldr;</em> is that with OTEL you can capture what goes on in your application and use a variety of services to explore this data. This is great especially for code that is meant to be deployed and thus not readily available for introspection.</p><p>A great thing about OTEL is that traces are linked across applications. If you have multiple linked microservices based on plumber2, then you can follow a request trace as it travels between the different APIs. The same goes for a shiny app that calls into a plumber2 api or the other way around. As we build out support across our tools this benefit will only get more profound.</p><h3 id=otel-in-plumber2>OTEL in plumber2
<a href=#otel-in-plumber2><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>While OTEL is integrated into plumber2 it is not activated by default. To set it up you need the otel and otelsdk installed and configured:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nf>pak</span><span class=nf>::</span><span class=nf><a href=https://pak.r-lib.org/reference/pak.html>pak</a></span><span class=o>(</span><span class=nf><a href=https://rdrr.io/r/base/c.html>c</a></span><span class=o>(</span><span class=s>"otel"</span>, <span class=s>"otelsdk"</span><span class=o>)</span><span class=o>)</span></span></code></pre></div><p>Configuration is completely code free and based on environment variables. You can e.g. add the lines below to your <code>.Renviron</code> file to setup OTEL with Logfire</p><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash><span class=c1># Enable OpenTelemetry by setting Collector environment variables</span>
<span class=nv>OTEL_TRACES_EXPORTER</span><span class=o>=</span>http
<span class=nv>OTEL_LOGS_EXPORTER</span><span class=o>=</span>http
<span class=nv>OTEL_LOG_LEVEL</span><span class=o>=</span>debug
<span class=nv>OTEL_METRICS_EXPORTER</span><span class=o>=</span>http

<span class=nv>OTEL_EXPORTER_OTLP_ENDPOINT</span><span class=o>=</span><span class=s2>&#34;https://logfire-us.pydantic.dev&#34;</span>
<span class=nv>OTEL_EXPORTER_OTLP_HEADERS</span><span class=o>=</span><span class=s2>&#34;Authorization=&lt;your-write-token&gt;&#34;</span>
</code></pre></div><p>You can verify that everything is set up by calling
<a href=https://otel.r-lib.org/reference/is_tracing_enabled.html target=_blank rel=noopener><code>otel::is_tracing_enabled()</code></a> which should return <code>TRUE</code> in that case.</p><p>OTEL has an extensive list of semantic conventions for telemetry of various domains so that information is captured in a standardised way. plumber2 adheres to the HTTP server conventions and supports all the required and most of the recommended
<a href=https://opentelemetry.io/docs/specs/semconv/http/http-spans/#http-server-span target=_blank rel=noopener>trace attributes</a> and
<a href=https://opentelemetry.io/docs/specs/semconv/http/http-metrics/ target=_blank rel=noopener>metrics</a>.</p><p>Within a plumber2 API, a trace span is started the moment a request is received. The span is populated with the following information:</p><ul><li><code>http.request.method</code>: The method of the request (e.g. <code>GET</code>, <code>POST</code>, etc)</li><li><code>url.path</code>: The exact path requested</li><li><code>url.scheme</code>: The protocol used for the request</li><li><code>http.route</code>: The route pattern of the last of the route handlers the request went through</li><li><code>network.protocol.name</code>: The internal protocol used. Always <code>http</code></li><li><code>network.protocol.version</code>: The version of the protocol. Always <code>1.1</code></li><li><code>server.port</code>: The port the server is listening on. Can be used to distinguish multiple concurrent servers</li><li><code>url.query</code>: The querystring of the request</li><li><code>client.address</code>: The IP address the request comes from</li><li><code>server.address</code>: The address the request was send to</li><li><code>user_agent.original</code>: The user agent of the client sending the request</li><li><code>http.request.header.&lt;header-name></code>: The value of <code>header-name</code> in the request. E.g. <code>http.request.header.date</code> will contain the value of the <code>Date</code> header</li></ul><p>Once the request has been handled it will further append the following information:</p><ul><li><code>http.response.status_code</code>: The status code of the response</li><li><code>http.response.header.&lt;header-name></code>: The value of <code>header-name</code> in the response. E.g. <code>http.response.header.content-type</code> will contain the value of the <code>Content-Type</code> header</li></ul><p>In addition to the trace attributes above, a number of OTEL metrics are also recorded:</p><ul><li><code>http.server.request.duration</code>: The duration of the request handling from it is received to it is send back</li><li><code>http.server.active_requests</code>: The number of active requests being handled at the given time</li><li><code>http.server.request.body.size</code>: The size of the request body</li><li><code>http.server.response.body.size</code>: The size of the response body</li></ul><p>As a child of this parent span each handler in your API will also initiate a span with the following attributes:</p><ul><li><code>routr.route</code>: The path pattern of the handler. This will be recorded in the routr representation which uses <code>:param</code> instead of <code>{param}</code> format (e.g. <code>users/:username</code> instead of <code>users/{username}</code>)</li><li><code>routr.path.param.&lt;param-name></code>: The value of the <code>param-name</code> path parameter. E.g. a request for <code>users/thomas</code> will get a <code>routr.path.param.username</code> attribute with the value <code>thomas</code> for the route <code>users/{username}</code>.</li></ul><p>Any span you initiate inside a handler will become a child of the handler span and through that be linked to the parent request span.</p><p>As you can see, the integration provides extensive information for you to use when figuring out what is going on in your application. On top of that, you can also use OTEL as your logging solution by setting <code>logger_otel</code> as your logging solution:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nf><a href=https://plumber2.posit.co/reference/api.html>api</a></span><span class=o>(</span><span class=o>)</span> <span class=o>|&gt;</span> </span>
<span>  <span class=nf><a href=https://plumber2.posit.co/reference/api_logger.html>api_logger</a></span><span class=o>(</span><span class=nv>logger_otel</span><span class=o>)</span></span></code></pre></div><p>This ensures that all the logs from errors, warnings, etc all end up in the same place as your other recordings and further gets linked to the exact request that gave rise to the log.</p><p>We truly believe extensive OTEL support across the ecosystem will be a game changer for deployed R code and we can&rsquo;t wait for our users to take advantage of it!</p><h2 id=auth-support>Auth support
<a href=#auth-support><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>The second headliner is support for various authentication schemes out of the box. This comes courtesy of of the
<a href=https://fireproof.data-imaginist.com target=_blank rel=noopener>fireproof</a> package which provides an auth plugin for fiery.</p><p>Setting up authentication is twofold: creating guards and attaching guards to routes.</p><p>First, you need to define one or more guards to use. A guard is an adaption of a specific authentication scheme such as e.g. OAuth. Currently, fireproof supports the Basic and Bearer HTTP authorization schemes, a custom key based scheme, as well as OAuth 2.0 and OpenID Connect. Setting up a guard can be done both programmatically and with annotations:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=c># Programmatic</span></span>
<span><span class=nv>api</span> <span class=o>&lt;-</span> <span class=nf><a href=https://plumber2.posit.co/reference/api.html>api</a></span><span class=o>(</span><span class=o>)</span> <span class=o>|&gt;</span> </span>
<span>  <span class=nf><a href=https://plumber2.posit.co/reference/api_auth_guard.html>api_auth_guard</a></span><span class=o>(</span></span>
<span>    guard <span class=o>=</span> <span class=nf>fireproof</span><span class=nf>::</span><span class=nf><a href=https://fireproof.data-imaginist.com/reference/guard_key.html>guard_key</a></span><span class=o>(</span></span>
<span>      key_name <span class=o>=</span> <span class=s>"X-API-KEY"</span>,</span>
<span>      validate <span class=o>=</span> <span class=s>"MY_VERY_SECRET_KEY"</span></span>
<span>    <span class=o>)</span>,</span>
<span>    name <span class=o>=</span> <span class=s>"key_guard"</span></span>
<span>  <span class=o>)</span></span></code></pre></div><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=c># Annotation</span></span>
<span></span>
<span><span class=c>#* @authGuard key_guard</span></span>
<span><span class=nf>fireproof</span><span class=nf>::</span><span class=nf><a href=https://fireproof.data-imaginist.com/reference/guard_key.html>guard_key</a></span><span class=o>(</span></span>
<span>  key_name <span class=o>=</span> <span class=s>"X-API-KEY"</span>,</span>
<span>  validate <span class=o>=</span> <span class=s>"MY_VERY_SECRET_KEY"</span></span>
<span><span class=o>)</span></span></code></pre></div><p>Both of these pieces of code yields the same result. You API now has a guard registered under the name <code>key_guard</code> which will (if called upon) check a request for the existence of a cookie named <code>X-API-KEY</code> with the value <code>MY_VERY_SECRET_KEY</code>.</p><p>Secondly, your handlers can now integrate the guards to protect access to the requested path. Again, this can be done both programmatically and in annotation and will generally be handled when the request handler is created:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=c># Programmatic</span></span>
<span><span class=nv>api</span> <span class=o>|&gt;</span> </span>
<span>  <span class=nf><a href=https://plumber2.posit.co/reference/api_request_handlers.html>api_get</a></span><span class=o>(</span></span>
<span>    path <span class=o>=</span> <span class=s>"/admin"</span>,</span>
<span>    <span class=kr>function</span><span class=o>(</span><span class=nv>...</span><span class=o>)</span> <span class=o>&#123;</span></span>
<span>      <span class=c># whatever you wish to protect</span></span>
<span>    <span class=o>&#125;</span>,</span>
<span>    auth_flow <span class=o>=</span> <span class=nv>key_guard</span></span>
<span>  <span class=o>)</span></span>
<span></span></code></pre></div><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=c># Annotation</span></span>
<span></span>
<span><span class=c>#* An example endpoint with auth</span></span>
<span><span class=c>#* </span></span>
<span><span class=c>#* @get /admin</span></span>
<span><span class=c>#* @auth key_guard</span></span>
<span><span class=kr>function</span><span class=o>(</span><span class=nv>...</span><span class=o>)</span> <span class=o>&#123;</span></span>
<span>  <span class=c># whatever you wish to protect</span></span>
<span><span class=o>&#125;</span></span></code></pre></div><p>Again, both code chunks achieve the same thing. They set up the endpoint to require the <code>key_guard</code> to be passed before further handling takes place.</p><h3 id=multiple-guards-and-requirements>Multiple guards and requirements
<a href=#multiple-guards-and-requirements><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>The previous section demonstrates the most basic authentication setup as it only uses the key guard&mdash;the simplest guard to configure. We can imagine a situation where we both want to allow users to log in with a username and password <em>or</em> authorize with a key and a google login. This requires defining multiple guards which can be done in sequence:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=c>#* @authGuard key</span></span>
<span><span class=nf>fireproof</span><span class=nf>::</span><span class=nf><a href=https://fireproof.data-imaginist.com/reference/guard_key.html>guard_key</a></span><span class=o>(</span></span>
<span>  key_name <span class=o>=</span> <span class=s>"X-API-KEY"</span>,</span>
<span>  validate <span class=o>=</span> <span class=s>"MY_VERY_SECRET_KEY"</span></span>
<span><span class=o>)</span></span>
<span><span class=c>#* @authGuard basic</span></span>
<span><span class=nf>fireproof</span><span class=nf>::</span><span class=nf><a href=https://fireproof.data-imaginist.com/reference/guard_basic.html>guard_basic</a></span><span class=o>(</span></span>
<span>  validate <span class=o>=</span> <span class=kr>function</span><span class=o>(</span><span class=nv>username</span>, <span class=nv>password</span><span class=o>)</span> <span class=o>&#123;</span></span>
<span>    <span class=nv>username</span> <span class=o>==</span> <span class=s>"thomas"</span> <span class=o>&amp;&amp;</span> <span class=nv>password</span> <span class=o>==</span> <span class=s>"xrCy45rWrgwq"</span></span>
<span>  <span class=o>&#125;</span></span>
<span><span class=o>)</span></span>
<span><span class=c>#* @authGuard google</span></span>
<span><span class=nf>fireproof</span><span class=nf>::</span><span class=nf><a href=https://fireproof.data-imaginist.com/reference/guard_google.html>guard_google</a></span><span class=o>(</span></span>
<span>  redirect_url <span class=o>=</span> <span class=s>"https://example.com/auth"</span>,</span>
<span>  client_id <span class=o>=</span> <span class=s>"MY_APP_ID"</span>,</span>
<span>  client_secret <span class=o>=</span> <span class=s>"SUCHASECRET"</span></span>
<span><span class=o>)</span></span></code></pre></div><p>We now have 3 guards (of dubious quality) that we can attach to our handler. How do we capture the relationship of requiring either the basic to pass or the key and google to pass? Simple, with a logical expression:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=c>#* An example endpoint with auth</span></span>
<span><span class=c>#* </span></span>
<span><span class=c>#* @get /admin</span></span>
<span><span class=c>#* @auth basic || (key &amp;&amp; google)</span></span>
<span><span class=kr>function</span><span class=o>(</span><span class=nv>...</span><span class=o>)</span> <span class=o>&#123;</span></span>
<span>  <span class=c># whatever you wish to protect</span></span>
<span><span class=o>&#125;</span></span></code></pre></div><p>The names of the guards act as booleans and can be composed with the basic boolean operators (<code>||</code>, <code>&&</code>, and <code>(</code>/<code>)</code>). The combinations are endless!</p><h3 id=scopes>Scopes
<a href=#scopes><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>Sometimes you need more granularity in your authentication. Some users may only read while others may read and write to resources. This could be solved with multiple guards but it quickly becomes unwieldy. Instead you can set scope requirements on an endpoint. Guards can then grant scopes to a user in their <code>validate</code> function by returning a character vector instead of a boolean, like this:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=c>#* @authGuard basic</span></span>
<span><span class=nf>fireproof</span><span class=nf>::</span><span class=nf><a href=https://fireproof.data-imaginist.com/reference/guard_basic.html>guard_basic</a></span><span class=o>(</span></span>
<span>  validate <span class=o>=</span> <span class=kr>function</span><span class=o>(</span><span class=nv>username</span>, <span class=nv>password</span><span class=o>)</span> <span class=o>&#123;</span></span>
<span>    <span class=kr>if</span> <span class=o>(</span><span class=nv>username</span> <span class=o>==</span> <span class=s>"guest"</span><span class=o>)</span> <span class=o>&#123;</span></span>
<span>      <span class=kr><a href=https://rdrr.io/r/base/function.html>return</a></span><span class=o>(</span><span class=s>"read"</span><span class=o>)</span></span>
<span>    <span class=o>&#125;</span></span>
<span>    <span class=kr>if</span> <span class=o>(</span><span class=nv>username</span> <span class=o>==</span> <span class=s>"thomas"</span> <span class=o>&amp;&amp;</span> <span class=nv>password</span> <span class=o>==</span> <span class=s>"xrCy45rWrgwq"</span><span class=o>)</span> <span class=o>&#123;</span></span>
<span>      <span class=kr><a href=https://rdrr.io/r/base/function.html>return</a></span><span class=o>(</span><span class=nf><a href=https://rdrr.io/r/base/c.html>c</a></span><span class=o>(</span><span class=s>"read"</span>, <span class=s>"write"</span><span class=o>)</span><span class=o>)</span></span>
<span>    <span class=o>&#125;</span></span>
<span>    <span class=kc>FALSE</span></span>
<span>  <span class=o>&#125;</span></span>
<span><span class=o>)</span></span>
<span></span>
<span><span class=c>#* Read the calendar entries</span></span>
<span><span class=c>#* </span></span>
<span><span class=c>#* @get /calendar</span></span>
<span><span class=c>#* @auth basic</span></span>
<span><span class=c>#* @authScope read</span></span>
<span><span class=c>#* </span></span>
<span><span class=kr>function</span><span class=o>(</span><span class=nv>...</span><span class=o>)</span> <span class=o>&#123;</span></span>
<span>  <span class=c># return calendar entries</span></span>
<span><span class=o>&#125;</span></span>
<span></span>
<span><span class=c>#* Add a new calendar entry</span></span>
<span><span class=c>#* </span></span>
<span><span class=c>#* @post /calendar</span></span>
<span><span class=c>#* @auth basic</span></span>
<span><span class=c>#* @authScope write</span></span>
<span><span class=c>#* </span></span>
<span><span class=kr>function</span><span class=o>(</span><span class=nv>...</span><span class=o>)</span> <span class=o>&#123;</span></span>
<span>  <span class=c># update the calendar</span></span>
<span><span class=o>&#125;</span></span></code></pre></div><p>The authentication that can be integrated is very flexible and will only grow as more guards are added to fireproof.</p><h2 id=other-news>Other news
<a href=#other-news><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><h3 id=annotation-for-datastores>Annotation for datastores
<a href=#annotation-for-datastores><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>While datastores through the
<a href=https://github.com/thomasp85/firesale target=_blank rel=noopener>firesale</a> package was supported upon release, they could only be set up programmatically. This has now been corrected with the addition of the <code>@datastore</code> tag. It works like this:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=c>#* @datastore my_store</span></span>
<span><span class=nf>storr</span><span class=nf>::</span><span class=nf><a href=https://richfitz.github.io/storr/reference/storr_environment.html>driver_environment</a></span><span class=o>(</span><span class=o>)</span></span></code></pre></div><p>The <code>my_store</code> proceeding the key is optional and gives the name of the datastore (defaults to <code>datastore</code>). Below the block you provide a
<a href=https://richfitz.github.io/storr/ target=_blank rel=noopener>storr</a> driver and then you are good to go.</p><p>Authentication requires a datastore in order to work as it facilitates persistent session login. Below, you can see an annotation implementation of a single guard that leverages a storr datastore.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=c>#* @datastore ds</span></span>
<span><span class=nf>storr</span><span class=nf>::</span><span class=nf><a href=https://richfitz.github.io/storr/reference/storr_environment.html>driver_environment</a></span><span class=o>(</span><span class=o>)</span></span>
<span></span>
<span><span class=c>#* @authGuard github</span></span>
<span><span class=nf>fireproof</span><span class=nf>::</span><span class=nf><a href=https://fireproof.data-imaginist.com/reference/guard_github.html>guard_github</a></span><span class=o>(</span></span>
<span>  redirect_url <span class=o>=</span> <span class=s>"https://example.com/auth"</span>,</span>
<span>  client_id <span class=o>=</span> <span class=s>"MY_APP_ID"</span>,</span>
<span>  client_secret <span class=o>=</span> <span class=s>"SUCHASECRET"</span></span>
<span><span class=o>)</span></span>
<span></span>
<span><span class=c>#* Get a summary of your github commit history</span></span>
<span><span class=c>#* </span></span>
<span><span class=c>#* @auth github</span></span>
<span><span class=kr>function</span><span class=o>(</span><span class=nv>ds</span><span class=o>)</span> <span class=o>&#123;</span></span>
<span>  <span class=nv>github_token</span> <span class=o>&lt;-</span> <span class=nv>ds</span><span class=o>$</span><span class=nv>session</span><span class=o>$</span><span class=nv>github</span><span class=o>$</span><span class=nv>token</span><span class=o>$</span><span class=nv>access_token</span></span>
<span>  <span class=c># Use the access token to fetch commit history and do some fun things</span></span>
<span><span class=o>&#125;</span></span></code></pre></div><h3 id=more-powerful-report-support>More powerful report support
<a href=#more-powerful-report-support><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>The report endpoint has gotten even more powerful in this release in a number of ways:</p><ul><li>Report endpoints can now be added programmatically as well using
<a href=https://plumber2.posit.co/reference/api_report.html target=_blank rel=noopener><code>api_report()</code></a></li><li>There is now support for quarto documents using the jupyter engine</li><li>OpenAPI documentation is now generated automatically for the report and incorporates the standard annotation known from request handler blocks.</li><li>Parameterised reports now has their parameters type checked and casted based on the type of the default values or on explicit type specification in the <code>@param</code> tags.</li><li>You can now request specific named output formats through the <code>/{output_format}</code> subpath. This is in addition to the content negotiation already available. E.g. <code>/report/revealjs</code> will request the revealjs format of the report served at <code>/report</code>.</li><li>Caches can now be user specific if the rendering includes information specific to the user requesting it</li><li>Caches can now be cleared using a <code>DELETE</code> request</li></ul><h2 id=thank-you>Thank you
<a href=#thank-you><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>I want to say thanks to everyone who has given plumber2 a spin. It takes some time to reach maturity when replacing a decade old package and every test spin brings more insight. With the addition of OTEL integration and auth support plumber2 has now reached the feature set I was planning for during the initial development and the next phase will be about refinement, performance, and bug fixes. Your input and experiences will be critical there.</p></div></div><div class=column25><div class="section hideOnMobile"><div class=sectionTitle>Contents</div><nav id=TableOfContents><ul><li><a href=#otel-support>OTEL support</a></li><li><a href=#auth-support>Auth support</a></li><li><a href=#other-news>Other news</a></li><li><a href=#thank-you>Thank you</a></li></ul></nav></div><div class=section></div></div></div></div></div><div id=rStudioFooter class=band><div class=bandContent><div id=copyright>The tidyverse is proudly supported by <a class=rstudioLogo href=https://posit.co/ aria-label="Posit Homepage"></a></div><div id=logos><a href=https://www.tidyverse.org/google_privacy_policy>Privacy policy</a>
<a href=https://github.com/tidyverse class="footerLogo gitHub" aria-label="Tidyverse GitHub organization"></a><a href=https://twitter.com/hashtag/rstats class="footerLogo twitter" aria-label="rstats hashtag on twitter.com"></a></div></div></div></div></div><script src=/js/math-code.js></script><script type=text/x-mathjax-config>
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    processEscapes: true
  }
});
</script><script async src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><script type=application/javascript>var dnt=(navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack);var doNotTrack=(dnt=="1"||dnt=="yes");if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');if(window.sessionStorage){var GA_SESSION_STORAGE_KEY='ga:clientId';ga('create','UA-115082821-1',{'storage':'none','clientId':sessionStorage.getItem(GA_SESSION_STORAGE_KEY)});ga(function(tracker){sessionStorage.setItem(GA_SESSION_STORAGE_KEY,tracker.get('clientId'));});}
ga('set','anonymizeIp',true);ga('send','pageview');}</script></body></html></div></div></body></html>