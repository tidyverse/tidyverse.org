<!doctype html><html><head><!doctype html><html lang=en-us><link rel=stylesheet href=/css/fonts.css><link rel=stylesheet href=/css/main-site.css><link rel=stylesheet href=/css/fa5-all.css><style type=text/css>body{background-color:#fff;color:#1a1917}a{color:#38577f}a:hover{color:#42709b}a:focus{outline-color:#42709b}.column25-left .sectionTitle a:hover:not(.current),.column16-left .sectionTitle a:hover:not(.current){color:#1a1917}.icon-attribution,.icon-attribution a{color:#1a1917;opacity:75%}#homeContent .band.first{background-color:#fff}#homeContent .band.second{background-color:#fdeba4}#homeContent .band.third{background-color:#fff}#rStudioHeader{background-color:#1a162d;color:#fff}#rStudioHeader .productName{color:#fff}#rStudioHeader .productName:hover,#rStudioHeader .productName:focus{color:#fdeba4}#rStudioHeader #menu .menuItem.a{background-color:#75aadb;color:#fff}#rStudioHeader #menu .menuItem:hover{background-color:#484557;color:#fff}#rStudioHeader #menu .menuItem.current{background-color:#fff;color:#1a162d;text-decoration:none}#rStudioFooter.band{background-color:#767381}#rStudioFooter .bandContent #copyright{color:#e3eef8}table tbody tr:nth-child(even){background-color:#f7faff}table tbody tr:nth-child(odd){background-color:#fff}.latest{border-top:.5em solid <no value>}.event{-moz-box-shadow:0 0 0 0 rgba(0,0,0,.1);-webkit-box-shadow:0 0 0 0 rgba(0,0,0,.1);box-shadow:0 0 0 0 rgba(0,0,0,.1)}.section .event{background-color:#eab0c41a}.section .event{border-top:7pt solid #a19ea936}.section .event a{color:#1a162d}.section .event{color:#404040}</style><link rel=stylesheet href=/css/tidyverse.css><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Hugo 0.71.1"><title>readxl 1.2.0</title><meta property="og:title" content="readxl 1.2.0"><meta property="og:description" content="readxl 1.2.0 is now on CRAN."><meta property="og:type" content="article"><meta property="og:url" content="https://www.tidyverse.org/blog/2018/12/readxl-1-2-0/"><meta property="twitter:card" content="summary_large_image"><meta property="og:title" content="readxl 1.2.0 - Tidyverse"><meta property="description" content="readxl 1.2.0 is now on CRAN."><meta property="og:description" content="readxl 1.2.0 is now on CRAN."><meta property="og:image" content="https://www.tidyverse.org/blog/2018/12/readxl-1-2-0/readxl-1-2-0-sq.jpg"><meta name=twitter:image content="https://www.tidyverse.org/blog/2018/12/readxl-1-2-0/readxl-1-2-0-wd.jpg"><link rel=apple-touch-icon sizes=180x180 href=/images/favicons/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/images/favicons/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/images/favicons/favicon-16x16.png><link rel=manifest href=/images/favicons/site.webmanifest><link rel=mask-icon href=/images/favicons/safari-pinned-tab.svg><link rel="shortcut icon" href=/images/favicons/favicon.ico><meta name=msapplication-TileColor content="#da532c"><meta name=msapplication-config href=/images/favicons/browserconfig.xml><script type=text/javascript src=/js/jquery-3.5.1.min.js></script><script type=text/javascript src=/js/site.js></script><link rel=icon href=/images/favicon.ico><script type=text/javascript src=/js/clipboard.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin=anonymous></script><script defer data-domain=tidyverse.org,all.tidyverse.org src=https://plausible.io/js/plausible.js></script></head><body><div id=appTidyverseSite class="shrinkHeader alwaysShrinkHeader"><div id=main><div id=rStudioHeader><nav class=band><div class="innards bandContent"><div><a class=productName href=/%20/>Tidyverse</a></div><div id=menu><div id=menuToggler></div><div id=menuItems><a class=menuItem href=/packages/>Packages</a>
<a class="menuItem current" href=/blog/>Blog</a>
<a class=menuItem href=/learn/>Learn</a>
<a class=menuItem href=/help/>Help</a>
<a class=menuItem href=/contribute/>Contribute</a></div></div></div></nav></div><main><div class="band padForHeader pushFooter"><div class=bandContent><div class="full splitColumns withMobileMargins"><div class=column75><h1 class=article-title>readxl 1.2.0</h1><div class=article-header aria-hidden=true><div class=photo><img src=/blog/2018/12/readxl-1-2-0/readxl-1-2-0-wd.jpg></div><div class=photoCredit>Photo by <a href=https://twitter.com/Thoughtfulnz/status/987900521309614080>David Hood</a></div></div><span class=article-date><i class="fas fa-calendar-day fa-fw"></i>&nbsp;&nbsp;2018/12/20</span><p style=margin-bottom:.5em;margin-top:.85em><i class="fas fa-tags"></i>&nbsp;
<a href=/tags/tidyverse/>tidyverse</a>,
<a href=/tags/readxl/>readxl</a></p><p style=margin-top:.5em><i class="fas fa-user-circle fa-fw"></i>&nbsp;
Jenny Bryan</p><div class=article-content><p>We&rsquo;re stoked to announce that
<a href=http://readxl.tidyverse.org target=_blank rel=noopener>readxl</a> 1.2.0 is now available on CRAN. Learn more about readxl at <a href=http://readxl.tidyverse.org>http://readxl.tidyverse.org</a>. Detailed notes are always in the
<a href=https://readxl.tidyverse.org/news/index.html#readxl-1-2-0 target=_blank rel=noopener>change log</a>.</p><p>The readxl package makes it easy to get tabular data out of Excel files and into R with code, not mouse clicks. It supports both the legacy <code>.xls</code> format and the modern XML-based <code>.xlsx</code> format. readxl is expressly designed to be easy to install and use on all operating systems. Therefore it has no external dependencies, such as Java or Perl, which have historically been a source of aggravation with some R packages that read Excel files.</p><p>The easiest way to install the latest version from CRAN is to install the whole tidyverse.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf>install.packages</span><span class=p>(</span><span class=s>&#34;tidyverse&#34;</span><span class=p>)</span>
</code></pre></div><p>Alternatively, install just readxl from CRAN:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf>install.packages</span><span class=p>(</span><span class=s>&#34;readxl&#34;</span><span class=p>)</span>
</code></pre></div><p>Regardless, you will still need to attach readxl explicitly. It is not a core tidyverse package, i.e. readxl is NOT attached via <code>library(tidyverse)</code>. Instead, do this in your script:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf>library</span><span class=p>(</span><span class=n>readxl</span><span class=p>)</span>
</code></pre></div><h2 id=column-name-repair>Column name repair
<a href=#column-name-repair><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>The most exciting change in the v1.2.0 release is the introduction of the new <code>.name_repair</code> argument to <code>read_excel()</code>, <code>read_xlsx()</code>, and <code>read_xls()</code>. readxl exposes the <code>.name_repair</code> argument that is
<a href=https://www.tidyverse.org/articles/2018/11/tibble-2.0.0-pre-announce/ target=_blank rel=noopener>coming soon to version 2.0.0 of the tibble package</a>. <strong>Note: the following examples were executed with the not-yet-released version 2.0.0 of the tibble package.</strong></p><p>First, rest assured that if your sheet has unique column names, readxl leaves them alone, as always:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf>read_excel</span><span class=p>(</span><span class=nf>readxl_example</span><span class=p>(</span><span class=s>&#34;datasets.xlsx&#34;</span><span class=p>),</span> <span class=n>sheet</span> <span class=o>=</span> <span class=s>&#34;iris&#34;</span><span class=p>,</span> <span class=n>n_max</span> <span class=o>=</span> <span class=m>3</span><span class=p>)</span>
<span class=c1>#&gt; # A tibble: 3 x 5</span>
<span class=c1>#&gt;   Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span>
<span class=c1>#&gt;          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;  </span>
<span class=c1>#&gt; 1          5.1         3.5          1.4         0.2 setosa </span>
<span class=c1>#&gt; 2          4.9         3            1.4         0.2 setosa </span>
<span class=c1>#&gt; 3          4.7         3.2          1.3         0.2 setosa</span>
</code></pre></div><p>However, spreadsheet column names frequently leave much to be desired. <code>.name_repair</code> is a more flexible alternative to passing a specific vector of <code>col_names</code>. You can express what you want in two main ways:</p><ul><li>Levels of name repair:<ul><li><code>"minimal"</code>: use <code>""</code> for any missing names</li><li><code>"unique"</code>: names are made unique <strong>readxl&rsquo;s default</strong></li><li><code>"universal"</code>: names are made <code>"unique"</code> and syntactic</li></ul></li><li>Name repair strategy, as a function that takes (bad) names in and returns (good) names:<ul><li>Function defined in base R, by another package, or by you</li><li>Anonymous function, specified using a purrr-style <code>~</code> formula</li></ul></li></ul><p>Here are two examples of specifying a name repair strategy.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=c1>## pass custom function to implement &#34;lower_snake_case&#34;</span>
<span class=n>my_custom_name_repair</span> <span class=o>&lt;-</span> <span class=nf>function</span><span class=p>(</span><span class=n>nms</span><span class=p>)</span> <span class=nf>tolower</span><span class=p>(</span><span class=nf>gsub</span><span class=p>(</span><span class=s>&#34;[.]&#34;</span><span class=p>,</span> <span class=s>&#34;_&#34;</span><span class=p>,</span> <span class=n>nms</span><span class=p>))</span>
<span class=nf>read_excel</span><span class=p>(</span>
  <span class=nf>readxl_example</span><span class=p>(</span><span class=s>&#34;datasets.xlsx&#34;</span><span class=p>),</span> <span class=n>n_max</span> <span class=o>=</span> <span class=m>3</span><span class=p>,</span>
  <span class=n>.name_repair</span> <span class=o>=</span> <span class=n>my_custom_name_repair</span>
<span class=p>)</span>
<span class=c1>#&gt; # A tibble: 3 x 5</span>
<span class=c1>#&gt;   sepal_length sepal_width petal_length petal_width species</span>
<span class=c1>#&gt;          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;  </span>
<span class=c1>#&gt; 1          5.1         3.5          1.4         0.2 setosa </span>
<span class=c1>#&gt; 2          4.9         3            1.4         0.2 setosa </span>
<span class=c1>#&gt; 3          4.7         3.2          1.3         0.2 setosa</span>

<span class=c1>## use purrr-style formula to truncate names at 3 characters</span>
<span class=nf>read_excel</span><span class=p>(</span>
  <span class=nf>readxl_example</span><span class=p>(</span><span class=s>&#34;datasets.xlsx&#34;</span><span class=p>),</span> <span class=n>sheet</span> <span class=o>=</span> <span class=s>&#34;chickwts&#34;</span><span class=p>,</span> <span class=n>n_max</span> <span class=o>=</span> <span class=m>3</span><span class=p>,</span>
  <span class=n>.name_repair</span> <span class=o>=</span> <span class=o>~</span> <span class=nf>substr</span><span class=p>(</span><span class=n>.x</span><span class=p>,</span> <span class=n>start</span> <span class=o>=</span> <span class=m>1</span><span class=p>,</span> <span class=n>stop</span> <span class=o>=</span> <span class=m>3</span><span class=p>)</span>
<span class=p>)</span>
<span class=c1>#&gt; # A tibble: 3 x 2</span>
<span class=c1>#&gt;     wei fee      </span>
<span class=c1>#&gt;   &lt;dbl&gt; &lt;chr&gt;    </span>
<span class=c1>#&gt; 1   179 horsebean</span>
<span class=c1>#&gt; 2   160 horsebean</span>
<span class=c1>#&gt; 3   136 horsebean</span>
</code></pre></div><p>Read more in readxl&rsquo;s new
<a href=https://readxl.tidyverse.org/articles/articles/column-names.html target=_blank rel=noopener>Column Names</a> article.</p><h2 id=hello-is-any-one-there>Hello, is any one there?
<a href=#hello-is-any-one-there><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>readxl now displays a progress spinner in interactive sessions if it looks like the operation might take several seconds or more. This should provide some measure of reassurance when reading large sheets. This was accompanied by a rationalization of when readxl checks for user interrupts.</p><h2 id=updated-libxls>Updated libxls
<a href=#updated-libxls><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>The last user-visible change is that all known <code>.xls</code> regressions have been fixed. The previous version, readxl v1.1.0, included some big updates in the embedded libxls library, which were overwhelmingly positive. But there were a few reports of <code>.xls</code> files that went from &ldquo;readable&rdquo; to &ldquo;unreadable&rdquo;. To the best of my knowledge, those regressions have now all been addressed upstream and in readxl v1.2.0.</p><h2 id=acknowledgements>Acknowledgements
<a href=#acknowledgements><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Special thanks to Evan Miller for his recent work on libxls.</p><p>Thank you to the 47 contributors who made this release possible:
<a href=https://github.com/2005m target=_blank rel=noopener>@2005m</a>,
<a href=https://github.com/ajdamico target=_blank rel=noopener>@ajdamico</a>,
<a href=https://github.com/alfredojavier5 target=_blank rel=noopener>@alfredojavier5</a>,
<a href=https://github.com/antuki target=_blank rel=noopener>@antuki</a>,
<a href=https://github.com/apreshill target=_blank rel=noopener>@apreshill</a>,
<a href=https://github.com/awwsmm target=_blank rel=noopener>@awwsmm</a>,
<a href=https://github.com/batpigandme target=_blank rel=noopener>@batpigandme</a>,
<a href=https://github.com/berkorbay target=_blank rel=noopener>@berkorbay</a>,
<a href=https://github.com/billdenney target=_blank rel=noopener>@billdenney</a>,
<a href=https://github.com/breichholf target=_blank rel=noopener>@breichholf</a>,
<a href=https://github.com/brianwdavis target=_blank rel=noopener>@brianwdavis</a>,
<a href=https://github.com/chrowe target=_blank rel=noopener>@chrowe</a>,
<a href=https://github.com/ddheart target=_blank rel=noopener>@ddheart</a>,
<a href=https://github.com/doctsh target=_blank rel=noopener>@doctsh</a>,
<a href=https://github.com/dominicshore target=_blank rel=noopener>@dominicshore</a>,
<a href=https://github.com/Gillis target=_blank rel=noopener>@Gillis</a>,
<a href=https://github.com/gorkang target=_blank rel=noopener>@gorkang</a>,
<a href=https://github.com/gregdutkowski target=_blank rel=noopener>@gregdutkowski</a>,
<a href=https://github.com/gregleleu target=_blank rel=noopener>@gregleleu</a>,
<a href=https://github.com/hidekoji target=_blank rel=noopener>@hidekoji</a>,
<a href=https://github.com/hlenka target=_blank rel=noopener>@hlenka</a>,
<a href=https://github.com/hroptatyr target=_blank rel=noopener>@hroptatyr</a>,
<a href=https://github.com/j6t target=_blank rel=noopener>@j6t</a>,
<a href=https://github.com/jamesdalg target=_blank rel=noopener>@jamesdalg</a>,
<a href=https://github.com/jameshunterbr target=_blank rel=noopener>@jameshunterbr</a>,
<a href=https://github.com/jennybc target=_blank rel=noopener>@jennybc</a>,
<a href=https://github.com/jeroen target=_blank rel=noopener>@jeroen</a>,
<a href=https://github.com/jimhester target=_blank rel=noopener>@jimhester</a>,
<a href=https://github.com/KS2907 target=_blank rel=noopener>@KS2907</a>,
<a href=https://github.com/KyleHaynes target=_blank rel=noopener>@KyleHaynes</a>,
<a href=https://github.com/llrs target=_blank rel=noopener>@llrs</a>,
<a href=https://github.com/ltierney target=_blank rel=noopener>@ltierney</a>,
<a href=https://github.com/LTLA target=_blank rel=noopener>@LTLA</a>,
<a href=https://github.com/mcSamuelDataSci target=_blank rel=noopener>@mcSamuelDataSci</a>,
<a href=https://github.com/mdekstrand target=_blank rel=noopener>@mdekstrand</a>,
<a href=https://github.com/msgoussi target=_blank rel=noopener>@msgoussi</a>,
<a href=https://github.com/N1h1l1sT target=_blank rel=noopener>@N1h1l1sT</a>,
<a href=https://github.com/pm321 target=_blank rel=noopener>@pm321</a>,
<a href=https://github.com/ptoche target=_blank rel=noopener>@ptoche</a>,
<a href=https://github.com/randallhelms target=_blank rel=noopener>@randallhelms</a>,
<a href=https://github.com/rnuske target=_blank rel=noopener>@rnuske</a>,
<a href=https://github.com/roualdes target=_blank rel=noopener>@roualdes</a>,
<a href=https://github.com/rrohwer target=_blank rel=noopener>@rrohwer</a>,
<a href=https://github.com/SebVen target=_blank rel=noopener>@SebVen</a>,
<a href=https://github.com/siemersn target=_blank rel=noopener>@siemersn</a>,
<a href=https://github.com/VincentGuyader target=_blank rel=noopener>@VincentGuyader</a>, and
<a href=https://github.com/yurasmol target=_blank rel=noopener>@yurasmol</a>.</p></div></div><div class=column25><div class="section hideOnMobile"><div class=sectionTitle>Contents</div><nav id=TableOfContents><ul><li><a href=#column-name-repair>Column name repair</a></li><li><a href=#hello-is-any-one-there>Hello, is any one there?</a></li><li><a href=#updated-libxls>Updated libxls</a></li><li><a href=#acknowledgements>Acknowledgements</a></li></ul></nav></div><div class=section></div></div></div></div></div><div id=rStudioFooter class=band><div class=bandContent><div id=copyright>The tidyverse is proudly supported by <a class=rstudioLogo href=https://posit.co/ aria-label="Posit Homepage"></a></div><div id=logos><a href=https://www.tidyverse.org/google_privacy_policy>Privacy policy</a>
<a href=https://github.com/tidyverse class="footerLogo gitHub" aria-label="Tidyverse GitHub organization"></a><a href=https://twitter.com/hashtag/rstats class="footerLogo twitter" aria-label="rstats hashtag on twitter.com"></a></div></div></div></div></div><script type=application/javascript>var dnt=(navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack);var doNotTrack=(dnt=="1"||dnt=="yes");if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');if(window.sessionStorage){var GA_SESSION_STORAGE_KEY='ga:clientId';ga('create','UA-115082821-1',{'storage':'none','clientId':sessionStorage.getItem(GA_SESSION_STORAGE_KEY)});ga(function(tracker){sessionStorage.setItem(GA_SESSION_STORAGE_KEY,tracker.get('clientId'));});}
ga('set','anonymizeIp',true);ga('send','pageview');}</script></body></html></div></div></body></html>