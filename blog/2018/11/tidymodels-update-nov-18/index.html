<!doctype html><html><head><!doctype html><html lang=en-us><link rel=stylesheet href=/css/fonts.css><link rel=stylesheet href=/css/main-site.css><link rel=stylesheet href=/css/fa5-all.css><style type=text/css>body{background-color:#fff;color:#1a1917}a{color:#38577f}a:hover{color:#42709b}a:focus{outline-color:#42709b}.column25-left .sectionTitle a:hover:not(.current),.column16-left .sectionTitle a:hover:not(.current){color:#1a1917}.icon-attribution,.icon-attribution a{color:#1a1917;opacity:75%}#homeContent .band.first{background-color:#fff}#homeContent .band.second{background-color:#fdeba4}#homeContent .band.third{background-color:#fff}#rStudioHeader{background-color:#1a162d;color:#fff}#rStudioHeader .productName{color:#fff}#rStudioHeader .productName:hover,#rStudioHeader .productName:focus{color:#fdeba4}#rStudioHeader #menu .menuItem.a{background-color:#75aadb;color:#fff}#rStudioHeader #menu .menuItem:hover{background-color:#484557;color:#fff}#rStudioHeader #menu .menuItem.current{background-color:#fff;color:#1a162d;text-decoration:none}#rStudioFooter.band{background-color:#767381}#rStudioFooter .bandContent #copyright{color:#e3eef8}table tbody tr:nth-child(even){background-color:#f7faff}table tbody tr:nth-child(odd){background-color:#fff}.latest{border-top:.5em solid <no value>}.event{-moz-box-shadow:0 0 0 0 rgba(0,0,0,.1);-webkit-box-shadow:0 0 0 0 rgba(0,0,0,.1);box-shadow:0 0 0 0 rgba(0,0,0,.1)}.section .event{background-color:#eab0c41a}.section .event{border-top:7pt solid #a19ea936}.section .event a{color:#1a162d}.section .event{color:#404040}</style><link rel=stylesheet href=/css/tidyverse.css><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Hugo 0.71.1"><title>tidymodels package updates</title><meta property="og:title" content="tidymodels package updates"><meta property="og:description" content="A variety of updates for tidymodels packages."><meta property="og:type" content="article"><meta property="og:url" content="https://www.tidyverse.org/blog/2018/11/tidymodels-update-nov-18/"><meta property="twitter:card" content="summary_large_image"><meta property="og:title" content="tidymodels package updates - Tidyverse"><meta property="description" content="A variety of updates for tidymodels packages."><meta property="og:description" content="A variety of updates for tidymodels packages."><meta property="og:image" content="https://www.tidyverse.org/blog/2018/11/tidymodels-update-nov-18/tidymodels-update-nov-18-sq.jpg"><meta name=twitter:image content="https://www.tidyverse.org/blog/2018/11/tidymodels-update-nov-18/tidymodels-update-nov-18-wd.jpg"><link rel=apple-touch-icon sizes=180x180 href=/images/favicons/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/images/favicons/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/images/favicons/favicon-16x16.png><link rel=manifest href=/images/favicons/site.webmanifest><link rel=mask-icon href=/images/favicons/safari-pinned-tab.svg><link rel="shortcut icon" href=/images/favicons/favicon.ico><meta name=msapplication-TileColor content="#da532c"><meta name=msapplication-config href=/images/favicons/browserconfig.xml><script type=text/javascript src=/js/jquery-3.5.1.min.js></script><script type=text/javascript src=/js/site.js></script><link rel=icon href=/images/favicon.ico><script type=text/javascript src=/js/clipboard.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin=anonymous></script><script defer data-domain=tidyverse.org,all.tidyverse.org src=https://plausible.io/js/plausible.js></script></head><body><div id=appTidyverseSite class="shrinkHeader alwaysShrinkHeader"><div id=main><div id=rStudioHeader><nav class=band><div class="innards bandContent"><div><a class=productName href=/>Tidyverse</a></div><div id=menu><div id=menuToggler></div><div id=menuItems><a class=menuItem href=/packages/>Packages</a>
<a class="menuItem current" href=/blog/>Blog</a>
<a class=menuItem href=/learn/>Learn</a>
<a class=menuItem href=/help/>Help</a>
<a class=menuItem href=/contribute/>Contribute</a></div></div></div></nav></div><main><div class="band padForHeader pushFooter"><div class=bandContent><div class="full splitColumns withMobileMargins"><div class=column75><h1 class=article-title>tidymodels package updates</h1><div class=article-header aria-hidden=true><div class=photo><img src=/blog/2018/11/tidymodels-update-nov-18/tidymodels-update-nov-18-wd.jpg></div><div class=photoCredit>Photo by <a href=https://unsplash.com/photos/O6N9RV2rzX8>Jeremy Thomas</a></div></div><span class=article-date><i class="fas fa-calendar-day fa-fw"></i>&nbsp;&nbsp;2018/11/29</span><p style=margin-bottom:.5em;margin-top:.85em><i class="fas fa-tags"></i>&nbsp;
<a href=/tags/tidymodels/>tidymodels</a>,
<a href=/tags/recipes/>recipes</a>,
<a href=/tags/yardstick/>yardstick</a>,
<a href=/tags/tidyposterior/>tidyposterior</a>,
<a href=/tags/embed/>embed</a></p><p style=margin-top:.5em><i class="fas fa-user-circle fa-fw"></i>&nbsp;
Max Kuhn, Davis Vaughan, Alex Hayes</p><div class=article-content><p>Along with the release of
<a href=https://tidymodels.github.io/parsnip/ target=_blank rel=noopener><code>parsnip</code></a> there are new versions of many <code>tidymodels</code> packages:
<a href=https://tidymodels.github.io/recipes/ target=_blank rel=noopener><code>recipes</code></a>,
<a href=https://tidymodels.github.io/yardstick/ target=_blank rel=noopener><code>yardstick</code></a>,
<a href=https://tidymodels.github.io/embed/ target=_blank rel=noopener><code>embed</code></a>,
<a href=https://tidymodels.github.io/tidyposterior/ target=_blank rel=noopener><code>tidyposterior</code></a>, and
<a href=https://github.com/tidymodels/tidymodels target=_blank rel=noopener><code>tidymodels</code></a>.</p><p>We made the conscious choice to add all of the breaking changes now instead of spreading them out over a few versions. The biggest changes are in <code>yardstick</code> and <code>recipes</code> and these are described below.</p><p>One change across all of these packages: <code>broom</code> is no longer used to obtain the <code>tidy</code> S3 methods. Instead, the
<a href=https://www.tidyverse.org/articles/2018/11/generics-0.0.1/ target=_blank rel=noopener><code>generics</code> package</a> is imported so that we might reduce dependencies.</p><h2 id=yardstick><strong>yardstick</strong>
<a href=#yardstick><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>This is a large release for yardstick, with more metrics, grouped
data frame integration, multiclass metric support, and a few breaking changes.</p><h3 id=breaking-changes>Breaking changes
<a href=#breaking-changes><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>These changes were made with the intention of standardizing both the API and the output of each metric.</p><p>All metrics now return a tibble rather than a single numeric value. This sets
the groundwork for allowing metrics to be used with grouped data frames, and
allows more informative output to be returned from each metric.</p><p>To preserve some of the old behavior, <code>_vec()</code> functions have been added for each
metric. These take vectors as inputs and return a single numeric result.</p><p>A number of small breaking changes have been made to be in line with the tidymodels
<a href=https://tidymodels.github.io/model-implementation-principles/ target=_blank rel=noopener>model implementation principles</a>. These include: <code>mnLogLoss()</code> being renamed to
<a href=https://tidymodels.github.io/yardstick/reference/mn_log_loss.html target=_blank rel=noopener><code>mn_log_loss()</code></a>, the <code>na.rm</code> argument being renamed to <code>na_rm</code>, and other similar changes that reflect a standardization that is being implemented across the entire tidymodels ecosystem. All of the changes are documented in the
<a href=https://tidymodels.github.io/yardstick/news/index.html#breaking-changes target=_blank rel=noopener>NEWS</a>.</p><h3 id=multiclass-metrics>Multiclass metrics
<a href=#multiclass-metrics><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>A multiclass model is a classification model that has more than two potential outputs. Until now, the only metric with multiclass support was
<a href=https://tidymodels.github.io/yardstick/reference/accuracy.html target=_blank rel=noopener><code>accuracy()</code></a> because its definition extends naturally into the multiclass world. Now, all metrics have some form of multiclass support through the concepts of macro and micro averaging. To learn about how these types of averaging work, read the new
<a href=https://tidymodels.github.io/yardstick/articles/multiclass.html target=_blank rel=noopener>vignette</a>.</p><p>As an example, the following data set has columns for an observed multiclass result, the predicted class, individual class probability predictions, and the current resample (out of 10).</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf>library</span><span class=p>(</span><span class=n>dplyr</span><span class=p>)</span>
<span class=nf>data</span><span class=p>(</span><span class=s>&#34;hpc_cv&#34;</span><span class=p>)</span>
<span class=n>hpc_single_resample</span> <span class=o>&lt;-</span> <span class=nf>filter</span><span class=p>(</span><span class=n>hpc_cv</span><span class=p>,</span> <span class=n>Resample</span> <span class=o>==</span> <span class=s>&#34;Fold01&#34;</span><span class=p>)</span>
<span class=nf>head</span><span class=p>(</span><span class=n>hpc_single_resample</span><span class=p>,</span> <span class=n>n</span> <span class=o>=</span> <span class=m>1</span><span class=p>)</span>
</code></pre></div><pre><code>#&gt;   obs pred    VF      F       M        L Resample
#&gt; 1  VF   VF 0.914 0.0779 0.00848 1.99e-05   Fold01
</code></pre><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=c1># The outcome has 4 potential values</span>
<span class=nf>unique</span><span class=p>(</span><span class=n>hpc_single_resample</span><span class=o>$</span><span class=n>obs</span><span class=p>)</span>
</code></pre></div><pre><code>#&gt; [1] VF F  M  L 
#&gt; Levels: VF F M L
</code></pre><p>yardstick will automatically detect that the input is from a multiclass model,
and will choose to use macro averaging by default in most cases.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf>precision</span><span class=p>(</span><span class=n>hpc_single_resample</span><span class=p>,</span> <span class=n>obs</span><span class=p>,</span> <span class=n>pred</span><span class=p>)</span>
</code></pre></div><pre><code>#&gt; # A tibble: 1 x 3
#&gt;   .metric   .estimator .estimate
#&gt;   &lt;chr&gt;     &lt;chr&gt;          &lt;dbl&gt;
#&gt; 1 precision macro          0.637
</code></pre><p>To tell yardstick metrics to use a different variant of averaging, use the <code>estimator</code>
argument to specify <code>"macro"</code>, <code>"micro"</code> or <code>"macro_weighted"</code> averaging, among
others depending on the metric.</p><h3 id=grouped-data-frames>Grouped data frames
<a href=#grouped-data-frames><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>To calculate metrics on multiple resamples at once, yardstick now recognizes
grouped data frames and calculates the metric on each group separately.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=n>hpc_grouped</span> <span class=o>&lt;-</span> <span class=n>hpc_cv</span> <span class=o>%&gt;%</span>
  <span class=nf>group_by</span><span class=p>(</span><span class=n>Resample</span><span class=p>)</span>

<span class=n>hpc_grouped</span> <span class=o>%&gt;%</span>
  <span class=nf>pr_auc</span><span class=p>(</span><span class=n>obs</span><span class=p>,</span> <span class=n>VF</span><span class=o>:</span><span class=n>L</span><span class=p>)</span> <span class=o>%&gt;%</span>
  <span class=nf>head</span><span class=p>(</span><span class=m>3</span><span class=p>)</span>
</code></pre></div><pre><code>#&gt; # A tibble: 3 x 4
#&gt;   Resample .metric .estimator .estimate
#&gt;   &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
#&gt; 1 Fold01   pr_auc  macro          0.595
#&gt; 2 Fold02   pr_auc  macro          0.599
#&gt; 3 Fold03   pr_auc  macro          0.682
</code></pre><p>Combined with
<a href=https://tidymodels.github.io/yardstick/reference/metric_set.html target=_blank rel=noopener><code>metric_set()</code></a>, a new function for combining multiple metrics into one function call, this workflow makes calculating a large number of metrics over multiple resamples a quick task. We encourage you to check out the example section of
<a href=https://tidymodels.github.io/yardstick/reference/metric_set.html target=_blank rel=noopener><code>metric_set()</code>'s help page</a> if you are interested in learning more.</p><h3 id=curve-functions>Curve functions
<a href=#curve-functions><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>Four new &ldquo;curve&rdquo; functions have been added to compute the full ROC curve, precision-recall curve, lift curve, and gain curve. Each of these functions has a corresponding <code>ggplot2::autoplot()</code> method. Combined with the grouped data frame support, this greatly simplifies some aspects of visualizing model performance.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf>library</span><span class=p>(</span><span class=n>ggplot2</span><span class=p>)</span>
<span class=n>hpc_grouped</span> <span class=o>%&gt;%</span>
  <span class=nf>roc_curve</span><span class=p>(</span><span class=n>obs</span><span class=p>,</span> <span class=n>VF</span><span class=o>:</span><span class=n>L</span><span class=p>)</span> <span class=o>%&gt;%</span>
  <span class=nf>autoplot</span><span class=p>()</span> <span class=o>+</span>
  <span class=nf>ggtitle</span><span class=p>(</span><span class=s>&#34;One-VS-All ROC Curve&#34;</span><span class=p>,</span> <span class=n>subtitle</span> <span class=o>=</span> <span class=s>&#34;Computed for each resample&#34;</span><span class=p>)</span>
</code></pre></div><p><img src=/articles/2018-11-tidymodels-updates_files/figure-html/unnamed-chunk-4-1.png width=700px style=display:block;margin:auto></p><h3 id=new-metrics-and-vignettes>New metrics and vignettes
<a href=#new-metrics-and-vignettes><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>The following metrics are new in this release:
<a href=https://tidymodels.github.io/yardstick/reference/mape.html target=_blank rel=noopener><code>mape()</code></a>,
<a href=https://tidymodels.github.io/yardstick/reference/kap.html target=_blank rel=noopener><code>kap()</code></a>,
<a href=https://tidymodels.github.io/yardstick/reference/detection_prevalence.html target=_blank rel=noopener><code>detection_prevalence()</code></a>,
<a href=https://tidymodels.github.io/yardstick/reference/bal_accuracy.html target=_blank rel=noopener><code>bal_accuracy()</code></a>,
<a href=https://tidymodels.github.io/yardstick/reference/roc_curve.html target=_blank rel=noopener><code>roc_curve()</code></a>,
<a href=https://tidymodels.github.io/yardstick/reference/pr_curve.html target=_blank rel=noopener><code>pr_curve()</code></a>,
<a href=https://tidymodels.github.io/yardstick/reference/gain_curve.html target=_blank rel=noopener><code>gain_curve()</code></a>,
<a href=https://tidymodels.github.io/yardstick/reference/lift_curve.html target=_blank rel=noopener><code>lift_curve()</code></a>, and
<a href=https://tidymodels.github.io/yardstick/reference/gain_capture.html target=_blank rel=noopener><code>gain_capture()</code></a>.</p><p>There are also three new vignettes. One has already been mentioned that describes
<a href=https://tidymodels.github.io/yardstick/articles/multiclass.html target=_blank rel=noopener>multiclass averaging</a>. The other two focus on the three main
<a href=https://tidymodels.github.io/yardstick/articles/metric-types.html target=_blank rel=noopener>metric types</a> in yardstick, and on implementing
<a href=https://tidymodels.github.io/yardstick/articles/custom-metrics.html target=_blank rel=noopener>custom metrics</a> for personal use.</p><h2 id=recipes><strong>recipes</strong>
<a href=#recipes><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><h3 id=breaking-changes-1>Breaking changes
<a href=#breaking-changes-1><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>One big change was to make the argument names more consistent with the tidyverse standards and to also make them consistent with <code>dials</code> and other packages. For example,
<a href=https://tidymodels.github.io/recipes/reference/step_pca.html target=_blank rel=noopener><code>step_pca()</code></a> now has an argument <code>num_comp</code> that replaces the previous <code>num</code> argument. This will pay off later when we enable the detection of tuning parameters and the automatic determination of grid values or parameter ranges. The biggest name change is in
<a href=https://tidymodels.github.io/recipes/reference/bake.html target=_blank rel=noopener><code>bake()</code></a>; <code>newdata</code> is now <code>new_data</code>. For the time being, a warning will be issued when <code>newdata</code> is used but that won&rsquo;t last past the next version. The list of name changes are detailed
<a href=https://tidymodels.github.io/recipes/news/index.html target=_blank rel=noopener>here</a>.</p><p>In recipes, variables can have different roles (e.g. &ldquo;predictor&rdquo; or &ldquo;outcome&rdquo;). Beyond those set by the package, roles are largely user specified and can be pretty much anything. Previously, only a single role was allowed. The new version of recipes expands the number of roles per column. This now means that
<a href=https://tidymodels.github.io/recipes/reference/roles.html target=_blank rel=noopener><code>add_role()</code></a> will <em>append</em> roles, and the new function
<a href=https://tidymodels.github.io/recipes/reference/roles.html target=_blank rel=noopener><code>update_role()</code></a> will reset them. It also changes how the <code>summary()</code> results for a recipe are returned since there can now be multiple rows per column variable.</p><p>A feature that we will be working on in the <em>next</em> version is to be able to reference (and use) previous steps. For example, if you center some variables, you might want to uncenter them at a later step. For this future feature, this version of <code>recipes</code> mandates an ID field for each step. The ID can be anything, but the current convention is to use the step name followed by random digits (e.g. <code>"center_irqtH"</code>).</p><p>Another change was to default the
<a href=https://tidymodels.github.io/recipes/reference/prep.html target=_blank rel=noopener><code>prep()</code></a> option <code>retain</code> to <code>TRUE</code>. We (and others) found that this was something that is always done since it allows
<a href=https://tidymodels.github.io/recipes/reference/juice.html target=_blank rel=noopener><code>juice()</code></a> to get the processed training set at no extra cost. The down-side is that, if the training set is large, you carry a large copy of the data inside the recipe. When the <code>verbose</code> option is turned on, a message is printed showing the size of the training set, i.e.:</p><blockquote><p>&ldquo;The retained training set is ~ 20.0 Mb in memory.&rdquo;</p></blockquote><p>This size estimate is approximate since the base R function <code>object.size()</code> is used, which does not count objects in any environments that are carried along.</p><p>Finally, a number of steps check for duplicate names and will throw an error during <code>prep()</code> if this occurs. This behavior may slightly change in the future due to changes in the <code>tibble</code> package related to how unique names should treated be when creating data frames.</p><h3 id=new-steps>New steps
<a href=#new-steps><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>A big new feature in this version of <code>recipes</code> is the addition of <code>dplyr</code>-related steps:
<a href=https://tidymodels.github.io/recipes/reference/step_arrange.html target=_blank rel=noopener><code>step_arrange()</code></a>,
<a href=https://tidymodels.github.io/recipes/reference/step_filter.html target=_blank rel=noopener><code>step_filter()</code></a>,
<a href=https://tidymodels.github.io/recipes/reference/step_mutate.html target=_blank rel=noopener><code>step_mutate()</code></a>,
<a href=https://tidymodels.github.io/recipes/reference/step_sample.html target=_blank rel=noopener><code>step_sample()</code></a>, and
<a href=https://tidymodels.github.io/recipes/reference/step_slice.html target=_blank rel=noopener><code>step_slice()</code></a>. They follow their <code>dplyr</code> analogs.
<a href=https://tidymodels.github.io/recipes/reference/step_sample.html target=_blank rel=noopener><code>step_sample()</code></a> covers both <code>dplyr::sample_n()</code> and <code>dplyr::sample_frac()</code>. Other new steps include:</p><ul><li><p><a href=https://tidymodels.github.io/recipes/reference/step_integer.html target=_blank rel=noopener><code>step_integer()</code></a> converts data to ordered integers similar to
<a href=https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.LabelEncoder.html target=_blank rel=noopener><code>LabelEncoder</code></a>.</p></li><li><p><a href=https://tidymodels.github.io/recipes/reference/step_geodist.html target=_blank rel=noopener><code>step_geodist()</code></a> can be used to calculate the distance between geocodes and a single reference location.</p></li><li><p><a href=https://tidymodels.github.io/recipes/reference/step_nnmf.html target=_blank rel=noopener><code>step_nnmf()</code></a> computes the non-negative matrix factorization components for non-negative data.</p></li></ul><p>List-columns are also supported in <code>recipes</code> now.
<a href=https://tidymodels.github.io/recipes/reference/summary.recipe.html target=_blank rel=noopener><code>summary.recipe()</code></a> now shows <code>type</code> column values as &ldquo;list&rdquo; and these can be selected using <code>has_type("list")</code>. When printing the recipe, a row is labeled as missing when its entire list element is missing (e.g. <code>is.na(list[[i]])</code> is <code>TRUE</code>). If the list element has some non-missing values, it is not counted as missing.</p><p>There are also bug fixes and other small changes that can be found in the
<a href=https://tidymodels.github.io/recipes/news/index.html target=_blank rel=noopener>News file</a>.</p><h2 id=rsample><strong>rsample</strong>
<a href=#rsample><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>A function
<a href=https://tidymodels.github.io/rsample/reference/initial_split.html target=_blank rel=noopener><code>initial_time_split()</code></a> was added. It can be used to create <em>ordered</em> initial splits and would be appropriate for time series data.</p><p>(<strong>breaking change</strong>) Also, the <code>recipes</code>-related
<a href=https://tidymodels.github.io/recipes/reference/prepper.html target=_blank rel=noopener><code>prepper()</code></a> function was moved to the <code>recipes</code> package. This makes the <code>rsample</code>'s install footprint much smaller.</p><p>Finally, <code>rsplit</code> objects have a better representation inside of tibbles when the sample sizes are large.</p><h2 id=embed><strong>embed</strong>
<a href=#embed><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>The tensorflow function
<a href=https://tidymodels.github.io/embed/reference/step_embed.html target=_blank rel=noopener><code>step_embed()</code></a> can now handle callbacks to <code>keras</code>. This enables a few different features, including stopping when a convergence criterion is met.</p><h2 id=tidymodels><strong>tidymodels</strong>
<a href=#tidymodels><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>We added
<a href=https://tidymodels.github.io/parsnip/ target=_blank rel=noopener><code>parsnip</code></a> and
<a href=https://tidymodels.github.io/dials/ target=_blank rel=noopener><code>dials</code></a> to the core set of packages and bumped all packages up to their current versions.</p></div></div><div class=column25><div class="section hideOnMobile"><div class=sectionTitle>Contents</div><nav id=TableOfContents><ul><li><a href=#yardstick><strong>yardstick</strong></a></li><li><a href=#recipes><strong>recipes</strong></a></li><li><a href=#rsample><strong>rsample</strong></a></li><li><a href=#embed><strong>embed</strong></a></li><li><a href=#tidymodels><strong>tidymodels</strong></a></li></ul></nav></div><div class=section></div></div></div></div></div><div id=rStudioFooter class=band><div class=bandContent><div id=copyright>The tidyverse is proudly supported by <a class=rstudioLogo href=https://posit.co/ aria-label="Posit Homepage"></a></div><div id=logos><a href=https://www.tidyverse.org/google_privacy_policy>Privacy policy</a>
<a href=https://github.com/tidyverse class="footerLogo gitHub" aria-label="Tidyverse GitHub organization"></a><a href=https://twitter.com/hashtag/rstats class="footerLogo twitter" aria-label="rstats hashtag on twitter.com"></a></div></div></div></div></div><script src=/js/math-code.js></script><script type=text/x-mathjax-config>
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    processEscapes: true
  }
});
</script><script async src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><script type=application/javascript>var dnt=(navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack);var doNotTrack=(dnt=="1"||dnt=="yes");if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');if(window.sessionStorage){var GA_SESSION_STORAGE_KEY='ga:clientId';ga('create','UA-115082821-1',{'storage':'none','clientId':sessionStorage.getItem(GA_SESSION_STORAGE_KEY)});ga(function(tracker){sessionStorage.setItem(GA_SESSION_STORAGE_KEY,tracker.get('clientId'));});}
ga('set','anonymizeIp',true);ga('send','pageview');}</script></body></html></div></div></body></html>