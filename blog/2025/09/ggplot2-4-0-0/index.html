<!doctype html><html><head><!doctype html><html lang=en-us><link rel=stylesheet href=/css/fonts.css><link rel=stylesheet href=/css/main-site.css><link rel=stylesheet href=/css/fa5-all.css><style type=text/css>body{background-color:#fff;color:#1a1917}a{color:#38577f}a:hover{color:#42709b}a:focus{outline-color:#42709b}.column25-left .sectionTitle a:hover:not(.current),.column16-left .sectionTitle a:hover:not(.current){color:#1a1917}.icon-attribution,.icon-attribution a{color:#1a1917;opacity:75%}#homeContent .band.first{background-color:#fff}#homeContent .band.second{background-color:#fdeba4}#homeContent .band.third{background-color:#fff}#rStudioHeader{background-color:#1a162d;color:#fff}#rStudioHeader .productName{color:#fff}#rStudioHeader .productName:hover,#rStudioHeader .productName:focus{color:#fdeba4}#rStudioHeader #menu .menuItem.a{background-color:#75aadb;color:#fff}#rStudioHeader #menu .menuItem:hover{background-color:#484557;color:#fff}#rStudioHeader #menu .menuItem.current{background-color:#fff;color:#1a162d;text-decoration:none}#rStudioFooter.band{background-color:#767381}#rStudioFooter .bandContent #copyright{color:#e3eef8}table tbody tr:nth-child(even){background-color:#f7faff}table tbody tr:nth-child(odd){background-color:#fff}.latest{border-top:.5em solid <no value>}.event{-moz-box-shadow:0 0 0 0 rgba(0,0,0,.1);-webkit-box-shadow:0 0 0 0 rgba(0,0,0,.1);box-shadow:0 0 0 0 rgba(0,0,0,.1)}.section .event{background-color:#eab0c41a}.section .event{border-top:7pt solid #a19ea936}.section .event a{color:#1a162d}.section .event{color:#404040}</style><link rel=stylesheet href=/css/tidyverse.css><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Hugo 0.71.1"><title>ggplot2 4.0.0</title><meta property="og:title" content="ggplot2 4.0.0"><meta property="og:description" content="A new major version of ggplot2 has been released on CRAN. Find out what is new here."><meta property="og:type" content="article"><meta property="og:url" content="https://www.tidyverse.org/blog/2025/09/ggplot2-4-0-0/"><meta property="twitter:card" content="summary_large_image"><meta property="og:title" content="ggplot2 4.0.0 - Tidyverse"><meta property="description" content="A new major version of ggplot2 has been released on CRAN. Find out what is new here."><meta property="og:description" content="A new major version of ggplot2 has been released on CRAN. Find out what is new here."><meta property="og:image" content="https://www.tidyverse.org/blog/2025/09/ggplot2-4-0-0/thumbnail-sq.jpg"><meta name=twitter:image content="https://www.tidyverse.org/blog/2025/09/ggplot2-4-0-0/thumbnail-wd.jpg"><link rel=apple-touch-icon sizes=180x180 href=/images/favicons/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/images/favicons/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/images/favicons/favicon-16x16.png><link rel=manifest href=/images/favicons/site.webmanifest><link rel=mask-icon href=/images/favicons/safari-pinned-tab.svg><link rel="shortcut icon" href=/images/favicons/favicon.ico><meta name=msapplication-TileColor content="#da532c"><meta name=msapplication-config href=/images/favicons/browserconfig.xml><script type=text/javascript src=/js/jquery-3.5.1.min.js></script><script type=text/javascript src=/js/site.js></script><link rel=icon href=/images/favicon.ico><script type=text/javascript src=/js/clipboard.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin=anonymous></script><script defer data-domain=tidyverse.org,all.tidyverse.org src=https://plausible.io/js/plausible.js></script></head><body><div id=appTidyverseSite class="shrinkHeader alwaysShrinkHeader"><div id=main><div id=rStudioHeader><nav class=band><div class="innards bandContent"><div><a class=productName href=/%20/>Tidyverse</a></div><div id=menu><div id=menuToggler></div><div id=menuItems><a class=menuItem href=/packages/>Packages</a>
<a class="menuItem current" href=/blog/>Blog</a>
<a class=menuItem href=/learn/>Learn</a>
<a class=menuItem href=/help/>Help</a>
<a class=menuItem href=/contribute/>Contribute</a></div></div></div></nav></div><main><div class="band padForHeader pushFooter"><div class=bandContent><div class="full splitColumns withMobileMargins"><div class=column75><h1 class=article-title>ggplot2 4.0.0</h1><div class=article-header aria-hidden=true><div class=photo><img src=/blog/2025/09/ggplot2-4-0-0/thumbnail-wd.jpg></div><div class=photoCredit>Photo by <a href=https://unsplash.com/photos/selective-focus-photography-of-water-droplets-on-grasses--N_UwPdUs7E>Jonas Weckschmied</a></div></div><span class=article-date><i class="fas fa-calendar-day fa-fw"></i>&nbsp;&nbsp;2025/09/11</span><p style=margin-bottom:.5em;margin-top:.85em><i class="fas fa-tags"></i>&nbsp;
<a href=/tags/ggplot2/>ggplot2</a></p><p style=margin-top:.5em><i class="fas fa-user-circle fa-fw"></i>&nbsp;
Teun van den Brand</p><div class=article-content><p>We&rsquo;re tickled pink to announce the release of
<a href=https://ggplot2.tidyverse.org target=_blank rel=noopener>ggplot2</a> 4.0.0. ggplot2 is a system for declaratively creating graphics, based on The Grammar of Graphics. You provide the data, tell ggplot2 how to map variables to aesthetics, what graphical primitives to use, and it takes care of the details.</p><p>The new version can be installed from CRAN using:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nf><a href=https://rdrr.io/r/utils/install.packages.html>install.packages</a></span><span class=o>(</span><span class=s>"ggplot2"</span><span class=o>)</span></span></code></pre></div><p>This is a substantial release meriting a new major version, and contains a series of changes from a rewrite of the object oriented system from S3 to S7, large new features to smaller quality of life improvements and bugfixes. It is also the 18th anniversary of ggplot2 which is cause for celebration! In this blog post, we will highlight the most salient new features that come with this release. You can see a full list of changes in the
<a href=https://ggplot2.tidyverse.org/news/index.html target=_blank rel=noopener>release notes</a></p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=kr><a href=https://rdrr.io/r/base/library.html>library</a></span><span class=o>(</span><span class=nv><a href=https://ggplot2.tidyverse.org>ggplot2</a></span><span class=o>)</span></span>
<span><span class=kr><a href=https://rdrr.io/r/base/library.html>library</a></span><span class=o>(</span><span class=nv><a href=https://patchwork.data-imaginist.com>patchwork</a></span><span class=o>)</span></span></code></pre></div><h2 id=adopting-s7>Adopting S7
<a href=#adopting-s7><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>In ggplot2, we use major version increments to indicate that something at the core of the package has changed. In this release, we have replaced many of ggplot2&rsquo;s S3 objects with S7 objects. Like S3 and S4, S7 is also an object oriented system that uses classes, generics and methods. S7 is a newer system that aims to strike a good balance between the flexibility of S3 and formality of S4.</p><p>Mostly, this change shouldn&rsquo;t be very noticeable when you&rsquo;re just using ggplot2 for building regular plots. At best, you may notice that we&rsquo;re more strictly enforcing types for certain arguments. For example, most ludicrous input is now rejected right away. This is due to how properties in S7 work, which get validated when a new object is instantiated.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nf><a href=https://ggplot2.tidyverse.org/reference/element.html>element_text</a></span><span class=o>(</span>hjust <span class=o>=</span> <span class=s>"foo"</span><span class=o>)</span></span>
<span><span class=c>#&gt; Error: &lt;ggplot2::element_text&gt; object properties are invalid:</span></span>
<span><span class=c>#&gt; - @hjust must be &lt;NULL&gt;, &lt;integer&gt;, or &lt;double&gt;, not &lt;character&gt;</span></span>
<span></span></code></pre></div><p>However, it may require some adaptation on your end if you use ggplot2&rsquo;s innards in unusual ways. For extension builders, a major benefit of using S7 is that one can now use double dispatch. This is most important for the
<a href=https://ggplot2.tidyverse.org/reference/update_ggplot.html target=_blank rel=noopener><code>update_ggplot()</code></a> function (the successor of
<a href=https://ggplot2.tidyverse.org/reference/update_ggplot.html target=_blank rel=noopener><code>ggplot_add()</code></a>), which determines what happens when you <code>+</code> an object to a plot. Now with S7, you can control what happens not only for right-hand side objects (which is how it used to work in S3), but also for the left-hand side objects.</p><p>We have put various pieces of backwards compatibility in to not break many packages that assumed the S3 structures of ggplot2. For example, we still return the data property with <code>ggplot()$data</code>, whereas the S7 way of accessing this should be <code>ggplot()@data</code>. Expect these to be phased out over time in favour of S7. We are preparing another blog post to help migrating from S3 to S7 for ggplot2 related packages.</p><h2 id=theme-improvements>Theme improvements
<a href=#theme-improvements><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Themes in ggplot2 have long served the role of capturing any non-data aspects of styling plots. We have come to realise that the default look of layers, from what the default shape of points is to what the default colour palette is, are also not truly data-driven choices. The idea to put these defaults into themes has been around for a while and Dana Page Seidel did pioneering work implementing this as early as 2018. Now, years of waiting have come to fruition and we&rsquo;re proud to announce this new functionality.</p><h3 id=ink-and-paper>Ink and paper
<a href=#ink-and-paper><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>The way layer defaults are now implemented differs slightly from typical aesthetics you know and love. Whereas layers aesthetics distinguish <code>colour</code> and <code>fill</code>, the theme defaults distinguish <code>ink</code> (foreground) and <code>paper</code> (background). A boxplot is unreadable without <code>colour</code>, but is perfectly interpretable without <code>fill</code>. In the boxplot case, the <code>ink</code> is thus clearly the <code>colour</code> whereas <code>paper</code> is the <code>fill</code>. In bar charts or histograms, the
<a href=https://clauswilke.com/dataviz/proportional-ink.html target=_blank rel=noopener>proportional ink</a> principle prescribes that the <code>fill</code> aesthetic is considered foreground, and thus count as <code>ink</code>. To accommodate special cases, like lines in
<a href=https://ggplot2.tidyverse.org/reference/geom_smooth.html target=_blank rel=noopener><code>geom_smooth()</code></a> or
<a href=https://ggplot2.tidyverse.org/reference/geom_contour.html target=_blank rel=noopener><code>geom_contour()</code></a>, we also added a third <code>accent</code> option. In short, the theme defaults have role-oriented settings that differ from the property-oriented settings in layers.</p><p>We&rsquo;ve added these three options to all built-in complete themes. Not only propagate these automatically to the layer defaults, they are also used to style additional theme components. You may notice that the panel background colour is a blend between <code>paper</code> and <code>ink</code>, which is now how many elements are parametrised in complete themes.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nf><a href=https://ggplot2.tidyverse.org/reference/ggplot.html>ggplot</a></span><span class=o>(</span><span class=nv>mpg</span>, <span class=nf><a href=https://ggplot2.tidyverse.org/reference/aes.html>aes</a></span><span class=o>(</span><span class=nv>displ</span>, <span class=nv>hwy</span><span class=o>)</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/geom_point.html>geom_point</a></span><span class=o>(</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/geom_smooth.html>geom_smooth</a></span><span class=o>(</span>method <span class=o>=</span> <span class=s>"lm"</span>, formula <span class=o>=</span> <span class=nv>y</span> <span class=o>~</span> <span class=nv>x</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/ggtheme.html>theme_gray</a></span><span class=o>(</span>paper <span class=o>=</span> <span class=s>"cornsilk"</span>, ink <span class=o>=</span> <span class=s>"navy"</span>, accent <span class=o>=</span> <span class=s>"tomato"</span><span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-3-1.png width=700px style=display:block;margin:auto></p></div><p>If you&rsquo;re customising a theme, you can use the <code>theme(geom)</code> argument to set a collection of defaults. The new function
<a href=https://ggplot2.tidyverse.org/reference/element.html target=_blank rel=noopener><code>element_geom()</code></a> can be used to set these properties. Additionally, if you want a layer to read the property from this theme element, you can use the
<a href=https://ggplot2.tidyverse.org/reference/aes_eval.html target=_blank rel=noopener><code>from_theme()</code></a> function in the mapping to access these variables<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nf><a href=https://ggplot2.tidyverse.org/reference/ggplot.html>ggplot</a></span><span class=o>(</span><span class=nv>mpg</span>, <span class=nf><a href=https://ggplot2.tidyverse.org/reference/aes.html>aes</a></span><span class=o>(</span><span class=nv>class</span>, <span class=nv>displ</span><span class=o>)</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/geom_boxplot.html>geom_boxplot</a></span><span class=o>(</span><span class=nf><a href=https://ggplot2.tidyverse.org/reference/aes.html>aes</a></span><span class=o>(</span>colour <span class=o>=</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/aes_eval.html>from_theme</a></span><span class=o>(</span><span class=nv>accent</span><span class=o>)</span><span class=o>)</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/theme.html>theme</a></span><span class=o>(</span></span>
<span>    geom <span class=o>=</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/element.html>element_geom</a></span><span class=o>(</span>accent <span class=o>=</span> <span class=s>"tomato"</span>, paper <span class=o>=</span> <span class=s>"cornsilk"</span><span class=o>)</span></span>
<span>  <span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-4-1.png width=700px style=display:block;margin:auto></p></div><p>A second conceptual difference in
<a href=https://ggplot2.tidyverse.org/reference/element.html target=_blank rel=noopener><code>element_geom()</code></a> pertains the the use of lines. In one role, like in a line graph, the line represents the data directly. In a second role, a line serves as separation between two units. For example, you can display countries as polygons and the line connecting the vertices separate out places that are inside a country versus places that are outside that country. These two roles are captured in a <code>linewidth</code> and <code>linetype</code> pair and a <code>borderwidth</code> and <code>bordertype</code> pair.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nf><a href=https://ggplot2.tidyverse.org/reference/ggplot.html>ggplot</a></span><span class=o>(</span><span class=nv>faithful</span>, <span class=nf><a href=https://ggplot2.tidyverse.org/reference/aes.html>aes</a></span><span class=o>(</span><span class=nv>waiting</span><span class=o>)</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/geom_histogram.html>geom_histogram</a></span><span class=o>(</span>bins <span class=o>=</span> <span class=m>30</span>, colour <span class=o>=</span> <span class=s>"black"</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/geom_histogram.html>geom_freqpoly</a></span><span class=o>(</span>bins <span class=o>=</span> <span class=m>30</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/theme.html>theme</a></span><span class=o>(</span>geom <span class=o>=</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/element.html>element_geom</a></span><span class=o>(</span></span>
<span>    bordertype <span class=o>=</span> <span class=s>"dashed"</span>,</span>
<span>    borderwidth <span class=o>=</span> <span class=m>0.2</span>,</span>
<span>    linewidth <span class=o>=</span> <span class=m>2</span>,</span>
<span>    linetype <span class=o>=</span> <span class=s>"solid"</span></span>
<span>  <span class=o>)</span><span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-5-1.png width=700px style=display:block;margin:auto></p></div><h3 id=scales-and-palettes>Scales and palettes
<a href=#scales-and-palettes><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>In addition to the defaults for layers, default palettes are now also encapsulated in the theme. The relevant theme settings have the pattern <code>palette.{aesthetic}.{type}</code>, where <code>type</code> can be either discrete or continuous. This allows you to coordinate your colour palettes with the rest of the theme.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nf><a href=https://ggplot2.tidyverse.org/reference/ggplot.html>ggplot</a></span><span class=o>(</span><span class=nv>mpg</span>, <span class=nf><a href=https://ggplot2.tidyverse.org/reference/aes.html>aes</a></span><span class=o>(</span><span class=nv>displ</span>, <span class=nv>hwy</span>, shape <span class=o>=</span> <span class=nv>drv</span>, colour <span class=o>=</span> <span class=nv>cty</span><span class=o>)</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/geom_point.html>geom_point</a></span><span class=o>(</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/theme.html>theme</a></span><span class=o>(</span></span>
<span>    palette.colour.continuous <span class=o>=</span> <span class=nf><a href=https://rdrr.io/r/base/c.html>c</a></span><span class=o>(</span><span class=s>"chartreuse"</span>, <span class=s>"forestgreen"</span><span class=o>)</span>,</span>
<span>    palette.shape.discrete <span class=o>=</span> <span class=nf><a href=https://rdrr.io/r/base/c.html>c</a></span><span class=o>(</span><span class=s>"triangle"</span>, <span class=s>"triangle open"</span>, <span class=s>"triangle down open"</span><span class=o>)</span></span>
<span>  <span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-6-1.png width=700px style=display:block;margin:auto></p></div><p>The way this works is that all defaults scales now have <code>palette = NULL</code> as their default. During plot building, any <code>NULL</code> palettes are replaced by those declared in the theme.</p><h3 id=shortcuts>Shortcuts
<a href=#shortcuts><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>We like to introduce a new family of short cuts. Looking at code in the wild, we&rsquo;ve come to realise that theme declarations are very often chaotic. The
<a href=https://ggplot2.tidyverse.org/reference/theme.html target=_blank rel=noopener><code>theme()</code></a> functions has lots of arguments, long argument names (hello there, <code>axis.minor.ticks.length.x.bottom</code>!) and very little structure. To make themes a little bit more digestible, we&rsquo;ve created the following helper functions:</p><ul><li><a href=https://ggplot2.tidyverse.org/reference/subtheme.html target=_blank rel=noopener><code>theme_sub_axis()</code></a><ul><li><a href=https://ggplot2.tidyverse.org/reference/subtheme.html target=_blank rel=noopener><code>theme_sub_axis_x()</code></a><ul><li><a href=https://ggplot2.tidyverse.org/reference/subtheme.html target=_blank rel=noopener><code>theme_sub_axis_bottom()</code></a></li><li><a href=https://ggplot2.tidyverse.org/reference/subtheme.html target=_blank rel=noopener><code>theme_sub_axis_top()</code></a></li></ul></li><li><a href=https://ggplot2.tidyverse.org/reference/subtheme.html target=_blank rel=noopener><code>theme_sub_axis_y()</code></a><ul><li><a href=https://ggplot2.tidyverse.org/reference/subtheme.html target=_blank rel=noopener><code>theme_sub_axis_left()</code></a></li><li><a href=https://ggplot2.tidyverse.org/reference/subtheme.html target=_blank rel=noopener><code>theme_sub_axis_right()</code></a></li></ul></li></ul></li><li><a href=https://ggplot2.tidyverse.org/reference/subtheme.html target=_blank rel=noopener><code>theme_sub_legend()</code></a></li><li><a href=https://ggplot2.tidyverse.org/reference/subtheme.html target=_blank rel=noopener><code>theme_sub_panel()</code></a></li><li><a href=https://ggplot2.tidyverse.org/reference/subtheme.html target=_blank rel=noopener><code>theme_sub_plot()</code></a></li><li><a href=https://ggplot2.tidyverse.org/reference/subtheme.html target=_blank rel=noopener><code>theme_sub_strip()</code></a></li></ul><p>These helper functions pass on their arguments to
<a href=https://ggplot2.tidyverse.org/reference/theme.html target=_blank rel=noopener><code>theme()</code></a> after they&rsquo;ve prepended a relevant prefix. For example, using <code>theme_sub_legend(justification)</code> will translate to <code>theme(legend.justification)</code>. When you have >1 theme element to change in a cluster of settings, it quickly becomes less typing to enlist the relevant shortcut. As a bonus, your theme code will tend to self-organise and become somewhat more readable.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=c># Tired, verbose, chaotic</span></span>
<span><span class=nf><a href=https://ggplot2.tidyverse.org/reference/theme.html>theme</a></span><span class=o>(</span></span>
<span>  panel.widths <span class=o>=</span> <span class=nf><a href=https://rdrr.io/r/grid/unit.html>unit</a></span><span class=o>(</span><span class=m>5</span>, <span class=s>"cm"</span><span class=o>)</span>,</span>
<span>  axis.ticks.x <span class=o>=</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/element.html>element_line</a></span><span class=o>(</span>colour <span class=o>=</span> <span class=s>"red"</span><span class=o>)</span>,</span>
<span>  axis.ticks.length.x <span class=o>=</span> <span class=nf><a href=https://rdrr.io/r/grid/unit.html>unit</a></span><span class=o>(</span><span class=m>5</span>, <span class=s>"mm"</span><span class=o>)</span>,</span>
<span>  panel.background <span class=o>=</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/element.html>element_rect</a></span><span class=o>(</span>fill <span class=o>=</span> <span class=kc>NA</span><span class=o>)</span>,</span>
<span>  panel.spacing.x <span class=o>=</span> <span class=nf><a href=https://rdrr.io/r/grid/unit.html>unit</a></span><span class=o>(</span><span class=m>5</span>, <span class=s>"mm"</span><span class=o>)</span></span>
<span><span class=o>)</span></span>
<span></span>
<span><span class=c># Wired, terse, orderly</span></span>
<span><span class=nf><a href=https://ggplot2.tidyverse.org/reference/subtheme.html>theme_sub_axis_x</a></span><span class=o>(</span></span>
<span>  ticks <span class=o>=</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/element.html>element_line</a></span><span class=o>(</span>colour <span class=o>=</span> <span class=s>"red"</span><span class=o>)</span>,</span>
<span>  ticks.length <span class=o>=</span> <span class=nf><a href=https://rdrr.io/r/grid/unit.html>unit</a></span><span class=o>(</span><span class=m>5</span>, <span class=s>"mm"</span><span class=o>)</span></span>
<span><span class=o>)</span> <span class=o>+</span></span>
<span><span class=nf><a href=https://ggplot2.tidyverse.org/reference/subtheme.html>theme_sub_panel</a></span><span class=o>(</span></span>
<span>  widths <span class=o>=</span> <span class=nf><a href=https://rdrr.io/r/grid/unit.html>unit</a></span><span class=o>(</span><span class=m>5</span>, <span class=s>"cm"</span><span class=o>)</span>,</span>
<span>  spacing.x <span class=o>=</span> <span class=nf><a href=https://rdrr.io/r/grid/unit.html>unit</a></span><span class=o>(</span><span class=m>5</span>, <span class=s>"mm"</span><span class=o>)</span>,</span>
<span>  background <span class=o>=</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/element.html>element_rect</a></span><span class=o>(</span>fill <span class=o>=</span> <span class=kc>NA</span><span class=o>)</span></span>
<span><span class=o>)</span></span></code></pre></div><p>In addition to shortcuts for clusters of theme elements, we&rsquo;ve also added a few variants to declare margins.</p><ul><li><a href=https://ggplot2.tidyverse.org/reference/element.html target=_blank rel=noopener><code>margin_auto()</code></a> sets the margins in a CSS-like fashion similar to the
<a href=https://developer.mozilla.org/en-US/docs/Web/CSS/margin target=_blank rel=noopener><code>margin</code></a> and
<a href=https://developer.mozilla.org/en-US/docs/Web/CSS/padding target=_blank rel=noopener><code>padding</code></a> property.<ul><li><code>margin_auto(1)</code> sets all four sides at once. It expands to <code>margin(t = 1, r = 1, b = 1, l = 1)</code>.</li><li><code>margin_auto(1, 2)</code> sets horizontal and vertical sides. It expands to <code>margin(t = 1, r = 2, b = 1, l = 2)</code>.</li><li><code>margin_auto(1, 2, 3)</code> expands to <code>margin(t = 1, r = 2, b = 3, l = 2)</code>.</li></ul></li><li><a href=https://ggplot2.tidyverse.org/reference/element.html target=_blank rel=noopener><code>margin_part()</code></a> has <code>NA</code> units as default, which will get replaced when the theme gets resolved. It roughly equates to &lsquo;set some of the sides, keep others as they are&rsquo;.</li></ul><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nf><a href=https://ggplot2.tidyverse.org/reference/merge_element.html>merge_element</a></span><span class=o>(</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/element.html>margin_part</a></span><span class=o>(</span>r <span class=o>=</span> <span class=m>20</span><span class=o>)</span>, <span class=c># child</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/element.html>margin_auto</a></span><span class=o>(</span><span class=m>10</span><span class=o>)</span> <span class=c># parent</span></span>
<span><span class=o>)</span></span>
<span><span class=c>#&gt; [1] 10points 20points 10points 10points</span></span>
<span></span></code></pre></div><h3 id=new-settings>New settings
<a href=#new-settings><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>To coordinate (non-text) margins and spacings in a theme, we&rsquo;ve introduced <code>spacing</code> and <code>margins</code> as new root elements in the theme. Other spacings and margins at the leaf elements inherit from (scale with) these root elements. To facilitate the different spacings in ggplot2, unit elements can now use
<a href=https://ggplot2.tidyverse.org/reference/element.html target=_blank rel=noopener><code>rel()</code></a> to modify the inherited value. For example the default <code>axis.ticks.length</code> is now <code>rel(0.5)</code>, making the y-axis ticks 0.5 cm in the plot below. If we set the <code>axis.ticks.length.x</code> to <code>rel(2)</code>, it will double the value coming from <code>axis.ticks.length</code>, not double the value of <code>spacing</code>.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>p</span> <span class=o>&lt;-</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/ggplot.html>ggplot</a></span><span class=o>(</span><span class=nv>penguins</span>, <span class=nf><a href=https://ggplot2.tidyverse.org/reference/aes.html>aes</a></span><span class=o>(</span><span class=nv>bill_dep</span>, <span class=nv>bill_len</span>, colour <span class=o>=</span> <span class=nv>species</span><span class=o>)</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/geom_point.html>geom_point</a></span><span class=o>(</span>na.rm <span class=o>=</span> <span class=kc>TRUE</span><span class=o>)</span></span>
<span></span>
<span><span class=nv>p</span> <span class=o>+</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/theme.html>theme</a></span><span class=o>(</span></span>
<span>  spacing <span class=o>=</span> <span class=nf><a href=https://rdrr.io/r/grid/unit.html>unit</a></span><span class=o>(</span><span class=m>1</span>, <span class=s>"cm"</span><span class=o>)</span>, </span>
<span>  margins <span class=o>=</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/element.html>margin_auto</a></span><span class=o>(</span><span class=m>1</span>, unit <span class=o>=</span> <span class=s>"cm"</span><span class=o>)</span>,</span>
<span>  axis.ticks.length.x <span class=o>=</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/element.html>rel</a></span><span class=o>(</span><span class=m>2</span><span class=o>)</span></span>
<span><span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-9-1.png width=700px style=display:block;margin:auto></p></div><p>We also made it easier to set plot sizes. Using the <code>panel.widths</code> and <code>panel.heights</code> arguments, you can control the sizes of the panels. This mechanism is distinct from using <code>ggsave(width, height)</code>, where the whole plot, including annotations such as axes and titles is included. There are two ways to use these arguments:</p><ul><li>Give a vector of units: each one will be applied to a panel separately and the vector will be recycled to fit the number of panels.</li><li>Give a single unit: which sets the total panel area (including panel spacings and inner axes) to that size.</li></ul><p>Naturally, if you only have a single panel, these approaches are identical. If you have multiple panels and you want to set individual panels all to the same size (as opposed to the total size), you can take advantage of the recycling and use a length 2 unit vector.</p><p>In the plots below, you can notice that the panels span a different width despite the units adding up to the same amount (9 cm). This is because the &lsquo;single unit&rsquo; approach also includes the panel spacings, but not the &lsquo;separate units&rsquo; approach.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>p1</span> <span class=o>&lt;-</span> <span class=nv>p</span> <span class=o>+</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/facet_grid.html>facet_grid</a></span><span class=o>(</span><span class=o>~</span> <span class=nv>island</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/labs.html>labs</a></span><span class=o>(</span>title <span class=o>=</span> <span class=s>"Separate units (per panel)"</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=c># Using the new shortcut for panels</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/subtheme.html>theme_sub_panel</a></span><span class=o>(</span></span>
<span>    widths <span class=o>=</span> <span class=nf><a href=https://rdrr.io/r/grid/unit.html>unit</a></span><span class=o>(</span><span class=nf><a href=https://rdrr.io/r/base/c.html>c</a></span><span class=o>(</span><span class=m>2</span>, <span class=m>3</span>, <span class=m>4</span><span class=o>)</span>, <span class=s>"cm"</span><span class=o>)</span>,</span>
<span>    heights <span class=o>=</span> <span class=nf><a href=https://rdrr.io/r/grid/unit.html>unit</a></span><span class=o>(</span><span class=m>3</span>, <span class=s>"cm"</span><span class=o>)</span></span>
<span>  <span class=o>)</span></span>
<span></span>
<span><span class=nv>p2</span> <span class=o>&lt;-</span> <span class=nv>p</span> <span class=o>+</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/facet_grid.html>facet_grid</a></span><span class=o>(</span><span class=o>~</span> <span class=nv>island</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/labs.html>labs</a></span><span class=o>(</span>title <span class=o>=</span> <span class=s>"Single unit (all panels)"</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/subtheme.html>theme_sub_panel</a></span><span class=o>(</span></span>
<span>    widths <span class=o>=</span> <span class=nf><a href=https://rdrr.io/r/grid/unit.html>unit</a></span><span class=o>(</span><span class=m>9</span>, <span class=s>"cm"</span><span class=o>)</span>,</span>
<span>    heights <span class=o>=</span> <span class=nf><a href=https://rdrr.io/r/grid/unit.html>unit</a></span><span class=o>(</span><span class=m>3</span>, <span class=s>"cm"</span><span class=o>)</span></span>
<span>  <span class=o>)</span></span>
<span></span>
<span><span class=nv>p1</span> <span class=o>/</span> <span class=nv>p2</span></span>
</code></pre><p><img src=figs/unnamed-chunk-10-1.png width=700px style=display:block;margin:auto></p></div><h2 id=labels>Labels
<a href=#labels><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>We have added new ways that a plot retrieves labels for your variables. It is an informal convention in several packages including gt, Hmisc, labelled and others to use the &lsquo;label&rsquo; attribute to store human readable labels for vectors. Now ggplot2 joins this convention and uses the &lsquo;label&rsquo; attribute as the default label for a variable if present.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=c># The penguins dataset was incorporated into base R 4.5</span></span>
<span><span class=nv>df</span> <span class=o>&lt;-</span> <span class=nv>penguins</span></span>
<span></span>
<span><span class=c># Manually set label attributes.</span></span>
<span><span class=c># Other packages may offer better tooling than this.</span></span>
<span><span class=nf><a href=https://rdrr.io/r/base/attr.html>attr</a></span><span class=o>(</span><span class=nv>df</span><span class=o>$</span><span class=nv>species</span>, <span class=s>"label"</span><span class=o>)</span> <span class=o>&lt;-</span> <span class=s>"Penguin Species"</span></span>
<span><span class=nf><a href=https://rdrr.io/r/base/attr.html>attr</a></span><span class=o>(</span><span class=nv>df</span><span class=o>$</span><span class=nv>bill_dep</span>, <span class=s>"label"</span><span class=o>)</span> <span class=o>&lt;-</span> <span class=s>"Bill depth (mm)"</span></span>
<span><span class=nf><a href=https://rdrr.io/r/base/attr.html>attr</a></span><span class=o>(</span><span class=nv>df</span><span class=o>$</span><span class=nv>bill_len</span>, <span class=s>"label"</span><span class=o>)</span> <span class=o>&lt;-</span> <span class=s>"Bill length (mm)"</span></span>
<span><span class=nf><a href=https://rdrr.io/r/base/attr.html>attr</a></span><span class=o>(</span><span class=nv>df</span><span class=o>$</span><span class=nv>body_mass</span>, <span class=s>"label"</span><span class=o>)</span> <span class=o>&lt;-</span> <span class=s>"Body mass (g)"</span></span>
<span></span>
<span><span class=nf><a href=https://ggplot2.tidyverse.org/reference/ggplot.html>ggplot</a></span><span class=o>(</span><span class=nv>df</span>, <span class=nf><a href=https://ggplot2.tidyverse.org/reference/aes.html>aes</a></span><span class=o>(</span><span class=nv>bill_dep</span>, <span class=nv>bill_len</span>, colour <span class=o>=</span> <span class=nf><a href=https://rdrr.io/r/base/MathFun.html>sqrt</a></span><span class=o>(</span><span class=nv>body_mass</span><span class=o>)</span><span class=o>)</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/geom_point.html>geom_point</a></span><span class=o>(</span>na.rm <span class=o>=</span> <span class=kc>TRUE</span><span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-11-1.png width=700px style=display:block;margin:auto></p></div><p>It has also been entrenched in some workflows to use a &lsquo;data dictionary&rsquo; or codebook. For labelling purposes these dictionaries often contain column metadata that include labels or descriptions for variables (columns) in the dataset. To make it easier to work with column labels, we added the <code>labs(dictionary)</code> argument. It takes a named vector of labels, that can easily be generated from a data dictionary by
<a href=https://rdrr.io/r/stats/setNames.html target=_blank rel=noopener><code>setNames()</code></a> or
<a href=https://dplyr.tidyverse.org/reference/pull.html target=_blank rel=noopener><code>dplyr::pull()</code></a>.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>dict</span> <span class=o>&lt;-</span> <span class=nf>tibble</span><span class=nf>::</span><span class=nf><a href=https://tibble.tidyverse.org/reference/tribble.html>tribble</a></span><span class=o>(</span></span>
<span>  <span class=o>~</span><span class=nv>var</span>,    <span class=o>~</span><span class=nv>label</span>,</span>
<span>  <span class=s>"species"</span>,  <span class=s>"Penguin Species"</span>,</span>
<span>  <span class=s>"bill_dep"</span>, <span class=s>"Bill depth (mm)"</span>,</span>
<span>  <span class=s>"bill_len"</span>, <span class=s>"Bill length (mm)"</span>,</span>
<span>  <span class=s>"body_mass"</span>, <span class=s>"Body mass (g)"</span></span>
<span><span class=o>)</span></span>
<span></span>
<span><span class=nf><a href=https://ggplot2.tidyverse.org/reference/ggplot.html>ggplot</a></span><span class=o>(</span><span class=nv>penguins</span>, <span class=nf><a href=https://ggplot2.tidyverse.org/reference/aes.html>aes</a></span><span class=o>(</span><span class=nv>bill_dep</span>, <span class=nv>bill_len</span>, colour <span class=o>=</span> <span class=nv>body_mass</span><span class=o>)</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/geom_point.html>geom_point</a></span><span class=o>(</span>na.rm <span class=o>=</span> <span class=kc>TRUE</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=c># Or:</span></span>
<span>  <span class=c># labs(dictionary = dplyr::pull(dict, label, name = var))</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/labs.html>labs</a></span><span class=o>(</span>dictionary <span class=o>=</span> <span class=nf><a href=https://rdrr.io/r/stats/setNames.html>setNames</a></span><span class=o>(</span><span class=nv>dict</span><span class=o>$</span><span class=nv>label</span>, <span class=nv>dict</span><span class=o>$</span><span class=nv>var</span><span class=o>)</span><span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-12-1.png width=700px style=display:block;margin:auto></p></div><p>One benefit to the label attributes or data dictionary approaches is that it is linked to your variables, not aesthetics. This means you can easily rearrange your aesthetics for a different plot, without having to painstakingly reorient the labels towards the correct aesthetics.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nf><a href=https://ggplot2.tidyverse.org/reference/get_last_plot.html>last_plot</a></span><span class=o>(</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/aes.html>aes</a></span><span class=o>(</span><span class=nv>body_mass</span>, <span class=nv>bill_len</span>, colour <span class=o>=</span> <span class=nv>species</span><span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-13-1.png width=700px style=display:block;margin:auto></p></div><p>There are a few caveats to these label attributes and data dictionary approaches though:</p><ul><li>If the aesthetic is not a pure variable name the label is not used. You can see this in the <code>sqrt(body_mass)</code> in the first example, which does not use the &lsquo;Body mass (g)&rsquo; label. We assume when a variable is adjusted in this way, this would need to be reflected in the label itself. It would therefore be inappropriate to use the label of the unadjusted variable. Use of the
<a href=https://ggplot2.tidyverse.org/articles/ggplot2-in-packages.html#using-aes-and-vars-in-a-package-function target=_blank rel=noopener><code>.data</code>-pronoun</a> counts as a pure variable name for labelling purposes.</li><li>Some attributes are more stable than others, and it is not ggplot2&rsquo;s responsibility to babysit attributes. For example using <code>head(&lt;data.frame>)</code> will typically drop attributes from atomic columns, whereas <code>head(&lt;tibble>)</code> will not.</li></ul><p>In addition, we&rsquo;re also allowing to use functions in all the places you can declare labels. The
<a href=https://ggplot2.tidyverse.org/reference/labs.html target=_blank rel=noopener><code>labs()</code></a> function, scale names and guide titles now accept functions that take in the labels generated by the lower hierarchies and return amended labels. It should be spelled out that the hierarchy from lowest priority to highest priority is the following:</p><ol><li>The expression given in
<a href=https://ggplot2.tidyverse.org/reference/aes.html target=_blank rel=noopener><code>aes()</code></a>.</li><li>The entry in <code>labs(dictionary)</code>.</li><li>The label attribute of the column.</li><li>The entry in <code>labs(&lt;aesthetic> = &lt;label>)</code>.</li><li>The <code>scale_*(name)</code> argument.</li><li>The <code>guide_*(title)</code> argument.</li></ol><p>We can see this hierarchy in action in the plot below: the function in the axis guide transforms the input from the
<a href=https://ggplot2.tidyverse.org/reference/labs.html target=_blank rel=noopener><code>labs()</code></a> function.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nf><a href=https://ggplot2.tidyverse.org/reference/ggplot.html>ggplot</a></span><span class=o>(</span><span class=nv>penguins</span>, <span class=nf><a href=https://ggplot2.tidyverse.org/reference/aes.html>aes</a></span><span class=o>(</span><span class=nv>bill_dep</span>, <span class=nv>bill_len</span>, colour <span class=o>=</span> <span class=nv>species</span><span class=o>)</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/geom_point.html>geom_point</a></span><span class=o>(</span>na.rm <span class=o>=</span> <span class=kc>TRUE</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/scale_colour_discrete.html>scale_colour_discrete</a></span><span class=o>(</span>name <span class=o>=</span> <span class=nv>toupper</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/guides.html>guides</a></span><span class=o>(</span>x <span class=o>=</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/guide_axis.html>guide_axis</a></span><span class=o>(</span>title <span class=o>=</span> <span class=nf>tools</span><span class=nf>::</span><span class=nv><a href=https://rdrr.io/r/tools/toTitleCase.html>toTitleCase</a></span><span class=o>)</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/labs.html>labs</a></span><span class=o>(</span></span>
<span>    y <span class=o>=</span> \<span class=o>(</span><span class=nv>x</span><span class=o>)</span> <span class=nf><a href=https://rdrr.io/r/base/paste.html>paste0</a></span><span class=o>(</span><span class=nv>x</span>, <span class=s>" variable"</span><span class=o>)</span>,</span>
<span>    x <span class=o>=</span> <span class=s>"the label for the x variable"</span></span>
<span>  <span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-14-1.png width=700px style=display:block;margin:auto></p></div><p>In addition to the
<a href=https://ggplot2.tidyverse.org/reference/labs.html target=_blank rel=noopener><code>labs()</code></a>-labels, we also made labelling the levels of discrete scales easier. When the scale&rsquo;s <code>breaks</code> are named, the scale&rsquo;s labels will adopt the break&rsquo;s names by default. This already was the case in continuous scales but now discrete scales have parity. A nice benefit of specifying labels this way is that they are directly linked to the breaks, which prevents the common mistake of specifying the <code>labels</code> argument without also setting the <code>breaks</code> argument, which may accidentally mismatch labels.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nf><a href=https://ggplot2.tidyverse.org/reference/ggplot.html>ggplot</a></span><span class=o>(</span><span class=nv>penguins</span>, <span class=nf><a href=https://ggplot2.tidyverse.org/reference/aes.html>aes</a></span><span class=o>(</span><span class=nv>bill_dep</span>, <span class=nv>bill_len</span>, colour <span class=o>=</span> <span class=nv>species</span><span class=o>)</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/geom_point.html>geom_point</a></span><span class=o>(</span>na.rm <span class=o>=</span> <span class=kc>TRUE</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/scale_colour_discrete.html>scale_colour_discrete</a></span><span class=o>(</span></span>
<span>    breaks <span class=o>=</span> <span class=nf><a href=https://rdrr.io/r/base/c.html>c</a></span><span class=o>(</span></span>
<span>      <span class=s>"Pygoscelis adeliae"</span>     <span class=o>=</span> <span class=s>"Adelie"</span>,</span>
<span>      <span class=s>"Pygoscelis papua"</span>       <span class=o>=</span> <span class=s>"Gentoo"</span>,</span>
<span>      <span class=s>"Pygoscelis antarcticus"</span> <span class=o>=</span> <span class=s>"Chinstrap"</span></span>
<span>    <span class=o>)</span></span>
<span>  <span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-15-1.png width=700px style=display:block;margin:auto></p></div><h2 id=discrete-scales>Discrete scales
<a href=#discrete-scales><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>In this release we have tried to improve the &lsquo;freedom&rsquo; afforded by discrete position scales. Previously, discrete values were always mapped to an integer sequence starting at 1 going up to the number of levels. Instead, we wanted to allow for different mappings that deviated from that pattern. While it is a bit foreign for position scales, ggplot2 already had a mechanism to assign alternate values to the levels of a scale: palettes! You can now use the <code>palette</code> argument like you would for non-position scales. It makes it easier to indicate any grouping structure along the axis, like separating the orange juice (OJ) groups from the vitamin C (VC) groups in the plot below.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nf><a href=https://ggplot2.tidyverse.org/reference/ggplot.html>ggplot</a></span><span class=o>(</span><span class=nv>ToothGrowth</span>, <span class=nf><a href=https://ggplot2.tidyverse.org/reference/aes.html>aes</a></span><span class=o>(</span><span class=nf><a href=https://rdrr.io/r/base/interaction.html>interaction</a></span><span class=o>(</span><span class=nv>dose</span>, <span class=nv>supp</span>, sep <span class=o>=</span> <span class=s>"\n"</span><span class=o>)</span>, <span class=nv>len</span><span class=o>)</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/geom_boxplot.html>geom_boxplot</a></span><span class=o>(</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/scale_discrete.html>scale_x_discrete</a></span><span class=o>(</span></span>
<span>    palette <span class=o>=</span> <span class=nf>scales</span><span class=nf>::</span><span class=nf><a href=https://scales.r-lib.org/reference/pal_manual.html>pal_manual</a></span><span class=o>(</span><span class=nf><a href=https://rdrr.io/r/base/c.html>c</a></span><span class=o>(</span><span class=m>1</span><span class=o>:</span><span class=m>3</span>, <span class=m>5</span><span class=o>:</span><span class=m>7</span><span class=o>)</span><span class=o>)</span></span>
<span>  <span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-16-1.png width=700px style=display:block;margin:auto></p></div><p>A second improvement we made to the placement of discrete levels is that we give greater control over the continuous limits. The continuous limits of a discrete scale used to be an implementation detail that kept track of any &lsquo;additional space&rsquo; layers were taking up, for example because they use a <code>width</code> parameter. Now, these can be declared directly, making it easier to synchronise limits across plots or even facets. In the plot below, we&rsquo;re using the <code>continuous.limits</code> argument to ensure that all the bars have the same width; regardless of how many levels the x scale has to accommodate.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>p1</span> <span class=o>&lt;-</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/ggplot.html>ggplot</a></span><span class=o>(</span><span class=nv>mpg</span>, <span class=nf><a href=https://ggplot2.tidyverse.org/reference/aes.html>aes</a></span><span class=o>(</span><span class=nv>class</span><span class=o>)</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/geom_bar.html>geom_bar</a></span><span class=o>(</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/facet_wrap.html>facet_wrap</a></span><span class=o>(</span><span class=o>~</span> <span class=nv>drv</span>, ncol <span class=o>=</span> <span class=m>1</span>, scales <span class=o>=</span> <span class=s>"free_x"</span><span class=o>)</span></span>
<span></span>
<span><span class=nv>p2</span> <span class=o>&lt;-</span> <span class=nv>p1</span> <span class=o>+</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/scale_discrete.html>scale_x_discrete</a></span><span class=o>(</span>continuous.limits <span class=o>=</span> <span class=nf><a href=https://rdrr.io/r/base/c.html>c</a></span><span class=o>(</span><span class=m>1</span>, <span class=m>5</span><span class=o>)</span><span class=o>)</span></span>
<span></span>
<span><span class=o>(</span><span class=nv>p1</span> <span class=o>+</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/labs.html>labs</a></span><span class=o>(</span>title <span class=o>=</span> <span class=s>"Free limits"</span><span class=o>)</span><span class=o>)</span> <span class=o>|</span> </span>
<span><span class=o>(</span><span class=nv>p2</span> <span class=o>+</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/labs.html>labs</a></span><span class=o>(</span>title <span class=o>=</span> <span class=s>"Fixed limits"</span><span class=o>)</span><span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-17-1.png width=700px style=display:block;margin:auto></p></div><p>Also absent from discrete scales was the ability to set minor breaks. Admittedly, they are less useful than minor breaks in continuous scales. In contrast to discrete (major) <code>breaks</code>, <code>minor_breaks</code> uses numeric input instead, allowing you to fine-tune placement without being bound by the scale&rsquo;s levels. With a few tweaks of the theme, you can conceivably use minor breaks to visually separate levels as an alternative to the centre-lines for major breaks.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>p1</span> <span class=o>&lt;-</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/ggplot.html>ggplot</a></span><span class=o>(</span><span class=nv>mpg</span>, <span class=nf><a href=https://ggplot2.tidyverse.org/reference/aes.html>aes</a></span><span class=o>(</span><span class=nv>drv</span>, <span class=nv>hwy</span>, colour <span class=o>=</span> <span class=nf><a href=https://rdrr.io/r/base/factor.html>factor</a></span><span class=o>(</span><span class=nv>year</span><span class=o>)</span><span class=o>)</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/geom_point.html>geom_point</a></span><span class=o>(</span>position <span class=o>=</span> <span class=s>"jitterdodge"</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/guides.html>guides</a></span><span class=o>(</span>colour <span class=o>=</span> <span class=s>"none"</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/scale_discrete.html>scale_x_discrete</a></span><span class=o>(</span></span>
<span>    minor_breaks <span class=o>=</span> <span class=nf>scales</span><span class=nf>::</span><span class=nf><a href=https://scales.r-lib.org/reference/breaks_width.html>breaks_width</a></span><span class=o>(</span><span class=m>1</span>, offset <span class=o>=</span> <span class=m>0.5</span><span class=o>)</span>,</span>
<span>    <span class=c># To show that the minor axis ticks take on these values</span></span>
<span>    guide <span class=o>=</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/guide_axis.html>guide_axis</a></span><span class=o>(</span>minor.ticks <span class=o>=</span> <span class=kc>TRUE</span><span class=o>)</span></span>
<span>  <span class=o>)</span></span>
<span></span>
<span><span class=nv>p2</span> <span class=o>&lt;-</span> <span class=nv>p1</span> <span class=o>+</span> </span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/theme.html>theme</a></span><span class=o>(</span>panel.grid.major.x <span class=o>=</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/element.html>element_blank</a></span><span class=o>(</span><span class=o>)</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/subtheme.html>theme_sub_axis_bottom</a></span><span class=o>(</span>ticks <span class=o>=</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/element.html>element_blank</a></span><span class=o>(</span><span class=o>)</span>, minor.ticks <span class=o>=</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/element.html>element_line</a></span><span class=o>(</span><span class=o>)</span><span class=o>)</span></span>
<span></span>
<span><span class=nv>p1</span> <span class=o>|</span> <span class=nv>p2</span></span>
</code></pre><p><img src=figs/unnamed-chunk-18-1.png width=700px style=display:block;margin:auto></p></div><p>Discrete position scales now also have access to secondary axes. In contrast to continuous scales, discrete scales don&rsquo;t support transformations. So instead of
<a href=https://ggplot2.tidyverse.org/reference/sec_axis.html target=_blank rel=noopener><code>sec_axis()</code></a>, it is recommended to use
<a href=https://ggplot2.tidyverse.org/reference/sec_axis.html target=_blank rel=noopener><code>dup_axis()</code></a>. To allow for arbitrary positions for <code>dup_axis(breaks)</code>, these can take numeric values or one of the discrete levels. They are not truly useful to for showing two aligned datasets of different scales, but they can serve as annotations. For example, they can display some summary statistics about the groups.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nf><a href=https://ggplot2.tidyverse.org/reference/ggplot.html>ggplot</a></span><span class=o>(</span><span class=nv>mpg</span>, <span class=nf><a href=https://ggplot2.tidyverse.org/reference/aes.html>aes</a></span><span class=o>(</span><span class=nv>class</span>, <span class=nv>cty</span><span class=o>)</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/geom_boxplot.html>geom_boxplot</a></span><span class=o>(</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/scale_discrete.html>scale_x_discrete</a></span><span class=o>(</span></span>
<span>    sec.axis <span class=o>=</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/sec_axis.html>dup_axis</a></span><span class=o>(</span></span>
<span>      name <span class=o>=</span> <span class=s>"Counts"</span>,</span>
<span>      <span class=c># You can use numeric input for breaks</span></span>
<span>      breaks <span class=o>=</span> <span class=nf><a href=https://rdrr.io/r/base/seq.html>seq_len</a></span><span class=o>(</span><span class=nf><a href=https://rdrr.io/r/base/length.html>length</a></span><span class=o>(</span><span class=nf><a href=https://rdrr.io/r/base/unique.html>unique</a></span><span class=o>(</span><span class=nv>mpg</span><span class=o>$</span><span class=nv>class</span><span class=o>)</span><span class=o>)</span><span class=o>)</span>,</span>
<span>      <span class=c># Watch out for the order of `table()` and your levels!</span></span>
<span>      labels <span class=o>=</span> <span class=nf><a href=https://rdrr.io/r/base/paste.html>paste0</a></span><span class=o>(</span><span class=s>"n = "</span>, <span class=nf><a href=https://rdrr.io/r/base/table.html>table</a></span><span class=o>(</span><span class=nv>mpg</span><span class=o>$</span><span class=nv>class</span><span class=o>)</span><span class=o>)</span></span>
<span>    <span class=o>)</span></span>
<span>  <span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-19-1.png width=700px style=display:block;margin:auto></p></div><h2 id=position-aesthetics>Position aesthetics
<a href=#position-aesthetics><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Layers consist of three components: stats, geoms and positions. While stats and geoms have their own aesthetics, like <code>weight</code> or <code>linewidth</code>, the position adjustments did not. In this release, positions can also declare their own aesthetics. You can map data to these aesthetics like you would for geom or stat aesthetics.</p><p>In
<a href=https://ggplot2.tidyverse.org/reference/position_nudge.html target=_blank rel=noopener><code>position_nudge()</code></a> for example, we now have the <code>nudge_x</code> and <code>nudge_y</code> parameters as aesthetics. <sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup> Two benefits are that we can now use expressions in
<a href=https://ggplot2.tidyverse.org/reference/aes.html target=_blank rel=noopener><code>aes()</code></a> to declare these and they are vectorised. We use that advantage in the plot below where we use
<a href=https://rdrr.io/r/base/sign.html target=_blank rel=noopener><code>sign()</code></a> in a divergent bar chart to determine the left-right direction of the nudge.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=c># Taken from:</span></span>
<span><span class=c># https://ourworldindata.org/grapher/share-electricity-coal?tab=table&amp;tableFilter=continents</span></span>
<span><span class=nv>coal</span> <span class=o>&lt;-</span> <span class=nf>tibble</span><span class=nf>::</span><span class=nf><a href=https://tibble.tidyverse.org/reference/tribble.html>tribble</a></span><span class=o>(</span></span>
<span>  <span class=o>~</span><span class=nv>continent</span>,  <span class=o>~</span><span class=nv>pct_1985</span>, <span class=o>~</span><span class=nv>pct_2024</span>,</span>
<span>  <span class=s>"Africa"</span>,        <span class=m>53.87</span>, <span class=m>24.68</span>,</span>
<span>  <span class=s>"Asia"</span>,          <span class=m>32.60</span>, <span class=m>51.19</span>,</span>
<span>  <span class=s>"Europe"</span>,        <span class=m>32.84</span>, <span class=m>12.91</span>,</span>
<span>  <span class=s>"North America"</span>, <span class=m>48.93</span>, <span class=m>13.79</span>,</span>
<span>  <span class=s>"South America"</span>,  <span class=m>2.91</span>,  <span class=m>3.31</span>,</span>
<span>  <span class=s>"Oceania"</span>,       <span class=m>58.75</span>, <span class=m>39.26</span></span>
<span><span class=o>)</span> <span class=o>|&gt;</span></span>
<span>  <span class=nf>dplyr</span><span class=nf>::</span><span class=nf><a href=https://dplyr.tidyverse.org/reference/mutate.html>mutate</a></span><span class=o>(</span>pp_difference <span class=o>=</span> <span class=nv>pct_2024</span> <span class=o>-</span> <span class=nv>pct_1985</span><span class=o>)</span></span>
<span></span>
<span><span class=nf><a href=https://ggplot2.tidyverse.org/reference/ggplot.html>ggplot</a></span><span class=o>(</span><span class=nv>coal</span>, <span class=nf><a href=https://ggplot2.tidyverse.org/reference/aes.html>aes</a></span><span class=o>(</span><span class=nv>pp_difference</span>, <span class=nv>continent</span><span class=o>)</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/geom_bar.html>geom_col</a></span><span class=o>(</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/geom_text.html>geom_text</a></span><span class=o>(</span></span>
<span>    <span class=nf><a href=https://ggplot2.tidyverse.org/reference/aes.html>aes</a></span><span class=o>(</span>nudge_x <span class=o>=</span> <span class=nf><a href=https://rdrr.io/r/base/sign.html>sign</a></span><span class=o>(</span><span class=nv>pp_difference</span><span class=o>)</span> <span class=o>*</span> <span class=m>3</span>, </span>
<span>        label <span class=o>=</span> <span class=nv>pp_difference</span><span class=o>)</span></span>
<span>  <span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/labs.html>labs</a></span><span class=o>(</span>x <span class=o>=</span> <span class=s>"Change in electricity generated by coal (pp)"</span><span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-20-1.png width=700px style=display:block;margin:auto></p></div><p>A second position adjustment that has gotten its own aesthetic is
<a href=https://ggplot2.tidyverse.org/reference/position_dodge.html target=_blank rel=noopener><code>position_dodge()</code></a>. In the plot below, we see for sports where we do not have records for both &lsquo;sex = &ldquo;f&rdquo;&rsquo; and &lsquo;sex = &ldquo;m&rdquo;&rsquo; only one box is drawn just beneath the centre line. This is true for &lsquo;water polo&rsquo; where we have no records for &lsquo;f&rsquo;, but also netball and gymnastics where there are no records for &lsquo;m&rsquo;. For sports where there are records for both sexes, the &ldquo;f&rdquo; is depicted beneath the centre line and &ldquo;m&rdquo; is depicted above the centre line. Depending on your aesthetic sensibilities, this inconsistency can be a major pain.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>sports</span> <span class=o>&lt;-</span> <span class=nf><a href=https://rdrr.io/r/base/c.html>c</a></span><span class=o>(</span><span class=s>"water polo"</span>, <span class=s>"swimming"</span>, <span class=s>"gymnastics"</span>, <span class=s>"field"</span>, <span class=s>"netball"</span><span class=o>)</span></span>
<span><span class=nv>p</span> <span class=o>&lt;-</span> <span class=nf>ggridges</span><span class=nf>::</span><span class=nv><a href=https://wilkelab.org/ggridges/reference/Aus_athletes.html>Aus_athletes</a></span> <span class=o>|&gt;</span></span>
<span>  <span class=nf>dplyr</span><span class=nf>::</span><span class=nf><a href=https://dplyr.tidyverse.org/reference/filter.html>filter</a></span><span class=o>(</span><span class=nv>sport</span> <span class=o><a href=https://rdrr.io/r/base/match.html>%in%</a></span> <span class=nv>sports</span><span class=o>)</span> <span class=o>|&gt;</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/ggplot.html>ggplot</a></span><span class=o>(</span><span class=nf><a href=https://ggplot2.tidyverse.org/reference/aes.html>aes</a></span><span class=o>(</span><span class=nv>height</span>, <span class=nv>sport</span>, fill <span class=o>=</span> <span class=nv>sex</span><span class=o>)</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/geom_boxplot.html>geom_boxplot</a></span><span class=o>(</span>position <span class=o>=</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/position_dodge.html>position_dodge</a></span><span class=o>(</span>preserve <span class=o>=</span> <span class=s>"single"</span><span class=o>)</span><span class=o>)</span></span>
<span></span>
<span><span class=nv>p</span></span>
</code></pre><p><img src=figs/unnamed-chunk-21-1.png width=700px style=display:block;margin:auto></p></div><p>The origin of this inconsistency is that ggplot2 doesn&rsquo;t have an understanding of groups other than that <em>they exist</em>. It doesn&rsquo;t know that groups are formed by <code>fill</code> and what levels populate this aesthetic. To break ggplot2&rsquo;s ignorance, we now have the <code>order</code> aesthetic for
<a href=https://ggplot2.tidyverse.org/reference/position_dodge.html target=_blank rel=noopener><code>position_dodge()</code></a>.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>p</span> <span class=o>+</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/aes.html>aes</a></span><span class=o>(</span>order <span class=o>=</span> <span class=nv>sex</span><span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-22-1.png width=700px style=display:block;margin:auto></p></div><p>Using that aesthetic to the position adjustment soothes the soul by putting all the right groups in the right places.</p><h2 id=facets>Facets
<a href=#facets><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><h3 id=wrapping-directions>Wrapping directions
<a href=#wrapping-directions><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>The
<a href=https://ggplot2.tidyverse.org/reference/facet_wrap.html target=_blank rel=noopener><code>facet_wrap()</code></a> function has had two arguments controlling the layout: <code>dir</code> which can be <code>"h"</code> or <code>"v"</code>, and <code>as.table</code> with can be <code>TRUE</code> or <code>FALSE</code>. Together, these gave a total of 4 layout options. Arguably there are 8 sensible options in total though, so we were missing out on the layout. To simplify having to juggle two arguments for 4 options, we&rsquo;re now just using one argument (<code>dir</code>) for 8 options. The new options are all two letter codes using combinations of <code>t</code> (top), <code>r</code> (right), <code>b</code> (bottom) and <code>l</code> (left). The combination will tell you where the first facet level will be. Both <code>br</code> and <code>rb</code> will start in the bottom-right with the first facet. Then the order will tell you about the filling direction, where starting with <code>b</code> will fill bottom-to-top and starting with <code>r</code> will fill right-to-left.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>p</span> <span class=o>&lt;-</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/ggplot.html>ggplot</a></span><span class=o>(</span><span class=nv>mpg</span>, <span class=nf><a href=https://ggplot2.tidyverse.org/reference/aes.html>aes</a></span><span class=o>(</span><span class=nv>displ</span>, <span class=nv>hwy</span><span class=o>)</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/geom_point.html>geom_point</a></span><span class=o>(</span><span class=o>)</span></span>
<span></span>
<span><span class=nv>p1</span> <span class=o>&lt;-</span> <span class=nv>p</span> <span class=o>+</span> </span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/facet_wrap.html>facet_wrap</a></span><span class=o>(</span><span class=o>~</span> <span class=nf>vctrs</span><span class=nf>::</span><span class=nf><a href=https://vctrs.r-lib.org/reference/vec_group.html>vec_group_id</a></span><span class=o>(</span><span class=nv>class</span><span class=o>)</span>, dir <span class=o>=</span> <span class=s>"br"</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/labs.html>labs</a></span><span class=o>(</span>title <span class=o>=</span> <span class=s>"dir = 'br'"</span><span class=o>)</span></span>
<span></span>
<span><span class=nv>p2</span> <span class=o>&lt;-</span> <span class=nv>p</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/facet_wrap.html>facet_wrap</a></span><span class=o>(</span><span class=o>~</span> <span class=nf>vctrs</span><span class=nf>::</span><span class=nf><a href=https://vctrs.r-lib.org/reference/vec_group.html>vec_group_id</a></span><span class=o>(</span><span class=nv>class</span><span class=o>)</span>, dir <span class=o>=</span> <span class=s>"rb"</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/labs.html>labs</a></span><span class=o>(</span>title <span class=o>=</span> <span class=s>"dir = 'rb'"</span><span class=o>)</span></span>
<span></span>
<span><span class=nv>p1</span> <span class=o>|</span> <span class=nv>p2</span></span>
</code></pre><p><img src=figs/unnamed-chunk-23-1.png width=700px style=display:block;margin:auto></p></div><p>To cover all 8 options, we list them here:</p><ul><li><code>"lt"</code>: start in the top-left, start filling left-to-right.</li><li><code>"tl"</code>: start in the top-left, start filling top-to-bottom.</li><li><code>"lb"</code>: start in the bottom-left, start filling left-to-right.</li><li><code>"bl"</code>: start in the bottom-left, start filling bottom-to-top.</li><li><code>"rt"</code>: start in the top-right, start filling right-to-left.</li><li><code>"tr"</code>: start in the top-right, start filling top-to-bottom.</li><li><code>"rb"</code>: start in the bottom-right, start filling right-to-left.</li><li><code>"br"</code> start in the bottom-right, start filling bottom-to-top.</li></ul><h3 id=free-space-in-wrapping>Free space in wrapping
<a href=#free-space-in-wrapping><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>The <code>facet_grid(space)</code> argument can ensure that panels are allocated space in proportion to their data range. This works because all data within a row share a y-axis, and data within a column share an x-axis. Historically, this argument did not have an equivalent in
<a href=https://ggplot2.tidyverse.org/reference/facet_wrap.html target=_blank rel=noopener><code>facet_wrap()</code></a> because axes aren&rsquo;t shared. We realised that there is a narrow circumstance in which each column has a consistent axis, and this is when there is only one row. The inverse also holds true for rows when there is only one column. In this release, we&rsquo;ve added <code>facet_wrap(space)</code> that sets the panel sizes in these circumstances.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nf><a href=https://ggplot2.tidyverse.org/reference/ggplot.html>ggplot</a></span><span class=o>(</span><span class=nv>penguins</span>, <span class=nf><a href=https://ggplot2.tidyverse.org/reference/aes.html>aes</a></span><span class=o>(</span><span class=nv>bill_dep</span>, <span class=nv>bill_len</span>, colour <span class=o>=</span> <span class=nv>species</span><span class=o>)</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/geom_point.html>geom_point</a></span><span class=o>(</span>na.rm <span class=o>=</span> <span class=kc>TRUE</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/facet_wrap.html>facet_wrap</a></span><span class=o>(</span><span class=o>~</span> <span class=nv>island</span>, scales <span class=o>=</span> <span class=s>"free_x"</span>, space <span class=o>=</span> <span class=s>"free_x"</span><span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-24-1.png width=700px style=display:block;margin:auto></p></div><p>We can note that the Dream and Torgersen islands have narrower panels because they don&rsquo;t have the Gentoo penguin with low bill depths.</p><h3 id=layer-layout>Layer layout
<a href=#layer-layout><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>We&rsquo;ve added the argument <code>layer(layout)</code>, which instructs facets on how to handle the data. Generally speaking, facets or custom layouts are free to interpret instructions as they see fit, so it is not set in stone. Nonetheless, we&rsquo;ve come up with the following interpretations for
<a href=https://ggplot2.tidyverse.org/reference/facet_wrap.html target=_blank rel=noopener><code>facet_wrap()</code></a> and
<a href=https://ggplot2.tidyverse.org/reference/facet_grid.html target=_blank rel=noopener><code>facet_grid()</code></a>.</p><ul><li><code>layout = NULL</code> (the default) uses the faceting variables to assign data to a panel.</li><li><code>layout = "fixed"</code> repeats the data for every panel and ignores faceting variables.</li><li><code>layout = &lt;integer></code> assigns to data to a specific panel.</li></ul><p>In addition, specifically for
<a href=https://ggplot2.tidyverse.org/reference/facet_grid.html target=_blank rel=noopener><code>facet_grid()</code></a> the following options also apply:</p><ul><li><code>layout = "fixed_cols"</code> pools data for every column and repeats it within the column&rsquo;s panels.</li><li><code>layout = "fixed_rows"</code> pools data for every row and repeats it within the row&rsquo;s panels.</li></ul><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nf><a href=https://ggplot2.tidyverse.org/reference/ggplot.html>ggplot</a></span><span class=o>(</span><span class=nv>penguins</span>, <span class=nf><a href=https://ggplot2.tidyverse.org/reference/aes.html>aes</a></span><span class=o>(</span><span class=nv>bill_dep</span>, <span class=nv>bill_len</span><span class=o>)</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=c># Repeat within every row</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/geom_point.html>geom_point</a></span><span class=o>(</span>na.rm <span class=o>=</span> <span class=kc>TRUE</span>, colour <span class=o>=</span> <span class=s>"grey"</span>, layout <span class=o>=</span> <span class=s>"fixed_rows"</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=c># Use facetting variables (default)</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/geom_point.html>geom_point</a></span><span class=o>(</span>na.rm <span class=o>=</span> <span class=kc>TRUE</span>, layout <span class=o>=</span> <span class=kc>NULL</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=c># Pick particular panel</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/annotate.html>annotate</a></span><span class=o>(</span></span>
<span>    <span class=s>"text"</span>, x <span class=o>=</span> <span class=nf><a href=https://rdrr.io/r/base/AsIs.html>I</a></span><span class=o>(</span><span class=m>0.5</span><span class=o>)</span>, y <span class=o>=</span> <span class=nf><a href=https://rdrr.io/r/base/AsIs.html>I</a></span><span class=o>(</span><span class=m>0.5</span><span class=o>)</span>,</span>
<span>    label <span class=o>=</span> <span class=s>"Panel 6"</span>, layout <span class=o>=</span> <span class=m>6</span></span>
<span>  <span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/facet_grid.html>facet_grid</a></span><span class=o>(</span><span class=nv>island</span> <span class=o>~</span> <span class=nv>species</span><span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-25-1.png width=700px style=display:block;margin:auto></p></div><p>In previous incarnations of ggplot2, people went through some acrobatics to get data to repeat across panels. With these new options, this should be a walk in the park.</p><h2 id=styling-updates>Styling updates
<a href=#styling-updates><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><h3 id=boxplots>Boxplots
<a href=#boxplots><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>In
<a href=https://ggplot2.tidyverse.org/reference/geom_boxplot.html target=_blank rel=noopener><code>geom_boxplot()</code></a>, you may have become accustomed to all the different options for styling outliers like <code>outlier.colour</code> or <code>outlier.shape</code>. Now, we&rsquo;re also enabling styling the different parts of the boxplot: the median line, the box, the whiskers and the staples. You can assign different colours, line type or line width to these parts of the boxplot.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nf><a href=https://ggplot2.tidyverse.org/reference/ggplot.html>ggplot</a></span><span class=o>(</span><span class=nv>mpg</span>, <span class=nf><a href=https://ggplot2.tidyverse.org/reference/aes.html>aes</a></span><span class=o>(</span><span class=nv>class</span>, <span class=nv>hwy</span>, colour <span class=o>=</span> <span class=nv>class</span><span class=o>)</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/geom_boxplot.html>geom_boxplot</a></span><span class=o>(</span></span>
<span>    whisker.linetype <span class=o>=</span> <span class=s>"dashed"</span>,</span>
<span>    box.colour <span class=o>=</span> <span class=s>"black"</span>,</span>
<span>    median.linewidth <span class=o>=</span> <span class=m>2</span>,</span>
<span>    staplewidth <span class=o>=</span> <span class=m>0.5</span>, <span class=c># show staple</span></span>
<span>    staple.colour <span class=o>=</span> <span class=s>"grey50"</span></span>
<span>  <span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/guides.html>guides</a></span><span class=o>(</span>colour <span class=o>=</span> <span class=s>"none"</span><span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-26-1.png width=700px style=display:block;margin:auto></p></div><p>For consistency,
<a href=https://ggplot2.tidyverse.org/reference/geom_linerange.html target=_blank rel=noopener><code>geom_crossbar()</code></a> has been given the same treatment, but uses the <code>middle.*</code> prefix where
<a href=https://ggplot2.tidyverse.org/reference/geom_boxplot.html target=_blank rel=noopener><code>geom_boxplot()</code></a> uses the <code>median.*</code> prefix. Because <code>middle.linewidth</code> and <code>median.linewidth</code> have taken over the role of <code>fatten</code> and are aligned with other graphical properties, the <code>fatten</code> argument is now deprecated.</p><h3 id=violin--quantiles>Violin & quantiles
<a href=#violin--quantiles><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>It has been an inconvenience for some time that the quantile computation in violin layers was computed on the density data rather than the input data. To make the quantile computation more faithful to the real data, we had to properly delegate the responsibilities to the correct parts of the layer. The stat part of the layer is now in charge of calculating quantiles of the input data via the <code>stat_ydensity(quantiles)</code> arguments. By default, the quantiles are the 25th, 50th and 75th percentiles and are always computed. Whether these quantiles are also displayed, is under the purview of the geom part of the layer. We&rsquo;ve taken a similar approach as boxplots shown above, in that we now have <code>quantile.colour</code>, <code>quantile.linetype</code> and <code>quantile.linewidth</code> arguments to style the quantile lines. Previously, quantiles were not displayed by default. To mirror that behaviour, we&rsquo;ve set <code>quantile.linetype = 0</code> (blank, no line) by default. This means that to turn on the display of quantiles, you have to set a non-blank line type.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nf><a href=https://ggplot2.tidyverse.org/reference/ggplot.html>ggplot</a></span><span class=o>(</span><span class=nv>mpg</span>, <span class=nf><a href=https://ggplot2.tidyverse.org/reference/aes.html>aes</a></span><span class=o>(</span><span class=nv>class</span>, <span class=nv>hwy</span>, fill <span class=o>=</span> <span class=nv>class</span><span class=o>)</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/geom_violin.html>geom_violin</a></span><span class=o>(</span></span>
<span>    quantiles <span class=o>=</span> <span class=nf><a href=https://rdrr.io/r/base/c.html>c</a></span><span class=o>(</span><span class=m>0.1</span>, <span class=m>0.9</span><span class=o>)</span>,</span>
<span>    quantile.linetype <span class=o>=</span> <span class=m>1</span></span>
<span>  <span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/guides.html>guides</a></span><span class=o>(</span>fill <span class=o>=</span> <span class=s>"none"</span><span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-27-1.png width=700px style=display:block;margin:auto></p></div><h3 id=labels-1>Labels
<a href=#labels-1><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p><a href=https://ggplot2.tidyverse.org/reference/geom_text.html target=_blank rel=noopener><code>geom_label()</code></a> also has new styling options. It now has a <code>linetype</code> and <code>linewidth</code> aesthetic, which can be mapped from the data. The <code>linewidth</code> aesthetic replaces the <code>label.size</code> argument, which used to determine the line width of the label border. In addition to the new aesthetics,
<a href=https://ggplot2.tidyverse.org/reference/geom_text.html target=_blank rel=noopener><code>geom_label()</code></a> has two new arguments: <code>border.colour</code> and <code>text.colour</code> which set the colour for the border and text respectively. When these are set, it overrules the <code>colour</code> aesthetic for a part of the label. In the plot below, we fix the <code>text.colour</code> to black, so the <code>colour</code> aesthetic applies to the border, not the text.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nf><a href=https://ggplot2.tidyverse.org/reference/ggplot.html>ggplot</a></span><span class=o>(</span><span class=nv>mtcars</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/aes.html>aes</a></span><span class=o>(</span></span>
<span>    <span class=nv>wt</span>, <span class=nv>mpg</span>,</span>
<span>    label <span class=o>=</span> <span class=nf><a href=https://rdrr.io/r/base/colnames.html>rownames</a></span><span class=o>(</span><span class=nv>mtcars</span><span class=o>)</span>,</span>
<span>    colour <span class=o>=</span> <span class=nf><a href=https://rdrr.io/r/base/factor.html>factor</a></span><span class=o>(</span><span class=nv>cyl</span><span class=o>)</span>,</span>
<span>    linetype <span class=o>=</span> <span class=nf><a href=https://rdrr.io/r/base/factor.html>factor</a></span><span class=o>(</span><span class=nv>vs</span><span class=o>)</span>,</span>
<span>    linewidth <span class=o>=</span> <span class=nf><a href=https://rdrr.io/r/base/factor.html>factor</a></span><span class=o>(</span><span class=nv>am</span><span class=o>)</span></span>
<span>  <span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/geom_text.html>geom_label</a></span><span class=o>(</span>text.colour <span class=o>=</span> <span class=s>"black"</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/scale_manual.html>scale_linewidth_manual</a></span><span class=o>(</span>values <span class=o>=</span> <span class=nf><a href=https://rdrr.io/r/base/c.html>c</a></span><span class=o>(</span><span class=m>0.3</span>, <span class=m>0.6</span><span class=o>)</span><span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-28-1.png width=700px style=display:block;margin:auto></p></div><h3 id=area-and-ribbons>Area and ribbons
<a href=#area-and-ribbons><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>Both
<a href=https://ggplot2.tidyverse.org/reference/geom_ribbon.html target=_blank rel=noopener><code>geom_area()</code></a> and
<a href=https://ggplot2.tidyverse.org/reference/geom_ribbon.html target=_blank rel=noopener><code>geom_ribbon()</code></a> now allow a varying <code>fill</code> aesthetic within a group. Such a fill is displayed as a gradient, and therefore requires R 4.1.0+ and a compatible graphics device.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nf><a href=https://ggplot2.tidyverse.org/reference/ggplot.html>ggplot</a></span><span class=o>(</span><span class=nv>economics</span>, <span class=nf><a href=https://ggplot2.tidyverse.org/reference/aes.html>aes</a></span><span class=o>(</span><span class=nv>date</span>, <span class=nv>unemploy</span><span class=o>)</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/geom_ribbon.html>geom_area</a></span><span class=o>(</span><span class=nf><a href=https://ggplot2.tidyverse.org/reference/aes.html>aes</a></span><span class=o>(</span>fill <span class=o>=</span> <span class=nv>uempmed</span><span class=o>)</span><span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-29-1.png width=700px style=display:block;margin:auto></p></div><h2 id=new-stats>New stats
<a href=#new-stats><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><h3 id=manual>Manual
<a href=#manual><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>Many ggplot extensions are based on stats, which allows you to perform arbitrary computations on data before handing it off the drawing functions. The new
<a href=https://ggplot2.tidyverse.org/reference/stat_manual.html target=_blank rel=noopener><code>stat_manual()</code></a> aims to give you the same extension powers, but without doing the formal ritual of defining a class and constructor. You can provide it any function that both ingests and returns a data frame. It can create new aesthetics or modify pre-existing aesthetics as long as eventually the geom part of the layer has their required aesthetics. In the example below, we use
<a href=https://ggplot2.tidyverse.org/reference/stat_manual.html target=_blank rel=noopener><code>stat_manual()</code></a> with a geom and a function, but also show you how to use a geom with <code>stat = "manual"</code>.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>make_centroids</span> <span class=o>&lt;-</span> <span class=kr>function</span><span class=o>(</span><span class=nv>df</span><span class=o>)</span> <span class=o>&#123;</span></span>
<span>  <span class=nf><a href=https://rdrr.io/r/base/transform.html>transform</a></span><span class=o>(</span></span>
<span>    <span class=nv>df</span>,</span>
<span>    xend <span class=o>=</span> <span class=nf><a href=https://rdrr.io/r/base/mean.html>mean</a></span><span class=o>(</span><span class=nv>x</span>, na.rm <span class=o>=</span> <span class=kc>TRUE</span><span class=o>)</span>,</span>
<span>    yend <span class=o>=</span> <span class=nf><a href=https://rdrr.io/r/base/mean.html>mean</a></span><span class=o>(</span><span class=nv>y</span>, na.rm <span class=o>=</span> <span class=kc>TRUE</span><span class=o>)</span></span>
<span>  <span class=o>)</span></span>
<span><span class=o>&#125;</span></span>
<span></span>
<span><span class=nv>make_hull</span> <span class=o>&lt;-</span> <span class=kr>function</span><span class=o>(</span><span class=nv>df</span><span class=o>)</span> <span class=o>&#123;</span></span>
<span>  <span class=nv>df</span> <span class=o>&lt;-</span> <span class=nv>df</span><span class=o>[</span><span class=nf><a href=https://rdrr.io/r/stats/complete.cases.html>complete.cases</a></span><span class=o>(</span><span class=nv>df</span><span class=o>)</span>, , drop <span class=o>=</span> <span class=kc>FALSE</span><span class=o>]</span></span>
<span>  <span class=nv>hull</span> <span class=o>&lt;-</span> <span class=nf><a href=https://rdrr.io/r/grDevices/chull.html>chull</a></span><span class=o>(</span><span class=nv>df</span><span class=o>$</span><span class=nv>x</span>, <span class=nv>df</span><span class=o>$</span><span class=nv>y</span><span class=o>)</span></span>
<span>  <span class=nv>df</span><span class=o>[</span><span class=nv>hull</span>, , drop <span class=o>=</span> <span class=kc>FALSE</span><span class=o>]</span></span>
<span><span class=o>&#125;</span></span>
<span></span>
<span><span class=nf><a href=https://ggplot2.tidyverse.org/reference/ggplot.html>ggplot</a></span><span class=o>(</span><span class=nv>penguins</span>, <span class=nf><a href=https://ggplot2.tidyverse.org/reference/aes.html>aes</a></span><span class=o>(</span><span class=nv>bill_len</span>, <span class=nv>bill_dep</span>, colour <span class=o>=</span> <span class=nv>species</span><span class=o>)</span><span class=o>)</span> <span class=o>+</span> </span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/geom_point.html>geom_point</a></span><span class=o>(</span>na.rm <span class=o>=</span> <span class=kc>TRUE</span><span class=o>)</span> <span class=o>+</span> </span>
<span>  <span class=c># As a stat, provide a geom</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/stat_manual.html>stat_manual</a></span><span class=o>(</span></span>
<span>    geom <span class=o>=</span> <span class=s>"segment"</span>, <span class=c># function creates new xend/yend for segment</span></span>
<span>    fun <span class=o>=</span> <span class=nv>make_centroids</span>,</span>
<span>    linewidth <span class=o>=</span> <span class=m>0.2</span>,</span>
<span>    na.rm <span class=o>=</span> <span class=kc>TRUE</span></span>
<span>  <span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=c># As a geom, provide the stat</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/geom_polygon.html>geom_polygon</a></span><span class=o>(</span></span>
<span>    stat <span class=o>=</span> <span class=s>"manual"</span>,</span>
<span>    fun <span class=o>=</span> <span class=nv>make_hull</span>,</span>
<span>    fill <span class=o>=</span> <span class=kc>NA</span>,</span>
<span>    linetype <span class=o>=</span> <span class=s>"dotted"</span></span>
<span>  <span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-30-1.png width=700px style=display:block;margin:auto></p></div><h3 id=connection>Connection
<a href=#connection><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>It has come to our attention that generalisations of
<a href=https://ggplot2.tidyverse.org/reference/geom_path.html target=_blank rel=noopener><code>geom_step()</code></a> have become commonplace in several extensions. Stairstep ribbons are used in Kaplan-Meier curves to indicate uncertainty. Stairstep area plots make for some great histograms. To this end, we&rsquo;re introducing
<a href=https://ggplot2.tidyverse.org/reference/stat_connect.html target=_blank rel=noopener><code>stat_connect()</code></a>, which can connect observations in a stairstep fashion without constraining a geom choice. In the plot, you can see it work on the <code>y</code>, <code>ymin</code> and <code>ymax</code> aesthetics indiscriminately with distinct geoms.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>eco</span> <span class=o>&lt;-</span> <span class=nv>economics</span> <span class=o>|&gt;</span></span>
<span>  <span class=nf>dplyr</span><span class=nf>::</span><span class=nf><a href=https://dplyr.tidyverse.org/reference/mutate.html>mutate</a></span><span class=o>(</span>year <span class=o>=</span> <span class=nf>lubridate</span><span class=nf>::</span><span class=nf><a href=https://lubridate.tidyverse.org/reference/year.html>year</a></span><span class=o>(</span><span class=nv>date</span><span class=o>)</span><span class=o>)</span> <span class=o>|&gt;</span></span>
<span>  <span class=nf>dplyr</span><span class=nf>::</span><span class=nf><a href=https://dplyr.tidyverse.org/reference/summarise.html>summarise</a></span><span class=o>(</span></span>
<span>    min <span class=o>=</span> <span class=nf><a href=https://rdrr.io/r/base/Extremes.html>min</a></span><span class=o>(</span><span class=nv>unemploy</span><span class=o>)</span>,</span>
<span>    max <span class=o>=</span> <span class=nf><a href=https://rdrr.io/r/base/Extremes.html>max</a></span><span class=o>(</span><span class=nv>unemploy</span><span class=o>)</span>,</span>
<span>    mid <span class=o>=</span> <span class=nf><a href=https://rdrr.io/r/stats/median.html>median</a></span><span class=o>(</span><span class=nv>unemploy</span><span class=o>)</span>,</span>
<span>    .by <span class=o>=</span> <span class=nv>year</span></span>
<span>  <span class=o>)</span></span>
<span></span>
<span><span class=nf><a href=https://ggplot2.tidyverse.org/reference/ggplot.html>ggplot</a></span><span class=o>(</span><span class=nv>eco</span>, <span class=nf><a href=https://ggplot2.tidyverse.org/reference/aes.html>aes</a></span><span class=o>(</span><span class=nv>year</span>, y <span class=o>=</span> <span class=nv>mid</span>, ymin <span class=o>=</span> <span class=nv>min</span>, ymax <span class=o>=</span> <span class=nv>max</span><span class=o>)</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/geom_path.html>geom_line</a></span><span class=o>(</span>stat <span class=o>=</span> <span class=s>"connect"</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/geom_ribbon.html>geom_ribbon</a></span><span class=o>(</span>stat <span class=o>=</span> <span class=s>"connect"</span>, alpha <span class=o>=</span> <span class=m>0.4</span><span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-31-1.png width=700px style=display:block;margin:auto></p></div><p>However, we aren&rsquo;t necessarily limited to stairstep connections. We can use a 2-column numeric matrix to sketch out other types of connections. For example if we use
<a href=https://rdrr.io/r/stats/Logistic.html target=_blank rel=noopener><code>plogis()</code></a> to create a logistic transition, we can make &lsquo;bump chart&rsquo;-like connections. Or you can use a zigzag pattern if silliness is your cup of tea.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>x</span> <span class=o>&lt;-</span> <span class=nf><a href=https://rdrr.io/r/base/seq.html>seq</a></span><span class=o>(</span><span class=m>0</span>, <span class=m>1</span>, length.out <span class=o>=</span> <span class=m>20</span><span class=o>)</span><span class=o>[</span><span class=o>-</span><span class=m>1</span><span class=o>]</span></span>
<span><span class=nv>smooth</span> <span class=o>&lt;-</span> <span class=nf><a href=https://rdrr.io/r/base/cbind.html>cbind</a></span><span class=o>(</span><span class=nv>x</span>, <span class=nf>scales</span><span class=nf>::</span><span class=nf><a href=https://scales.r-lib.org/reference/rescale.html>rescale</a></span><span class=o>(</span><span class=nf><a href=https://rdrr.io/r/stats/Logistic.html>plogis</a></span><span class=o>(</span><span class=nv>x</span>, location <span class=o>=</span> <span class=m>0.5</span>, scale <span class=o>=</span> <span class=m>0.1</span><span class=o>)</span><span class=o>)</span><span class=o>)</span></span>
<span><span class=nv>zigzag</span> <span class=o>&lt;-</span> <span class=nf><a href=https://rdrr.io/r/base/cbind.html>cbind</a></span><span class=o>(</span><span class=nf><a href=https://rdrr.io/r/base/c.html>c</a></span><span class=o>(</span><span class=m>0.4</span>, <span class=m>0.6</span>, <span class=m>1</span><span class=o>)</span>, <span class=nf><a href=https://rdrr.io/r/base/c.html>c</a></span><span class=o>(</span><span class=m>0.75</span>, <span class=m>0.25</span>, <span class=m>1</span><span class=o>)</span><span class=o>)</span></span>
<span></span>
<span><span class=nf><a href=https://ggplot2.tidyverse.org/reference/ggplot.html>ggplot</a></span><span class=o>(</span><span class=nf><a href=https://rdrr.io/r/utils/head.html>head</a></span><span class=o>(</span><span class=nv>eco</span>, <span class=m>10</span><span class=o>)</span>, <span class=nf><a href=https://ggplot2.tidyverse.org/reference/aes.html>aes</a></span><span class=o>(</span><span class=nv>year</span>, y <span class=o>=</span> <span class=nv>mid</span><span class=o>)</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/geom_point.html>geom_point</a></span><span class=o>(</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/stat_connect.html>stat_connect</a></span><span class=o>(</span><span class=nf><a href=https://ggplot2.tidyverse.org/reference/aes.html>aes</a></span><span class=o>(</span>colour <span class=o>=</span> <span class=s>"smooth"</span><span class=o>)</span>, connection <span class=o>=</span> <span class=nv>smooth</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/stat_connect.html>stat_connect</a></span><span class=o>(</span><span class=nf><a href=https://ggplot2.tidyverse.org/reference/aes.html>aes</a></span><span class=o>(</span>colour <span class=o>=</span> <span class=s>"zigzag"</span><span class=o>)</span>, connection <span class=o>=</span> <span class=nv>zigzag</span><span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-32-1.png width=700px style=display:block;margin:auto></p></div><h2 id=coord-reversal>Coord reversal
<a href=#coord-reversal><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>It has been possible to use reverse transformations for scales to flip a plot direction. You could even use
<a href=https://scales.r-lib.org/reference/transform_compose.html target=_blank rel=noopener><code>scales::transform_compose()</code></a> to do, for example, a reversed log<sub>10</sub> transformation to highlight the smallest p-values. However, the transformation approach has a few limitations, notably that discrete scales do not support transformations and not all coords obeyed transformed scales. You can&rsquo;t really combine <code>coord_sf() + scale_x_log10()</code> for example. To remedy this limitation, coords now have a <code>reverse</code> argument that can typically be <code>"none"</code>, <code>"x"</code>, <code>"y"</code> or <code>"xy"</code> that reverse some directions. If you are from the lands down under, you can now plot a map in your native orientation.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>world</span> <span class=o>&lt;-</span> <span class=nf>sf</span><span class=nf>::</span><span class=nf><a href=https://r-spatial.github.io/sf/reference/st_as_sf.html>st_as_sf</a></span><span class=o>(</span><span class=nf>maps</span><span class=nf>::</span><span class=nf><a href=https://rdrr.io/pkg/maps/man/map.html>map</a></span><span class=o>(</span><span class=s>'world'</span>, plot <span class=o>=</span> <span class=kc>FALSE</span>, fill <span class=o>=</span> <span class=kc>TRUE</span><span class=o>)</span><span class=o>)</span></span>
<span></span>
<span><span class=nf><a href=https://ggplot2.tidyverse.org/reference/ggplot.html>ggplot</a></span><span class=o>(</span><span class=nv>world</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/ggsf.html>geom_sf</a></span><span class=o>(</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/ggsf.html>coord_sf</a></span><span class=o>(</span>reverse <span class=o>=</span> <span class=s>"y"</span><span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-33-1.png width=700px style=display:block;margin:auto></p></div><p>In
<a href=https://ggplot2.tidyverse.org/reference/coord_radial.html target=_blank rel=noopener><code>coord_radial()</code></a>, the <code>reverse</code> argument replaces the <code>direction</code> argument that only worked for the theta-direction. Contrary to many coords, <code>coord_radial(reverse)</code> takes <code>"none"</code>, <code>"theta"</code>, <code>"r"</code> and <code>"thetar"</code> instead of the x/y directions.</p><h2 id=goodies-for-extensions>Goodies for extensions
<a href=#goodies-for-extensions><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><h3 id=layers>Layers
<a href=#layers><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>If you&rsquo;ve ever written a <code>Geom</code> class, chances are that you&rsquo;ve danced with
<a href=https://rdrr.io/r/grid/gpar.html target=_blank rel=noopener><code>grid::gpar()</code></a> and frowned at the use of <code>.pt</code> and <code>.stroke</code> and whatnot. We&rsquo;ve made a wrapper for
<a href=https://rdrr.io/r/grid/gpar.html target=_blank rel=noopener><code>grid::gpar()</code></a> that applies the ggplot2 interpretation of settings and translates them to grid settings. For example, <code>linewidth</code> (or the <code>lwd</code> grid setting) is interpreted in millimetres in ggplot2, whereas grid expects them in points. The
<a href=https://ggplot2.tidyverse.org/reference/gg_par.html target=_blank rel=noopener><code>gg_par()</code></a> function helps these translations, protects against <code>NA</code>s in line types and strokes, removes 0-length vectors, and has additional logic for point strokes.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nf><a href=https://ggplot2.tidyverse.org/reference/gg_par.html>gg_par</a></span><span class=o>(</span>lwd <span class=o>=</span> <span class=m>5</span><span class=o>)</span></span>
<span><span class=c>#&gt; $lwd</span></span>
<span><span class=c>#&gt; [1] 14.22638</span></span>
<span></span><span><span class=nf>grid</span><span class=nf>::</span><span class=nf><a href=https://rdrr.io/r/grid/grid.convert.html>convertUnit</a></span><span class=o>(</span><span class=nf><a href=https://rdrr.io/r/grid/unit.html>unit</a></span><span class=o>(</span><span class=m>5</span>, <span class=s>"mm"</span><span class=o>)</span>, <span class=s>"pt"</span><span class=o>)</span></span>
<span><span class=c>#&gt; [1] 14.2263779527559points</span></span>
<span></span></code></pre></div><p>For geom and stat extensions, the magic usually happens in the <code>Geom*</code> or <code>Stat*</code> classes and the constructor is simply boilerplate code used to populate a layer. To reduce the amount of boilerplate code, you can now use
<a href=https://ggplot2.tidyverse.org/reference/make_constructor.html target=_blank rel=noopener><code>make_constructor()</code></a> on <code>Geom*</code> and <code>Stat*</code> classes. It produces a typical constructor function that adheres to several conventions, like exposing arguments to compute/drawing methods. To illustrate, notice how the following constructor for <code>GeomPath</code> includes arguments for <code>lineend</code> and <code>linejoin</code> automatically because they are arguments to the <code>GeomPath$draw_panel()</code> method.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>geom_foo</span> <span class=o>&lt;-</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/make_constructor.html>make_constructor</a></span><span class=o>(</span><span class=nv>GeomPath</span>, position <span class=o>=</span> <span class=s>"stack"</span><span class=o>)</span></span>
<span><span class=nf><a href=https://rdrr.io/r/base/print.html>print</a></span><span class=o>(</span><span class=nv>geom_foo</span><span class=o>)</span></span>
<span><span class=c>#&gt; function (mapping = NULL, data = NULL, stat = "identity", position = "stack", </span></span>
<span><span class=c>#&gt;     ..., arrow = NULL, arrow.fill = NULL, lineend = "butt", linejoin = "round", </span></span>
<span><span class=c>#&gt;     linemitre = 10, na.rm = FALSE, show.legend = NA, inherit.aes = TRUE) </span></span>
<span><span class=c>#&gt; &#123;</span></span>
<span><span class=c>#&gt;     layer(mapping = mapping, data = data, geom = "path", stat = stat, </span></span>
<span><span class=c>#&gt;         position = position, show.legend = show.legend, inherit.aes = inherit.aes, </span></span>
<span><span class=c>#&gt;         params = list2(na.rm = na.rm, arrow = arrow, arrow.fill = arrow.fill, </span></span>
<span><span class=c>#&gt;             lineend = lineend, linejoin = linejoin, linemitre = linemitre, </span></span>
<span><span class=c>#&gt;             ...))</span></span>
<span><span class=c>#&gt; &#125;</span></span>
<span><span class=c>#&gt; &lt;environment: 0x00000223e1277e08&gt;</span></span>
<span></span></code></pre></div><p>In addition, you can now also use the <code>#' @aesthetics &lt;Geom/Stat/Position></code> roxygen tag to automatically populate an &lsquo;Aesthetics&rsquo; section of your documentation. The code below;</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>GeomDummy</span> <span class=o>&lt;-</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/ggproto.html>ggproto</a></span><span class=o>(</span><span class=s>"GeomDummy"</span>, <span class=nv>Geom</span>, default_aes <span class=o>=</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/aes.html>aes</a></span><span class=o>(</span>foo <span class=o>=</span> <span class=s>"bar"</span><span class=o>)</span><span class=o>)</span></span>
<span></span>
<span><span class=c>#' &lt;rest of roxygen comments&gt;</span></span>
<span><span class=c>#' @aesthetics GeomDummy</span></span>
<span><span class=nv>geom_foo</span> <span class=o>&lt;-</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/make_constructor.html>make_constructor</a></span><span class=o>(</span><span class=nv>GeomDummy</span><span class=o>)</span></span></code></pre></div><p>will generate the following .Rd code:</p><pre><code>\section{Aesthetics}{

\code{geom_dummy()} understands the following aesthetics. Required aesthetics are displayed in bold and defaults are displayed for optional aesthetics:
\tabular{rll}{
 • \tab \code{foo} \tab → \code{&quot;bar&quot;} \cr
 • \tab \code{\link[ggplot2:aes_group_order]{group}} \tab → inferred \cr
}

Learn more about setting these aesthetics in \code{vignette(&quot;ggplot2-specs&quot;)}.
}
</code></pre><h3 id=themes>Themes
<a href=#themes><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>To replicate how themes are handled internally, you can now use
<a href=https://ggplot2.tidyverse.org/reference/complete_theme.html target=_blank rel=noopener><code>complete_theme()</code></a>. It fills in all missing elements and performs typical checks.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>my_theme</span> <span class=o>&lt;-</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/theme.html>theme</a></span><span class=o>(</span>plot.background <span class=o>=</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/element.html>element_rect</a></span><span class=o>(</span>fill <span class=o>=</span> <span class=kc>NA</span><span class=o>)</span><span class=o>)</span></span>
<span><span class=nf><a href=https://rdrr.io/r/base/length.html>length</a></span><span class=o>(</span><span class=nv>my_theme</span><span class=o>)</span></span>
<span><span class=c>#&gt; [1] 1</span></span>
<span></span><span></span>
<span><span class=nv>completed</span> <span class=o>&lt;-</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/complete_theme.html>complete_theme</a></span><span class=o>(</span><span class=nv>my_theme</span><span class=o>)</span></span>
<span><span class=nf><a href=https://rdrr.io/r/base/length.html>length</a></span><span class=o>(</span><span class=nv>completed</span><span class=o>)</span></span>
<span><span class=c>#&gt; [1] 144</span></span>
<span></span><span></span>
<span><span class=c># You should give rect elements to text settings</span></span>
<span><span class=nv>completed</span> <span class=o>&lt;-</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/theme.html>theme</a></span><span class=o>(</span>legend.text <span class=o>=</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/element.html>element_rect</a></span><span class=o>(</span><span class=o>)</span><span class=o>)</span> <span class=o>|&gt;</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/complete_theme.html>complete_theme</a></span><span class=o>(</span><span class=o>)</span></span>
<span><span class=c>#&gt; <span style=color:#bb0;font-weight:700>Error</span><span style=font-weight:700> in `plot_theme()`:</span></span></span>
<span><span class=c>#&gt; <span style=color:#bb0>!</span> Can't merge the `legend.text` theme element.</span></span>
<span><span class=c>#&gt; <span style=font-weight:700>Caused by error in `method(merge_element, list(ggplot2::element, class_any))`:</span></span></span>
<span><span class=c>#&gt; <span style=color:#bb0>!</span> Only elements of the same class can be merged.</span></span>
<span></span><span></span>
<span><span class=c># Unknown elements</span></span>
<span><span class=nv>completed</span> <span class=o>&lt;-</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/theme.html>theme</a></span><span class=o>(</span>foobar <span class=o>=</span> <span class=m>12</span><span class=o>)</span> <span class=o>|&gt;</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/complete_theme.html>complete_theme</a></span><span class=o>(</span><span class=o>)</span></span>
<span><span class=c>#&gt; Warning in plot_theme(list(theme = theme), default = default): The `foobar` theme element is not defined in the element hierarchy.</span></span>
<span></span></code></pre></div><p>We&rsquo;re also introducing point and polygon theme elements. These aren&rsquo;t used in any of the base ggplot2 theme settings, but you can use them in extensions. The example below demonstrates registering new theme settings and that points and polygons follow inheritance and can be rendered.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=c># Let's say your package 'my_pkg' registers custom point/polygon elements</span></span>
<span><span class=nf><a href=https://ggplot2.tidyverse.org/reference/register_theme_elements.html>register_theme_elements</a></span><span class=o>(</span></span>
<span>  my_pkg_point <span class=o>=</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/element.html>element_point</a></span><span class=o>(</span>colour <span class=o>=</span> <span class=s>"red"</span><span class=o>)</span>,</span>
<span>  my_pkg_polygon <span class=o>=</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/element.html>element_polygon</a></span><span class=o>(</span>fill <span class=o>=</span> <span class=kc>NA</span><span class=o>)</span>,</span>
<span>  element_tree <span class=o>=</span> <span class=nf><a href=https://rdrr.io/r/base/list.html>list</a></span><span class=o>(</span></span>
<span>    my_pkg_point <span class=o>=</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/register_theme_elements.html>el_def</a></span><span class=o>(</span><span class=nv>element_point</span>, inherit <span class=o>=</span> <span class=s>"point"</span><span class=o>)</span>,</span>
<span>    my_pkg_polygon <span class=o>=</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/register_theme_elements.html>el_def</a></span><span class=o>(</span><span class=nv>element_polygon</span>, inherit <span class=o>=</span> <span class=s>"polygon"</span><span class=o>)</span></span>
<span>  <span class=o>)</span></span>
<span><span class=o>)</span></span>
<span></span>
<span><span class=c># Which should inherit from the root point/polygon theme elements</span></span>
<span><span class=nv>my_theme</span> <span class=o>&lt;-</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/theme.html>theme</a></span><span class=o>(</span></span>
<span>  point <span class=o>=</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/element.html>element_point</a></span><span class=o>(</span>shape <span class=o>=</span> <span class=m>17</span><span class=o>)</span>,</span>
<span>  polygon <span class=o>=</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/element.html>element_polygon</a></span><span class=o>(</span>linetype <span class=o>=</span> <span class=s>"dotted"</span><span class=o>)</span></span>
<span><span class=o>)</span> <span class=o>|&gt;</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/complete_theme.html>complete_theme</a></span><span class=o>(</span><span class=o>)</span></span>
<span></span>
<span><span class=c># Rendering your elements</span></span>
<span><span class=nv>pts</span> <span class=o>&lt;-</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/calc_element.html>calc_element</a></span><span class=o>(</span><span class=s>"my_pkg_point"</span>, <span class=nv>my_theme</span><span class=o>)</span> <span class=o>|&gt;</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/element_grob.html>element_grob</a></span><span class=o>(</span></span>
<span>    x <span class=o>=</span> <span class=nf><a href=https://rdrr.io/r/base/c.html>c</a></span><span class=o>(</span><span class=m>0.2</span>, <span class=m>0.5</span>, <span class=m>0.8</span><span class=o>)</span>,</span>
<span>    y <span class=o>=</span> <span class=nf><a href=https://rdrr.io/r/base/c.html>c</a></span><span class=o>(</span><span class=m>0.8</span>, <span class=m>0.2</span>, <span class=m>0.5</span><span class=o>)</span></span>
<span>  <span class=o>)</span></span>
<span><span class=nv>poly</span> <span class=o>&lt;-</span> <span class=nf><a href=https://ggplot2.tidyverse.org/reference/calc_element.html>calc_element</a></span><span class=o>(</span><span class=s>"my_pkg_polygon"</span>, <span class=nv>my_theme</span><span class=o>)</span> <span class=o>|&gt;</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/element_grob.html>element_grob</a></span><span class=o>(</span></span>
<span>    x <span class=o>=</span> <span class=nf><a href=https://rdrr.io/r/base/c.html>c</a></span><span class=o>(</span><span class=m>0.1</span>, <span class=m>0.5</span>, <span class=m>0.9</span><span class=o>)</span>,</span>
<span>    y <span class=o>=</span> <span class=nf><a href=https://rdrr.io/r/base/c.html>c</a></span><span class=o>(</span><span class=m>0.9</span>, <span class=m>0.1</span>, <span class=m>0.5</span><span class=o>)</span></span>
<span>  <span class=o>)</span></span>
<span></span>
<span><span class=c># Drawing the elements</span></span>
<span><span class=nf>grid</span><span class=nf>::</span><span class=nf><a href=https://rdrr.io/r/grid/grid.newpage.html>grid.newpage</a></span><span class=o>(</span><span class=o>)</span></span>
<span><span class=nf>grid</span><span class=nf>::</span><span class=nf><a href=https://rdrr.io/r/grid/grid.draw.html>grid.draw</a></span><span class=o>(</span><span class=nv>pts</span><span class=o>)</span></span>
<span><span class=nf>grid</span><span class=nf>::</span><span class=nf><a href=https://rdrr.io/r/grid/grid.draw.html>grid.draw</a></span><span class=o>(</span><span class=nv>poly</span><span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-38-1.png width=700px style=display:block;margin:auto></p></div><h2 id=acknowledgements>Acknowledgements
<a href=#acknowledgements><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Thank you to all the people who contributed their issues, code and comments to this release:
<a href=https://github.com/83221n4ndr34 target=_blank rel=noopener>@83221n4ndr34</a>,
<a href=https://github.com/Abiologist target=_blank rel=noopener>@Abiologist</a>,
<a href=https://github.com/acebulsk target=_blank rel=noopener>@acebulsk</a>,
<a href=https://github.com/adisarid target=_blank rel=noopener>@adisarid</a>,
<a href=https://github.com/agila5 target=_blank rel=noopener>@agila5</a>,
<a href=https://github.com/agmurray target=_blank rel=noopener>@agmurray</a>,
<a href=https://github.com/agneeshbarua target=_blank rel=noopener>@agneeshbarua</a>,
<a href=https://github.com/aijordan target=_blank rel=noopener>@aijordan</a>,
<a href=https://github.com/amarjitsinghchandhial target=_blank rel=noopener>@amarjitsinghchandhial</a>,
<a href=https://github.com/amkilpatrick target=_blank rel=noopener>@amkilpatrick</a>,
<a href=https://github.com/amongoodtx target=_blank rel=noopener>@amongoodtx</a>,
<a href=https://github.com/Andtise target=_blank rel=noopener>@Andtise</a>,
<a href=https://github.com/andybeet target=_blank rel=noopener>@andybeet</a>,
<a href=https://github.com/antoine4ucsd target=_blank rel=noopener>@antoine4ucsd</a>,
<a href=https://github.com/aphalo target=_blank rel=noopener>@aphalo</a>,
<a href=https://github.com/aravind-j target=_blank rel=noopener>@aravind-j</a>,
<a href=https://github.com/arcresu target=_blank rel=noopener>@arcresu</a>,
<a href=https://github.com/arnaudgallou target=_blank rel=noopener>@arnaudgallou</a>,
<a href=https://github.com/assaron target=_blank rel=noopener>@assaron</a>,
<a href=https://github.com/baderstine target=_blank rel=noopener>@baderstine</a>,
<a href=https://github.com/BajczA475 target=_blank rel=noopener>@BajczA475</a>,
<a href=https://github.com/bakaburg1 target=_blank rel=noopener>@bakaburg1</a>,
<a href=https://github.com/BegoniaCampos target=_blank rel=noopener>@BegoniaCampos</a>,
<a href=https://github.com/benjaminhlina target=_blank rel=noopener>@benjaminhlina</a>,
<a href=https://github.com/billdenney target=_blank rel=noopener>@billdenney</a>,
<a href=https://github.com/binkleym target=_blank rel=noopener>@binkleym</a>,
<a href=https://github.com/bkohrn target=_blank rel=noopener>@bkohrn</a>,
<a href=https://github.com/bnprks target=_blank rel=noopener>@bnprks</a>,
<a href=https://github.com/botanize target=_blank rel=noopener>@botanize</a>,
<a href=https://github.com/Breeze-Hu target=_blank rel=noopener>@Breeze-Hu</a>,
<a href=https://github.com/brianmsm target=_blank rel=noopener>@brianmsm</a>,
<a href=https://github.com/brunomioto target=_blank rel=noopener>@brunomioto</a>,
<a href=https://github.com/btupper target=_blank rel=noopener>@btupper</a>,
<a href=https://github.com/bwu62 target=_blank rel=noopener>@bwu62</a>,
<a href=https://github.com/carljpearson target=_blank rel=noopener>@carljpearson</a>,
<a href=https://github.com/catalamarti target=_blank rel=noopener>@catalamarti</a>,
<a href=https://github.com/cbrnr target=_blank rel=noopener>@cbrnr</a>,
<a href=https://github.com/ccani007 target=_blank rel=noopener>@ccani007</a>,
<a href=https://github.com/ccsarapas target=_blank rel=noopener>@ccsarapas</a>,
<a href=https://github.com/cgoo4 target=_blank rel=noopener>@cgoo4</a>,
<a href=https://github.com/clauswilke target=_blank rel=noopener>@clauswilke</a>,
<a href=https://github.com/Close-your-eyes target=_blank rel=noopener>@Close-your-eyes</a>,
<a href=https://github.com/collinberke target=_blank rel=noopener>@collinberke</a>,
<a href=https://github.com/const-ae target=_blank rel=noopener>@const-ae</a>,
<a href=https://github.com/dafxy target=_blank rel=noopener>@dafxy</a>,
<a href=https://github.com/DanChaltiel target=_blank rel=noopener>@DanChaltiel</a>,
<a href=https://github.com/danli349 target=_blank rel=noopener>@danli349</a>,
<a href=https://github.com/dansmith01 target=_blank rel=noopener>@dansmith01</a>,
<a href=https://github.com/daorui target=_blank rel=noopener>@daorui</a>,
<a href=https://github.com/david-romano target=_blank rel=noopener>@david-romano</a>,
<a href=https://github.com/davidhodge931 target=_blank rel=noopener>@davidhodge931</a>,
<a href=https://github.com/dinosquash target=_blank rel=noopener>@dinosquash</a>,
<a href=https://github.com/dominicroye target=_blank rel=noopener>@dominicroye</a>,
<a href=https://github.com/dsconnell target=_blank rel=noopener>@dsconnell</a>,
<a href=https://github.com/EA-Ammar target=_blank rel=noopener>@EA-Ammar</a>,
<a href=https://github.com/EBukin target=_blank rel=noopener>@EBukin</a>,
<a href=https://github.com/elgabbas target=_blank rel=noopener>@elgabbas</a>,
<a href=https://github.com/eliocamp target=_blank rel=noopener>@eliocamp</a>,
<a href=https://github.com/elipousson target=_blank rel=noopener>@elipousson</a>,
<a href=https://github.com/erinnacland target=_blank rel=noopener>@erinnacland</a>,
<a href=https://github.com/etiennebacher target=_blank rel=noopener>@etiennebacher</a>,
<a href=https://github.com/EvaMaeRey target=_blank rel=noopener>@EvaMaeRey</a>,
<a href=https://github.com/evanmascitti target=_blank rel=noopener>@evanmascitti</a>,
<a href=https://github.com/eyayaw target=_blank rel=noopener>@eyayaw</a>,
<a href=https://github.com/fabian-s target=_blank rel=noopener>@fabian-s</a>,
<a href=https://github.com/fkohrt target=_blank rel=noopener>@fkohrt</a>,
<a href=https://github.com/FloLecorvaisier target=_blank rel=noopener>@FloLecorvaisier</a>,
<a href=https://github.com/fmarotta target=_blank rel=noopener>@fmarotta</a>,
<a href=https://github.com/Fugwaaaa target=_blank rel=noopener>@Fugwaaaa</a>,
<a href=https://github.com/fwunschel target=_blank rel=noopener>@fwunschel</a>,
<a href=https://github.com/g-pacheco target=_blank rel=noopener>@g-pacheco</a>,
<a href=https://github.com/gaborcsardi target=_blank rel=noopener>@gaborcsardi</a>,
<a href=https://github.com/gregorp target=_blank rel=noopener>@gregorp</a>,
<a href=https://github.com/guqicun target=_blank rel=noopener>@guqicun</a>,
<a href=https://github.com/hadley target=_blank rel=noopener>@hadley</a>,
<a href=https://github.com/heinonmatti target=_blank rel=noopener>@heinonmatti</a>,
<a href=https://github.com/heor-robyoung target=_blank rel=noopener>@heor-robyoung</a>,
<a href=https://github.com/herry23xet target=_blank rel=noopener>@herry23xet</a>,
<a href=https://github.com/HMU-WH target=_blank rel=noopener>@HMU-WH</a>,
<a href=https://github.com/HRodenhizer target=_blank rel=noopener>@HRodenhizer</a>,
<a href=https://github.com/hsiaoyi0504 target=_blank rel=noopener>@hsiaoyi0504</a>,
<a href=https://github.com/Hy4m target=_blank rel=noopener>@Hy4m</a>,
<a href=https://github.com/IndrajeetPatil target=_blank rel=noopener>@IndrajeetPatil</a>,
<a href=https://github.com/jack-davison target=_blank rel=noopener>@jack-davison</a>,
<a href=https://github.com/JacobBumgarner target=_blank rel=noopener>@JacobBumgarner</a>,
<a href=https://github.com/JakubKomarek target=_blank rel=noopener>@JakubKomarek</a>,
<a href=https://github.com/jansim target=_blank rel=noopener>@jansim</a>,
<a href=https://github.com/japhir target=_blank rel=noopener>@japhir</a>,
<a href=https://github.com/jbengler target=_blank rel=noopener>@jbengler</a>,
<a href=https://github.com/jdonland target=_blank rel=noopener>@jdonland</a>,
<a href=https://github.com/jeraldnoble target=_blank rel=noopener>@jeraldnoble</a>,
<a href=https://github.com/Jigyasu4indp target=_blank rel=noopener>@Jigyasu4indp</a>,
<a href=https://github.com/jiw181 target=_blank rel=noopener>@jiw181</a>,
<a href=https://github.com/jmbuhr target=_blank rel=noopener>@jmbuhr</a>,
<a href=https://github.com/JMeyer31 target=_blank rel=noopener>@JMeyer31</a>,
<a href=https://github.com/jmgirard target=_blank rel=noopener>@jmgirard</a>,
<a href=https://github.com/jnolis target=_blank rel=noopener>@jnolis</a>,
<a href=https://github.com/joaopedrosusselbertogna target=_blank rel=noopener>@joaopedrosusselbertogna</a>,
<a href=https://github.com/johow target=_blank rel=noopener>@johow</a>,
<a href=https://github.com/jonocarroll target=_blank rel=noopener>@jonocarroll</a>,
<a href=https://github.com/jpquast target=_blank rel=noopener>@jpquast</a>,
<a href=https://github.com/JStorey42 target=_blank rel=noopener>@JStorey42</a>,
<a href=https://github.com/JThomasWatson target=_blank rel=noopener>@JThomasWatson</a>,
<a href=https://github.com/julianbarg target=_blank rel=noopener>@julianbarg</a>,
<a href=https://github.com/julou target=_blank rel=noopener>@julou</a>,
<a href=https://github.com/junjunlab target=_blank rel=noopener>@junjunlab</a>,
<a href=https://github.com/JWiley target=_blank rel=noopener>@JWiley</a>,
<a href=https://github.com/kauedesousa target=_blank rel=noopener>@kauedesousa</a>,
<a href=https://github.com/kdarras target=_blank rel=noopener>@kdarras</a>,
<a href=https://github.com/kevinushey target=_blank rel=noopener>@kevinushey</a>,
<a href=https://github.com/kevinwolz target=_blank rel=noopener>@kevinwolz</a>,
<a href=https://github.com/kieran-mace target=_blank rel=noopener>@kieran-mace</a>,
<a href=https://github.com/kkellysci target=_blank rel=noopener>@kkellysci</a>,
<a href=https://github.com/kobetst target=_blank rel=noopener>@kobetst</a>,
<a href=https://github.com/koheiw target=_blank rel=noopener>@koheiw</a>,
<a href=https://github.com/krlmlr target=_blank rel=noopener>@krlmlr</a>,
<a href=https://github.com/KryeKuzhinieri target=_blank rel=noopener>@KryeKuzhinieri</a>,
<a href=https://github.com/kylebutts target=_blank rel=noopener>@kylebutts</a>,
<a href=https://github.com/laurabrianna target=_blank rel=noopener>@laurabrianna</a>,
<a href=https://github.com/lbenz730 target=_blank rel=noopener>@lbenz730</a>,
<a href=https://github.com/lcpmgh target=_blank rel=noopener>@lcpmgh</a>,
<a href=https://github.com/lgaborini target=_blank rel=noopener>@lgaborini</a>,
<a href=https://github.com/lgibson7 target=_blank rel=noopener>@lgibson7</a>,
<a href=https://github.com/LGraz target=_blank rel=noopener>@LGraz</a>,
<a href=https://github.com/llrs target=_blank rel=noopener>@llrs</a>,
<a href=https://github.com/louis-heraut target=_blank rel=noopener>@louis-heraut</a>,
<a href=https://github.com/ltierney target=_blank rel=noopener>@ltierney</a>,
<a href=https://github.com/Lucielclr target=_blank rel=noopener>@Lucielclr</a>,
<a href=https://github.com/luhann target=_blank rel=noopener>@luhann</a>,
<a href=https://github.com/m-muecke target=_blank rel=noopener>@m-muecke</a>,
<a href=https://github.com/marcelglueck target=_blank rel=noopener>@marcelglueck</a>,
<a href=https://github.com/margaret-colville target=_blank rel=noopener>@margaret-colville</a>,
<a href=https://github.com/markus-schaffer target=_blank rel=noopener>@markus-schaffer</a>,
<a href=https://github.com/Maschette target=_blank rel=noopener>@Maschette</a>,
<a href=https://github.com/MathiasAmbuehl target=_blank rel=noopener>@MathiasAmbuehl</a>,
<a href=https://github.com/MathieuYeche target=_blank rel=noopener>@MathieuYeche</a>,
<a href=https://github.com/mattansb target=_blank rel=noopener>@mattansb</a>,
<a href=https://github.com/MauricioCely target=_blank rel=noopener>@MauricioCely</a>,
<a href=https://github.com/MaxAtoms target=_blank rel=noopener>@MaxAtoms</a>,
<a href=https://github.com/mcol target=_blank rel=noopener>@mcol</a>,
<a href=https://github.com/mfoos target=_blank rel=noopener>@mfoos</a>,
<a href=https://github.com/MichaelChirico target=_blank rel=noopener>@MichaelChirico</a>,
<a href=https://github.com/MichelineCampbell target=_blank rel=noopener>@MichelineCampbell</a>,
<a href=https://github.com/mikmart target=_blank rel=noopener>@mikmart</a>,
<a href=https://github.com/misea target=_blank rel=noopener>@misea</a>,
<a href=https://github.com/mjskay target=_blank rel=noopener>@mjskay</a>,
<a href=https://github.com/mkoohafkan target=_blank rel=noopener>@mkoohafkan</a>,
<a href=https://github.com/mlaparie target=_blank rel=noopener>@mlaparie</a>,
<a href=https://github.com/MLopez-Ibanez target=_blank rel=noopener>@MLopez-Ibanez</a>,
<a href=https://github.com/mluerig target=_blank rel=noopener>@mluerig</a>,
<a href=https://github.com/mohammad-numan target=_blank rel=noopener>@mohammad-numan</a>,
<a href=https://github.com/MoREpro target=_blank rel=noopener>@MoREpro</a>,
<a href=https://github.com/mtrsl target=_blank rel=noopener>@mtrsl</a>,
<a href=https://github.com/muschellij2 target=_blank rel=noopener>@muschellij2</a>,
<a href=https://github.com/mzavattaro target=_blank rel=noopener>@mzavattaro</a>,
<a href=https://github.com/nicholasdavies target=_blank rel=noopener>@nicholasdavies</a>,
<a href=https://github.com/njspix target=_blank rel=noopener>@njspix</a>,
<a href=https://github.com/nmercadeb target=_blank rel=noopener>@nmercadeb</a>,
<a href=https://github.com/noejn2 target=_blank rel=noopener>@noejn2</a>,
<a href=https://github.com/npearlmu target=_blank rel=noopener>@npearlmu</a>,
<a href=https://github.com/Olivia-Box-Power target=_blank rel=noopener>@Olivia-Box-Power</a>,
<a href=https://github.com/olivroy target=_blank rel=noopener>@olivroy</a>,
<a href=https://github.com/oracle5th target=_blank rel=noopener>@oracle5th</a>,
<a href=https://github.com/oskard95 target=_blank rel=noopener>@oskard95</a>,
<a href=https://github.com/palderman target=_blank rel=noopener>@palderman</a>,
<a href=https://github.com/PanfengZhang target=_blank rel=noopener>@PanfengZhang</a>,
<a href=https://github.com/paulfajour target=_blank rel=noopener>@paulfajour</a>,
<a href=https://github.com/PCEBrunaLab target=_blank rel=noopener>@PCEBrunaLab</a>,
<a href=https://github.com/petrbouchal target=_blank rel=noopener>@petrbouchal</a>,
<a href=https://github.com/pgmj target=_blank rel=noopener>@pgmj</a>,
<a href=https://github.com/phispu target=_blank rel=noopener>@phispu</a>,
<a href=https://github.com/PietrH target=_blank rel=noopener>@PietrH</a>,
<a href=https://github.com/pn317 target=_blank rel=noopener>@pn317</a>,
<a href=https://github.com/ppoyk target=_blank rel=noopener>@ppoyk</a>,
<a href=https://github.com/pradosj target=_blank rel=noopener>@pradosj</a>,
<a href=https://github.com/psoldath target=_blank rel=noopener>@psoldath</a>,
<a href=https://github.com/py9mrg target=_blank rel=noopener>@py9mrg</a>,
<a href=https://github.com/qli84 target=_blank rel=noopener>@qli84</a>,
<a href=https://github.com/randyzwitch target=_blank rel=noopener>@randyzwitch</a>,
<a href=https://github.com/raphaludwig target=_blank rel=noopener>@raphaludwig</a>,
<a href=https://github.com/RaynorJim target=_blank rel=noopener>@RaynorJim</a>,
<a href=https://github.com/rdboyes target=_blank rel=noopener>@rdboyes</a>,
<a href=https://github.com/reechawong target=_blank rel=noopener>@reechawong</a>,
<a href=https://github.com/rempsyc target=_blank rel=noopener>@rempsyc</a>,
<a href=https://github.com/rfgoldberg target=_blank rel=noopener>@rfgoldberg</a>,
<a href=https://github.com/rikivillalba target=_blank rel=noopener>@rikivillalba</a>,
<a href=https://github.com/rishabh-mp3 target=_blank rel=noopener>@rishabh-mp3</a>,
<a href=https://github.com/RodDalBen target=_blank rel=noopener>@RodDalBen</a>,
<a href=https://github.com/rogerssam target=_blank rel=noopener>@rogerssam</a>,
<a href=https://github.com/rsh52 target=_blank rel=noopener>@rsh52</a>,
<a href=https://github.com/rwilson8 target=_blank rel=noopener>@rwilson8</a>,
<a href=https://github.com/salim-b target=_blank rel=noopener>@salim-b</a>,
<a href=https://github.com/sambtalcott target=_blank rel=noopener>@sambtalcott</a>,
<a href=https://github.com/samuel-marsh target=_blank rel=noopener>@samuel-marsh</a>,
<a href=https://github.com/schloerke target=_blank rel=noopener>@schloerke</a>,
<a href=https://github.com/schmittrjp target=_blank rel=noopener>@schmittrjp</a>,
<a href=https://github.com/sierrajohnson target=_blank rel=noopener>@sierrajohnson</a>,
<a href=https://github.com/smouksassi target=_blank rel=noopener>@smouksassi</a>,
<a href=https://github.com/stitam target=_blank rel=noopener>@stitam</a>,
<a href=https://github.com/stragu target=_blank rel=noopener>@stragu</a>,
<a href=https://github.com/strengejacke target=_blank rel=noopener>@strengejacke</a>,
<a href=https://github.com/sunta3iouxos target=_blank rel=noopener>@sunta3iouxos</a>,
<a href=https://github.com/szkabel target=_blank rel=noopener>@szkabel</a>,
<a href=https://github.com/taozhou2020 target=_blank rel=noopener>@taozhou2020</a>,
<a href=https://github.com/tdhock target=_blank rel=noopener>@tdhock</a>,
<a href=https://github.com/telenskyt target=_blank rel=noopener>@telenskyt</a>,
<a href=https://github.com/teunbrand target=_blank rel=noopener>@teunbrand</a>,
<a href=https://github.com/the-Hull target=_blank rel=noopener>@the-Hull</a>,
<a href=https://github.com/thgsponer target=_blank rel=noopener>@thgsponer</a>,
<a href=https://github.com/thomasp85 target=_blank rel=noopener>@thomasp85</a>,
<a href=https://github.com/ThomasSoeiro target=_blank rel=noopener>@ThomasSoeiro</a>,
<a href=https://github.com/Tiggax target=_blank rel=noopener>@Tiggax</a>,
<a href=https://github.com/tikkss target=_blank rel=noopener>@tikkss</a>,
<a href=https://github.com/TimTaylor target=_blank rel=noopener>@TimTaylor</a>,
<a href=https://github.com/tombishop1 target=_blank rel=noopener>@tombishop1</a>,
<a href=https://github.com/tommmmi target=_blank rel=noopener>@tommmmi</a>,
<a href=https://github.com/totajuliusd target=_blank rel=noopener>@totajuliusd</a>,
<a href=https://github.com/trafficfan target=_blank rel=noopener>@trafficfan</a>,
<a href=https://github.com/tungttnguyen target=_blank rel=noopener>@tungttnguyen</a>,
<a href=https://github.com/tvatter target=_blank rel=noopener>@tvatter</a>,
<a href=https://github.com/twest820 target=_blank rel=noopener>@twest820</a>,
<a href=https://github.com/ujtwr target=_blank rel=noopener>@ujtwr</a>,
<a href=https://github.com/venpopov target=_blank rel=noopener>@venpopov</a>,
<a href=https://github.com/vgregoire1 target=_blank rel=noopener>@vgregoire1</a>,
<a href=https://github.com/victorcat4 target=_blank rel=noopener>@victorcat4</a>,
<a href=https://github.com/victorfeagins target=_blank rel=noopener>@victorfeagins</a>,
<a href=https://github.com/vivekJax target=_blank rel=noopener>@vivekJax</a>,
<a href=https://github.com/wbvguo target=_blank rel=noopener>@wbvguo</a>,
<a href=https://github.com/willgearty target=_blank rel=noopener>@willgearty</a>,
<a href=https://github.com/williamlai2 target=_blank rel=noopener>@williamlai2</a>,
<a href=https://github.com/withr target=_blank rel=noopener>@withr</a>,
<a href=https://github.com/wvictor14 target=_blank rel=noopener>@wvictor14</a>,
<a href=https://github.com/XdahaX target=_blank rel=noopener>@XdahaX</a>,
<a href=https://github.com/yjunechoe target=_blank rel=noopener>@yjunechoe</a>,
<a href=https://github.com/yoshidk6 target=_blank rel=noopener>@yoshidk6</a>,
<a href=https://github.com/YUCHENG-ZHAO target=_blank rel=noopener>@YUCHENG-ZHAO</a>,
<a href=https://github.com/Yunuuuu target=_blank rel=noopener>@Yunuuuu</a>,
<a href=https://github.com/yutannihilation target=_blank rel=noopener>@yutannihilation</a>,
<a href=https://github.com/yzz32 target=_blank rel=noopener>@yzz32</a>,
<a href=https://github.com/zhengxiaoUVic target=_blank rel=noopener>@zhengxiaoUVic</a>, and
<a href=https://github.com/zjwinn target=_blank rel=noopener>@zjwinn</a>.</p><section class=footnotes role=doc-endnotes><hr><ol><li id=fn:1 role=doc-endnote><p>Normally,
<a href=https://ggplot2.tidyverse.org/reference/aes.html target=_blank rel=noopener><code>aes()</code></a> is strictly used to map data instead of setting a fixed property. We diverge from this API for pragmatic reasons, not theoretical ones. <a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2 role=doc-endnote><p>Aesthetics of the position adjustment are not be confused with position aesthetics. Position aesthetics like <code>x</code> and <code>y</code> are transformed by a scale, whereas aesthetics of the position adjustment like <code>nudge_x</code> and <code>nudge_y</code> are not (akin to <code>width</code> and <code>height</code>). <a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></section></div></div><div class=column25><div class="section hideOnMobile"><div class=sectionTitle>Contents</div><nav id=TableOfContents><ul><li><a href=#adopting-s7>Adopting S7</a></li><li><a href=#theme-improvements>Theme improvements</a></li><li><a href=#labels>Labels</a></li><li><a href=#discrete-scales>Discrete scales</a></li><li><a href=#position-aesthetics>Position aesthetics</a></li><li><a href=#facets>Facets</a></li><li><a href=#styling-updates>Styling updates</a></li><li><a href=#new-stats>New stats</a></li><li><a href=#coord-reversal>Coord reversal</a></li><li><a href=#goodies-for-extensions>Goodies for extensions</a></li><li><a href=#acknowledgements>Acknowledgements</a></li></ul></nav></div><div class=section></div></div></div></div></div><div id=rStudioFooter class=band><div class=bandContent><div id=copyright>The tidyverse is proudly supported by <a class=rstudioLogo href=https://posit.co/ aria-label="Posit Homepage"></a></div><div id=logos><a href=https://www.tidyverse.org/google_privacy_policy>Privacy policy</a>
<a href=https://github.com/tidyverse class="footerLogo gitHub" aria-label="Tidyverse GitHub organization"></a><a href=https://twitter.com/hashtag/rstats class="footerLogo twitter" aria-label="rstats hashtag on twitter.com"></a></div></div></div></div></div><script src=/js/math-code.js></script><script type=text/x-mathjax-config>
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    processEscapes: true
  }
});
</script><script async src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><script type=application/javascript>var dnt=(navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack);var doNotTrack=(dnt=="1"||dnt=="yes");if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');if(window.sessionStorage){var GA_SESSION_STORAGE_KEY='ga:clientId';ga('create','UA-115082821-1',{'storage':'none','clientId':sessionStorage.getItem(GA_SESSION_STORAGE_KEY)});ga(function(tracker){sessionStorage.setItem(GA_SESSION_STORAGE_KEY,tracker.get('clientId'));});}
ga('set','anonymizeIp',true);ga('send','pageview');}</script></body></html></div></div></body></html>