<!doctype html><html><head><!doctype html><html lang=en-us><link rel=stylesheet href=/css/fonts.css><link rel=stylesheet href=/css/main-site.css><link rel=stylesheet href=/css/fa5-all.css><style type=text/css>body{background-color:#fff;color:#1a1917}a{color:#38577f}a:hover{color:#42709b}a:focus{outline-color:#42709b}.column25-left .sectionTitle a:hover:not(.current),.column16-left .sectionTitle a:hover:not(.current){color:#1a1917}.icon-attribution,.icon-attribution a{color:#1a1917;opacity:75%}#homeContent .band.first{background-color:#fff}#homeContent .band.second{background-color:#fdeba4}#homeContent .band.third{background-color:#fff}#rStudioHeader{background-color:#1a162d;color:#fff}#rStudioHeader .productName{color:#fff}#rStudioHeader .productName:hover,#rStudioHeader .productName:focus{color:#fdeba4}#rStudioHeader #menu .menuItem.a{background-color:#75aadb;color:#fff}#rStudioHeader #menu .menuItem:hover{background-color:#484557;color:#fff}#rStudioHeader #menu .menuItem.current{background-color:#fff;color:#1a162d;text-decoration:none}#rStudioFooter.band{background-color:#767381}#rStudioFooter .bandContent #copyright{color:#e3eef8}table tbody tr:nth-child(even){background-color:#f7faff}table tbody tr:nth-child(odd){background-color:#fff}.latest{border-top:.5em solid <no value>}.event{-moz-box-shadow:0 0 0 0 rgba(0,0,0,.1);-webkit-box-shadow:0 0 0 0 rgba(0,0,0,.1);box-shadow:0 0 0 0 rgba(0,0,0,.1)}.section .event{background-color:#eab0c41a}.section .event{border-top:7pt solid #a19ea936}.section .event a{color:#1a162d}.section .event{color:#404040}</style><link rel=stylesheet href=/css/tidyverse.css><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Hugo 0.71.1"><title>Fonts in R</title><meta property="og:title" content="Fonts in R"><meta property="og:description" content="Taking control of fonts and text rendering in R can be challenging. This deep-dive teaches you everything (and then some) you need to know to keep your sanity"><meta property="og:type" content="article"><meta property="og:url" content="https://www.tidyverse.org/blog/2025/05/fonts-in-r/"><meta property="twitter:card" content="summary_large_image"><meta property="og:title" content="Fonts in R - Tidyverse"><meta property="description" content="Taking control of fonts and text rendering in R can be challenging. This deep-dive teaches you everything (and then some) you need to know to keep your sanity"><meta property="og:description" content="Taking control of fonts and text rendering in R can be challenging. This deep-dive teaches you everything (and then some) you need to know to keep your sanity"><meta property="og:image" content="https://www.tidyverse.org/blog/2025/05/fonts-in-r/thumbnail-sq.jpg"><meta name=twitter:image content="https://www.tidyverse.org/blog/2025/05/fonts-in-r/thumbnail-wd.jpg"><link rel=apple-touch-icon sizes=180x180 href=/images/favicons/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/images/favicons/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/images/favicons/favicon-16x16.png><link rel=manifest href=/images/favicons/site.webmanifest><link rel=mask-icon href=/images/favicons/safari-pinned-tab.svg><link rel="shortcut icon" href=/images/favicons/favicon.ico><meta name=msapplication-TileColor content="#da532c"><meta name=msapplication-config href=/images/favicons/browserconfig.xml><script type=text/javascript src=/js/jquery-3.5.1.min.js></script><script type=text/javascript src=/js/site.js></script><link rel=icon href=/images/favicon.ico><script type=text/javascript src=/js/clipboard.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin=anonymous></script><script defer data-domain=tidyverse.org,all.tidyverse.org src=https://plausible.io/js/plausible.js></script></head><body><div id=appTidyverseSite class="shrinkHeader alwaysShrinkHeader"><div id=main><div id=rStudioHeader><nav class=band><div class="innards bandContent"><div><a class=productName href=/%20/>Tidyverse</a></div><div id=menu><div id=menuToggler></div><div id=menuItems><a class=menuItem href=/packages/>Packages</a>
<a class="menuItem current" href=/blog/>Blog</a>
<a class=menuItem href=/learn/>Learn</a>
<a class=menuItem href=/help/>Help</a>
<a class=menuItem href=/contribute/>Contribute</a></div></div></div></nav></div><main><div class="band padForHeader pushFooter"><div class=bandContent><div class="full splitColumns withMobileMargins"><div class=column75><h1 class=article-title>Fonts in R</h1><div class=article-header aria-hidden=true><div class=photo><img src=/blog/2025/05/fonts-in-r/thumbnail-wd.jpg></div><div class=photoCredit>Photo by <a href=https://unsplash.com/photos/flat-lay-photography-of-stamp-lot-p8gzCnZf39k>Kristian Strand</a></div></div><span class=article-date><i class="fas fa-calendar-day fa-fw"></i>&nbsp;&nbsp;2025/05/12</span><p style=margin-bottom:.5em;margin-top:.85em><i class="fas fa-tags"></i>&nbsp;
<a href=/tags/graphics/>graphics</a>,
<a href=/tags/ragg/>ragg</a>,
<a href=/tags/svglite/>svglite</a>,
<a href=/tags/systemfonts/>systemfonts</a>,
<a href=/tags/textshaping/>textshaping</a></p><p style=margin-top:.5em><i class="fas fa-user-circle fa-fw"></i>&nbsp;
Thomas Lin Pedersen</p><div class=article-content><style type=text/css>pre{text-wrap:nowrap;overflow-x:scroll}figure{margin-top:2em}figcaption{text-align:center;margin-top:1em}table{max-width:99%}</style><p>(An updated version of this blog post will be available at
<a href=https://systemfonts.r-lib.org target=_blank rel=noopener>the systemfonts webpage</a>)</p><p>The purpose of this document is to give you a thorough overview of fonts in R. However, for this to be possible, you&rsquo;ll first need a basic understanding of fonts in general. If you already have a thorough understanding of digital typography you can skip to
<a href=#font-handling-in-r>the next section</a>.</p><h2 id=digital-typography>Digital typography
<a href=#digital-typography><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Many books could be, and have been, written about the subject of typography. This blog post is not meant to be an exhaustive deep dive into all areas of this vast subject. Rather, it is meant to give you just enough understanding of core concepts and terminology to appreciate how it all plays into using fonts in R.</p><h3 id=typeface-or-font>Typeface or font?
<a href=#typeface-or-font><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>There is a good chance that you, like 99% of world, use &ldquo;font&rdquo; as the term describing &ldquo;the look&rdquo; of the letters you type. You may, perhaps, have heard the term &ldquo;typeface&rdquo; as well and thought it synonymous. This is in fact slightly wrong, and a great deal of typography snobbery has been dealt out on that account (much like the distinction between packages and libraries in R). It is a rather inconsequential mix-up for the most part, especially because 99% of the population wouldn&rsquo;t bat an eye if you use them interchangeably. However, the distinction between the two serves as a good starting point to talk about other terms in digital typography as well as the nature of font files, so let&rsquo;s dive in.</p><p>When most people use the word &ldquo;font&rdquo; or &ldquo;font family&rdquo;, what they are actually describing is a typeface. A <strong>typeface</strong> is a style of lettering that forms a cohesive whole. As an example, consider the well-known &ldquo;Helvetica&rdquo; typeface. This name embraces many different weights (bold, normal, light) as well as slanted (italic) and upright. However, all of these variations are all as much Helvetica as the others - they are all part of the same typeface.</p><p>A <strong>font</strong> is a subset of a typeface, describing a particular variation of the typeface, i.e.¬†the combination of weight, width, and slant that comes together to describe the specific subset of a typeface that is used. We typically give a specific combination of these features a name, like &ldquo;bold&rdquo; or &ldquo;medium&rdquo; or &ldquo;italic&rdquo;, which we call the <strong>font style</strong><sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>. In other words, a font is a particularly style within a typeface.</p><div class=highlight><div class=figure style=text-align:center><p><img src=figs/unnamed-chunk-2-1.png alt="Different fonts from the Avenir Next typeface" width=700px></p><p class=caption>Different fonts from the Avenir Next typeface</p></div></div><p>In the rest of this document we will use the terms typeface and font with the meaning described above.</p><h3 id=font-files>Font files
<a href=#font-files><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>Next, we need to talk about how typefaces are represented for use by computers. Font files record information on how to draw the individual glyphs (characters), but also instructions about how to draw sequences of glyphs like distance adjustments (kerning) and substitution rules (ligatures). Font files typically encode a single font but can encode a full typeface:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>typefaces</span> <span class=o>&lt;-</span> <span class=nf>systemfonts</span><span class=nf>::</span><span class=nf><a href=https://systemfonts.r-lib.org/reference/system_fonts.html>system_fonts</a></span><span class=o>(</span><span class=o>)</span><span class=o>[</span>, <span class=nf><a href=https://rdrr.io/r/base/c.html>c</a></span><span class=o>(</span><span class=s>"path"</span>, <span class=s>"index"</span>, <span class=s>"family"</span>, <span class=s>"style"</span><span class=o>)</span><span class=o>]</span></span>
<span></span>
<span><span class=c># Full typeface in one file</span></span>
<span><span class=nv>typefaces</span><span class=o>[</span><span class=nv>typefaces</span><span class=o>$</span><span class=nv>family</span> <span class=o>==</span> <span class=s>"Helvetica"</span>, <span class=o>]</span></span>
<span><span class=c>#&gt; <span style=color:#555># A tibble: 6 √ó 4</span></span></span>
<span><span class=c>#&gt;   path                                index family    style        </span></span>
<span><span class=c>#&gt;   <span style=color:#555;font-style:italic>&lt;chr&gt;</span>                               <span style=color:#555;font-style:italic>&lt;int&gt;</span> <span style=color:#555;font-style:italic>&lt;chr&gt;</span>     <span style=color:#555;font-style:italic>&lt;chr&gt;</span>        </span></span>
<span><span class=c>#&gt; <span style=color:#555>1</span> /System/Library/Fonts/Helvetica.ttc     2 Helvetica Oblique      </span></span>
<span><span class=c>#&gt; <span style=color:#555>2</span> /System/Library/Fonts/Helvetica.ttc     4 Helvetica Light        </span></span>
<span><span class=c>#&gt; <span style=color:#555>3</span> /System/Library/Fonts/Helvetica.ttc     5 Helvetica Light Oblique</span></span>
<span><span class=c>#&gt; <span style=color:#555>4</span> /System/Library/Fonts/Helvetica.ttc     1 Helvetica Bold         </span></span>
<span><span class=c>#&gt; <span style=color:#555>5</span> /System/Library/Fonts/Helvetica.ttc     3 Helvetica Bold Oblique </span></span>
<span><span class=c>#&gt; <span style=color:#555>6</span> /System/Library/Fonts/Helvetica.ttc     0 Helvetica Regular</span></span>
<span></span><span></span>
<span><span class=c># One font per font file</span></span>
<span><span class=nv>typefaces</span><span class=o>[</span><span class=nv>typefaces</span><span class=o>$</span><span class=nv>family</span> <span class=o>==</span> <span class=s>"Arial"</span>, <span class=o>]</span></span>
<span><span class=c>#&gt; <span style=color:#555># A tibble: 4 √ó 4</span></span></span>
<span><span class=c>#&gt;   path                                                     index family style      </span></span>
<span><span class=c>#&gt;   <span style=color:#555;font-style:italic>&lt;chr&gt;</span>                                                    <span style=color:#555;font-style:italic>&lt;int&gt;</span> <span style=color:#555;font-style:italic>&lt;chr&gt;</span>  <span style=color:#555;font-style:italic>&lt;chr&gt;</span>      </span></span>
<span><span class=c>#&gt; <span style=color:#555>1</span> /System/Library/Fonts/Supplemental/Arial.ttf                 0 Arial  Regular    </span></span>
<span><span class=c>#&gt; <span style=color:#555>2</span> /System/Library/Fonts/Supplemental/Arial Bold.ttf            0 Arial  Bold       </span></span>
<span><span class=c>#&gt; <span style=color:#555>3</span> /System/Library/Fonts/Supplemental/Arial Bold Italic.ttf     0 Arial  Bold Italic</span></span>
<span><span class=c>#&gt; <span style=color:#555>4</span> /System/Library/Fonts/Supplemental/Arial Italic.ttf          0 Arial  Italic</span></span>
<span></span></code></pre></div><p>Here, each row is a font, with <strong>family</strong> giving the name of the typeface, and <strong>style</strong> the font style.</p><p>It took a considerable number of tries before the world managed to nail the digitial representation of fonts, leading to a proliferation of file types. As an R user, there are three formats that are particularly improtant:</p><ul><li><p><strong>TrueType</strong> (ttf/ttc). Truetype is the baseline format that all modern formats stand on top of. It was developed by Apple in the &rsquo;80s and became popular due to its great balance between size and quality. Fonts can be encoded, either as scalable paths, or as bitmaps of various sizes, the former generally being preferred as it allows for seamless scaling and small file size at the same time.</p></li><li><p><strong>OpenType</strong> (otf/otc). OpenType was created by Microsoft and Adobe to improve upon TrueType. While TrueType was a great success, the number of glyphs it could contain was limited and so was its support for selecting different features during
<a href=#text-shaping>shaping</a>. OpenType resolved these issues, so if you want access to advanced typography features you&rsquo;ll need a font in OpenType format.</p></li><li><p><strong>Web Open Font Format</strong> (woff/woff2). TrueType and OpenType tend to create large files. Since a large percentage of the text consumed today is delivered over the internet this creates a problem. WOFF resolves this problem by acting as a compression wrapper around TrueType/OpenType to reduce file sizes while also limiting the number of advanced features provided to those relevant to web fonts. The woff2 format is basically identical to woff except it uses the more efficient
<a href=https://en.wikipedia.org/wiki/Brotli target=_blank rel=noopener>brotli</a> compression algorithm. WOFF was designed specifically to be delivered over the internet and support is still a bit limited outside of browsers.</p></li></ul><p>While we have mainly talked about font files as containers for the shape of glyphs, they also carries a lot of other information needed for rendering text in a way pleasant for reading. Font level information records a lot of stylistic information about typeface/font, statistics on the number of glyphs and how many different mappings between character encodings and glyphs it contains, and overall sizing information such as the maximum descend of the font, the position of an underline relative to the baseline etc. systemfonts provdies a convenient way to access this data from R:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nf>dplyr</span><span class=nf>::</span><span class=nf><a href=https://pillar.r-lib.org/reference/glimpse.html>glimpse</a></span><span class=o>(</span><span class=nf>systemfonts</span><span class=nf>::</span><span class=nf><a href=https://systemfonts.r-lib.org/reference/font_info.html>font_info</a></span><span class=o>(</span>family <span class=o>=</span> <span class=s>"Helvetica"</span><span class=o>)</span><span class=o>)</span></span>
<span><span class=c>#&gt; Rows: 1</span></span>
<span><span class=c>#&gt; Columns: 24</span></span>
<span><span class=c>#&gt; $ path               <span style=color:#555;font-style:italic>&lt;chr&gt;</span> "/System/Library/Fonts/Helvetica.ttc"</span></span>
<span><span class=c>#&gt; $ index              <span style=color:#555;font-style:italic>&lt;int&gt;</span> 0</span></span>
<span><span class=c>#&gt; $ family             <span style=color:#555;font-style:italic>&lt;chr&gt;</span> "Helvetica"</span></span>
<span><span class=c>#&gt; $ style              <span style=color:#555;font-style:italic>&lt;chr&gt;</span> "Regular"</span></span>
<span><span class=c>#&gt; $ italic             <span style=color:#555;font-style:italic>&lt;lgl&gt;</span> FALSE</span></span>
<span><span class=c>#&gt; $ bold               <span style=color:#555;font-style:italic>&lt;lgl&gt;</span> FALSE</span></span>
<span><span class=c>#&gt; $ monospace          <span style=color:#555;font-style:italic>&lt;lgl&gt;</span> FALSE</span></span>
<span><span class=c>#&gt; $ weight             <span style=color:#555;font-style:italic>&lt;ord&gt;</span> normal</span></span>
<span><span class=c>#&gt; $ width              <span style=color:#555;font-style:italic>&lt;ord&gt;</span> normal</span></span>
<span><span class=c>#&gt; $ kerning            <span style=color:#555;font-style:italic>&lt;lgl&gt;</span> FALSE</span></span>
<span><span class=c>#&gt; $ color              <span style=color:#555;font-style:italic>&lt;lgl&gt;</span> FALSE</span></span>
<span><span class=c>#&gt; $ scalable           <span style=color:#555;font-style:italic>&lt;lgl&gt;</span> TRUE</span></span>
<span><span class=c>#&gt; $ vertical           <span style=color:#555;font-style:italic>&lt;lgl&gt;</span> FALSE</span></span>
<span><span class=c>#&gt; $ n_glyphs           <span style=color:#555;font-style:italic>&lt;int&gt;</span> 2252</span></span>
<span><span class=c>#&gt; $ n_sizes            <span style=color:#555;font-style:italic>&lt;int&gt;</span> 0</span></span>
<span><span class=c>#&gt; $ n_charmaps         <span style=color:#555;font-style:italic>&lt;int&gt;</span> 10</span></span>
<span><span class=c>#&gt; $ bbox               <span style=color:#555;font-style:italic>&lt;list&gt;</span> &lt;-11.406250, 17.343750, -5.765625, 13.453125&gt;</span></span>
<span><span class=c>#&gt; $ max_ascend         <span style=color:#555;font-style:italic>&lt;dbl&gt;</span> 9.234375</span></span>
<span><span class=c>#&gt; $ max_descend        <span style=color:#555;font-style:italic>&lt;dbl&gt;</span> -2.765625</span></span>
<span><span class=c>#&gt; $ max_advance_width  <span style=color:#555;font-style:italic>&lt;dbl&gt;</span> 18</span></span>
<span><span class=c>#&gt; $ max_advance_height <span style=color:#555;font-style:italic>&lt;dbl&gt;</span> 12</span></span>
<span><span class=c>#&gt; $ lineheight         <span style=color:#555;font-style:italic>&lt;dbl&gt;</span> 12</span></span>
<span><span class=c>#&gt; $ underline_pos      <span style=color:#555;font-style:italic>&lt;dbl&gt;</span> -1.203125</span></span>
<span><span class=c>#&gt; $ underline_size     <span style=color:#555;font-style:italic>&lt;dbl&gt;</span> 0.59375</span></span>
<span></span></code></pre></div><p>Further, for each glyph there is a range of information in addition to its shape:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nf>systemfonts</span><span class=nf>::</span><span class=nf><a href=https://systemfonts.r-lib.org/reference/glyph_info.html>glyph_info</a></span><span class=o>(</span><span class=s>"j"</span>, family <span class=o>=</span> <span class=s>"Helvetica"</span>, size <span class=o>=</span> <span class=m>30</span><span class=o>)</span></span>
<span><span class=c>#&gt; <span style=color:#555># A tibble: 1 √ó 9</span></span></span>
<span><span class=c>#&gt;   glyph index width height x_bearing y_bearing x_advance y_advance bbox     </span></span>
<span><span class=c>#&gt;   <span style=color:#555;font-style:italic>&lt;chr&gt;</span> <span style=color:#555;font-style:italic>&lt;int&gt;</span> <span style=color:#555;font-style:italic>&lt;dbl&gt;</span>  <span style=color:#555;font-style:italic>&lt;dbl&gt;</span>     <span style=color:#555;font-style:italic>&lt;dbl&gt;</span>     <span style=color:#555;font-style:italic>&lt;dbl&gt;</span>     <span style=color:#555;font-style:italic>&lt;dbl&gt;</span>     <span style=color:#555;font-style:italic>&lt;dbl&gt;</span> <span style=color:#555;font-style:italic>&lt;list&gt;</span>   </span></span>
<span><span class=c>#&gt; <span style=color:#555>1</span> j        77     6     27        -<span style=color:#b00>1</span>        21         7         0 <span style=color:#555>&lt;dbl [4]&gt;</span></span></span>
<span></span></code></pre></div><p>These terms are more easily understood with a diagram:</p><div class=highlight><p><img src=figs/unnamed-chunk-6-1.png width=700px style=display:block;margin:auto></p></div><p>The <code>x_advance</code> in particular is important when rendering text because it tells you how far to move to the right before rendering the next glyph (ignoring for a bit the concept of kerning)</p><h3 id=text-shaping>Text shaping
<a href=#text-shaping><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>The next important concept to understand is <strong>text shaping</strong>, which, in the simplest of terms, is to convert a succession of characters into a sequence of glyphs along with their locations. Important here is the distinction between <strong>characters</strong>, the things you think of as letters, and <strong>glyphs</strong>, which is what the font will draw. For example, think of the character &ldquo;f&rdquo;, which is often tricky to draw because the &ldquo;hook&rdquo; of the f can interfere with other characters. To solve this problem, many typefaces include <strong>ligatures</strong>, like &ldquo;Ô¨Å&rdquo;, which are used for specific pairs of characaters. Ligatures are extremely important for languages like Arabic.</p><p>A few of the challenges of text shaping include kerning, bidirectional text, and font substitution. <strong>Kerning</strong> is the adjustment of distance between specific pairs of characters. For example, you can put &ldquo;VM&rdquo; a little closer together but &ldquo;OO&rdquo; needs to be a little further apart. Kerning is an integral part of all modern text rendering and you will almost solemnly notice it when it is absent (or worse,
<a href=https://www.fastcompany.com/91324550/kerning-on-pope-francis-tomb-is-a-travesty target=_blank rel=noopener>wrongly applied</a>).</p><p>Not every language writes text in the same direction, but regardless of your native script, you are likely to use arabic numerals which are always written left-to-right. This gives rise to the challenge of <strong>bidirectional</strong> (or bidi) text, which mixes text flowing in different directions. This imposes a whole new range of challenges!</p><p>Finally, you might request a character that a font doesn&rsquo;t contain. One way to deal with this is to render a glyph representing a missing glyph, usually an empty box or a question mark. But it&rsquo;s typically more useful to use the correct glyph from a different font. This is called <strong>font fallback</strong> and happens all the time for emojis, but can also happen when you suddenly change script without bothering to pick a new font. Font fallback is an imprecise science, typically relying on an operating system font that has a very large number of characters, but might look very different from your existing font.</p><p>Once you have determined the order and location of glyphs, you are still not done. Text often needs to be wrapped to fit into a specific width, it may need a specific justification, perhaps, indentation or tracking must be applied, etc. Thankfully, all of this is generally a matter of (often gnarly) math that you just have to get right. That is, all except text wrapping which should happen at the right boundaries, and may need to break up a word and inserting a hyphen etc.</p><p>Like I said, the pit of despair is bottomless&mldr;</p><h2 id=font-handling-in-r>Font handling in R
<a href=#font-handling-in-r><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>You hopefully arrive at this section with an appreciation of the horrors that goes into rendering text. If not, maybe this
<a href=https://faultlore.com/blah/text-hates-you/ target=_blank rel=noopener>blog post</a> will convince you.</p><p>Are you still here? Good.</p><p>Now that you understand the basics of what goes into handling fonts and text, we can now discuss the details of fonts in R specifically.</p><h3 id=fonts-and-text-from-a-user-perspective>Fonts and text from a user perspective
<a href=#fonts-and-text-from-a-user-perspective><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>The users perception of working with fonts in R is largely shaped by plots. This means using either base or grid graphics or one of the packages that have been build on top of it, like
<a href=https://ggplot2.tidyverse.org target=_blank rel=noopener>ggplot2</a>. While the choice of tool will affect <em>where</em> you specify the font to use, they generally agree on how to specify it.</p><table style=width:99%><col style=width:37%><col style=width:5%><col style=width:18%><col style=width:37%><thead><tr><th>Graphic system</th><th>Argument</th><th></th><th></th></tr></thead><tbody><tr><td></td><td><em>Typeface</em></td><td><em>Font</em></td><td><em>Size</em></td></tr><tr><td><p><strong>Base</strong></p><p><em>Arguments are passed to <code>par()</code> to set globally or directly to the call that renders text (e.g.¬†<code>text()</code>)</em></p></td><td><code>family</code></td><td><code>font</code></td><td><code>cra</code> (pixels) or <code>cin</code> (inches) multiplied by <code>cex</code></td></tr><tr><td><p><strong>Grid</strong></p><p>Arguments are passed to the <code>gp</code> argument of relevant grobs using the <code>gpar()</code> constructor</p></td><td><code>fontfamily</code></td><td><code>fontface</code></td><td><code>fontsize</code> (points) multiplied by <code>cex</code></td></tr><tr><td><p><strong>ggplot2</strong></p><p>Arguments are set in <code>element_text()</code> to alter theme fonts or directly in the geom call to alter geom fonts</p></td><td><code>family</code></td><td><code>face</code> (in <code>element_text()</code>) or <code>fontface</code> (in geoms)</td><td><code>size</code> (points when used in <code>element_text()</code>, depends on the value of <code>size.unit</code> argument when used in geom)</td></tr></tbody></table><p>From the table it is clear that in R <code>fontfamily</code>/<code>family</code> is used to describe the typeface and <code>font</code>/<code>fontface</code>/<code>face</code> is used to select a font from the typeface. Size settings is just a plain mess.</p><p>The major limitation in <code>fontface</code> (and friends) is that it takes a number, not a string, and you can only select from four options: <code>1</code>: plain, <code>2</code>: bold, <code>3</code>: italic, and <code>4</code>: bold-italic. This means, for example, that there&rsquo;s no way to select Futura Condensed Extra Bold. Another limitation is that it&rsquo;s not possible to specify any font variations such as using tabular numbers or stylistic ligatures.</p><h3 id=fonts-and-text-from-a-graphics-device-perspective>Fonts and text from a graphics device perspective
<a href=#fonts-and-text-from-a-graphics-device-perspective><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>In R, a graphics device is the part responsible for doing the rendering you request and put it on your screen or in a file. When you call
<a href=https://rdrr.io/r/grDevices/png.html target=_blank rel=noopener><code>png()</code></a> or
<a href=https://ragg.r-lib.org/reference/agg_png.html target=_blank rel=noopener><code>ragg::agg_png()</code></a> you open up a graphics device that will receive all the plotting instructions from R. Both graphics devices will ultimately produce the same file type (PNG), but how they choose to handle and respond to the plotting instructions may differ (greatly). Nowhere is this difference more true than when it comes to text rendering.</p><p>After a user has made a call that renders some text, it is funneled through the graphic system (base or grid), handed off to the graphics engine, which ultimately asks the graphics device to render the text. From the perspective of the graphics device it is much the same information that the user provided which are presented to it. The
<a href=https://rdrr.io/r/graphics/text.html target=_blank rel=noopener><code>text()</code></a> method of the device are given an array of characters, the typeface, the size in points, and an integer denoting if the style is regular, bold, italic, or bold-italic.</p><figure><img src=text_call_flow.svg data-fig-alt="A diagram showing the flow of text rendering instructions from ggplot2, grid, the graphics engine, and down to the graphics device. Very little changes in the available information about the font during the flow" alt="Flow of font information through the R rendering stack"><figcaption aria-hidden=true>Flow of font information through the R rendering stack</figcaption></figure><p>This means that it is up to the graphics device to find the approprate font file (using the provided typeface and font style) and shape the text with all that that entails. This is a lot of work, which is why text is handled so inconsistently between graphics devices. Issues can range from not being able to find fonts installed on the computer, to not providing font fallback mechanisms, or even handling right-to-left text. It may also be that certain font file formats are not well supported so that e.g.¬†color emojis are not rendered correctly.</p><p>There have been a number of efforts to resolve these problems over the years:</p><ul><li><p><strong>extrafont</strong>: Developed by Winston Chang,
<a href=https://github.com/wch/extrafont target=_blank rel=noopener>extrafont</a> sought to mainly improve the situation for the
<a href=https://rdrr.io/r/grDevices/pdf.html target=_blank rel=noopener><code>pdf()</code></a> device which generally only had access to the postscript fonts that comes with R. The package allows the
<a href=https://rdrr.io/r/grDevices/pdf.html target=_blank rel=noopener><code>pdf()</code></a> device to get access to TrueType fonts installed on the computer, as well as provide means for embedding the font into the PDF so that it can be opened on systems where the font is not installed. (It also provides the capabilities to the Windows
<a href=https://rdrr.io/r/grDevices/png.html target=_blank rel=noopener><code>png()</code></a> device).</p></li><li><p><strong>sysfonts</strong> and <strong>showtext</strong>. These packages are developed by Yixuan Qiu and provide support for system fonts to all graphics devices, by hijacking the
<a href=https://rdrr.io/r/graphics/text.html target=_blank rel=noopener><code>text()</code></a> method of the graphics device to treat text as polygons or raster images. This guarantees your plots will look the same on every device, but it doesn&rsquo;t do advanced text shaping, so there&rsquo;s no support for ligatures or font substitution. Additionally, it produces large files with inaccessible text when used to produce pdf and svg outputs.</p></li><li><p><strong>systemfonts</strong> and <strong>textshaping</strong>. These packages are developed by me to provide a soup-to-nuts solution to text rendering for graphics devices.
<a href=https://systemfonts.r-lib.org target=_blank rel=noopener>systemfonts</a> provides access to fonts installed on the system along with font fallback mechanisms, registration of non-system fonts, reading of font files etc.
<a href=https://github.com/r-lib/textshaping target=_blank rel=noopener>textshaping</a> builds on top of systemfonts and provides a fully modern engine for shaping text. The functionality is exposed both at the R level and at the C level, so that graphics devices can directly access to font lookup and shaping.</p></li></ul><p>We will fosus on systemfonts, because it&rsquo;s designed to give R a modern text rendering stack. That&rsquo;s unfortunately impossible without coordination with the graphics device, which means that to use all these features you need a supported graphics device. There are currently two options:</p><ul><li>The
<a href=https://ragg.r-lib.org target=_blank rel=noopener>ragg</a> package provides graphics devices for rendering raster graphics in a variety of formats (PNG, JPEG, TIFF) and uses systemfonts and textshaping extensively.</li><li>The
<a href=https://svglite.r-lib.org target=_blank rel=noopener>svglite</a> package provides a graphic device for rendering vector graphics to SVG using systemfonts and textshaping for text.</li></ul><p>You might notice there&rsquo;s currently a big hole in this workflow: PDFs. This is something we plan to work on in the future.</p><h2 id=a-systemfonts-based-workflow>A systemfonts based workflow
<a href=#a-systemfonts-based-workflow><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>With all that said, how do you actually use systemfonts to use custom fonts in your plots? First, you&rsquo;ll need to use ragg or svglite.</p><h3 id=using-ragg>Using ragg
<a href=#using-ragg><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>While there is no way to unilaterally make
<a href=https://ragg.r-lib.org/reference/agg_png.html target=_blank rel=noopener><code>ragg::agg_png()</code></a> the default everywhere, it&rsquo;s possible to get close:</p><ul><li><p>Positron: recent versions automatically use ragg for the plot pane if it&rsquo;s installed.</p></li><li><p>RStudio IDE: set &ldquo;AGG&rdquo; as the backend under Global Options > General > Graphics.</p></li><li><p><a href=https://ggplot2.tidyverse.org/reference/ggsave.html target=_blank rel=noopener><code>ggplot2::ggsave()</code></a>: ragg will be automatically used for raster output if installed.</p></li><li><p>R Markdown and Quarto: you need to set the <code>dev</code> option to <code>"ragg_png"</code>. You can either do this with code:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=c1>#| include: false</span>
<span class=n>knitr</span><span class=o>::</span><span class=n>opts_chunk</span><span class=o>$</span><span class=nf>set</span><span class=p>(</span><span class=n>dev</span> <span class=o>=</span> <span class=s>&#34;ragg_png&#34;</span><span class=p>)</span>
</code></pre></div><p>Or in Quarto, you can set it in the yaml metadata:</p><div class=highlight><pre class=chroma><code class=language-yaml data-lang=yaml>---<span class=w>
</span><span class=w></span><span class=k>title</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;My Document&#34;</span><span class=w>
</span><span class=w></span><span class=k>format</span><span class=p>:</span><span class=w> </span>html<span class=w>
</span><span class=w></span><span class=k>knitr</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=k>opts_chunk</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=k>dev</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;ragg_png&#34;</span><span class=w>
</span><span class=w></span>---<span class=w>
</span></code></pre></div></li></ul><p>If you want to use a font installed on your computer, you&rsquo;re done!</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nf>grid</span><span class=nf>::</span><span class=nf><a href=https://rdrr.io/r/grid/grid.text.html>grid.text</a></span><span class=o>(</span></span>
<span>  <span class=s>"FUTURA üéâ"</span>,</span>
<span>  gp <span class=o>=</span> <span class=nf>grid</span><span class=nf>::</span><span class=nf><a href=https://rdrr.io/r/grid/gpar.html>gpar</a></span><span class=o>(</span>fontfamily <span class=o>=</span> <span class=s>"Futura"</span>, fontface <span class=o>=</span> <span class=m>3</span>, fontsize <span class=o>=</span> <span class=m>30</span><span class=o>)</span></span>
<span><span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-7-1.png width=700px style=display:block;margin:auto></p></div><p>Or, if using ggplot2</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nf><a href=https://ggplot2.tidyverse.org/reference/ggplot.html>ggplot</a></span><span class=o>(</span><span class=nf><a href=https://rdrr.io/r/stats/na.fail.html>na.omit</a></span><span class=o>(</span><span class=nv>penguins</span><span class=o>)</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/geom_point.html>geom_point</a></span><span class=o>(</span><span class=nf><a href=https://ggplot2.tidyverse.org/reference/aes.html>aes</a></span><span class=o>(</span>x <span class=o>=</span> <span class=nv>bill_len</span>, y <span class=o>=</span> <span class=nv>body_mass</span>, colour <span class=o>=</span> <span class=nv>species</span><span class=o>)</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/labs.html>labs</a></span><span class=o>(</span>x <span class=o>=</span> <span class=s>"Bill Length"</span>, y <span class=o>=</span> <span class=s>"Body Mass"</span>, colour <span class=o>=</span> <span class=s>"Species"</span><span class=o>)</span> <span class=o>+</span></span>
<span>  <span class=nf><a href=https://ggplot2.tidyverse.org/reference/ggtheme.html>theme_minimal</a></span><span class=o>(</span>base_family <span class=o>=</span> <span class=s>"Futura"</span><span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-8-1.png width=700px style=display:block;margin:auto></p></div><p>If the results don&rsquo;t look as you expect, you can use various systemfonts helpers to diagnose the problem:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nf>systemfonts</span><span class=nf>::</span><span class=nf><a href=https://systemfonts.r-lib.org/reference/match_fonts.html>match_fonts</a></span><span class=o>(</span><span class=s>"Futura"</span>, weight <span class=o>=</span> <span class=s>"bold"</span><span class=o>)</span></span>
<span><span class=c>#&gt; <span style=color:#555># A tibble: 1 √ó 3</span></span></span>
<span><span class=c>#&gt;   path                                          index features  </span></span>
<span><span class=c>#&gt;   <span style=color:#555;font-style:italic>&lt;chr&gt;</span>                                         <span style=color:#555;font-style:italic>&lt;int&gt;</span> <span style=color:#555;font-style:italic>&lt;list&gt;</span>    </span></span>
<span><span class=c>#&gt; <span style=color:#555>1</span> /System/Library/Fonts/Supplemental/Futura.ttc     2 <span style=color:#555>&lt;font_ftr&gt;</span></span></span>
<span></span><span><span class=nf>systemfonts</span><span class=nf>::</span><span class=nf><a href=https://systemfonts.r-lib.org/reference/font_fallback.html>font_fallback</a></span><span class=o>(</span><span class=s>"üéâ"</span>, family <span class=o>=</span> <span class=s>"Futura"</span>, weight <span class=o>=</span> <span class=s>"bold"</span><span class=o>)</span></span>
<span><span class=c>#&gt;                                          path index</span></span>
<span><span class=c>#&gt; 1 /System/Library/Fonts/Apple Color Emoji.ttc     0</span></span>
<span></span></code></pre></div><p>If you want to see all the fonts that are available for use, you can use
<a href=https://systemfonts.r-lib.org/reference/system_fonts.html target=_blank rel=noopener><code>systemfonts::system_fonts()</code></a></p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nf>systemfonts</span><span class=nf>::</span><span class=nf><a href=https://systemfonts.r-lib.org/reference/system_fonts.html>system_fonts</a></span><span class=o>(</span><span class=o>)</span></span></code></pre></div><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=c>#&gt; <span style=color:#555># A tibble: 570 √ó 9</span></span></span>
<span><span class=c>#&gt;    path                                         index name  family style weight width italic monospace</span></span>
<span><span class=c>#&gt;    <span style=color:#555;font-style:italic>&lt;chr&gt;</span>                                        <span style=color:#555;font-style:italic>&lt;int&gt;</span> <span style=color:#555;font-style:italic>&lt;chr&gt;</span> <span style=color:#555;font-style:italic>&lt;chr&gt;</span>  <span style=color:#555;font-style:italic>&lt;chr&gt;</span> <span style=color:#555;font-style:italic>&lt;ord&gt;</span>  <span style=color:#555;font-style:italic>&lt;ord&gt;</span> <span style=color:#555;font-style:italic>&lt;lgl&gt;</span>  <span style=color:#555;font-style:italic>&lt;lgl&gt;</span>    </span></span>
<span><span class=c>#&gt; <span style=color:#555> 1</span> /System/Library/Fonts/Supplemental/Rockwell‚Ä¶     2 Rock‚Ä¶ Rockw‚Ä¶ Bold  bold   norm‚Ä¶ FALSE  FALSE    </span></span>
<span><span class=c>#&gt; <span style=color:#555> 2</span> /System/Library/Fonts/Noteworthy.ttc             0 Note‚Ä¶ Notew‚Ä¶ Light normal norm‚Ä¶ FALSE  FALSE    </span></span>
<span><span class=c>#&gt; <span style=color:#555> 3</span> /System/Library/Fonts/Supplemental/Devanaga‚Ä¶     1 Deva‚Ä¶ Devan‚Ä¶ Bold  bold   norm‚Ä¶ FALSE  FALSE    </span></span>
<span><span class=c>#&gt; <span style=color:#555> 4</span> /System/Library/Fonts/Supplemental/Kannada ‚Ä¶     0 Kann‚Ä¶ Kanna‚Ä¶ Regu‚Ä¶ normal norm‚Ä¶ FALSE  FALSE    </span></span>
<span><span class=c>#&gt; <span style=color:#555> 5</span> /System/Library/Fonts/Supplemental/Verdana ‚Ä¶     0 Verd‚Ä¶ Verda‚Ä¶ Bold  bold   norm‚Ä¶ FALSE  FALSE    </span></span>
<span><span class=c>#&gt; <span style=color:#555> 6</span> /System/Library/Fonts/ArialHB.ttc                8 Aria‚Ä¶ Arial‚Ä¶ Light light  norm‚Ä¶ FALSE  FALSE    </span></span>
<span><span class=c>#&gt; <span style=color:#555> 7</span> /System/Library/Fonts/AppleSDGothicNeo.ttc      10 Appl‚Ä¶ Apple‚Ä¶ Thin  thin   norm‚Ä¶ FALSE  FALSE    </span></span>
<span><span class=c>#&gt; <span style=color:#555> 8</span> /System/Library/Fonts/Supplemental/DecoType‚Ä¶     0 Deco‚Ä¶ DecoT‚Ä¶ Regu‚Ä¶ normal norm‚Ä¶ FALSE  FALSE    </span></span>
<span><span class=c>#&gt; <span style=color:#555> 9</span> /System/Library/Fonts/Supplemental/Trebuche‚Ä¶     0 Treb‚Ä¶ Trebu‚Ä¶ Ital‚Ä¶ normal norm‚Ä¶ TRUE   FALSE    </span></span>
<span><span class=c>#&gt; <span style=color:#555>10</span> /System/Library/Fonts/Supplemental/Khmer MN‚Ä¶     0 Khme‚Ä¶ Khmer‚Ä¶ Regu‚Ä¶ normal norm‚Ä¶ FALSE  FALSE    </span></span>
<span><span class=c>#&gt; <span style=color:#555># ‚Ñπ 560 more rows</span></span></span>
<span></span></code></pre></div><h3 id=extra-font-styles>Extra font styles
<a href=#extra-font-styles><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>As we discussed above, the R interface only allows you to select between four styles: plain, italic, bold, and bold-italic. If you want to use a thin font, you have no way of communicating this wish to the device. To overcome this, systemfonts provides <code>register_variant()</code> which allows you to register a font with a new typeface name. For example, to use the thin font from the Avenir Next typeface you can register it as follows:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nf>systemfonts</span><span class=nf>::</span><span class=nf><a href=https://systemfonts.r-lib.org/reference/register_variant.html>register_variant</a></span><span class=o>(</span></span>
<span>  name <span class=o>=</span> <span class=s>"Avenir Thin"</span>,</span>
<span>  family <span class=o>=</span> <span class=s>"Avenir Next"</span>,</span>
<span>  weight <span class=o>=</span> <span class=s>"thin"</span></span>
<span><span class=o>)</span></span></code></pre></div><p>Now you can use Avenir Thin where you would otherwise specify the typeface:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nf>grid</span><span class=nf>::</span><span class=nf><a href=https://rdrr.io/r/grid/grid.text.html>grid.text</a></span><span class=o>(</span></span>
<span>  <span class=s>"Thin weight is soo classy"</span>,</span>
<span>  gp <span class=o>=</span> <span class=nf>grid</span><span class=nf>::</span><span class=nf><a href=https://rdrr.io/r/grid/gpar.html>gpar</a></span><span class=o>(</span>fontfamily <span class=o>=</span> <span class=s>"Avenir Thin"</span>, fontsize <span class=o>=</span> <span class=m>30</span><span class=o>)</span></span>
<span><span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-13-1.png width=700px style=display:block;margin:auto></p></div><p><code>register_variant()</code> also allows you to turn on font features otherwise hidden away:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nf>systemfonts</span><span class=nf>::</span><span class=nf><a href=https://systemfonts.r-lib.org/reference/register_variant.html>register_variant</a></span><span class=o>(</span></span>
<span>  name <span class=o>=</span> <span class=s>"Avenir Small Caps"</span>,</span>
<span>  family <span class=o>=</span> <span class=s>"Avenir Next"</span>,</span>
<span>  features <span class=o>=</span> <span class=nf>systemfonts</span><span class=nf>::</span><span class=nf><a href=https://systemfonts.r-lib.org/reference/font_feature.html>font_feature</a></span><span class=o>(</span></span>
<span>    letters <span class=o>=</span> <span class=s>"small_caps"</span></span>
<span>  <span class=o>)</span></span>
<span><span class=o>)</span></span>
<span><span class=nf>grid</span><span class=nf>::</span><span class=nf><a href=https://rdrr.io/r/grid/grid.text.html>grid.text</a></span><span class=o>(</span></span>
<span>  <span class=s>"All caps ‚Äî Small caps"</span>,</span>
<span>  gp <span class=o>=</span> <span class=nf>grid</span><span class=nf>::</span><span class=nf><a href=https://rdrr.io/r/grid/gpar.html>gpar</a></span><span class=o>(</span>fontfamily <span class=o>=</span> <span class=s>"Avenir Small Caps"</span>, fontsize <span class=o>=</span> <span class=m>30</span><span class=o>)</span></span>
<span><span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-14-1.png width=700px style=display:block;margin:auto></p></div><h3 id=fonts-from-other-places>Fonts from other places
<a href=#fonts-from-other-places><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>Historically, systemfonts primary role was to access the font installed on your computer, the <strong>system fonts</strong>. But what if you&rsquo;re using a computer where you don&rsquo;t have the rights to install new fonts, or you don&rsquo;t want the hassle of installing a font just to use it for a single plot? That&rsquo;s the problem solved by <code>systemfonts::add_font()</code> which makes it easy to use a font based on a path. But in many cases you don&rsquo;t even need that as systemfont now scans <code>./fonts</code> and <code>~/fonts</code> and adds any font files it find. This means that you can put personal fonts in a fonts folder in your home directory, and project fonts in a fonts directory at the root of the project. This is a great way to ensure that specific fonts are available when you deploy some code to a server.</p><p>And you don&rsquo;t even need to leave R to populate these folders.
<a href=https://systemfonts.r-lib.org/reference/web-fonts.html target=_blank rel=noopener><code>systemfonts::get_from_google_fonts()</code></a> will download and install a google font in <code>~/fonts</code>:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nf>systemfonts</span><span class=nf>::</span><span class=nf><a href=https://systemfonts.r-lib.org/reference/web-fonts.html>get_from_google_fonts</a></span><span class=o>(</span><span class=s>"Barrio"</span><span class=o>)</span></span>
<span></span>
<span><span class=nf>grid</span><span class=nf>::</span><span class=nf><a href=https://rdrr.io/r/grid/grid.text.html>grid.text</a></span><span class=o>(</span></span>
<span>  <span class=s>"A new font a day keeps Tufte away"</span>,</span>
<span>  gp <span class=o>=</span> <span class=nf>grid</span><span class=nf>::</span><span class=nf><a href=https://rdrr.io/r/grid/gpar.html>gpar</a></span><span class=o>(</span>fontfamily <span class=o>=</span> <span class=s>"Barrio"</span>, fontsize <span class=o>=</span> <span class=m>30</span><span class=o>)</span></span>
<span><span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-15-1.png width=700px style=display:block;margin:auto></p></div><p>And if you want to make sure this code works for anyone using your code (regardless of whether or not they already have the font installed), you can use
<a href=https://systemfonts.r-lib.org/reference/require_font.html target=_blank rel=noopener><code>systemfonts::require_font()</code></a>. If the font isn&rsquo;t already installed, this function download it from one of the repositories it knows about. If it can&rsquo;t find it it will either throw an error (the default) or remap the name to another font so that plotting will still succeed.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nf>systemfonts</span><span class=nf>::</span><span class=nf><a href=https://systemfonts.r-lib.org/reference/require_font.html>require_font</a></span><span class=o>(</span><span class=s>"Rubik Distressed"</span><span class=o>)</span></span>
<span><span class=c>#&gt; Trying Google Fonts... Found! Downloading font to /var/folders/l4/tvfrd0ps4dqdr2z7kvnl9xh40000gn/T//Rtmp2qw4bE</span></span>
<span></span><span></span>
<span><span class=nf>grid</span><span class=nf>::</span><span class=nf><a href=https://rdrr.io/r/grid/grid.text.html>grid.text</a></span><span class=o>(</span></span>
<span>  <span class=s>"There are no bad fonts\nonly bad text"</span>,</span>
<span>  gp <span class=o>=</span> <span class=nf>grid</span><span class=nf>::</span><span class=nf><a href=https://rdrr.io/r/grid/gpar.html>gpar</a></span><span class=o>(</span>fontfamily <span class=o>=</span> <span class=s>"Rubik Distressed"</span>, fontsize <span class=o>=</span> <span class=m>30</span><span class=o>)</span></span>
<span><span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-16-1.png width=700px style=display:block;margin:auto></p></div><p>By default, <code>require_font()</code> places new fonts in a temporary folder so it doesn&rsquo;t pollute your carefully curated collection of fonts.</p><h3 id=font-embedding-in-svg>Font embedding in SVG
<a href=#font-embedding-in-svg><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>Fonts work a little differently in vector formats like SVG. These formats include the raw text and only render the font when you open the file. This makes for small, accessible files with crisp text at every level of zoom. But it comes with a price: since the text is rendered when it&rsquo;s opened, it relies on the font in use being available on the viewer&rsquo;s computer. This obviously puts you at the mercy of their font selection, so if you want consistent outputs you&rsquo;ll need to <strong>embed</strong> the font.</p><p>In SVG, you can embed fonts using an <code>@import</code> statement in the stylesheet, and can point to a web resource so the SVG doesn&rsquo;t need to contain the entire font. systemfonts provides facilities to generate URLs for import statements and can provide them in a variety of formats:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nf>systemfonts</span><span class=nf>::</span><span class=nf><a href=https://systemfonts.r-lib.org/reference/fonts_as_import.html>fonts_as_import</a></span><span class=o>(</span><span class=s>"Barrio"</span><span class=o>)</span></span>
<span><span class=c>#&gt; [1] "https://fonts.bunny.net/css2?family=Barrio&amp;display=swap"</span></span>
<span></span><span><span class=nf>systemfonts</span><span class=nf>::</span><span class=nf><a href=https://systemfonts.r-lib.org/reference/fonts_as_import.html>fonts_as_import</a></span><span class=o>(</span><span class=s>"Rubik Distressed"</span>, type <span class=o>=</span> <span class=s>"link"</span><span class=o>)</span></span>
<span><span class=c>#&gt; [1] "&lt;link rel=\"stylesheet\" href=\"https://fonts.bunny.net/css2?family=Rubik+Distressed&amp;display=swap\"/&gt;"</span></span>
<span></span></code></pre></div><p>Further, if the font is not available from an online repository, it can embed the font data directly into the URL:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nf><a href=https://rdrr.io/r/base/substr.html>substr</a></span><span class=o>(</span><span class=nf>systemfonts</span><span class=nf>::</span><span class=nf><a href=https://systemfonts.r-lib.org/reference/fonts_as_import.html>fonts_as_import</a></span><span class=o>(</span><span class=s>"Chalkduster"</span><span class=o>)</span>, <span class=m>1</span>, <span class=m>200</span><span class=o>)</span></span>
<span><span class=c>#&gt; [1] "data:text/css,@font-face%20%7B%0A%20%20font-family:%20%22Chalkduster%22;%0A%20%20src:%20url(data:font/ttf;charset=utf-8;base64,AAEAAAAMAIAAAwC4T1MvMmk8+wsAAAFIAAAAYGNtYXBJhgfNAAAEOAAACspnbHlmLDPYGwAAf"</span></span>
<span></span></code></pre></div><p>svglite uses this feature to allow seamless font embedding with the <code>web_fonts</code> argument. It can take a URL as returned by <code>fonts_as_import()</code> or just the name of the typeface and the URL will automatically be resolved. Look at line 6 in the SVG generated below</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nv>svg</span> <span class=o>&lt;-</span> <span class=nf>svglite</span><span class=nf>::</span><span class=nf><a href=https://svglite.r-lib.org/reference/svgstring.html>svgstring</a></span><span class=o>(</span>web_fonts <span class=o>=</span> <span class=s>"Barrio"</span><span class=o>)</span></span>
<span><span class=nf>grid</span><span class=nf>::</span><span class=nf><a href=https://rdrr.io/r/grid/grid.text.html>grid.text</a></span><span class=o>(</span><span class=s>"Example"</span>, gp <span class=o>=</span> <span class=nf>grid</span><span class=nf>::</span><span class=nf><a href=https://rdrr.io/r/grid/gpar.html>gpar</a></span><span class=o>(</span>fontfamily <span class=o>=</span> <span class=s>"Barrio"</span><span class=o>)</span><span class=o>)</span></span>
<span><span class=nf><a href=https://rdrr.io/r/base/invisible.html>invisible</a></span><span class=o>(</span><span class=nf><a href=https://rdrr.io/r/grDevices/dev.html>dev.off</a></span><span class=o>(</span><span class=o>)</span><span class=o>)</span></span>
<span><span class=nf><a href=https://rdrr.io/r/grDevices/cairo.html>svg</a></span><span class=o>(</span><span class=o>)</span></span>
<span><span class=c>#&gt; &lt;?xml version='1.0' encoding='UTF-8' ?&gt;</span></span>
<span><span class=c>#&gt; &lt;svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' width='720.00pt' height='576.00pt' viewBox='0 0 720.00 576.00'&gt;</span></span>
<span><span class=c>#&gt; &lt;g class='svglite'&gt;</span></span>
<span><span class=c>#&gt; &lt;defs&gt;</span></span>
<span><span class=c>#&gt;   &lt;style type='text/css'&gt;&lt;![CDATA[</span></span>
<span><span class=c>#&gt;     @import url('https://fonts.bunny.net/css2?family=Barrio&amp;display=swap');</span></span>
<span><span class=c>#&gt;     .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle &#123;</span></span>
<span><span class=c>#&gt;       fill: none;</span></span>
<span><span class=c>#&gt;       stroke: #000000;</span></span>
<span><span class=c>#&gt;       stroke-linecap: round;</span></span>
<span><span class=c>#&gt;       stroke-linejoin: round;</span></span>
<span><span class=c>#&gt;       stroke-miterlimit: 10.00;</span></span>
<span><span class=c>#&gt;     &#125;</span></span>
<span><span class=c>#&gt;     .svglite text &#123;</span></span>
<span><span class=c>#&gt;       white-space: pre;</span></span>
<span><span class=c>#&gt;     &#125;</span></span>
<span><span class=c>#&gt;     .svglite g.glyphgroup path &#123;</span></span>
<span><span class=c>#&gt;       fill: inherit;</span></span>
<span><span class=c>#&gt;       stroke: none;</span></span>
<span><span class=c>#&gt;     &#125;</span></span>
<span><span class=c>#&gt;   ]]&gt;&lt;/style&gt;</span></span>
<span><span class=c>#&gt; &lt;/defs&gt;</span></span>
<span><span class=c>#&gt; &lt;rect width='100%' height='100%' style='stroke: none; fill: #FFFFFF;'/&gt;</span></span>
<span><span class=c>#&gt; &lt;defs&gt;</span></span>
<span><span class=c>#&gt;   &lt;clipPath id='cpMC4wMHw3MjAuMDB8MC4wMHw1NzYuMDA='&gt;</span></span>
<span><span class=c>#&gt;     &lt;rect x='0.00' y='0.00' width='720.00' height='576.00' /&gt;</span></span>
<span><span class=c>#&gt;   &lt;/clipPath&gt;</span></span>
<span><span class=c>#&gt; &lt;/defs&gt;</span></span>
<span><span class=c>#&gt; &lt;g clip-path='url(#cpMC4wMHw3MjAuMDB8MC4wMHw1NzYuMDA=)'&gt;</span></span>
<span><span class=c>#&gt; &lt;text x='360.00' y='292.32' text-anchor='middle' style='font-size: 12.00px; font-family: "Barrio";' textLength='48.12px' lengthAdjust='spacingAndGlyphs'&gt;Example&lt;/text&gt;</span></span>
<span><span class=c>#&gt; &lt;/g&gt;</span></span>
<span><span class=c>#&gt; &lt;/g&gt;</span></span>
<span><span class=c>#&gt; &lt;/svg&gt;</span></span>
<span></span></code></pre></div><h2 id=want-more>Want more?
<a href=#want-more><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>This document has mainly focused on how to use the fonts you desire from within R. R has other limitations when it comes to text rendering specifically how to render text that consists of a mix of fonts. This has been solved by
<a href=https://marquee.r-lib.org target=_blank rel=noopener>marquee</a> and the curious soul can continue there in order to up their skills in rendering text with R</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span><span class=nf>grid</span><span class=nf>::</span><span class=nf><a href=https://rdrr.io/r/grid/grid.draw.html>grid.draw</a></span><span class=o>(</span></span>
<span>  <span class=nf>marquee</span><span class=nf>::</span><span class=nf><a href=https://marquee.r-lib.org/reference/marquee_grob.html>marquee_grob</a></span><span class=o>(</span></span>
<span>    <span class=s>"_This_ **is** the &#123;.red end&#125;"</span>,</span>
<span>    <span class=nf>marquee</span><span class=nf>::</span><span class=nf><a href=https://marquee.r-lib.org/reference/classic_style.html>classic_style</a></span><span class=o>(</span>base_size <span class=o>=</span> <span class=m>30</span><span class=o>)</span></span>
<span>  <span class=o>)</span></span>
<span><span class=o>)</span></span>
</code></pre><p><img src=figs/unnamed-chunk-20-1.png width=700px style=display:block;margin:auto></p></div><section class=footnotes role=doc-endnotes><hr><ol><li id=fn:1 role=doc-endnote><p>Be aware that the style name is at the discretion of the developer of the typeface. It is very common to see discrepancies between the style name and e.g.¬†the weight reported by the font (e.g.¬†Avenir Next Ultra Light is a <em>thin</em> weight font). <a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></section></div></div><div class=column25><div class="section hideOnMobile"><div class=sectionTitle>Contents</div><nav id=TableOfContents><ul><li><a href=#digital-typography>Digital typography</a></li><li><a href=#font-handling-in-r>Font handling in R</a></li><li><a href=#a-systemfonts-based-workflow>A systemfonts based workflow</a></li><li><a href=#want-more>Want more?</a></li></ul></nav></div><div class=section></div></div></div></div></div><div id=rStudioFooter class=band><div class=bandContent><div id=copyright>The tidyverse is proudly supported by <a class=rstudioLogo href=https://posit.co/ aria-label="Posit Homepage"></a></div><div id=logos><a href=https://www.tidyverse.org/google_privacy_policy>Privacy policy</a>
<a href=https://github.com/tidyverse class="footerLogo gitHub" aria-label="Tidyverse GitHub organization"></a><a href=https://twitter.com/hashtag/rstats class="footerLogo twitter" aria-label="rstats hashtag on twitter.com"></a></div></div></div></div></div><script src=/js/math-code.js></script><script type=text/x-mathjax-config>
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    processEscapes: true
  }
});
</script><script async src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><script type=application/javascript>var dnt=(navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack);var doNotTrack=(dnt=="1"||dnt=="yes");if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');if(window.sessionStorage){var GA_SESSION_STORAGE_KEY='ga:clientId';ga('create','UA-115082821-1',{'storage':'none','clientId':sessionStorage.getItem(GA_SESSION_STORAGE_KEY)});ga(function(tracker){sessionStorage.setItem(GA_SESSION_STORAGE_KEY,tracker.get('clientId'));});}
ga('set','anonymizeIp',true);ga('send','pageview');}</script></body></html></div></div></body></html>