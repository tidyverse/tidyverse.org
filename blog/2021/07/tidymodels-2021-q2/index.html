<!doctype html><html><head><!doctype html><html lang=en-us><link rel=stylesheet href=/css/fonts.css><link rel=stylesheet href=/css/main-site.css><link rel=stylesheet href=/css/fa5-all.css><style type=text/css>body{background-color:#fff;color:#1a1917}a{color:#38577f}a:hover{color:#42709b}a:focus{outline-color:#42709b}.column25-left .sectionTitle a:hover:not(.current),.column16-left .sectionTitle a:hover:not(.current){color:#1a1917}.icon-attribution,.icon-attribution a{color:#1a1917;opacity:75%}#homeContent .band.first{background-color:#fff}#homeContent .band.second{background-color:#fdeba4}#homeContent .band.third{background-color:#fff}#rStudioHeader{background-color:#1a162d;color:#fff}#rStudioHeader .productName{color:#fff}#rStudioHeader .productName:hover,#rStudioHeader .productName:focus{color:#fdeba4}#rStudioHeader #menu .menuItem.a{background-color:#75aadb;color:#fff}#rStudioHeader #menu .menuItem:hover{background-color:#484557;color:#fff}#rStudioHeader #menu .menuItem.current{background-color:#fff;color:#1a162d;text-decoration:none}#rStudioFooter.band{background-color:#767381}#rStudioFooter .bandContent #copyright{color:#e3eef8}table tbody tr:nth-child(even){background-color:#f7faff}table tbody tr:nth-child(odd){background-color:#fff}.latest{border-top:.5em solid <no value>}.event{-moz-box-shadow:0 0 0 0 rgba(0,0,0,.1);-webkit-box-shadow:0 0 0 0 rgba(0,0,0,.1);box-shadow:0 0 0 0 rgba(0,0,0,.1)}.section .event{background-color:#eab0c41a}.section .event{border-top:7pt solid #a19ea936}.section .event a{color:#1a162d}.section .event{color:#404040}</style><link rel=stylesheet href=/css/tidyverse.css><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Hugo 0.71.1"><title>Q2 2021 tidymodels digest</title><meta property="og:title" content="Q2 2021 tidymodels digest"><meta property="og:description" content="Releases of tidymodels packages in Q2 of 2021 include more streamlined memory footprints for feature-engineering recipes, new model engine options, and better support for post-processing predictions."><meta property="og:type" content="article"><meta property="og:url" content="https://www.tidyverse.org/blog/2021/07/tidymodels-2021-q2/"><meta property="twitter:card" content="summary_large_image"><meta property="og:title" content="Q2 2021 tidymodels digest - Tidyverse"><meta property="description" content="Releases of tidymodels packages in Q2 of 2021 include more streamlined memory footprints for feature-engineering recipes, new model engine options, and better support for post-processing predictions."><meta property="og:description" content="Releases of tidymodels packages in Q2 of 2021 include more streamlined memory footprints for feature-engineering recipes, new model engine options, and better support for post-processing predictions."><meta property="og:image" content="https://www.tidyverse.org/blog/2021/07/tidymodels-2021-q2/thumbnail-sq.jpg"><meta name=twitter:image content="https://www.tidyverse.org/blog/2021/07/tidymodels-2021-q2/thumbnail-wd.jpg"><link rel=apple-touch-icon sizes=180x180 href=/images/favicons/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/images/favicons/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/images/favicons/favicon-16x16.png><link rel=manifest href=/images/favicons/site.webmanifest><link rel=mask-icon href=/images/favicons/safari-pinned-tab.svg><link rel="shortcut icon" href=/images/favicons/favicon.ico><meta name=msapplication-TileColor content="#da532c"><meta name=msapplication-config href=/images/favicons/browserconfig.xml><script type=text/javascript src=/js/jquery-3.5.1.min.js></script><script type=text/javascript src=/js/site.js></script><link rel=icon href=/images/favicon.ico><script type=text/javascript src=/js/clipboard.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin=anonymous></script><script defer data-domain=tidyverse.org,all.tidyverse.org src=https://plausible.io/js/plausible.js></script></head><body><div id=appTidyverseSite class="shrinkHeader alwaysShrinkHeader"><div id=main><div id=rStudioHeader><nav class=band><div class="innards bandContent"><div><a class=productName href=/%20/>Tidyverse</a></div><div id=menu><div id=menuToggler></div><div id=menuItems><a class=menuItem href=/packages/>Packages</a>
<a class="menuItem current" href=/blog/>Blog</a>
<a class=menuItem href=/learn/>Learn</a>
<a class=menuItem href=/help/>Help</a>
<a class=menuItem href=/contribute/>Contribute</a></div></div></div></nav></div><main><div class="band padForHeader pushFooter"><div class=bandContent><div class="full splitColumns withMobileMargins"><div class=column75><h1 class=article-title>Q2 2021 tidymodels digest</h1><div class=article-header aria-hidden=true><div class=photo><img src=/blog/2021/07/tidymodels-2021-q2/thumbnail-wd.jpg></div><div class=photoCredit>Photo by <a href=https://unsplash.com/photos/UsZNiW6LyQ0>SHOT</a></div></div><span class=article-date><i class="fas fa-calendar-day fa-fw"></i>&nbsp;&nbsp;2021/07/02</span><p style=margin-bottom:.5em;margin-top:.85em><i class="fas fa-tags"></i>&nbsp;
<a href=/tags/tidymodels/>tidymodels</a>,
<a href=/tags/recipes/>recipes</a>,
<a href=/tags/parsnip/>parsnip</a>,
<a href=/tags/yardstick/>yardstick</a>,
<a href=/tags/butcher/>butcher</a>,
<a href=/tags/probably/>probably</a></p><p style=margin-top:.5em><i class="fas fa-user-circle fa-fw"></i>&nbsp;
Julia Silge</p><div class=article-content><p>The
<a href=https://www.tidymodels.org/ target=_blank rel=noopener>tidymodels</a> framework is a collection of R packages for modeling and machine learning using tidyverse principles. Earlier this year, we
<a href=https://www.tidyverse.org/blog/2021/03/tidymodels-2021-q1/ target=_blank rel=noopener>started regular updates</a> here on the tidyverse blog summarizing recent developments in the tidymodels ecosystem. You can check out the
<a href=https://www.tidyverse.org/tags/tidymodels/ target=_blank rel=noopener><code>tidymodels</code> tag</a> to find all tidymodels blog posts here, including those that focus on a single package or more major releases. The purpose of these roundup posts is to keep you informed about any releases you may have missed and useful new functionality as we maintain these packages.</p><p>Since our last roundup post, there have been 19 CRAN releases of 15 different packages. That might sound like a lot of change to absorb as a tidymodels user! However, we purposefully write code in small, modular packages that we can release frequently to make models easier to deploy and our software easier to maintain. You can install these updates from CRAN with:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf>install.packages</span><span class=p>(</span><span class=nf>c</span><span class=p>(</span><span class=s>&#34;broom&#34;</span><span class=p>,</span> <span class=s>&#34;butcher&#34;</span><span class=p>,</span> <span class=s>&#34;discrim&#34;</span><span class=p>,</span> <span class=s>&#34;hardhat&#34;</span><span class=p>,</span> <span class=s>&#34;parsnip&#34;</span><span class=p>,</span> <span class=s>&#34;probably&#34;</span><span class=p>,</span> 
                   <span class=s>&#34;recipes&#34;</span><span class=p>,</span> <span class=s>&#34;rsample&#34;</span><span class=p>,</span> <span class=s>&#34;stacks&#34;</span><span class=p>,</span> <span class=s>&#34;themis&#34;</span><span class=p>,</span> <span class=s>&#34;tidymodels&#34;</span><span class=p>,</span> 
                   <span class=s>&#34;tidyposterior&#34;</span><span class=p>,</span> <span class=s>&#34;tune&#34;</span><span class=p>,</span> <span class=s>&#34;workflowsets&#34;</span><span class=p>,</span> <span class=s>&#34;yardstick&#34;</span><span class=p>))</span>
</code></pre></div><p>The <code>NEWS</code> files are linked here for each package; you&rsquo;ll notice that many of these releases involve small bug fixes or internal changes that are not user-facing. It&rsquo;s a lot to keep up with and there are some super useful updates in the mix, so read on for several highlights!</p><ul><li><a href=https://broom.tidymodels.org/news/index.html#broom-0-7-8-2021-06-24 target=_blank rel=noopener>broom</a></li><li><a href=https://butcher.tidymodels.org/news/index.html#butcher-0-1-4-2021-03-19 target=_blank rel=noopener>butcher</a></li><li><a href=https://discrim.tidymodels.org/news/index.html#discrim-0-1-2-2021-05-28 target=_blank rel=noopener>discrim</a></li><li><a href=https://hardhat.tidymodels.org/news/index.html#hardhat-0-1-4-2020-07-02 target=_blank rel=noopener>hardhat</a></li><li><a href=https://parsnip.tidymodels.org/news/index.html#parsnip-0-1-6-2021-05-27 target=_blank rel=noopener>parsnip</a></li><li><a href=https://probably.tidymodels.org/news/index.html#probably-0-0-6-2020-06-05 target=_blank rel=noopener>probably</a></li><li><a href=https://recipes.tidymodels.org/news/index.html#recipes-0-1-16-2021-04-16 target=_blank rel=noopener>recipes</a></li><li><a href=https://rsample.tidymodels.org/news/index.html#rsample-0-1-0-2021-05-08 target=_blank rel=noopener>rsample</a></li><li><a href=https://github.com/tidymodels/stacks/blob/main/NEWS.md#v020 target=_blank rel=noopener>stacks</a></li><li><a href=https://themis.tidymodels.org/dev/news/index.html#themis-0-1-4-2021-06-12 target=_blank rel=noopener>themis</a></li><li><a href=https://tidymodels.tidymodels.org/news/index.html#tidymodels-0-1-3-2021-04-19 target=_blank rel=noopener>tidymodels</a></li><li><a href=https://github.com/tidymodels/tidyposterior/blob/master/NEWS.md#tidyposterior-010 target=_blank rel=noopener>tidyposterior</a></li><li><a href=https://tune.tidymodels.org/news/index.html#tune-0-1-5-2021-04-23 target=_blank rel=noopener>tune</a></li><li><a href=https://workflowsets.tidymodels.org/news/index.html#workflowsets-0-0-2-2021-04-16 target=_blank rel=noopener>workflowsets</a></li><li><a href=https://yardstick.tidymodels.org/news/index.html#yardstick-0-0-8-2021-03-28 target=_blank rel=noopener>yardstick</a></li></ul><h2 id=reduce-the-memory-footprint-of-your-recipes>Reduce the memory footprint of your recipes
<a href=#reduce-the-memory-footprint-of-your-recipes><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>The
<a href=https://butcher.tidymodels.org/ target=_blank rel=noopener>butcher</a> package provides methods to remove (or &ldquo;axe&rdquo;) components from model objects that are not needed for prediction. The most recent release updated how butcher handles <em>recipes</em> (the tidymodels approach for preprocessing and feature engineering) for more complete and robust coverage. Let&rsquo;s consider a simulated churn-classification dataset for phone company customers:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf>library</span><span class=p>(</span><span class=n>tidymodels</span><span class=p>)</span>
<span class=nf>library</span><span class=p>(</span><span class=n>butcher</span><span class=p>)</span>
<span class=nf>data</span><span class=p>(</span><span class=s>&#34;mlc_churn&#34;</span><span class=p>)</span>

<span class=nf>set.seed</span><span class=p>(</span><span class=m>123</span><span class=p>)</span>
<span class=n>churn_split</span> <span class=o>&lt;-</span> <span class=nf>initial_split</span><span class=p>(</span><span class=n>mlc_churn</span><span class=p>)</span>
<span class=n>churn_train</span> <span class=o>&lt;-</span> <span class=nf>training</span><span class=p>(</span><span class=n>churn_split</span><span class=p>)</span>
<span class=n>churn_test</span>  <span class=o>&lt;-</span> <span class=nf>testing</span><span class=p>(</span><span class=n>churn_split</span><span class=p>)</span>

<span class=nf>ggplot</span><span class=p>(</span><span class=n>churn_train</span><span class=p>,</span> <span class=nf>aes</span><span class=p>(</span><span class=n>y</span> <span class=o>=</span> <span class=n>voice_mail_plan</span><span class=p>,</span> <span class=n>fill</span> <span class=o>=</span> <span class=n>churn</span><span class=p>))</span> <span class=o>+</span>
  <span class=nf>geom_bar</span><span class=p>(</span><span class=n>alpha</span> <span class=o>=</span> <span class=m>0.8</span><span class=p>,</span> <span class=n>position</span> <span class=o>=</span> <span class=s>&#34;fill&#34;</span><span class=p>)</span> <span class=o>+</span>
  <span class=nf>scale_x_continuous</span><span class=p>(</span><span class=n>labels</span> <span class=o>=</span> <span class=n>scales</span><span class=o>::</span><span class=nf>percent_format</span><span class=p>())</span> <span class=o>+</span>
  <span class=nf>labs</span><span class=p>(</span><span class=n>x</span> <span class=o>=</span> <span class=kc>NULL</span><span class=p>)</span>
</code></pre></div><p><img src=figure/unnamed-chunk-3-1.png alt="plot of chunk unnamed-chunk-3"></p><p>For some kinds of models, we would want to create dummy or indicator variables from nominal predictors, and preprocess features to be on the same scale. We can use recipes for this task:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=n>churn_rec</span> <span class=o>&lt;-</span> 
  <span class=nf>recipe</span><span class=p>(</span><span class=n>churn</span> <span class=o>~</span> <span class=n>voice_mail_plan</span> <span class=o>+</span> <span class=n>total_intl_minutes</span> <span class=o>+</span> 
           <span class=n>total_day_minutes</span> <span class=o>+</span> <span class=n>total_eve_minutes</span> <span class=o>+</span> <span class=n>state</span><span class=p>,</span> 
         <span class=n>data</span> <span class=o>=</span> <span class=n>churn_train</span><span class=p>)</span> <span class=o>%&gt;%</span>
  <span class=nf>step_dummy</span><span class=p>(</span><span class=nf>all_nominal_predictors</span><span class=p>())</span> <span class=o>%&gt;%</span>
  <span class=nf>step_normalize</span><span class=p>(</span><span class=nf>all_predictors</span><span class=p>())</span>
</code></pre></div><p>You can <code>prep(churn_rec)</code> to estimate the quantities needed to create categorical features and to scale all the predictors:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=n>churn_prep</span> <span class=o>&lt;-</span> <span class=nf>prep</span><span class=p>(</span><span class=n>churn_rec</span><span class=p>)</span>
<span class=n>churn_prep</span>
<span class=c1>#&gt; Data Recipe</span>
<span class=c1>#&gt; </span>
<span class=c1>#&gt; Inputs:</span>
<span class=c1>#&gt; </span>
<span class=c1>#&gt;       role #variables</span>
<span class=c1>#&gt;    outcome          1</span>
<span class=c1>#&gt;  predictor          5</span>
<span class=c1>#&gt; </span>
<span class=c1>#&gt; Training data contained 3750 data points and no missing data.</span>
<span class=c1>#&gt; </span>
<span class=c1>#&gt; Operations:</span>
<span class=c1>#&gt; </span>
<span class=c1>#&gt; Dummy variables from voice_mail_plan, state [trained]</span>
<span class=c1>#&gt; Centering and scaling for total_intl_minutes, total_day_minutes, ... [trained]</span>
</code></pre></div><p>To remove everything from this prepped recipe not needed for applying to new data (e.g.
<a href=https://recipes.tidymodels.org/reference/bake.html target=_blank rel=noopener>bake()</a> it), we can call <code>butcher(churn_prep)</code>. In some applications, modeling practitioners need to make custom functions with a feature-engineering recipe. Sometimes those functions have&mldr; a lot of extra STUFF in them, stuff that is not needed for prediction.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=n>butchered_plus</span> <span class=o>&lt;-</span> <span class=nf>function</span><span class=p>()</span> <span class=p>{</span>
  <span class=n>some_stuff_in_the_environment</span> <span class=o>&lt;-</span> <span class=nf>runif</span><span class=p>(</span><span class=m>1e6</span><span class=p>)</span>
  
  <span class=n>churn_prep</span> <span class=o>&lt;-</span> 
    <span class=nf>recipe</span><span class=p>(</span><span class=n>churn</span> <span class=o>~</span> <span class=n>voice_mail_plan</span> <span class=o>+</span> <span class=n>total_intl_minutes</span> <span class=o>+</span> 
             <span class=n>total_day_minutes</span> <span class=o>+</span> <span class=n>total_eve_minutes</span> <span class=o>+</span> <span class=n>state</span><span class=p>,</span> 
           <span class=n>data</span> <span class=o>=</span> <span class=n>churn_train</span><span class=p>)</span> <span class=o>%&gt;%</span>
    <span class=nf>step_dummy</span><span class=p>(</span><span class=nf>all_nominal_predictors</span><span class=p>())</span> <span class=o>%&gt;%</span>
    <span class=nf>step_normalize</span><span class=p>(</span><span class=nf>all_predictors</span><span class=p>())</span> <span class=o>%&gt;%</span>
    <span class=nf>prep</span><span class=p>()</span>
  
  <span class=nf>butcher</span><span class=p>(</span><span class=n>churn_prep</span><span class=p>)</span>
<span class=p>}</span>
</code></pre></div><p>In the old version of butcher, we did not successfully remove all that extra stuff, and recipes were bigger than they needed to be:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=c1># old version of butcher</span>
<span class=n>lobstr</span><span class=o>::</span><span class=nf>obj_size</span><span class=p>(</span><span class=nf>butcher</span><span class=p>(</span><span class=n>churn_prep</span><span class=p>))</span>
<span class=c1>#&gt; 1,835,512 B</span>
<span class=n>lobstr</span><span class=o>::</span><span class=nf>obj_size</span><span class=p>(</span><span class=nf>butchered_plus</span><span class=p>())</span>
<span class=c1>#&gt; 9,836,480 B</span>
</code></pre></div><p>In the new version of butcher, we now successfully remove unneeded components from the recipe, so it is smaller:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=c1># new version of butcher</span>
<span class=n>lobstr</span><span class=o>::</span><span class=nf>obj_size</span><span class=p>(</span><span class=nf>butcher</span><span class=p>(</span><span class=n>churn_prep</span><span class=p>))</span>
<span class=c1>#&gt; 1,695,352 B</span>
<span class=n>lobstr</span><span class=o>::</span><span class=nf>obj_size</span><span class=p>(</span><span class=nf>butchered_plus</span><span class=p>())</span>
<span class=c1>#&gt; 1,695,352 B</span>
</code></pre></div><p>There are also <code>butcher()</code> methods for <code>workflow()</code> objects, so when you <code>butcher()</code> a modeling workflow, you remove everything not needed for prediction from both its estimated recipe <em>and</em> its trained model, making it as lightweight as possible for deployment.</p><h2 id=svms-and-fast-logistic-regression-with-liblinear>SVMs and fast logistic regression with LiblineaR
<a href=#svms-and-fast-logistic-regression-with-liblinear><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Unfortunately, the <code>"liquidSVM"</code> engine for support vector machine models that parsnip supported was deprecated in the latest release, because that package was removed from CRAN. We added a new engine in the same release that allows users to fit linear SVMs with the
<a href=https://parsnip.tidymodels.org/reference/svm_linear.html target=_blank rel=noopener>parsnip model <code>svm_linear()</code></a>, as well as having another option for logistic regression. This new <code>"LiblineaR"</code> engine is based on the same C++ library that is shipped with
<a href=https://scikit-learn.org/ target=_blank rel=noopener>scikit-learn</a>. We&rsquo;d like to thank the
<a href=https://www.dnalytics.com/software/liblinear/ target=_blank rel=noopener>maintainers of the LiblineaR R package</a> for all their help as we set up this integration.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf>set.seed</span><span class=p>(</span><span class=m>234</span><span class=p>)</span>
<span class=n>churn_folds</span> <span class=o>&lt;-</span> <span class=nf>vfold_cv</span><span class=p>(</span><span class=n>churn_train</span><span class=p>,</span> <span class=n>v</span> <span class=o>=</span> <span class=m>5</span><span class=p>,</span> <span class=n>strata</span> <span class=o>=</span> <span class=n>churn</span><span class=p>)</span>

<span class=n>liblinear_spec</span> <span class=o>&lt;-</span>
  <span class=nf>logistic_reg</span><span class=p>(</span><span class=n>penalty</span> <span class=o>=</span> <span class=m>0.2</span><span class=p>,</span> <span class=n>mixture</span> <span class=o>=</span> <span class=m>1</span><span class=p>)</span> <span class=o>%&gt;%</span>
  <span class=nf>set_mode</span><span class=p>(</span><span class=s>&#34;classification&#34;</span><span class=p>)</span> <span class=o>%&gt;%</span>
  <span class=nf>set_engine</span><span class=p>(</span><span class=s>&#34;LiblineaR&#34;</span><span class=p>)</span>

<span class=n>liblinear_wf</span> <span class=o>&lt;-</span>
  <span class=nf>workflow</span><span class=p>()</span> <span class=o>%&gt;%</span>
  <span class=nf>add_recipe</span><span class=p>(</span><span class=n>churn_rec</span><span class=p>)</span> <span class=o>%&gt;%</span>
  <span class=nf>add_model</span><span class=p>(</span><span class=n>liblinear_spec</span><span class=p>)</span>

<span class=nf>fit_resamples</span><span class=p>(</span><span class=n>liblinear_wf</span><span class=p>,</span> <span class=n>resamples</span> <span class=o>=</span> <span class=n>churn_folds</span><span class=p>)</span>
<span class=c1>#&gt; # Resampling results</span>
<span class=c1>#&gt; # 5-fold cross-validation using stratification </span>
<span class=c1>#&gt; # A tibble: 5 x 4</span>
<span class=c1>#&gt;   splits             id    .metrics         .notes          </span>
<span class=c1>#&gt;   &lt;list&gt;             &lt;chr&gt; &lt;list&gt;           &lt;list&gt;          </span>
<span class=c1>#&gt; 1 &lt;split [2999/751]&gt; Fold1 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 1]&gt;</span>
<span class=c1>#&gt; 2 &lt;split [2999/751]&gt; Fold2 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 1]&gt;</span>
<span class=c1>#&gt; 3 &lt;split [3000/750]&gt; Fold3 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 1]&gt;</span>
<span class=c1>#&gt; 4 &lt;split [3001/749]&gt; Fold4 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 1]&gt;</span>
<span class=c1>#&gt; 5 &lt;split [3001/749]&gt; Fold5 &lt;tibble [2 × 4]&gt; &lt;tibble [0 × 1]&gt;</span>
</code></pre></div><p>The <code>"LiblineaR"</code> engine for regularized logistic regression
<a href=https://twitter.com/juliasilge/status/1374029310764359681 target=_blank rel=noopener>can be very fast compared to the <code>"glmnet"</code> engine</a>, even when we use a
<a href=https://www.tidyverse.org/blog/2020/11/tidymodels-sparse-support/ target=_blank rel=noopener>sparse representation</a>. Check out
<a href=https://gist.github.com/juliasilge/26a43e5e68cf12842354e6652dfed688 target=_blank rel=noopener>benchmarking code here</a>.</p><h2 id=post-processing-your-model-predictions-with-probably-and-yardstick>Post-processing your model predictions with probably and yardstick
<a href=#post-processing-your-model-predictions-with-probably-and-yardstick><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>We recently had releases of both the
<a href=https://yardstick.tidymodels.org/ target=_blank rel=noopener>yardstick</a> and
<a href=https://probably.tidymodels.org/ target=_blank rel=noopener>probably</a> packages, which now work together even better. The probably package can, among other things, help you post-process your model predictions. This data on churn is imbalanced, with many more customers who did not churn than those who did; we may need to use a threshold other than 0.5 for most appropriate results, or an organization may want to set a specific threshold for some action to prevent churn. You can set a threshold using the
<a href=https://probably.tidymodels.org/reference/make_class_pred.html target=_blank rel=noopener>probably function <code>make_two_class_pred()</code></a>.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf>library</span><span class=p>(</span><span class=n>probably</span><span class=p>)</span>

<span class=nf>set.seed</span><span class=p>(</span><span class=m>123</span><span class=p>)</span>
<span class=n>churn_preds</span> <span class=o>&lt;-</span> 
  <span class=n>liblinear_wf</span> <span class=o>%&gt;%</span>
  <span class=nf>fit</span><span class=p>(</span><span class=n>churn_train</span><span class=p>)</span> <span class=o>%&gt;%</span>
  <span class=nf>augment</span><span class=p>(</span><span class=n>churn_test</span><span class=p>)</span>

<span class=n>churn_post</span> <span class=o>&lt;-</span> 
  <span class=n>churn_preds</span> <span class=o>%&gt;%</span>
  <span class=nf>mutate</span><span class=p>(</span><span class=n>.pred</span> <span class=o>=</span> <span class=nf>make_two_class_pred</span><span class=p>(</span><span class=n>.pred_yes</span><span class=p>,</span> <span class=nf>levels</span><span class=p>(</span><span class=n>churn</span><span class=p>),</span> <span class=n>threshold</span> <span class=o>=</span> <span class=m>0.7</span><span class=p>))</span>
</code></pre></div><p>The class predictions created with probably integrate well with functions from yardstick, including custom sets of metrics created with
<a href=https://yardstick.tidymodels.org/reference/metric_set.html target=_blank rel=noopener><code>metric_set()</code></a>.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=n>churn_metrics</span> <span class=o>&lt;-</span> <span class=nf>metric_set</span><span class=p>(</span><span class=n>accuracy</span><span class=p>,</span> <span class=n>sens</span><span class=p>,</span> <span class=n>spec</span><span class=p>)</span>

<span class=n>churn_post</span> <span class=o>%&gt;%</span> <span class=nf>churn_metrics</span><span class=p>(</span><span class=n>truth</span> <span class=o>=</span> <span class=n>churn</span><span class=p>,</span> <span class=n>estimate</span> <span class=o>=</span> <span class=n>.pred_class</span><span class=p>)</span>
<span class=c1>#&gt; # A tibble: 3 x 3</span>
<span class=c1>#&gt;   .metric  .estimator .estimate</span>
<span class=c1>#&gt;   &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt;</span>
<span class=c1>#&gt; 1 accuracy binary        0.854 </span>
<span class=c1>#&gt; 2 sens     binary        0.0619</span>
<span class=c1>#&gt; 3 spec     binary        0.999</span>
<span class=n>churn_post</span> <span class=o>%&gt;%</span> <span class=nf>churn_metrics</span><span class=p>(</span><span class=n>truth</span> <span class=o>=</span> <span class=n>churn</span><span class=p>,</span> <span class=n>estimate</span> <span class=o>=</span> <span class=n>.pred</span><span class=p>)</span>
<span class=c1>#&gt; # A tibble: 3 x 3</span>
<span class=c1>#&gt;   .metric  .estimator .estimate</span>
<span class=c1>#&gt;   &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt;</span>
<span class=c1>#&gt; 1 accuracy binary         0.746</span>
<span class=c1>#&gt; 2 sens     binary         0.149</span>
<span class=c1>#&gt; 3 spec     binary         0.856</span>
</code></pre></div><p>Notice that with the default threshold of 0.5, basically no customers were classified as at risk for churn! Adjusting the threshold with <code>make_two_class_pred()</code> helps to address this issue.</p><h2 id=acknowledgements>Acknowledgements
<a href=#acknowledgements><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>We&rsquo;d like to extend our thanks to all of the contributors who helped make these releases during Q2 possible!</p><ul><li><p>broom:
<a href=https://github.com/alexpghayes target=_blank rel=noopener>@alexpghayes</a>,
<a href=https://github.com/andrewsris target=_blank rel=noopener>@andrewsris</a>,
<a href=https://github.com/arcruz0 target=_blank rel=noopener>@arcruz0</a>,
<a href=https://github.com/bbolker target=_blank rel=noopener>@bbolker</a>,
<a href=https://github.com/bgall target=_blank rel=noopener>@bgall</a>,
<a href=https://github.com/cccneto target=_blank rel=noopener>@cccneto</a>,
<a href=https://github.com/ddsjoberg target=_blank rel=noopener>@ddsjoberg</a>,
<a href=https://github.com/DerForscher107 target=_blank rel=noopener>@DerForscher107</a>,
<a href=https://github.com/dikiprawisuda target=_blank rel=noopener>@dikiprawisuda</a>,
<a href=https://github.com/dmenne target=_blank rel=noopener>@dmenne</a>,
<a href=https://github.com/grantmcdermott target=_blank rel=noopener>@grantmcdermott</a>,
<a href=https://github.com/japhir target=_blank rel=noopener>@japhir</a>,
<a href=https://github.com/karldw target=_blank rel=noopener>@karldw</a>,
<a href=https://github.com/kelseygonzalez target=_blank rel=noopener>@kelseygonzalez</a>,
<a href=https://github.com/leejasme target=_blank rel=noopener>@leejasme</a>,
<a href=https://github.com/LukasWallrich target=_blank rel=noopener>@LukasWallrich</a>,
<a href=https://github.com/MatthieuStigler target=_blank rel=noopener>@MatthieuStigler</a>,
<a href=https://github.com/mbac target=_blank rel=noopener>@mbac</a>,
<a href=https://github.com/nt-williams target=_blank rel=noopener>@nt-williams</a>,
<a href=https://github.com/pachadotdev target=_blank rel=noopener>@pachadotdev</a>,
<a href=https://github.com/rpruim target=_blank rel=noopener>@rpruim</a>,
<a href=https://github.com/rsbivand target=_blank rel=noopener>@rsbivand</a>,
<a href=https://github.com/simonpcouch target=_blank rel=noopener>@simonpcouch</a>, and
<a href=https://github.com/vincentarelbundock target=_blank rel=noopener>@vincentarelbundock</a>.</p></li><li><p>butcher:
<a href=https://github.com/bshor target=_blank rel=noopener>@bshor</a>,
<a href=https://github.com/DavisVaughan target=_blank rel=noopener>@DavisVaughan</a>,
<a href=https://github.com/juliasilge target=_blank rel=noopener>@juliasilge</a>, and
<a href=https://github.com/lbenz-mdsol target=_blank rel=noopener>@lbenz-mdsol</a>.</p></li><li><p>discrim:
<a href=https://github.com/juliasilge target=_blank rel=noopener>@juliasilge</a>, and
<a href=https://github.com/topepo target=_blank rel=noopener>@topepo</a>.</p></li><li><p>hardhat:
<a href=https://github.com/DavisVaughan target=_blank rel=noopener>@DavisVaughan</a>, and
<a href=https://github.com/topepo target=_blank rel=noopener>@topepo</a>.</p></li><li><p>parsnip:
<a href=https://github.com/brshallo target=_blank rel=noopener>@brshallo</a>,
<a href=https://github.com/cgoo4 target=_blank rel=noopener>@cgoo4</a>,
<a href=https://github.com/DavisVaughan target=_blank rel=noopener>@DavisVaughan</a>,
<a href=https://github.com/dgrtwo target=_blank rel=noopener>@dgrtwo</a>,
<a href=https://github.com/EmilHvitfeldt target=_blank rel=noopener>@EmilHvitfeldt</a>,
<a href=https://github.com/graysonwhite target=_blank rel=noopener>@graysonwhite</a>,
<a href=https://github.com/hfrick target=_blank rel=noopener>@hfrick</a>,
<a href=https://github.com/hsbadr target=_blank rel=noopener>@hsbadr</a>,
<a href=https://github.com/joeycouse target=_blank rel=noopener>@joeycouse</a>,
<a href=https://github.com/jtlandis target=_blank rel=noopener>@jtlandis</a>,
<a href=https://github.com/juliasilge target=_blank rel=noopener>@juliasilge</a>,
<a href=https://github.com/klin333 target=_blank rel=noopener>@klin333</a>,
<a href=https://github.com/mdancho84 target=_blank rel=noopener>@mdancho84</a>,
<a href=https://github.com/paulponcet target=_blank rel=noopener>@paulponcet</a>,
<a href=https://github.com/pfc5098 target=_blank rel=noopener>@pfc5098</a>,
<a href=https://github.com/RaymondBalise target=_blank rel=noopener>@RaymondBalise</a>,
<a href=https://github.com/smingerson target=_blank rel=noopener>@smingerson</a>,
<a href=https://github.com/topepo target=_blank rel=noopener>@topepo</a>,
<a href=https://github.com/UnclAlDeveloper target=_blank rel=noopener>@UnclAlDeveloper</a>, and
<a href=https://github.com/vadimus202 target=_blank rel=noopener>@vadimus202</a>.</p></li><li><p>probably:
<a href=https://github.com/hsbadr target=_blank rel=noopener>@hsbadr</a>, and
<a href=https://github.com/juliasilge target=_blank rel=noopener>@juliasilge</a>.</p></li><li><p>recipes:
<a href=https://github.com/AlbertRapp target=_blank rel=noopener>@AlbertRapp</a>,
<a href=https://github.com/asmae-toumi target=_blank rel=noopener>@asmae-toumi</a>,
<a href=https://github.com/atusy target=_blank rel=noopener>@atusy</a>,
<a href=https://github.com/christiantillich target=_blank rel=noopener>@christiantillich</a>,
<a href=https://github.com/EdwinTh target=_blank rel=noopener>@EdwinTh</a>,
<a href=https://github.com/EmilHvitfeldt target=_blank rel=noopener>@EmilHvitfeldt</a>,
<a href=https://github.com/hfrick target=_blank rel=noopener>@hfrick</a>,
<a href=https://github.com/jake-mason target=_blank rel=noopener>@jake-mason</a>,
<a href=https://github.com/jkennel target=_blank rel=noopener>@jkennel</a>,
<a href=https://github.com/jtlandis target=_blank rel=noopener>@jtlandis</a>,
<a href=https://github.com/juliasilge target=_blank rel=noopener>@juliasilge</a>,
<a href=https://github.com/LiamBlake target=_blank rel=noopener>@LiamBlake</a>,
<a href=https://github.com/lindeloev target=_blank rel=noopener>@lindeloev</a>,
<a href=https://github.com/mikemc target=_blank rel=noopener>@mikemc</a>,
<a href=https://github.com/mrkaye97 target=_blank rel=noopener>@mrkaye97</a>,
<a href=https://github.com/renanxcortes target=_blank rel=noopener>@renanxcortes</a>,
<a href=https://github.com/schoonees target=_blank rel=noopener>@schoonees</a>,
<a href=https://github.com/SlowMo24 target=_blank rel=noopener>@SlowMo24</a>,
<a href=https://github.com/smingerson target=_blank rel=noopener>@smingerson</a>, and
<a href=https://github.com/topepo target=_blank rel=noopener>@topepo</a>.</p></li><li><p>rsample:
<a href=https://github.com/brian-j-smith target=_blank rel=noopener>@brian-j-smith</a>,
<a href=https://github.com/EmilHvitfeldt target=_blank rel=noopener>@EmilHvitfeldt</a>,
<a href=https://github.com/hfrick target=_blank rel=noopener>@hfrick</a>,
<a href=https://github.com/juliasilge target=_blank rel=noopener>@juliasilge</a>,
<a href=https://github.com/LiamBlake target=_blank rel=noopener>@LiamBlake</a>,
<a href=https://github.com/mattwarkentin target=_blank rel=noopener>@mattwarkentin</a>,
<a href=https://github.com/PathosEthosLogos target=_blank rel=noopener>@PathosEthosLogos</a>,
<a href=https://github.com/rkb965 target=_blank rel=noopener>@rkb965</a>, and
<a href=https://github.com/supermdat target=_blank rel=noopener>@supermdat</a>.</p></li><li><p>stacks:
<a href=https://github.com/asmae-toumi target=_blank rel=noopener>@asmae-toumi</a>,
<a href=https://github.com/Crisel12 target=_blank rel=noopener>@Crisel12</a>,
<a href=https://github.com/simonpcouch target=_blank rel=noopener>@simonpcouch</a>, and
<a href=https://github.com/topepo target=_blank rel=noopener>@topepo</a>.</p></li><li><p>themis:
<a href=https://github.com/EmilHvitfeldt target=_blank rel=noopener>@EmilHvitfeldt</a>,
<a href=https://github.com/kylegilde target=_blank rel=noopener>@kylegilde</a>, and
<a href=https://github.com/topepo target=_blank rel=noopener>@topepo</a>.</p></li><li><p>tidymodels:
<a href=https://github.com/dmenne target=_blank rel=noopener>@dmenne</a>,
<a href=https://github.com/Edward-Egros target=_blank rel=noopener>@Edward-Egros</a>,
<a href=https://github.com/juliasilge target=_blank rel=noopener>@juliasilge</a>,
<a href=https://github.com/PathosEthosLogos target=_blank rel=noopener>@PathosEthosLogos</a>,
<a href=https://github.com/topepo target=_blank rel=noopener>@topepo</a>, and
<a href=https://github.com/verajosemanuel target=_blank rel=noopener>@verajosemanuel</a>.</p></li><li><p>tidyposterior:
<a href=https://github.com/juliasilge target=_blank rel=noopener>@juliasilge</a>, and
<a href=https://github.com/topepo target=_blank rel=noopener>@topepo</a>.</p></li><li><p>tune:
<a href=https://github.com/albert-ying target=_blank rel=noopener>@albert-ying</a>,
<a href=https://github.com/amazongodman target=_blank rel=noopener>@amazongodman</a>,
<a href=https://github.com/brshallo target=_blank rel=noopener>@brshallo</a>,
<a href=https://github.com/dpanyard target=_blank rel=noopener>@dpanyard</a>,
<a href=https://github.com/EmilHvitfeldt target=_blank rel=noopener>@EmilHvitfeldt</a>,
<a href=https://github.com/juliasilge target=_blank rel=noopener>@juliasilge</a>,
<a href=https://github.com/klin333 target=_blank rel=noopener>@klin333</a>,
<a href=https://github.com/mbac target=_blank rel=noopener>@mbac</a>,
<a href=https://github.com/PathosEthosLogos target=_blank rel=noopener>@PathosEthosLogos</a>,
<a href=https://github.com/silvanhi target=_blank rel=noopener>@silvanhi</a>,
<a href=https://github.com/smingerson target=_blank rel=noopener>@smingerson</a>,
<a href=https://github.com/topepo target=_blank rel=noopener>@topepo</a>, and
<a href=https://github.com/yogat3ch target=_blank rel=noopener>@yogat3ch</a>.</p></li><li><p>workflowsets:
<a href=https://github.com/amazongodman target=_blank rel=noopener>@amazongodman</a>,
<a href=https://github.com/DavisVaughan target=_blank rel=noopener>@DavisVaughan</a>,
<a href=https://github.com/gunnergalactico target=_blank rel=noopener>@gunnergalactico</a>,
<a href=https://github.com/hnagaty target=_blank rel=noopener>@hnagaty</a>,
<a href=https://github.com/jonthegeek target=_blank rel=noopener>@jonthegeek</a>,
<a href=https://github.com/juliasilge target=_blank rel=noopener>@juliasilge</a>,
<a href=https://github.com/mdancho84 target=_blank rel=noopener>@mdancho84</a>,
<a href=https://github.com/oskasf target=_blank rel=noopener>@oskasf</a>,
<a href=https://github.com/rafzamb target=_blank rel=noopener>@rafzamb</a>,
<a href=https://github.com/topepo target=_blank rel=noopener>@topepo</a>, and
<a href=https://github.com/yogat3ch target=_blank rel=noopener>@yogat3ch</a>.</p></li><li><p>yardstick:
<a href=https://github.com/brshallo target=_blank rel=noopener>@brshallo</a>,
<a href=https://github.com/coletl target=_blank rel=noopener>@coletl</a>,
<a href=https://github.com/datenzauberai target=_blank rel=noopener>@datenzauberai</a>,
<a href=https://github.com/DavisVaughan target=_blank rel=noopener>@DavisVaughan</a>,
<a href=https://github.com/EmilHvitfeldt target=_blank rel=noopener>@EmilHvitfeldt</a>,
<a href=https://github.com/juliasilge target=_blank rel=noopener>@juliasilge</a>,
<a href=https://github.com/klin333 target=_blank rel=noopener>@klin333</a>,
<a href=https://github.com/mattwarkentin target=_blank rel=noopener>@mattwarkentin</a>,
<a href=https://github.com/mdancho84 target=_blank rel=noopener>@mdancho84</a>, and
<a href=https://github.com/topepo target=_blank rel=noopener>@topepo</a>.</p></li></ul></div></div><div class=column25><div class="section hideOnMobile"><div class=sectionTitle>Contents</div><nav id=TableOfContents><ul><li><a href=#reduce-the-memory-footprint-of-your-recipes>Reduce the memory footprint of your recipes</a></li><li><a href=#svms-and-fast-logistic-regression-with-liblinear>SVMs and fast logistic regression with LiblineaR</a></li><li><a href=#post-processing-your-model-predictions-with-probably-and-yardstick>Post-processing your model predictions with probably and yardstick</a></li><li><a href=#acknowledgements>Acknowledgements</a></li></ul></nav></div><div class=section></div></div></div></div></div><div id=rStudioFooter class=band><div class=bandContent><div id=copyright>The tidyverse is proudly supported by <a class=rstudioLogo href=https://posit.co/ aria-label="Posit Homepage"></a></div><div id=logos><a href=https://www.tidyverse.org/google_privacy_policy>Privacy policy</a>
<a href=https://github.com/tidyverse class="footerLogo gitHub" aria-label="Tidyverse GitHub organization"></a><a href=https://twitter.com/hashtag/rstats class="footerLogo twitter" aria-label="rstats hashtag on twitter.com"></a></div></div></div></div></div><script type=application/javascript>var dnt=(navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack);var doNotTrack=(dnt=="1"||dnt=="yes");if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');if(window.sessionStorage){var GA_SESSION_STORAGE_KEY='ga:clientId';ga('create','UA-115082821-1',{'storage':'none','clientId':sessionStorage.getItem(GA_SESSION_STORAGE_KEY)});ga(function(tracker){sessionStorage.setItem(GA_SESSION_STORAGE_KEY,tracker.get('clientId'));});}
ga('set','anonymizeIp',true);ga('send','pageview');}</script></body></html></div></div></body></html>