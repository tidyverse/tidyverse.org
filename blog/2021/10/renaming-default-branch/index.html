<!doctype html><html><head><!doctype html><html lang=en-us><link rel=stylesheet href=/css/fonts.css><link rel=stylesheet href=/css/main-site.css><link rel=stylesheet href=/css/fa5-all.css><style type=text/css>body{background-color:#fff;color:#1a1917}a{color:#38577f}a:hover{color:#42709b}a:focus{outline-color:#42709b}.column25-left .sectionTitle a:hover:not(.current),.column16-left .sectionTitle a:hover:not(.current){color:#1a1917}.icon-attribution,.icon-attribution a{color:#1a1917;opacity:75%}#homeContent .band.first{background-color:#fff}#homeContent .band.second{background-color:#fdeba4}#homeContent .band.third{background-color:#fff}#rStudioHeader{background-color:#1a162d;color:#fff}#rStudioHeader .productName{color:#fff}#rStudioHeader .productName:hover,#rStudioHeader .productName:focus{color:#fdeba4}#rStudioHeader #menu .menuItem.a{background-color:#75aadb;color:#fff}#rStudioHeader #menu .menuItem:hover{background-color:#484557;color:#fff}#rStudioHeader #menu .menuItem.current{background-color:#fff;color:#1a162d;text-decoration:none}#rStudioFooter.band{background-color:#767381}#rStudioFooter .bandContent #copyright{color:#e3eef8}table tbody tr:nth-child(even){background-color:#f7faff}table tbody tr:nth-child(odd){background-color:#fff}.latest{border-top:.5em solid <no value>}.event{-moz-box-shadow:0 0 0 0 rgba(0,0,0,.1);-webkit-box-shadow:0 0 0 0 rgba(0,0,0,.1);box-shadow:0 0 0 0 rgba(0,0,0,.1)}.section .event{background-color:#eab0c41a}.section .event{border-top:7pt solid #a19ea936}.section .event a{color:#1a162d}.section .event{color:#404040}</style><link rel=stylesheet href=/css/tidyverse.css><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Hugo 0.71.1"><title>Renaming the default branch</title><meta property="og:title" content="Renaming the default branch"><meta property="og:description" content="We are renaming the default branch of many Git(Hub) repositories and this post explains how contributors can adapt, using new functionality in usethis."><meta property="og:type" content="article"><meta property="og:url" content="https://www.tidyverse.org/blog/2021/10/renaming-default-branch/"><meta property="twitter:card" content="summary_large_image"><meta property="og:title" content="Renaming the default branch - Tidyverse"><meta property="description" content="We are renaming the default branch of many Git(Hub) repositories and this post explains how contributors can adapt, using new functionality in usethis."><meta property="og:description" content="We are renaming the default branch of many Git(Hub) repositories and this post explains how contributors can adapt, using new functionality in usethis."><meta property="og:image" content="https://www.tidyverse.org/blog/2021/10/renaming-default-branch/thumbnail-sq.jpg"><meta name=twitter:image content="https://www.tidyverse.org/blog/2021/10/renaming-default-branch/thumbnail-wd.jpg"><link rel=apple-touch-icon sizes=180x180 href=/images/favicons/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/images/favicons/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/images/favicons/favicon-16x16.png><link rel=manifest href=/images/favicons/site.webmanifest><link rel=mask-icon href=/images/favicons/safari-pinned-tab.svg><link rel="shortcut icon" href=/images/favicons/favicon.ico><meta name=msapplication-TileColor content="#da532c"><meta name=msapplication-config href=/images/favicons/browserconfig.xml><script type=text/javascript src=/js/jquery-3.5.1.min.js></script><script type=text/javascript src=/js/site.js></script><link rel=icon href=/images/favicon.ico><script type=text/javascript src=/js/clipboard.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin=anonymous></script><script defer data-domain=tidyverse.org,all.tidyverse.org src=https://plausible.io/js/plausible.js></script></head><body><div id=appTidyverseSite class="shrinkHeader alwaysShrinkHeader"><div id=main><div id=rStudioHeader><nav class=band><div class="innards bandContent"><div><a class=productName href=/%20/>Tidyverse</a></div><div id=menu><div id=menuToggler></div><div id=menuItems><a class=menuItem href=/packages/>Packages</a>
<a class="menuItem current" href=/blog/>Blog</a>
<a class=menuItem href=/learn/>Learn</a>
<a class=menuItem href=/help/>Help</a>
<a class=menuItem href=/contribute/>Contribute</a></div></div></div></nav></div><main><div class="band padForHeader pushFooter"><div class=bandContent><div class="full splitColumns withMobileMargins"><div class=column75><h1 class=article-title>Renaming the default branch</h1><div class=article-header aria-hidden=true><div class=photo><img src=/blog/2021/10/renaming-default-branch/thumbnail-wd.jpg></div><div class=photoCredit>Photo by <a href=https://unsplash.com/photos/jA264x_MkCI>Natalie Chaney</a></div></div><span class=article-date><i class="fas fa-calendar-day fa-fw"></i>&nbsp;&nbsp;2021/10/27</span><p style=margin-bottom:.5em;margin-top:.85em><i class="fas fa-tags"></i>&nbsp;
<a href=/tags/devtools/>devtools</a>,
<a href=/tags/usethis/>usethis</a></p><p style=margin-top:.5em><i class="fas fa-user-circle fa-fw"></i>&nbsp;
Jenny Bryan</p><div class=article-content><p>Technically, Git has no official concept of the default branch. But in practice, most Git repos have an <em>effective default branch</em>. If there&rsquo;s only one branch, this is it! It is the branch that most bug fixes and features get merged in to. It is the branch you see when you first visit a repo on a site such as GitHub. On a Git remote, it is the branch that <code>HEAD</code> points to. The default branch may not be precisely defined in Git itself, but most of us know it when we see it.</p><p>Historically, <code>master</code> has been the most common name for the default branch, but <code>main</code> is an increasingly popular choice. There is coordinated change across the Git ecosystem that is making it easier for users to make this switch, for example:</p><ul><li><a href=https://sfconservancy.org/news/2020/jun/23/gitbranchname/ target=_blank rel=noopener>Regarding Git and Branch Naming</a>, statement from the Git project and the Software Freedom Conservancy regarding the new <code>init.defaultBranch</code> configuration option</li><li><a href=https://github.com/github/renaming#readme target=_blank rel=noopener>Renaming the default branch from<code>master</code></a>, GitHub&rsquo;s roadmap for supporting the shift away from <code>master</code></li><li><a href=https://about.gitlab.com/blog/2021/03/10/new-git-default-branch-name/ target=_blank rel=noopener>The new Git default branch name</a>, same, but for GitLab</li></ul><p>Folks at RStudio maintain hundreds of public repositories on GitHub, spread out over various organizations and user accounts. Some individual repos had already moved away from <code>master</code> in the past year, but many of us had not made the change, just due to inertia. We&rsquo;ve decided it tackle this switch proactively and in bulk, for any interested individual or team, hopefully reducing the pain for everyone.</p><p>The purpose of this blog post is to:</p><ul><li>Give our community a heads-up about this change.</li><li>Explain how this affects people who have cloned or forked our repositories.</li><li>Explain how you can make the <code>master</code> to <code>main</code> switch in your own Git life.</li><li>Advertise new functions in usethis >= 2.1.2 that help with the above.</li></ul><h2 id=tldr>TL;DR
<a href=#tldr><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>These are the key bits of code shown below.</p><p><strong>NOTE: you will need to update to usethis 2.1.2 or higher to get this functionality!</strong></p><table><thead><tr><th>Function</th><th>Purpose</th></tr></thead><tbody><tr><td><a href=https://usethis.r-lib.org/reference/git-default-branch.html target=_blank rel=noopener><code>usethis::git_default_branch()</code></a></td><td>Reveals the default branch of the current project.</td></tr><tr><td><a href=https://usethis.r-lib.org/reference/git-default-branch.html target=_blank rel=noopener><code>usethis::git_default_branch_rediscover()</code></a></td><td>Detects when a project&rsquo;s default branch has changed on GitHub and makes the necessary updates to your Git environment. Primarily for use by <strong>contributors</strong>.</td></tr><tr><td><a href=https://usethis.r-lib.org/reference/git-default-branch.html target=_blank rel=noopener><code>usethis::git_default_branch_rename()</code></a></td><td>Changes the default branch on GitHub and makes any necessary local updates. Aimed at <strong>maintainers</strong> who have admin permissions.</td></tr><tr><td><a href=https://usethis.r-lib.org/reference/git-default-branch.html target=_blank rel=noopener><code>usethis::git_default_branch_configure()</code></a></td><td>Changes the default name of the initial branch in new Git repos, going forward.</td></tr></tbody></table><p>Read on for more context.</p><h2 id=which-repositories-are-affected>Which repositories are affected?
<a href=#which-repositories-are-affected><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>The transition from <code>master</code> to <code>main</code> is happening organization-wide for specific GitHub organizations (e.g. 
<a href=https://github.com/tidyverse target=_blank rel=noopener>tidyverse</a>,
<a href=https://github.com/r-lib target=_blank rel=noopener>r-lib</a>,
<a href=https://github.com/tidymodels target=_blank rel=noopener>tidymodels</a>, and
<a href=https://github.com/sol-eng target=_blank rel=noopener>sol-eng</a>). However, several teams maintain repos across multiple organizations and several organizations host repos for multiple teams and purposes. The organization-wide approach doesn&rsquo;t work well for these cases. Therefore, many additional &ldquo;one-off&rdquo; repos are also part of this effort.</p><p>In total, we&rsquo;re coordinating the <code>master</code> to <code>main</code> switch for around 350 repositories.</p><p>In each case, we opened a GitHub issue announcing the coming change, several weeks in advance. These issues all look something like this: <a href=https://github.com/tidyverse/dplyr/issues/6006>https://github.com/tidyverse/dplyr/issues/6006</a>.</p><h2 id=when-are-things-changing>When are things changing?
<a href=#when-are-things-changing><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>&ldquo;Around now.&rdquo;</p><p>Ideally, we would publish this post at the very same moment we rename our branches. But that&rsquo;s not possible for a variety of reasons, chiefly because no single person has the necessary permissions for all of the affected repos.</p><p>Is there a repo you care about, that has an open issue about branch renaming, and yet the change doesn&rsquo;t seem to be happening? Feel free to give us a gentle nudge by commenting in the issue thread.</p><h2 id=usethis-has-functions-to-help>usethis has functions to help
<a href=#usethis-has-functions-to-help><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>The recent release of usethis has some new functions to support changes in the default branch. Specifically, you want version 2.1.2 or higher. To be clear, you don&rsquo;t <em>need</em> usethis to adapt to change in the default branch. On a small scale, the work can be done through some combination of command line Git and actions in a web browser, if that&rsquo;s how you roll.</p><p>But the new <code>git_default_branch*()</code> family of functions can make this process more pleasant, for those who enjoy using devtools/usethis, especially for Git and GitHub tasks. These functions also help us do this work programmatically for hundreds of repositories at once.</p><p>You can install the newest version of usethis from CRAN with:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf><a href=https://rdrr.io/r/utils/install.packages.html>install.packages</a></span><span class=o>(</span><span class=s>"usethis"</span><span class=o>)</span></code></pre></div><p>You can make usethis available in your R session with either of these commands:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=kr><a href=https://rdrr.io/r/base/library.html>library</a></span><span class=o>(</span><span class=nv><a href=https://usethis.r-lib.org>usethis</a></span><span class=o>)</span>

<span class=c># or possibly even better:</span>
<span class=kr><a href=https://rdrr.io/r/base/library.html>library</a></span><span class=o>(</span><span class=nv><a href=https://devtools.r-lib.org/>devtools</a></span><span class=o>)</span>
<span class=c># devtools Depends on usethis, so attaching devtools also attaches usethis</span></code></pre></div><p>If you&rsquo;d like usethis to help with you with Git/GitHub, please read the article
<a href=https://usethis.r-lib.org/articles/articles/git-credentials.html target=_blank rel=noopener>Managing Git(Hub) Credentials</a>.</p><p>usethis is very opinionated and conservative about which GitHub setups it&rsquo;s willing to manage, because we don&rsquo;t want to barge in and mess with something we don&rsquo;t understand. These standard setups and what we mean by, e.g., <strong>source repo</strong> are all described at <a href=https://happygitwithr.com/common-remote-setups.html>https://happygitwithr.com/common-remote-setups.html</a>.</p><div class=highlight><div class=figure style=text-align:center><p><img src=six-configs.png alt="Six common GitHub setups" width=100%></p><p class=caption>Six common GitHub setups</p></div></div><h2 id=how-to-update-your-clones-and-forks>How to update your clones and forks
<a href=#how-to-update-your-clones-and-forks><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>As mentioned above, our bulk renaming involves around 350 GitHub repos, which are associated with approximately 90K watchers, 34K forks, 9.5K open issues, and 1K open pull requests. It&rsquo;s impossible to say how many non-fork clones are out there. One thing that&rsquo;s clear: our branch renaming potentially affects lots of people.</p><h3 id=how-will-i-know-i-have-a-problem>How will I know I have a problem?
<a href=#how-will-i-know-i-have-a-problem><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>Here&rsquo;s what it looks like when you try to pull from a remote repo in a project that used to use <code>master</code>, but now uses <code>main</code>, but you haven&rsquo;t updated your local repo yet.</p><ul><li><p>Example with
<a href=https://usethis.r-lib.org/reference/pull-requests.html target=_blank rel=noopener><code>usethis::pr_merge_main()</code></a> <strong>with usethis >= 2.1.2</strong>:</p><pre><code>pr_merge_main()
#&gt; Error: Default branch mismatch between local repo and remote.
#&gt; The default branch of the &quot;origin&quot; remote is &quot;main&quot;.
#&gt; But the default branch of the local repo appears to be &quot;master&quot;.
#&gt; Call `git_default_branch_rediscover()` to resolve this.
</code></pre></li><li><p>Example with command line <code>git pull</code> (which is what RStudio&rsquo;s blue &ldquo;down&rdquo; arrow does):</p><pre><code>Your configuration specifies to merge with the ref 'refs/heads/master'
from the remote, but no such ref was fetched.
</code></pre></li></ul><p>Both messages are telling you the same thing:</p><blockquote><p>We&rsquo;re trying to pull changes from the remote <code>master</code> branch, but the remote does not have a <code>master</code> branch.</p></blockquote><p>You need to tell your local repo about the switch from <code>master</code> to <code>main</code>.</p><p>In usethis v2.0.1 and earlier, we were not proactively on the lookout for a change to the default branch name in the source repository. Implicitly, we assumed that the user was responsible for staying current with such changes. The recent usethis release (>= 2.1.2) tries much harder to alert the user if the default branch name changes and to provide an easy way to sync up.</p><h3 id=-can-i-just-burn-it-all-down->🔥 Can I just burn it all down? 🔥
<a href=#-can-i-just-burn-it-all-down-><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>Yes, yes you can!</p><p>If there&rsquo;s nothing precious in your local clone of our repo or in your fork, it&rsquo;s perfectly reasonable to delete them and just start over. Locally, you delete the folder corresponding to the repo. On GitHub, in your fork, go to <em>Settings</em> and scroll down to the <em>Danger Zone</em> to <em>Delete this repository</em>.</p><p>Then you can do a fresh fork-and-clone of, for example, dplyr:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf><a href=https://usethis.r-lib.org/reference/create_from_github.html>create_from_github</a></span><span class=o>(</span><span class=s>"tidyverse/dplyr"</span><span class=o>)</span></code></pre></div><h3 id=how-do-i-update-my-stuff-to-reflect-the-new-default-branch>How do I update my stuff to reflect the new default branch?
<a href=#how-do-i-update-my-stuff-to-reflect-the-new-default-branch><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>If you don&rsquo;t want to burn it all down, you can call
<a href=https://usethis.r-lib.org/reference/git-default-branch.html target=_blank rel=noopener><code>usethis::git_default_branch_rediscover()</code></a> to <em>rediscover</em> the default branch from the <strong>source repo</strong>.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf><a href=https://usethis.r-lib.org/reference/git-default-branch.html>git_default_branch_rediscover</a></span><span class=o>(</span><span class=o>)</span>
<span class=c>#&gt; ℹ Default branch of the source repo 'jennybc/happy-git-with-r': 'main'</span>
<span class=c>#&gt; ✓ Default branch of local repo has moved: 'master' --&gt; 'main'</span></code></pre></div><p>Above, you see usethis updating the local repository to match the source repo. If we detect that you also have a fork of this repo, usethis will rename its default branch as well.</p><p>GitHub provides official instructions for
<a href=https://docs.github.com/en/github/administering-a-repository/managing-branches-in-your-repository/renaming-a-branch#updating-a-local-clone-after-a-branch-name-changes target=_blank rel=noopener>updating a local clone after a branch name changes</a>, using only command line Git:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r>git branch -m OLD-BRANCH-NAME NEW-BRANCH-NAME
git fetch origin
git branch -u origin/NEW-BRANCH-NAME NEW-BRANCH-NAME
git remote set-head origin -a</code></pre></div><p>Depending on your setup, above you might need to substitute <code>upstream</code> for <code>origin</code>. <code>OLD-BRANCH-NAME</code> is probably <code>master</code> and <code>NEW-BRANCH-NAME</code> is probably <code>main</code>.</p><h2 id=how-to-rename-default-branch-in-your-own-existing-repos>How to rename default branch in your own existing repos
<a href=#how-to-rename-default-branch-in-your-own-existing-repos><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>You can rename the default branch for repos that you effectively own. This is a straightforward task for a repo that only exists on your computer. <sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> We&rsquo;re more concerned about the trickier case where the project is also on GitHub.</p><p>You can call
<a href=https://usethis.r-lib.org/reference/git-default-branch.html target=_blank rel=noopener><code>usethis::git_default_branch_rename()</code></a> to <em>rename</em> (or move) the default branch in the <strong>source repo</strong>. For this to work, you must either own the source repo personally or, if it&rsquo;s organization-owned, you must have <code>admin</code> permission. This is a higher level of permission than <code>write</code>, which is what&rsquo;s needed to push.
<a href=https://usethis.r-lib.org/reference/git-default-branch.html target=_blank rel=noopener><code>git_default_branch_rename()</code></a> checks this pre-requisite and exits early, without doing anything, if you are not going to be successful.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf><a href=https://usethis.r-lib.org/reference/git-default-branch.html>git_default_branch_rename</a></span><span class=o>(</span><span class=o>)</span>
<span class=c>#&gt; ✓ Default branch of the source repo 'jennybc/myrepo' has moved: 'master' --&gt; 'main'</span>
<span class=c>#&gt; • Be sure to update files that refer to the default branch by name.</span>
<span class=c>#&gt;   Consider searching within your project for 'master'.</span>
<span class=c>#&gt; x Some badges may refer to the old default branch 'master':</span>
<span class=c>#&gt;   - 'README.md'</span>
<span class=c>#&gt; ✓ Default branch of local repo has moved: 'master' --&gt; 'main'</span></code></pre></div><p>Once the default branch is successfully renamed in the source repo on GitHub,
<a href=https://usethis.r-lib.org/reference/git-default-branch.html target=_blank rel=noopener><code>git_default_branch_rename()</code></a> makes an internal call to
<a href=https://usethis.r-lib.org/reference/git-default-branch.html target=_blank rel=noopener><code>git_default_branch_rediscover()</code></a> to finish the job. This makes any necessary local changes or, more rarely, changes in a personal fork.</p><p>Note also that we check for specific files that often include the name of the default branch, such as GitHub Actions workflows and the badges section of README. These references should be updated. It&rsquo;s probably a good idea to do a project-wide search for both the old and the new name and take a hard look at the &ldquo;hits&rdquo;.</p><p>If you don&rsquo;t want to use usethis, you can rename the default branch from a web browser. On GitHub, in your repo, go to <em>Settings</em>, then <em>Branches</em>, and edit the <em>Default branch</em>. Then follow the command line instructions from the previous section, emulating what we do in
<a href=https://usethis.r-lib.org/reference/git-default-branch.html target=_blank rel=noopener><code>git_default_branch_rename()</code></a>.</p><h2 id=how-to-change-the-default-name-of-your-default-branch-for-the-future>How to change the default name of your default branch, for the future
<a href=#how-to-change-the-default-name-of-your-default-branch-for-the-future><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>The way most repos end up with <code>master</code> as their default branch is that Git itself defaults to <code>master</code> when it creates the very first branch, with the very first commit, in a new repo. As of Git 2.28 (released 2020-07-27), this became configurable, so it&rsquo;s one of those things you can customize in your global, i.e. user-level, Git config file. usethis does all of its Git work via the
<a href=https://docs.ropensci.org/gert/ target=_blank rel=noopener>gert package</a> and the underlying library libgit2 library gained similar support in version 1.1 (released 2020-10-12).</p><p>The new configuration option is <code>init.defaultBranch</code>.</p><p>There are various ways to set your preferred initial branch name to, e.g., <code>main</code>:</p><ul><li><p>With usethis >= 2.1.2, using a special-purpose function:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf><a href=https://usethis.r-lib.org/reference/git-default-branch.html>git_default_branch_configure</a></span><span class=o>(</span><span class=o>)</span>
  <span class=c>#&gt; ✓ Configuring init.defaultBranch as 'main'.</span>
  <span class=c>#&gt; ℹ Remember: this only affects repos you create in the future.</span></code></pre></div></li><li><p>With usethis, using the general function to modify your Git configuration:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf><a href=https://usethis.r-lib.org/reference/use_git_config.html>use_git_config</a></span><span class=o>(</span>init.defaultBranch <span class=o>=</span> <span class=s>"main"</span><span class=o>)</span></code></pre></div></li><li><p>With command line Git:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r>git config --global init.defaultBranch main</code></pre></div></li></ul><p>Although it is more rare to first create repos on a host like GitHub or GitLab, this certainly comes up from time to time. All the major providers now support configuration of the initial branch name and, in the absence of a user or organization preference, all default to <code>main</code>.</p><h2 id=acknowledgements>Acknowledgements
<a href=#acknowledgements><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Thanks to Jeroen Ooms (
<a href=https://github.com/jeroen target=_blank rel=noopener>@jeroen</a>), maintainer of gert, for adding
<a href=https://docs.ropensci.org/gert/reference/git_branch.html target=_blank rel=noopener><code>gert::git_branch_move()</code></a>. And thanks to everyone at RStudio helping with this effort, especially the champions from other teams: Barret Schloerke (
<a href=https://github.com/schloerke target=_blank rel=noopener>@schloerke</a>, Shiny), Ian Flores Siaca (
<a href=https://github.com/ian-flores target=_blank rel=noopener>@ian-flores</a>, Solutions Engineering), Julia Silge (
<a href=https://github.com/juliasilge target=_blank rel=noopener>@juliasilge</a>, tidymodels), Mine Çetinkaya-Rundel (
<a href=https://github.com/mine-cetinkaya-rundel target=_blank rel=noopener>@mine-cetinkaya-rundel</a>, Education), Sigrid Keydana (
<a href=https://github.com/skeydan target=_blank rel=noopener>@skeydan</a>, Machine Learning), Alison Presmanes Hill (
<a href=https://github.com/apreshill target=_blank rel=noopener>@apreshill</a>, Data Science Communication).</p><section class=footnotes role=doc-endnotes><hr><ol><li id=fn:1 role=doc-endnote><p><a href=https://usethis.r-lib.org/reference/git-default-branch.html target=_blank rel=noopener><code>usethis::git_default_branch_rename()</code></a> <strong>does</strong> handle the special case of <code>"no_github"</code>. Internally, it calls
<a href=https://docs.ropensci.org/gert/reference/git_branch.html target=_blank rel=noopener><code>gert::git_branch_move()</code></a>. With command line Git, use <code>git branch -m OLD-BRANCH-NAME NEW-BRANCH-NAME</code>. <a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></section></div></div><div class=column25><div class="section hideOnMobile"><div class=sectionTitle>Contents</div><nav id=TableOfContents><ul><li><a href=#tldr>TL;DR</a></li><li><a href=#which-repositories-are-affected>Which repositories are affected?</a></li><li><a href=#when-are-things-changing>When are things changing?</a></li><li><a href=#usethis-has-functions-to-help>usethis has functions to help</a></li><li><a href=#how-to-update-your-clones-and-forks>How to update your clones and forks</a></li><li><a href=#how-to-rename-default-branch-in-your-own-existing-repos>How to rename default branch in your own existing repos</a></li><li><a href=#how-to-change-the-default-name-of-your-default-branch-for-the-future>How to change the default name of your default branch, for the future</a></li><li><a href=#acknowledgements>Acknowledgements</a></li></ul></nav></div><div class=section></div></div></div></div></div><div id=rStudioFooter class=band><div class=bandContent><div id=copyright>The tidyverse is proudly supported by <a class=rstudioLogo href=https://posit.co/ aria-label="Posit Homepage"></a></div><div id=logos><a href=https://www.tidyverse.org/google_privacy_policy>Privacy policy</a>
<a href=https://github.com/tidyverse class="footerLogo gitHub" aria-label="Tidyverse GitHub organization"></a><a href=https://twitter.com/hashtag/rstats class="footerLogo twitter" aria-label="rstats hashtag on twitter.com"></a></div></div></div></div></div><script type=application/javascript>var dnt=(navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack);var doNotTrack=(dnt=="1"||dnt=="yes");if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');if(window.sessionStorage){var GA_SESSION_STORAGE_KEY='ga:clientId';ga('create','UA-115082821-1',{'storage':'none','clientId':sessionStorage.getItem(GA_SESSION_STORAGE_KEY)});ga(function(tracker){sessionStorage.setItem(GA_SESSION_STORAGE_KEY,tracker.get('clientId'));});}
ga('set','anonymizeIp',true);ga('send','pageview');}</script></body></html></div></div></body></html>