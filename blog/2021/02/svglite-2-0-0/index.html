<!doctype html><html><head><!doctype html><html lang=en-us><link rel=stylesheet href=/css/fonts.css><link rel=stylesheet href=/css/main-site.css><link rel=stylesheet href=/css/fa5-all.css><style type=text/css>body{background-color:#fff;color:#1a1917}a{color:#38577f}a:hover{color:#42709b}a:focus{outline-color:#42709b}.column25-left .sectionTitle a:hover:not(.current),.column16-left .sectionTitle a:hover:not(.current){color:#1a1917}.icon-attribution,.icon-attribution a{color:#1a1917;opacity:75%}#homeContent .band.first{background-color:#fff}#homeContent .band.second{background-color:#fdeba4}#homeContent .band.third{background-color:#fff}#rStudioHeader{background-color:#1a162d;color:#fff}#rStudioHeader .productName{color:#fff}#rStudioHeader .productName:hover,#rStudioHeader .productName:focus{color:#fdeba4}#rStudioHeader #menu .menuItem.a{background-color:#75aadb;color:#fff}#rStudioHeader #menu .menuItem:hover{background-color:#484557;color:#fff}#rStudioHeader #menu .menuItem.current{background-color:#fff;color:#1a162d;text-decoration:none}#rStudioFooter.band{background-color:#767381}#rStudioFooter .bandContent #copyright{color:#e3eef8}table tbody tr:nth-child(even){background-color:#f7faff}table tbody tr:nth-child(odd){background-color:#fff}.latest{border-top:.5em solid <no value>}.event{-moz-box-shadow:0 0 0 0 rgba(0,0,0,.1);-webkit-box-shadow:0 0 0 0 rgba(0,0,0,.1);box-shadow:0 0 0 0 rgba(0,0,0,.1)}.section .event{background-color:#eab0c41a}.section .event{border-top:7pt solid #a19ea936}.section .event a{color:#1a162d}.section .event{color:#404040}</style><link rel=stylesheet href=/css/tidyverse.css><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Hugo 0.71.1"><title>svglite 2.0.0</title><meta property="og:title" content="svglite 2.0.0"><meta property="og:description" content="svglite 2.0.0 is now on CRAN. This is a huge feature release and part rewrite, and should excite anyone who cares about vector graphics. Read on to find out what is new!"><meta property="og:type" content="article"><meta property="og:url" content="https://www.tidyverse.org/blog/2021/02/svglite-2-0-0/"><meta property="twitter:card" content="summary_large_image"><meta property="og:title" content="svglite 2.0.0 - Tidyverse"><meta property="description" content="svglite 2.0.0 is now on CRAN. This is a huge feature release and part rewrite, and should excite anyone who cares about vector graphics. Read on to find out what is new!"><meta property="og:description" content="svglite 2.0.0 is now on CRAN. This is a huge feature release and part rewrite, and should excite anyone who cares about vector graphics. Read on to find out what is new!"><meta property="og:image" content="https://www.tidyverse.org/blog/2021/02/svglite-2-0-0/thumbnail-sq.jpg"><meta name=twitter:image content="https://www.tidyverse.org/blog/2021/02/svglite-2-0-0/thumbnail-wd.jpg"><link rel=apple-touch-icon sizes=180x180 href=/images/favicons/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/images/favicons/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/images/favicons/favicon-16x16.png><link rel=manifest href=/images/favicons/site.webmanifest><link rel=mask-icon href=/images/favicons/safari-pinned-tab.svg><link rel="shortcut icon" href=/images/favicons/favicon.ico><meta name=msapplication-TileColor content="#da532c"><meta name=msapplication-config href=/images/favicons/browserconfig.xml><script type=text/javascript src=/js/jquery-3.5.1.min.js></script><script type=text/javascript src=/js/site.js></script><link rel=icon href=/images/favicon.ico><script type=text/javascript src=/js/clipboard.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin=anonymous></script><script defer data-domain=tidyverse.org,all.tidyverse.org src=https://plausible.io/js/plausible.js></script></head><body><div id=appTidyverseSite class="shrinkHeader alwaysShrinkHeader"><div id=main><div id=rStudioHeader><nav class=band><div class="innards bandContent"><div><a class=productName href=/%20/>Tidyverse</a></div><div id=menu><div id=menuToggler></div><div id=menuItems><a class=menuItem href=/packages/>Packages</a>
<a class="menuItem current" href=/blog/>Blog</a>
<a class=menuItem href=/learn/>Learn</a>
<a class=menuItem href=/help/>Help</a>
<a class=menuItem href=/contribute/>Contribute</a></div></div></div></nav></div><main><div class="band padForHeader pushFooter"><div class=bandContent><div class="full splitColumns withMobileMargins"><div class=column75><h1 class=article-title>svglite 2.0.0</h1><div class=article-header aria-hidden=true><div class=photo><img src=/blog/2021/02/svglite-2-0-0/thumbnail-wd.jpg></div><div class=photoCredit>Photo by <a href=https://unsplash.com/photos/pVoEPpLw818>Rodion Kutsaev</a></div></div><span class=article-date><i class="fas fa-calendar-day fa-fw"></i>&nbsp;&nbsp;2021/02/08</span><p style=margin-bottom:.5em;margin-top:.85em><i class="fas fa-tags"></i>&nbsp;
<a href=/tags/svglite/>svglite</a>,
<a href=/tags/graphic-device/>graphic-device</a></p><p style=margin-top:.5em><i class="fas fa-user-circle fa-fw"></i>&nbsp;
Thomas Lin Pedersen</p><div class=article-content><p>We&rsquo;re extremely happy to announce the release of
<a href=https://svglite.r-lib.org target=_blank rel=noopener>svglite</a> 2.0.0. svglite is a graphic device that is capable of creating SVG files from R graphics. SVG is a vector graphic format which means that it encodes the instructions for recreating a graphic in a scale-independent way. This is in contrast with raster graphics, such as PNG (as can be produced with the graphic devices in
<a href=https://ragg.r-lib.org target=_blank rel=noopener>ragg</a>), which encode actual pixel values and will get pixelated as you zoom in.</p><p>You can install the latest release of svglite from CRAN with:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nf><a href=https://rdrr.io/r/utils/install.packages.html>install.packages</a></span><span class=o>(</span><span class=s>"svglite"</span><span class=o>)</span></code></pre></div><p>Much time has passed since svglite had a major release and this blog post will go into detail with all the major changes. You can see a full list of changes in the
<a href=%7B%20github_release%20%7D>release notes</a>.</p><h2 id=motivation-for-svglite>Motivation for svglite
<a href=#motivation-for-svglite><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>As part of this release, we have sharpened our motivation for creating and maintaining svglite given the pre-existing
<a href=https://rdrr.io/r/grDevices/cairo.html target=_blank rel=noopener><code>svg()</code></a> device provided by R. All of the changes that are part of this release somehow plays into these motivations and are thus grouped by them below.</p><h3 id=editability>Editability
<a href=#editability><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>The main difference between the output of
<a href=https://rdrr.io/r/grDevices/cairo.html target=_blank rel=noopener><code>svg()</code></a> and
<a href=https://svglite.r-lib.org/reference/svglite.html target=_blank rel=noopener><code>svglite()</code></a> is that the former encodes text as polygons, whereas the later simply encodes it as text and relies on the svg renderer (usually a browser or a vector drawing program) to figure out the look of the text. There are upsides and downsides to this:</p><p><strong>Pros</strong></p><ul><li><p>Encoding text as text means that you can open up the resulting SVG in a vector drawing program (e.g.Â Inkscape or Illustrator) and do further modifications on the text, etc. While R graphics is capable of producing amazing visualizations by itself, it is not uncommon that some amount of post-processing is required, and maximum editability of the file is a huge boon there.</p></li><li><p>Encoding text as text means that the resulting file is more accessible. Screen readers will be able to understand and read the text and the text is selectable and copyable.</p></li><li><p>File size will be dramatically smaller (more on that [below]).</p></li></ul><p><strong>Cons</strong></p><ul><li><p>Encoding text as polygons will mean that the file does not require the used fonts to be present on the system it is viewed on.</p></li><li><p>Encoding text as text means that the final look depend on the implementation of the svg renderer as well as the fonts available on the system where it is rendered. This might sound more ominous than it really is. The vast majority of interactive data visualizations on the web are now based on D3.js which often renders to SVG and it all seems to behave. Still, this is something to be mindful of, and a reason to use
<a href=https://rdrr.io/r/grDevices/cairo.html target=_blank rel=noopener><code>svg()</code></a> if exactness of the rendered text is of prime importance.</p></li></ul><p>With this release we further improve upon the editability of the output on key points:</p><ol><li><p>The horizontal alignment of the text is now encoded in the CSS, rather than being pre-computed and offsetted. This is only possible for <em>left</em>, <em>center</em>, and <em>right</em> alignment as these are the only recognized alignment types in SVG, so setting it to something different will still give you the old offsetting behavior. This change means that you can more easily modify center and right aligned text in post processing without messing up the alignment of the text block.</p></li><li><p>Fixing of the text width is now optional. Since the text is not rendered before the SVG is opened the final width of text is unknown while it is being generated. The text width is used in key places by the R graphics engine, partly for alignment offsetting (which we don&rsquo;t need anymore), but also by e.g.Â ggplot2&rsquo;s <code>geom_label()</code> to figure out the size of the background box. svglite solves this by making a good guess at the width and using the <code>textLength</code> attribute of the <code>&lt;text></code> tag to force the renderer to make the text fit into that space. While this works, it also means that if you modify the text in post processing the text will remain at the same width no matter what you do. Since there&rsquo;s no single right way to handle this, we have made the fixing of text width optional using the <code>fix_text_size</code> argument. It defaults to <code>TRUE</code> which is the old behavior, but if you know you are going to edit some aspect of the text in post processing you can set it to <code>FALSE</code>.</p></li></ol><h3 id=speed>Speed
<a href=#speed><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>When first created, svglite was much faster than
<a href=https://rdrr.io/r/grDevices/cairo.html target=_blank rel=noopener><code>svg()</code></a>, but at some point this regressed quite considerably so the previous release of svglite was rather slow. This release not only brings svglite back to its past glory, but improves further upon it: this release is ~13x faster than the previous and is ~3x faster than using
<a href=https://rdrr.io/r/grDevices/cairo.html target=_blank rel=noopener><code>svg()</code></a> (based on admittedly simple benchmark in the
<a href=https://svglite.r-lib.org/index.html#speed target=_blank rel=noopener>readme</a>).</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=kr><a href=https://rdrr.io/r/base/library.html>library</a></span><span class=o>(</span><span class=nv><a href=http://tidyverse.tidyverse.org>tidyverse</a></span><span class=o>)</span>
<span class=kr><a href=https://rdrr.io/r/base/library.html>library</a></span><span class=o>(</span><span class=nv><a href=https://svglite.r-lib.org>svglite</a></span><span class=o>)</span>

<span class=nv>x</span> <span class=o>&lt;-</span> <span class=nf><a href=https://rdrr.io/r/stats/Uniform.html>runif</a></span><span class=o>(</span><span class=m>1e3</span><span class=o>)</span>
<span class=nv>y</span> <span class=o>&lt;-</span> <span class=nf><a href=https://rdrr.io/r/stats/Uniform.html>runif</a></span><span class=o>(</span><span class=m>1e3</span><span class=o>)</span>
<span class=nv>tmp1</span> <span class=o>&lt;-</span> <span class=nf><a href=https://rdrr.io/r/base/tempfile.html>tempfile</a></span><span class=o>(</span><span class=o>)</span>
<span class=nv>tmp2</span> <span class=o>&lt;-</span> <span class=nf><a href=https://rdrr.io/r/base/tempfile.html>tempfile</a></span><span class=o>(</span><span class=o>)</span>

<span class=nv>svglite_test</span> <span class=o>&lt;-</span> <span class=kr>function</span><span class=o>(</span><span class=o>)</span> <span class=o>&#123;</span>
  <span class=nf><a href=https://svglite.r-lib.org/reference/svglite.html>svglite</a></span><span class=o>(</span><span class=nv>tmp1</span><span class=o>)</span>
  <span class=nf><a href=https://rdrr.io/r/graphics/plot.default.html>plot</a></span><span class=o>(</span><span class=nv>x</span>, <span class=nv>y</span><span class=o>)</span>
  <span class=nf><a href=https://rdrr.io/r/grDevices/dev.html>dev.off</a></span><span class=o>(</span><span class=o>)</span>
<span class=o>&#125;</span>
<span class=nv>svg_test</span> <span class=o>&lt;-</span> <span class=kr>function</span><span class=o>(</span><span class=o>)</span> <span class=o>&#123;</span>
  <span class=nf><a href=https://rdrr.io/r/grDevices/cairo.html>svg</a></span><span class=o>(</span><span class=nv>tmp2</span>, onefile <span class=o>=</span> <span class=kc>TRUE</span><span class=o>)</span>
  <span class=nf><a href=https://rdrr.io/r/graphics/plot.default.html>plot</a></span><span class=o>(</span><span class=nv>x</span>, <span class=nv>y</span><span class=o>)</span>
  <span class=nf><a href=https://rdrr.io/r/grDevices/dev.html>dev.off</a></span><span class=o>(</span><span class=o>)</span>
<span class=o>&#125;</span>

<span class=nf>bench</span><span class=nf>::</span><span class=nf><a href=https://rdrr.io/pkg/bench/man/mark.html>mark</a></span><span class=o>(</span>
  <span class=s>"svglite()"</span> <span class=o>=</span> <span class=nf>svglite_test</span><span class=o>(</span><span class=o>)</span>, 
  <span class=s>"svg()"</span> <span class=o>=</span> <span class=nf>svg_test</span><span class=o>(</span><span class=o>)</span>, 
  min_iterations <span class=o>=</span> <span class=m>250</span>
<span class=o>)</span> <span class=o>%&gt;%</span> 
  <span class=nf><a href=https://rdrr.io/r/graphics/plot.default.html>plot</a></span><span class=o>(</span>type <span class=o>=</span> <span class=s>"ridge"</span><span class=o>)</span> <span class=o>+</span> 
  <span class=nf>labs</span><span class=o>(</span>x <span class=o>=</span> <span class=kc>NULL</span>, y <span class=o>=</span> <span class=kc>NULL</span><span class=o>)</span>
</code></pre><p><img src=figs/unnamed-chunk-2-1.png width=700px style=display:block;margin:auto></p></div><p>The additional speed is mainly achieved by no longer ensuring that the file is valid svg <em>while</em> it is being rendered. If you need this, you can get the old behavior (and speed) back by setting <code>always_valid = TRUE</code> when opening the device. You should however consider using
<a href=https://svglite.r-lib.org/reference/svgstring.html target=_blank rel=noopener><code>svgstring()</code></a> instead of
<a href=https://svglite.r-lib.org/reference/svglite.html target=_blank rel=noopener><code>svglite()</code></a> if you need to continuously access the svg while it is being rendered.</p><h3 id=file-size>File size
<a href=#file-size><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>svglite has always produced smaller files than the
<a href=https://rdrr.io/r/grDevices/cairo.html target=_blank rel=noopener><code>svg()</code></a> device because of the difference in how text is encoded, but this has been improved on further with this release, mainly by being smarter about how to handle clipping regions in the plot. Another file-size-related feature in the new release is built-in support for SVGZ (gzipped SVG), simply by providing a file name with an <code>.svgz</code> extension:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nv>p</span> <span class=o>&lt;-</span> <span class=nf>ggplot</span><span class=o>(</span><span class=nv>mtcars</span><span class=o>)</span> <span class=o>+</span> 
  <span class=nf>geom_point</span><span class=o>(</span><span class=nf>aes</span><span class=o>(</span>x <span class=o>=</span> <span class=nv>disp</span>, y <span class=o>=</span> <span class=nv>mpg</span>, color <span class=o>=</span> <span class=nv>gear</span><span class=o>)</span><span class=o>)</span>

<span class=nv>svglite_file</span> <span class=o>&lt;-</span> <span class=nf><a href=https://rdrr.io/r/base/tempfile.html>tempfile</a></span><span class=o>(</span><span class=o>)</span>
<span class=nv>svglite_file_gz</span> <span class=o>&lt;-</span> <span class=nf><a href=https://rdrr.io/r/base/tempfile.html>tempfile</a></span><span class=o>(</span>fileext <span class=o>=</span> <span class=s>".svgz"</span><span class=o>)</span>
<span class=nv>svg_file</span> <span class=o>&lt;-</span> <span class=nf><a href=https://rdrr.io/r/base/tempfile.html>tempfile</a></span><span class=o>(</span><span class=o>)</span>

<span class=nf><a href=https://svglite.r-lib.org/reference/svglite.html>svglite</a></span><span class=o>(</span><span class=nv>svglite_file</span><span class=o>)</span>
<span class=nf><a href=https://rdrr.io/r/graphics/plot.default.html>plot</a></span><span class=o>(</span><span class=nv>p</span><span class=o>)</span>
<span class=nf><a href=https://rdrr.io/r/base/invisible.html>invisible</a></span><span class=o>(</span><span class=nf><a href=https://rdrr.io/r/grDevices/dev.html>dev.off</a></span><span class=o>(</span><span class=o>)</span><span class=o>)</span>

<span class=nf><a href=https://svglite.r-lib.org/reference/svglite.html>svglite</a></span><span class=o>(</span><span class=nv>svglite_file_gz</span><span class=o>)</span>
<span class=nf><a href=https://rdrr.io/r/graphics/plot.default.html>plot</a></span><span class=o>(</span><span class=nv>p</span><span class=o>)</span>
<span class=nf><a href=https://rdrr.io/r/base/invisible.html>invisible</a></span><span class=o>(</span><span class=nf><a href=https://rdrr.io/r/grDevices/dev.html>dev.off</a></span><span class=o>(</span><span class=o>)</span><span class=o>)</span>

<span class=nf><a href=https://rdrr.io/r/grDevices/cairo.html>svg</a></span><span class=o>(</span><span class=nv>svg_file</span><span class=o>)</span>
<span class=nf><a href=https://rdrr.io/r/graphics/plot.default.html>plot</a></span><span class=o>(</span><span class=nv>p</span><span class=o>)</span>
<span class=nf><a href=https://rdrr.io/r/base/invisible.html>invisible</a></span><span class=o>(</span><span class=nf><a href=https://rdrr.io/r/grDevices/dev.html>dev.off</a></span><span class=o>(</span><span class=o>)</span><span class=o>)</span>

<span class=nv>sizes</span> <span class=o>&lt;-</span> <span class=nf><a href=https://rdrr.io/r/base/data.frame.html>data.frame</a></span><span class=o>(</span>
  device <span class=o>=</span> <span class=nf><a href=https://rdrr.io/r/base/c.html>c</a></span><span class=o>(</span><span class=s>"svglite()"</span>, <span class=s>"svglite()\n&lt;gzipped&gt;"</span>, <span class=s>"svg()"</span><span class=o>)</span>,
  size <span class=o>=</span> <span class=nf>fs</span><span class=nf>::</span><span class=nf><a href=http://fs.r-lib.org/reference/file_info.html>file_size</a></span><span class=o>(</span><span class=nf><a href=https://rdrr.io/r/base/c.html>c</a></span><span class=o>(</span><span class=nv>svglite_file</span>, <span class=nv>svglite_file_gz</span>, <span class=nv>svg_file</span><span class=o>)</span><span class=o>)</span>
<span class=o>)</span>

<span class=nf>ggplot</span><span class=o>(</span><span class=nv>sizes</span><span class=o>)</span> <span class=o>+</span> 
  <span class=nf>geom_col</span><span class=o>(</span><span class=nf>aes</span><span class=o>(</span>x <span class=o>=</span> <span class=nv>size</span> <span class=o>/</span> <span class=m>1024</span>, y <span class=o>=</span> <span class=nv>device</span><span class=o>)</span><span class=o>)</span> <span class=o>+</span> 
  <span class=nf>labs</span><span class=o>(</span>x <span class=o>=</span> <span class=s>"Size (Kb)"</span>, y <span class=o>=</span> <span class=kc>NULL</span><span class=o>)</span>
</code></pre><p><img src=figs/unnamed-chunk-3-1.png width=700px style=display:block;margin:auto></p></div><h3 id=font-support>Font support
<a href=#font-support><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>You may remember a few days ago when we
<a href=https://www.tidyverse.org/blog/2021/02/modern-text-features/ target=_blank rel=noopener>announced some major improvements to ragg and its rendering of text</a>. What about svglite? For the most part svglite has delegated its rendering of text to the svg renderer so by and large it has always supported advanced text features such as right-to-left text, font fallback, and color fonts. Some changes have spilled over though, as svglite is now also based on systemfonts and uses that for doing font lookup and text width calculations. This change means that svglite now have direct access to all your installed fonts along with whatever you have registered with
<a href=https://rdrr.io/pkg/systemfonts/man/register_font.html target=_blank rel=noopener><code>register_font()</code></a> and
<a href=https://rdrr.io/pkg/systemfonts/man/register_variant.html target=_blank rel=noopener><code>register_variant()</code></a>. If you have registered any OpenType features or alternative weights with a font you use, these will now be encoded into the CSS of the text block:</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=kr><a href=https://rdrr.io/r/base/library.html>library</a></span><span class=o>(</span><span class=nv><a href=https://github.com/r-lib/systemfonts>systemfonts</a></span><span class=o>)</span>
<span class=nf><a href=https://rdrr.io/pkg/systemfonts/man/register_variant.html>register_variant</a></span><span class=o>(</span>
  name <span class=o>=</span> <span class=s>"Montserrat Extreme"</span>, 
  family <span class=o>=</span> <span class=s>"Montserrat"</span>, 
  weight <span class=o>=</span> <span class=s>"semibold"</span>,
  features <span class=o>=</span> <span class=nf><a href=https://rdrr.io/pkg/systemfonts/man/font_feature.html>font_feature</a></span><span class=o>(</span>ligatures <span class=o>=</span> <span class=s>"discretionary"</span>, letters <span class=o>=</span> <span class=s>"stylistic"</span><span class=o>)</span>
<span class=o>)</span>

<span class=nv>p</span> <span class=o>&lt;-</span> <span class=nf>ggplot</span><span class=o>(</span><span class=o>)</span> <span class=o>+</span> 
  <span class=nf>geom_text</span><span class=o>(</span>
    <span class=nf>aes</span><span class=o>(</span>x <span class=o>=</span> <span class=m>0</span>, y <span class=o>=</span> <span class=m>1</span>, label <span class=o>=</span> <span class=s>"This text should definitely differ"</span><span class=o>)</span>,
    family <span class=o>=</span> <span class=s>"Montserrat"</span>,
    size <span class=o>=</span> <span class=m>6</span>
  <span class=o>)</span> <span class=o>+</span> 
  <span class=nf>geom_text</span><span class=o>(</span>
    <span class=nf>aes</span><span class=o>(</span>x <span class=o>=</span> <span class=m>0</span>, y <span class=o>=</span> <span class=m>0</span>, label <span class=o>=</span> <span class=s>"This text should definitely differ"</span><span class=o>)</span>,
    family <span class=o>=</span> <span class=s>"Montserrat Extreme"</span>,
    size <span class=o>=</span> <span class=m>6</span>
  <span class=o>)</span> <span class=o>+</span> 
  <span class=nf>theme_void</span><span class=o>(</span><span class=o>)</span> <span class=o>+</span> 
  <span class=nf>expand_limits</span><span class=o>(</span>y <span class=o>=</span> <span class=nf><a href=https://rdrr.io/r/base/c.html>c</a></span><span class=o>(</span><span class=o>-</span><span class=m>1</span>, <span class=m>2</span><span class=o>)</span><span class=o>)</span>

<span class=nv>svg</span> <span class=o>&lt;-</span> <span class=nf><a href=https://svglite.r-lib.org/reference/svgstring.html>svgstring</a></span><span class=o>(</span>fix_text_size <span class=o>=</span> <span class=kc>FALSE</span>, standalone <span class=o>=</span> <span class=kc>FALSE</span><span class=o>)</span>
<span class=nf><a href=https://rdrr.io/r/graphics/plot.default.html>plot</a></span><span class=o>(</span><span class=nv>p</span><span class=o>)</span>
<span class=nf><a href=https://rdrr.io/r/base/invisible.html>invisible</a></span><span class=o>(</span><span class=nf><a href=https://rdrr.io/r/grDevices/dev.html>dev.off</a></span><span class=o>(</span><span class=o>)</span><span class=o>)</span>

<span class=nf><a href=https://rdrr.io/r/grDevices/cairo.html>svg</a></span><span class=o>(</span><span class=o>)</span></code></pre></div><div class=highlight><pre class=chroma><code class=language-svg data-lang=svg><span class=nt>&lt;svg</span> <span class=na>class=</span><span class=s>&#39;svglite&#39;</span> <span class=na>width=</span><span class=s>&#39;720.00pt&#39;</span> <span class=na>height=</span><span class=s>&#39;576.00pt&#39;</span> <span class=na>viewBox=</span><span class=s>&#39;0 0 720.00 576.00&#39;</span><span class=nt>&gt;</span>
<span class=nt>&lt;defs&gt;</span>
  <span class=nt>&lt;style</span> <span class=na>type=</span><span class=s>&#39;text/css&#39;</span><span class=nt>&gt;</span><span class=cp>&lt;![CDATA[
</span><span class=cp>    .svglite line, .svglite polyline, .svglite polygon, .svglite path, .svglite rect, .svglite circle {
</span><span class=cp>      fill: none;
</span><span class=cp>      stroke: #000000;
</span><span class=cp>      stroke-linecap: round;
</span><span class=cp>      stroke-linejoin: round;
</span><span class=cp>      stroke-miterlimit: 10.00;
</span><span class=cp>    }
</span><span class=cp>  ]]&gt;</span><span class=nt>&lt;/style&gt;</span>
<span class=nt>&lt;/defs&gt;</span>
<span class=nt>&lt;rect</span> <span class=na>width=</span><span class=s>&#39;100%&#39;</span> <span class=na>height=</span><span class=s>&#39;100%&#39;</span> <span class=na>style=</span><span class=s>&#39;stroke: none; fill: #FFFFFF;&#39;</span><span class=nt>/&gt;</span>
<span class=nt>&lt;defs&gt;</span>
  <span class=nt>&lt;clipPath</span> <span class=na>id=</span><span class=s>&#39;cpMC4wMHw3MjAuMDB8MC4wMHw1NzYuMDA=&#39;</span><span class=nt>&gt;</span>
    <span class=nt>&lt;rect</span> <span class=na>x=</span><span class=s>&#39;0.00&#39;</span> <span class=na>y=</span><span class=s>&#39;0.00&#39;</span> <span class=na>width=</span><span class=s>&#39;720.00&#39;</span> <span class=na>height=</span><span class=s>&#39;576.00&#39;</span> <span class=nt>/&gt;</span>
  <span class=nt>&lt;/clipPath&gt;</span>
<span class=nt>&lt;/defs&gt;</span>
<span class=nt>&lt;g</span> <span class=na>clip-path=</span><span class=s>&#39;url(#cpMC4wMHw3MjAuMDB8MC4wMHw1NzYuMDA=)&#39;</span><span class=nt>&gt;</span>
<span class=nt>&lt;text</span> <span class=na>x=</span><span class=s>&#39;360.00&#39;</span> <span class=na>y=</span><span class=s>&#39;206.70&#39;</span> <span class=na>text-anchor=</span><span class=s>&#39;middle&#39;</span> <span class=na>style=</span><span class=s>&#39;font-size: 17.07px; font-family: Montserrat;&#39;</span><span class=nt>&gt;</span>This text should definitely differ<span class=nt>&lt;/text&gt;</span>
<span class=nt>&lt;text</span> <span class=na>x=</span><span class=s>&#39;360.00&#39;</span> <span class=na>y=</span><span class=s>&#39;381.25&#39;</span> <span class=na>text-anchor=</span><span class=s>&#39;middle&#39;</span> <span class=na>style=</span><span class=s>&#39;font-size: 17.07px; font-weight: 600; font-family: Montserrat; font-feature-settings: &#34;dlig&#34; 1,&#34;salt&#34; 1;&#39;</span><span class=nt>&gt;</span>This text should definitely differ<span class=nt>&lt;/text&gt;</span>
<span class=nt>&lt;/g&gt;</span>
<span class=nt>&lt;/svg&gt;</span>
</code></pre></div><p>If you compare the two <code>&lt;text></code> tags in the end, you can see that the last one has the equivalent of <em>semibold</em> (600) encoded as the weight, along with the registered font feature settings (<em>dlig</em> is the tag for discretionary ligatures and <em>salt</em> is the tag for stylistic alternatives).</p><p>The switch to using systemfonts means that two old arguments to svglite: <code>system_fonts</code> and <code>user_fonts</code> have become superseded by the font registration in systemfonts. While they work for now they will likely become deprecated in the future as we streamline the text handling among our graphics devices.</p><p>The last addition to font handling in svglite is the support for embedding web font imports in the output. As we discussed in the
<a href=#editability>editability</a> section, the output from svglite will only render correctly if the used fonts are available. This is not a given when using non-standard fonts, but CSS provides a safety net by allowing the viewer to download fonts on the fly if required. You can specify a web font in two ways:</p><ol><li><p>As a URL (e.g.Â from Google Fonts) which will be used in an <code>@import</code> directive.</p></li><li><p>Using
<a href=https://svglite.r-lib.org/reference/font_face.html target=_blank rel=noopener><code>font_face()</code></a> which allows you to manually set the location of different font files and local backup fonts along with a identification name and potential styles to use. This will all be collected into a <code>@font-face</code> directive.</p></li></ol><p>We can use this with the example above to make sure that the SVG renders correctly even on computers that doesn&rsquo;t have the Montserrat font installed.</p><div class=highlight><pre class=chroma><code class=language-r data-lang=r><span class=nv>svg</span> <span class=o>&lt;-</span> <span class=nf><a href=https://svglite.r-lib.org/reference/svgstring.html>svgstring</a></span><span class=o>(</span>
  width <span class=o>=</span> <span class=m>6</span>, height <span class=o>=</span> <span class=m>2</span>,
  web_fonts <span class=o>=</span> <span class=nf><a href=https://rdrr.io/r/base/list.html>list</a></span><span class=o>(</span>
    <span class=s>"https://brick.freetls.fastly.net/Montserrat:400,600"</span>
  <span class=o>)</span>,
  fix_text_size <span class=o>=</span> <span class=kc>FALSE</span>, 
  standalone <span class=o>=</span> <span class=kc>FALSE</span>
<span class=o>)</span>
<span class=nf><a href=https://rdrr.io/r/graphics/plot.default.html>plot</a></span><span class=o>(</span><span class=nv>p</span><span class=o>)</span>
<span class=nf><a href=https://rdrr.io/r/base/invisible.html>invisible</a></span><span class=o>(</span><span class=nf><a href=https://rdrr.io/r/grDevices/dev.html>dev.off</a></span><span class=o>(</span><span class=o>)</span><span class=o>)</span>

<span class=nf><a href=https://rdrr.io/r/grDevices/cairo.html>svg</a></span><span class=o>(</span><span class=o>)</span>
</code></pre><svg class="svglite" width="432pt" height="144pt" viewBox="0 0 432 144"><defs><style>@import "https://brick.freetls.fastly.net/Montserrat:400,600";.svglite line,.svglite polyline,.svglite polygon,.svglite path,.svglite rect,.svglite circle{fill:none;stroke:#000;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10}</style></defs><rect width="100%" height="100%" style="stroke:none;fill:#fff"/><defs><clipPath id="cpMC4wMHw0MzIuMDB8MC4wMHwxNDQuMDA="><rect x="0" y="0" width="432" height="144"/></clipPath></defs><g clip-path="url(#cpMC4wMHw0MzIuMDB8MC4wMHwxNDQuMDA=)"><text x="216" y="56.15" text-anchor="middle" style="font-size:17.07px;font-family:Montserrat">This text should definitely differ</text><text x="216" y="99.79" text-anchor="middle" style='font-size:17.07px;font-weight:600;font-family:Montserrat;font-feature-settings:"dlig" 1,"salt" 1'>This text should definitely differ</text></g></svg></div><p>I&rsquo;m using
<a href=https://brick.im target=_blank rel=noopener>Brick</a> as a web font host since they include all OpenType features in their served font (which we need here), but the mechanism is the same for using e.g.
<a href=https://fonts.google.com target=_blank rel=noopener>Google Font</a>.</p><h2 id=all-the-rest>All the rest
<a href=#all-the-rest><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>These are just some of the many new features in this release. Depending on your temperament these other features may also get you excited:</p><ul><li><p>Support for generating multiple SVG files in one go using the standard file naming pattern (e.g.Â <code>"Rplot%03d.svg"</code>).</p></li><li><p>Direct encoding of raster data instead of rendering it through Cairo (this avoids downscaling any raster data).</p></li><li><p>Addition of a top-level <code>.svglite</code> class and possibility of adding a custom top-level id.</p></li><li><p>Addition of <code>scaling</code> argument in line with the ragg devices.</p></li></ul><h2 id=acknowledgments>Acknowledgments
<a href=#acknowledgments><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>This release comprises the work of 15 different contributors. Thank you all for your thoughtful comments, patience, and hard work!</p><p><a href=https://github.com/barrel0luck target=_blank rel=noopener>@barrel0luck</a>,
<a href=https://github.com/CameronNemo target=_blank rel=noopener>@CameronNemo</a>,
<a href=https://github.com/cpsievert target=_blank rel=noopener>@cpsievert</a>,
<a href=https://github.com/hadley target=_blank rel=noopener>@hadley</a>,
<a href=https://github.com/jeroen target=_blank rel=noopener>@jeroen</a>,
<a href=https://github.com/jimhester target=_blank rel=noopener>@jimhester</a>,
<a href=https://github.com/jplecavalier target=_blank rel=noopener>@jplecavalier</a>,
<a href=https://github.com/kurpav00 target=_blank rel=noopener>@kurpav00</a>,
<a href=https://github.com/kuzmenkov111 target=_blank rel=noopener>@kuzmenkov111</a>,
<a href=https://github.com/nx10 target=_blank rel=noopener>@nx10</a>,
<a href=https://github.com/paessens target=_blank rel=noopener>@paessens</a>,
<a href=https://github.com/pmur002 target=_blank rel=noopener>@pmur002</a>,
<a href=https://github.com/sqjin target=_blank rel=noopener>@sqjin</a>,
<a href=https://github.com/svenyos target=_blank rel=noopener>@svenyos</a>, and
<a href=https://github.com/thomasp85 target=_blank rel=noopener>@thomasp85</a>.</p></div></div><div class=column25><div class="section hideOnMobile"><div class=sectionTitle>Contents</div><nav id=TableOfContents><ul><li><a href=#motivation-for-svglite>Motivation for svglite</a></li><li><a href=#all-the-rest>All the rest</a></li><li><a href=#acknowledgments>Acknowledgments</a></li></ul></nav></div><div class=section></div></div></div></div></div><div id=rStudioFooter class=band><div class=bandContent><div id=copyright>The tidyverse is proudly supported by <a class=rstudioLogo href=https://posit.co/ aria-label="Posit Homepage"></a></div><div id=logos><a href=https://www.tidyverse.org/google_privacy_policy>Privacy policy</a>
<a href=https://github.com/tidyverse class="footerLogo gitHub" aria-label="Tidyverse GitHub organization"></a><a href=https://twitter.com/hashtag/rstats class="footerLogo twitter" aria-label="rstats hashtag on twitter.com"></a></div></div></div></div></div><script src=/js/math-code.js></script><script type=text/x-mathjax-config>
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    processEscapes: true
  }
});
</script><script async src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><script type=application/javascript>var dnt=(navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack);var doNotTrack=(dnt=="1"||dnt=="yes");if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');if(window.sessionStorage){var GA_SESSION_STORAGE_KEY='ga:clientId';ga('create','UA-115082821-1',{'storage':'none','clientId':sessionStorage.getItem(GA_SESSION_STORAGE_KEY)});ga(function(tracker){sessionStorage.setItem(GA_SESSION_STORAGE_KEY,tracker.get('clientId'));});}
ga('set','anonymizeIp',true);ga('send','pageview');}</script></body></html></div></div></body></html>