<!doctype html><html><head><!doctype html><html lang=en-us><link rel=stylesheet href=/css/fonts.css><link rel=stylesheet href=/css/main-site.css><link rel=stylesheet href=/css/fa5-all.css><style type=text/css>body{background-color:#fff;color:#1a1917}a{color:#38577f}a:hover{color:#42709b}a:focus{outline-color:#42709b}.column25-left .sectionTitle a:hover:not(.current),.column16-left .sectionTitle a:hover:not(.current){color:#1a1917}.icon-attribution,.icon-attribution a{color:#1a1917;opacity:75%}#homeContent .band.first{background-color:#fff}#homeContent .band.second{background-color:#fdeba4}#homeContent .band.third{background-color:#fff}#rStudioHeader{background-color:#1a162d;color:#fff}#rStudioHeader .productName{color:#fff}#rStudioHeader .productName:hover,#rStudioHeader .productName:focus{color:#fdeba4}#rStudioHeader #menu .menuItem.a{background-color:#75aadb;color:#fff}#rStudioHeader #menu .menuItem:hover{background-color:#484557;color:#fff}#rStudioHeader #menu .menuItem.current{background-color:#fff;color:#1a162d;text-decoration:none}#rStudioFooter.band{background-color:#767381}#rStudioFooter .bandContent #copyright{color:#e3eef8}table tbody tr:nth-child(even){background-color:#f7faff}table tbody tr:nth-child(odd){background-color:#fff}.latest{border-top:.5em solid <no value>}.event{-moz-box-shadow:0 0 0 0 rgba(0,0,0,.1);-webkit-box-shadow:0 0 0 0 rgba(0,0,0,.1);box-shadow:0 0 0 0 rgba(0,0,0,.1)}.section .event{background-color:#eab0c41a}.section .event{border-top:7pt solid #a19ea936}.section .event a{color:#1a162d}.section .event{color:#404040}</style><link rel=stylesheet href=/css/tidyverse.css><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Hugo 0.71.1"><title>gargle's debut on CRAN</title><meta property="og:title" content="gargle's debut on CRAN"><meta property="og:description" content="gargle is now on CRAN."><meta property="og:type" content="article"><meta property="og:url" content="https://www.tidyverse.org/blog/2019/08/gargle-hello-world/"><meta property="twitter:card" content="summary_large_image"><meta property="og:title" content="gargle's debut on CRAN - Tidyverse"><meta property="description" content="gargle is now on CRAN."><meta property="og:description" content="gargle is now on CRAN."><meta property="og:image" content="https://www.tidyverse.org/blog/2019/08/gargle-hello-world/gargle-hello-world-sq.jpg"><meta name=twitter:image content="https://www.tidyverse.org/blog/2019/08/gargle-hello-world/gargle-hello-world-wd.jpg"><link rel=apple-touch-icon sizes=180x180 href=/images/favicons/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/images/favicons/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/images/favicons/favicon-16x16.png><link rel=manifest href=/images/favicons/site.webmanifest><link rel=mask-icon href=/images/favicons/safari-pinned-tab.svg><link rel="shortcut icon" href=/images/favicons/favicon.ico><meta name=msapplication-TileColor content="#da532c"><meta name=msapplication-config href=/images/favicons/browserconfig.xml><script type=text/javascript src=/js/jquery-3.5.1.min.js></script><script type=text/javascript src=/js/site.js></script><link rel=icon href=/images/favicon.ico><script type=text/javascript src=/js/clipboard.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin=anonymous></script><script defer data-domain=tidyverse.org,all.tidyverse.org src=https://plausible.io/js/plausible.js></script></head><body><div id=appTidyverseSite class="shrinkHeader alwaysShrinkHeader"><div id=main><div id=rStudioHeader><nav class=band><div class="innards bandContent"><div><a class=productName href=/>Tidyverse</a></div><div id=menu><div id=menuToggler></div><div id=menuItems><a class=menuItem href=/packages/>Packages</a>
<a class="menuItem current" href=/blog/>Blog</a>
<a class=menuItem href=/learn/>Learn</a>
<a class=menuItem href=/help/>Help</a>
<a class=menuItem href=/contribute/>Contribute</a></div></div></div></nav></div><main><div class="band padForHeader pushFooter"><div class=bandContent><div class="full splitColumns withMobileMargins"><div class=column75><h1 class=article-title>gargle&rsquo;s debut on CRAN</h1><div class=article-header aria-hidden=true><div class=photo><img src=/blog/2019/08/gargle-hello-world/gargle-hello-world-wd.jpg></div><div class=photoCredit>Photo by <a href=https://flic.kr/p/oe2LJ1>North Carolina Christian advocate (1894)</a></div></div><span class=article-date><i class="fas fa-calendar-day fa-fw"></i>&nbsp;&nbsp;2019/08/20</span><p style=margin-bottom:.5em;margin-top:.85em><i class="fas fa-tags"></i>&nbsp;
<a href=/tags/r-lib/>r-lib</a>,
<a href=/tags/gargle/>gargle</a></p><p style=margin-top:.5em><i class="fas fa-user-circle fa-fw"></i>&nbsp;
Jenny Bryan</p><div class=article-content><p>We&rsquo;re elated to (somewhat belatedly) announce the initial release of gargle on CRAN!</p><p>The gargle package (<a href=https://gargle.r-lib.org>https://gargle.r-lib.org</a>) is meant to take some of the pain out of working with Google APIs. It&rsquo;s mostly aimed at the maintainers of R packages that call Google APIs. If we&rsquo;re successful, users won&rsquo;t really notice gargle, they&rsquo;ll just feel like these packages got easier to work with and less idiosyncratic.</p><p>The timing of this post is motivated by the release of
<a href=https://googledrive.tidyverse.org target=_blank rel=noopener>googledrive</a> v1.0.0. As of this version, googledrive gets all of its auth functionality (and more) from gargle. Although we did not blog about it, bigrquery also recently made the switch, with the release of v1.2.0.</p><p>If you are interested in the user-facing implications of using gargle, check out the
<a href=https://www.tidyverse.org/articles/2019/08/googledrive-1-0-0/ target=_blank rel=noopener>blog post announcing googledrive v1.0.0</a> and the
<a href=https://bigrquery.r-dbi.org/news/index.html#bigrquery-1-2-0 target=_blank rel=noopener>changelog for bigrquery v1.2.0</a>.</p><h2 id=gargle>gargle
<a href=#gargle><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>The
<a href=https://gargle.r-lib.org target=_blank rel=noopener>gargle package</a> first appeared on CRAN in early June 2019 and has gotten a few small updates as we learn more by wiring it into packages. gargle is already used by:</p><ul><li><a href=https://bigrquery.r-dbi.org target=_blank rel=noopener>bigrquery</a> (>= v1.2.0)</li><li><a href=https://googledrive.tidyverse.org target=_blank rel=noopener>googledrive</a> (>= v1.0.0)</li><li><a href=https://gmailr.r-lib.org target=_blank rel=noopener>gmailr</a> (>= v1.0.0 <em>coming soon to CRAN</em>)</li><li><a href=https://code.markedmondson.me/googleAuthR/ target=_blank rel=noopener>googleAuthR</a> (<em>dev version</em>)</li><li><a href=https://googlesheets4.tidyverse.org target=_blank rel=noopener>googlesheets4</a> <em>GitHub only</em></li><li><a href=https://andrie.github.io/gcalendr/ target=_blank rel=noopener>gcalendr</a> <em>GitHub only</em></li></ul><p>gargle&rsquo;s current functionality falls into two domains, which a client package can adopt (or not) separately:</p><ul><li>Auth: help users authenticate themselves with their Google identity and
obtain a token that the wrapper package can use to make authorized requests.</li><li>Request preparation and response handling: check requests against the
machine-readable
<a href=https://developers.google.com/discovery/v1/reference/apis target=_blank rel=noopener>Discovery Documents</a>
that describe Google APIs and process API responses, especially errors.</li></ul><p>The long-term stretch goal is to do for R what the
<a href=https://developers.google.com/api-client-library/ target=_blank rel=noopener>official Google API Client Libraries</a> do for other languages, like Python and Java.</p><h2 id=auth-via-gargle>Auth via gargle
<a href=#auth-via-gargle><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Under the hood, gargle&rsquo;s main auth function is
<a href=https://gargle.r-lib.org/articles/how-gargle-gets-tokens.html target=_blank rel=noopener><code>token_fetch()</code></a>, which tries a series of different methods for obtaining a token. The intent is to make auth &ldquo;just work&rdquo; in a wide variety of contexts. This makes some flows newly available in the client packages, such as Application Default Credentials (
<a href=https://cloud.google.com/docs/authentication/production target=_blank rel=noopener>official Google docs</a> and a
<a href=https://www.jhanley.com/google-cloud-application-default-credentials/ target=_blank rel=noopener>more readable 3rd party blog post</a>).</p><p>The main change that users will notice is that gargle implements its own way of storing user OAuth tokens between sessions. The
<a href=https://httr.r-lib.org target=_blank rel=noopener>httr package</a>, which gargle depends on, has historically used a local <code>.httr-oauth</code> file for this. In contrast, gargle encourages tokens to be stored <em>outside</em> the project, in a hidden directory at the user level, in a key-value store that incorporates the Google user&rsquo;s email. This makes it harder to accidentally push your tokens to the cloud, easier to use multiple Google identities, and easier to share tokens across projects and packages. Users will notice they need to re-auth and may want to track down and delete vestigial <code>.httr-oauth</code> files.</p><h2 id=articles-and-docs>Articles and docs
<a href=#articles-and-docs><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>The release of gargle has provided an occasion to document several recurring workflows that can be tricky for useRs, which now work the same across multiple packages:</p><ul><li><a href=https://gargle.r-lib.org/articles/non-interactive-auth.html target=_blank rel=noopener>Non-interactive auth</a></li><li><a href=https://gargle.r-lib.org/articles/auth-from-web.html target=_blank rel=noopener>Auth when using R in the browser</a></li><li><a href=https://gargle.r-lib.org/articles/articles/managing-tokens-securely.html target=_blank rel=noopener>Managing tokens securely</a></li><li><a href=https://gargle.r-lib.org/articles/get-api-credentials.html target=_blank rel=noopener>How to get your own API credentials</a></li></ul><p>gargle also offers a mechanism for client packages to build the documentation for their auth function from templates stored in gargle. This means that packages using a common design will also use the same words to describe it.</p><p>Another set of articles is aimed at package maintainers interested in delegating auth or request & response handling to gargle:</p><ul><li><a href=https://gargle.r-lib.org/articles/gargle-auth-in-client-package.html target=_blank rel=noopener>How to use gargle for auth in a client package</a></li><li><a href=https://gargle.r-lib.org/articles/request-helper-functions.html target=_blank rel=noopener>Request helper functions</a></li></ul><h2 id=privacy-policy-for-google-related-tidyverser-lib-packages>Privacy policy for Google-related tidyverse/r-lib packages
<a href=#privacy-policy-for-google-related-tidyverser-lib-packages><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Google is tightening the rules around various aspects of API access (see, e.g.,
<a href=https://www.blog.google/technology/safety-security/project-strobe/ target=_blank rel=noopener>Project Strobe</a> and
<a href=https://cloud.google.com/blog/products/g-suite/elevating-user-trust-in-our-api-ecosystems target=_blank rel=noopener>Elevating user trust in our API ecosystem</a>). I predict the main thing that useRs will notice is that more and more R packages and apps will require the user to get involved in the nitty gritty details of auth. Users will need to create their own Google Cloud Platform projects, obtain their own API keys, and their own OAuth client IDs and secrets. The overall rationale for Google&rsquo;s changes makes sense, but the way people use open source R packages is an awkward fit with their recommended auth solutions. It&rsquo;s becoming more difficult for package developers to make auth feel like it &ldquo;just works&rdquo;.</p><p>The Google-wrapping packages maintained by the tidyverse / r-lib team are now governed by a shared
<a href=https://www.tidyverse.org/google_privacy_policy/ target=_blank rel=noopener>Privacy Policy</a>. This is linked from each package and also from the consent screen whenever auth is facilitated through our OAuth client.</p><h2 id=some-gargle-history>Some gargle history
<a href=#some-gargle-history><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>I find gargle&rsquo;s origin story find very satisfying. I suspect that Hadley Wickham&rsquo;s bigrquery (first on CRAN January 2015) has shaped the basic design for how most R packages handle Google auth, directly or indirectly. I can certainly say that Joanna Zhao and I consulted it when developing googlesheets (first on CRAN July 2015). I know that Mark Edmondson was influenced, in turn, by googlesheets, when he developed googleAuthR (first on CRAN August 2015), used in his
<a href=https://code.markedmondson.me/r-packages/ target=_blank rel=noopener>suite of packages</a>. By the time Lucy D&rsquo;Agostino McGowan and I created googledrive (first on CRAN August 2017), I&rsquo;d developed some strong opinions about how to modify httr&rsquo;s default behaviour for work with Google APIs. I was also working with Hadley Wickham at RStudio by that point and Lucy and I benefited from his design advice. In May-ish 2017, leading up to
<a href=https://unconf17.ropensci.org target=_blank rel=noopener>rOpenSci&rsquo;s 2017 Unconf</a>, Craig Citro
<a href=https://github.com/ropensci/unconf17/issues/85 target=_blank rel=noopener>opened an issue</a> to generate discussion about how to de-duplicate even more API pain, especially for Google APIs. He has a wealth of experience from his role in shaping the
<a href=https://developers.google.com/api-client-library/ target=_blank rel=noopener>official Python client</a> and he made the initial commits that laid the foundation for <code>gargle::token_fetch()</code>.</p><p>Starting from a common origin (bigrquery), all these people and packages have explored different aspects of this problem space and have developed various solutions. gargle represents the distillation of a lot of hard-won experience and a promising space for future consolidation.</p><h2 id=thanks>Thanks!
<a href=#thanks><svg class="anchor-symbol" aria-hidden="true" height="26" width="26" viewBox="0 0 22 22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="currentcolor"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Thanks to all those who have helped get gargle to its first release:</p><p><a href=https://github.com/andrie target=_blank rel=noopener>@andrie</a>,
<a href=https://github.com/batpigandme target=_blank rel=noopener>@batpigandme</a>,
<a href=https://github.com/byapparov target=_blank rel=noopener>@byapparov</a>,
<a href=https://github.com/craigcitro target=_blank rel=noopener>@craigcitro</a>,
<a href=https://github.com/dlebech target=_blank rel=noopener>@dlebech</a>,
<a href=https://github.com/hadley target=_blank rel=noopener>@hadley</a>,
<a href=https://github.com/jennybc target=_blank rel=noopener>@jennybc</a>,
<a href=https://github.com/jonthegeek target=_blank rel=noopener>@jonthegeek</a>,
<a href=https://github.com/MarkEdmondson1234 target=_blank rel=noopener>@MarkEdmondson1234</a>,
<a href=https://github.com/wlongabaugh target=_blank rel=noopener>@wlongabaugh</a>, and
<a href=https://github.com/ZainRizvi target=_blank rel=noopener>@ZainRizvi</a></p></div></div><div class=column25><div class="section hideOnMobile"><div class=sectionTitle>Contents</div><nav id=TableOfContents><ul><li><a href=#gargle>gargle</a></li><li><a href=#auth-via-gargle>Auth via gargle</a></li><li><a href=#articles-and-docs>Articles and docs</a></li><li><a href=#privacy-policy-for-google-related-tidyverser-lib-packages>Privacy policy for Google-related tidyverse/r-lib packages</a></li><li><a href=#some-gargle-history>Some gargle history</a></li><li><a href=#thanks>Thanks!</a></li></ul></nav></div><div class=section></div></div></div></div></div><div id=rStudioFooter class=band><div class=bandContent><div id=copyright>The tidyverse is proudly supported by <a class=rstudioLogo href=https://posit.co/ aria-label="Posit Homepage"></a></div><div id=logos><a href=https://www.tidyverse.org/google_privacy_policy>Privacy policy</a>
<a href=https://github.com/tidyverse class="footerLogo gitHub" aria-label="Tidyverse GitHub organization"></a><a href=https://twitter.com/hashtag/rstats class="footerLogo twitter" aria-label="rstats hashtag on twitter.com"></a></div></div></div></div></div><script type=application/javascript>var dnt=(navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack);var doNotTrack=(dnt=="1"||dnt=="yes");if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');if(window.sessionStorage){var GA_SESSION_STORAGE_KEY='ga:clientId';ga('create','UA-115082821-1',{'storage':'none','clientId':sessionStorage.getItem(GA_SESSION_STORAGE_KEY)});ga(function(tracker){sessionStorage.setItem(GA_SESSION_STORAGE_KEY,tracker.get('clientId'));});}
ga('set','anonymizeIp',true);ga('send','pageview');}</script></body></html></div></div></body></html>